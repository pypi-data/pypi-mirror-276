[tox]
min_version = 4.0
env_list =
    py312
    py311
    py310
    py39
    type
    report

[tool:pytest]
testpaths = tests

[testenv]
setenv =
    py{312,311,310,39}: COVERAGE_FILE = .coverage.{envname}
deps =
  pytest
  pytest-cov
   -r requirements.txt
commands = pytest --cov actioncable_client --cov-report=
depends =
    report: py310,py39

[testenv:type]
deps =
  mypy
   -r requirements.txt
commands = mypy src

[testenv:report]
skip_install = true
deps = coverage
commands =
    coverage combine
    coverage xml
    coverage report --fail-under=10