{# -*- coding: utf-8 -*-

  Copyright (C) 2015-2021 CERN.
  Copyright (C)      2021 Graz University of Technology.
  Copyright (C) 2020-2022 TU Wien.

  Invenio is free software; you can redistribute it and/or modify it
  under the terms of the MIT License; see LICENSE file for more details.
#}

{#- base: invenio-oauthclient v2.3.0 #}
{#- changes: conditional super() call, customized heading #}
{#- TODO: this is horribly broken right now #}

{%- extends config.OAUTHCLIENT_LOGIN_USER_TEMPLATE_PARENT %}

{%- from "invenio_oauthclient/_macros.html" import oauth_button %}

{#- change: custom header 'log in to SITENAME' rather than 'log in to account' #}
{%- block form_header %}
  {#- TODO: probably misused heading #}
  <h3 class="ui login header">{{ _("Log in to") }} {{ config.THEME_SITENAME }}</h3>
{%- endblock -%}

{%- block form_outer %}
  {% if config.OAUTHCLIENT_REMOTE_APPS %}
    <div class="ui form">
      {%- for name in config.OAUTHCLIENT_REMOTE_APPS.keys() %}
        {{ oauth_button(name, next=request.args.get('next')) }}
      {%- endfor %}
    </div>

    {#- if the local login is enabled, show it #}
    {%- if config.ACCOUNTS_LOCAL_LOGIN_ENABLED %}
      <div class="ui horizontal divider">
        {{ _("Or") }}
      </div>
    {%- endif %}
  {%- endif %}

  {#- change: conditional super(), to prevent showing a 'login' button #}
  {#-         if there is no other input #}
  {%- if config.ACCOUNTS_LOCAL_LOGIN_ENABLED %}
    {{ super() }}
  {%- endif %}
{%- endblock %}
