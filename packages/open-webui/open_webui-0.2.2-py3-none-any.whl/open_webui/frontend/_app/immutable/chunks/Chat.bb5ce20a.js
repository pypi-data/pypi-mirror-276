import{s as Wt,E as le,F as ne,G as se,H as oe,w as ot,e as Ot,i as L,d as m,I as Ve,x as re,y as Xl,p as pt,f as I,g as M,h as S,L as te,Z as ke,u as x,v as ie,U as Ae,C as Mt,P as ce,a as J,l as _t,R as Kt,c as Q,m as bt,j as f,r as k,n as yt,K as ye,t as kt,W as Fe,z as mt,A as ht,X as Nt,Q as Qe,O as un,o as qe,S as we,B as fn,M as dn}from"./scheduler.96ee3362.js";import{S as Zt,i as Gt,a as O,t as R,g as zt,c as Ft,h as Kl,j as xl,k as Be,f as Ht,b as rt,d as it,m as at,e as ct}from"./index.7d87350f.js";import{g as mn}from"./globals.7f7f1b26.js";import{e as ee}from"./each.8122eab6.js";import{a as gt}from"./Toaster.svelte_svelte_type_style_lang.e88c75e4.js";import{M as hn,m as gn}from"./Messages.33790bb8.js";import{f as Ye}from"./dayjs.min.f771e3da.js";import{g as Pe}from"./navigation.74c7c429.js";import{p as pn}from"./stores.670b241c.js";import{p as _n,n as bn,e as Le,c as $l,f as ae,i as Ne,m as tn,a as He,S as Xe,r as Ke,W as en,h as ve,u as ln,j as vn,o as wn,g as Ce,O as Ue,v as xe}from"./index.8c78fced.js";import{f as nn,r as Re,i as $e,h as tl,v as el,p as ll,s as kn,a as nl,j as yn}from"./index.b3b584e7.js";import{q as En,r as Sn,s as In,t as Mn}from"./index.609edde9.js";import{u as Dn,n as sl,c as Cn,b as Te,j as je,i as Tn,x as Vn}from"./index.97c1ba9b.js";import{A as Bn,u as Nn,a as Hn,b as On,r as An}from"./AddFilesPlaceholder.e9a39835.js";import{t as ol}from"./index.c53b0f54.js";import"./sha256.8dba905a.js";import{T as me}from"./Tooltip.534e2f98.js";import{h as sn,j as Ln,f as We}from"./updater.31a4828a.js";import{D as on,M as Oe}from"./Dropdown.d3bf0ddf.js";import{s as Pn,g as Un,u as Rn,a as jn,M as rn}from"./menu-trigger.f5ee63a5.js";import{S as zn}from"./Switch.e0bc0fb7.js";import"./i18next.16542173.js";import{T as Fn,S as qn,U as Wn,q as Zn}from"./UserMenu.3c61b3d0.js";import{S as Gn}from"./Selector.5fb8d72d.js";import{d as Jn}from"./index.14530a0e.js";import{g as Ee}from"./spread.8a54911c.js";import{f as Qn}from"./FileSaver.min.898eb36f.js";import{b as Yn}from"./index.8935d89d.js";import"./paths.b4b02b7e.js";import{M as Xn}from"./MenuLines.fb3813b6.js";import{p as Kn}from"./index.0a2ad8e2.js";const xn=n=>({subIds:n&1}),rl=n=>({subIds:n[0]});function $n(n){let t;const e=n[6].default,l=le(e,n,n[5],rl);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,[r]){l&&l.p&&(!t||r&33)&&ne(l,e,s,s[5],t?oe(e,s[5],r,xn):se(s[5]),rl)},i(s){t||(O(l,s),t=!0)},o(s){R(l,s),t=!1},d(s){l&&l.d(s)}}}function ts(n,t,e){let l,{$$slots:s={},$$scope:r}=t,{disabled:o=void 0}=t,{open:i=void 0}=t,{onOpenChange:a=void 0}=t;const{updateOption:u,ids:c,states:{subOpen:d}}=Pn({disabled:o,onOpenChange:({next:v})=>(i!==v&&(a==null||a(v),e(2,i=v)),v)}),y=Jn([c.menu,c.trigger],([v,_])=>({menu:v,trigger:_}));return ot(n,y,v=>e(0,l=v)),n.$$set=v=>{"disabled"in v&&e(3,o=v.disabled),"open"in v&&e(2,i=v.open),"onOpenChange"in v&&e(4,a=v.onOpenChange),"$$scope"in v&&e(5,r=v.$$scope)},n.$$.update=()=>{n.$$.dirty&4&&i!==void 0&&d.set(i),n.$$.dirty&8&&u("disabled",o)},[l,y,i,o,a,r,s]}class es extends Zt{constructor(t){super(),Gt(this,t,ts,$n,Wt,{disabled:3,open:2,onOpenChange:4})}}const ls=n=>({builder:n[0]&256}),il=n=>({builder:n[8]}),ns=n=>({builder:n[0]&256}),al=n=>({builder:n[8]}),ss=n=>({builder:n[0]&256}),cl=n=>({builder:n[8]}),os=n=>({builder:n[0]&256}),ul=n=>({builder:n[8]}),rs=n=>({builder:n[0]&256}),fl=n=>({builder:n[8]}),is=n=>({builder:n[0]&256}),dl=n=>({builder:n[8]});function as(n){let t,e,l,s;const r=n[28].default,o=le(r,n,n[27],il);let i=[n[8],n[13]],a={};for(let u=0;u<i.length;u+=1)a=re(a,i[u]);return{c(){t=I("div"),o&&o.c(),this.h()},l(u){t=M(u,"DIV",{});var c=S(t);o&&o.l(c),c.forEach(m),this.h()},h(){te(t,a)},m(u,c){L(u,t,c),o&&o.m(t,null),n[33](t),e=!0,l||(s=[ke(n[8].action(t)),x(t,"m-focusout",n[12]),x(t,"m-keydown",n[12]),x(t,"m-pointermove",n[12])],l=!0)},p(u,c){o&&o.p&&(!e||c[0]&134217984)&&ne(o,r,u,u[27],e?oe(r,u[27],c,ls):se(u[27]),il),te(t,a=Ee(i,[c[0]&256&&u[8],c[0]&8192&&u[13]]))},i(u){e||(O(o,u),e=!0)},o(u){R(o,u),e=!1},d(u){u&&m(t),o&&o.d(u),n[33](null),l=!1,ie(s)}}}function cs(n){let t,e,l,s,r;const o=n[28].default,i=le(o,n,n[27],al);let a=[n[8],n[13]],u={};for(let c=0;c<a.length;c+=1)u=re(u,a[c]);return{c(){t=I("div"),i&&i.c(),this.h()},l(c){t=M(c,"DIV",{});var d=S(t);i&&i.l(d),d.forEach(m),this.h()},h(){te(t,u)},m(c,d){L(c,t,d),i&&i.m(t,null),n[32](t),l=!0,s||(r=[ke(n[8].action(t)),x(t,"m-focusout",n[12]),x(t,"m-keydown",n[12]),x(t,"m-pointermove",n[12])],s=!0)},p(c,d){n=c,i&&i.p&&(!l||d[0]&134217984)&&ne(i,o,n,n[27],l?oe(o,n[27],d,ns):se(n[27]),al),te(t,u=Ee(a,[d[0]&256&&n[8],d[0]&8192&&n[13]]))},i(c){l||(O(i,c),e&&e.end(1),l=!0)},o(c){R(i,c),c&&(e=Kl(t,n[5],n[6])),l=!1},d(c){c&&m(t),i&&i.d(c),n[32](null),c&&e&&e.end(),s=!1,ie(r)}}}function us(n){let t,e,l,s,r;const o=n[28].default,i=le(o,n,n[27],cl);let a=[n[8],n[13]],u={};for(let c=0;c<a.length;c+=1)u=re(u,a[c]);return{c(){t=I("div"),i&&i.c(),this.h()},l(c){t=M(c,"DIV",{});var d=S(t);i&&i.l(d),d.forEach(m),this.h()},h(){te(t,u)},m(c,d){L(c,t,d),i&&i.m(t,null),n[31](t),l=!0,s||(r=[ke(n[8].action(t)),x(t,"m-focusout",n[12]),x(t,"m-keydown",n[12]),x(t,"m-pointermove",n[12])],s=!0)},p(c,d){n=c,i&&i.p&&(!l||d[0]&134217984)&&ne(i,o,n,n[27],l?oe(o,n[27],d,ss):se(n[27]),cl),te(t,u=Ee(a,[d[0]&256&&n[8],d[0]&8192&&n[13]]))},i(c){l||(O(i,c),c&&(e||Ae(()=>{e=xl(t,n[3],n[4]),e.start()})),l=!0)},o(c){R(i,c),l=!1},d(c){c&&m(t),i&&i.d(c),n[31](null),s=!1,ie(r)}}}function fs(n){let t,e,l,s,r,o;const i=n[28].default,a=le(i,n,n[27],ul);let u=[n[8],n[13]],c={};for(let d=0;d<u.length;d+=1)c=re(c,u[d]);return{c(){t=I("div"),a&&a.c(),this.h()},l(d){t=M(d,"DIV",{});var y=S(t);a&&a.l(y),y.forEach(m),this.h()},h(){te(t,c)},m(d,y){L(d,t,y),a&&a.m(t,null),n[30](t),s=!0,r||(o=[ke(n[8].action(t)),x(t,"m-focusout",n[12]),x(t,"m-keydown",n[12]),x(t,"m-pointermove",n[12])],r=!0)},p(d,y){n=d,a&&a.p&&(!s||y[0]&134217984)&&ne(a,i,n,n[27],s?oe(i,n[27],y,os):se(n[27]),ul),te(t,c=Ee(u,[y[0]&256&&n[8],y[0]&8192&&n[13]]))},i(d){s||(O(a,d),d&&Ae(()=>{s&&(l&&l.end(1),e=xl(t,n[3],n[4]),e.start())}),s=!0)},o(d){R(a,d),e&&e.invalidate(),d&&(l=Kl(t,n[5],n[6])),s=!1},d(d){d&&m(t),a&&a.d(d),n[30](null),d&&l&&l.end(),r=!1,ie(o)}}}function ds(n){let t,e,l,s,r;const o=n[28].default,i=le(o,n,n[27],fl);let a=[n[8],n[13]],u={};for(let c=0;c<a.length;c+=1)u=re(u,a[c]);return{c(){t=I("div"),i&&i.c(),this.h()},l(c){t=M(c,"DIV",{});var d=S(t);i&&i.l(d),d.forEach(m),this.h()},h(){te(t,u)},m(c,d){L(c,t,d),i&&i.m(t,null),n[29](t),l=!0,s||(r=[ke(n[8].action(t)),x(t,"m-focusout",n[12]),x(t,"m-keydown",n[12]),x(t,"m-pointermove",n[12])],s=!0)},p(c,d){n=c,i&&i.p&&(!l||d[0]&134217984)&&ne(i,o,n,n[27],l?oe(o,n[27],d,rs):se(n[27]),fl),te(t,u=Ee(a,[d[0]&256&&n[8],d[0]&8192&&n[13]]))},i(c){l||(O(i,c),c&&Ae(()=>{l&&(e||(e=Be(t,n[1],n[2],!0)),e.run(1))}),l=!0)},o(c){R(i,c),c&&(e||(e=Be(t,n[1],n[2],!1)),e.run(0)),l=!1},d(c){c&&m(t),i&&i.d(c),n[29](null),c&&e&&e.end(),s=!1,ie(r)}}}function ms(n){let t;const e=n[28].default,l=le(e,n,n[27],dl);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,r){l&&l.p&&(!t||r[0]&134217984)&&ne(l,e,s,s[27],t?oe(e,s[27],r,is):se(s[27]),dl)},i(s){t||(O(l,s),t=!0)},o(s){R(l,s),t=!1},d(s){l&&l.d(s)}}}function hs(n){let t,e,l,s;const r=[ms,ds,fs,us,cs,as],o=[];function i(a,u){return a[7]&&a[9]?0:a[1]&&a[9]?1:a[3]&&a[5]&&a[9]?2:a[3]&&a[9]?3:a[5]&&a[9]?4:a[9]?5:-1}return~(t=i(n))&&(e=o[t]=r[t](n)),{c(){e&&e.c(),l=Ot()},l(a){e&&e.l(a),l=Ot()},m(a,u){~t&&o[t].m(a,u),L(a,l,u),s=!0},p(a,u){let c=t;t=i(a),t===c?~t&&o[t].p(a,u):(e&&(zt(),R(o[c],1,1,()=>{o[c]=null}),Ft()),~t?(e=o[t],e?e.p(a,u):(e=o[t]=r[t](a),e.c()),O(e,1),e.m(l.parentNode,l)):e=null)},i(a){s||(O(e),s=!0)},o(a){R(e),s=!1},d(a){a&&m(l),~t&&o[t].d(a)}}}function gs(n,t,e){let l;const s=["transition","transitionConfig","inTransition","inTransitionConfig","outTransition","outTransitionConfig","asChild","id","side","align","sideOffset","alignOffset","collisionPadding","avoidCollisions","collisionBoundary","sameWidth","fitViewport","strategy","overlap","el"];let r=Ve(t,s),o,i,{$$slots:a={},$$scope:u}=t,{transition:c=void 0}=t,{transitionConfig:d=void 0}=t,{inTransition:y=void 0}=t,{inTransitionConfig:v=void 0}=t,{outTransition:_=void 0}=t,{outTransitionConfig:b=void 0}=t,{asChild:h=!1}=t,{id:w=void 0}=t,{side:E="right"}=t,{align:D="start"}=t,{sideOffset:C=0}=t,{alignOffset:P=0}=t,{collisionPadding:T=8}=t,{avoidCollisions:V=!0}=t,{collisionBoundary:B=void 0}=t,{sameWidth:Y=!1}=t,{fitViewport:U=!1}=t,{strategy:A="absolute"}=t,{overlap:N=!1}=t,{el:ut=void 0}=t;const{elements:{subMenu:tt},states:{subOpen:lt},ids:Dt,getAttrs:Jt}=Un();ot(n,tt,z=>e(26,o=z)),ot(n,lt,z=>e(9,i=z));const At=sn(),St=Jt("sub-content");function Lt(z){pt[z?"unshift":"push"](()=>{ut=z,e(0,ut)})}function Vt(z){pt[z?"unshift":"push"](()=>{ut=z,e(0,ut)})}function qt(z){pt[z?"unshift":"push"](()=>{ut=z,e(0,ut)})}function Yt(z){pt[z?"unshift":"push"](()=>{ut=z,e(0,ut)})}function Qt(z){pt[z?"unshift":"push"](()=>{ut=z,e(0,ut)})}return n.$$set=z=>{t=re(re({},t),Xl(z)),e(13,r=Ve(t,s)),"transition"in z&&e(1,c=z.transition),"transitionConfig"in z&&e(2,d=z.transitionConfig),"inTransition"in z&&e(3,y=z.inTransition),"inTransitionConfig"in z&&e(4,v=z.inTransitionConfig),"outTransition"in z&&e(5,_=z.outTransition),"outTransitionConfig"in z&&e(6,b=z.outTransitionConfig),"asChild"in z&&e(7,h=z.asChild),"id"in z&&e(14,w=z.id),"side"in z&&e(15,E=z.side),"align"in z&&e(16,D=z.align),"sideOffset"in z&&e(17,C=z.sideOffset),"alignOffset"in z&&e(18,P=z.alignOffset),"collisionPadding"in z&&e(19,T=z.collisionPadding),"avoidCollisions"in z&&e(20,V=z.avoidCollisions),"collisionBoundary"in z&&e(21,B=z.collisionBoundary),"sameWidth"in z&&e(22,Y=z.sameWidth),"fitViewport"in z&&e(23,U=z.fitViewport),"strategy"in z&&e(24,A=z.strategy),"overlap"in z&&e(25,N=z.overlap),"el"in z&&e(0,ut=z.el),"$$scope"in z&&e(27,u=z.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&16384&&w&&Dt.menu.set(w),n.$$.dirty[0]&67108864&&e(8,l=o),n.$$.dirty[0]&256&&Object.assign(l,St),n.$$.dirty[0]&67076096&&Rn({side:E,align:D,sideOffset:C,alignOffset:P,collisionPadding:T,avoidCollisions:V,collisionBoundary:B,sameWidth:Y,fitViewport:U,strategy:A,overlap:N})},[ut,c,d,y,v,_,b,h,l,i,tt,lt,At,r,w,E,D,C,P,T,V,B,Y,U,A,N,o,u,a,Lt,Vt,qt,Yt,Qt]}class ps extends Zt{constructor(t){super(),Gt(this,t,gs,hs,Wt,{transition:1,transitionConfig:2,inTransition:3,inTransitionConfig:4,outTransition:5,outTransitionConfig:6,asChild:7,id:14,side:15,align:16,sideOffset:17,alignOffset:18,collisionPadding:19,avoidCollisions:20,collisionBoundary:21,sameWidth:22,fitViewport:23,strategy:24,overlap:25,el:0},null,[-1,-1])}}const _s=n=>({builder:n&4}),ml=n=>({builder:n[2]}),bs=n=>({builder:n&4}),hl=n=>({builder:n[2]});function vs(n){let t,e,l,s;const r=n[13].default,o=le(r,n,n[12],ml);let i=[n[2],n[6]],a={};for(let u=0;u<i.length;u+=1)a=re(a,i[u]);return{c(){t=I("div"),o&&o.c(),this.h()},l(u){t=M(u,"DIV",{});var c=S(t);o&&o.l(c),c.forEach(m),this.h()},h(){te(t,a)},m(u,c){L(u,t,c),o&&o.m(t,null),n[14](t),e=!0,l||(s=[ke(n[2].action(t)),x(t,"m-click",n[5]),x(t,"m-focusin",n[5]),x(t,"m-focusout",n[5]),x(t,"m-keydown",n[5]),x(t,"m-pointerleave",n[5]),x(t,"m-pointermove",n[5])],l=!0)},p(u,c){o&&o.p&&(!e||c&4100)&&ne(o,r,u,u[12],e?oe(r,u[12],c,_s):se(u[12]),ml),te(t,a=Ee(i,[c&4&&u[2],c&64&&u[6]]))},i(u){e||(O(o,u),e=!0)},o(u){R(o,u),e=!1},d(u){u&&m(t),o&&o.d(u),n[14](null),l=!1,ie(s)}}}function ws(n){let t;const e=n[13].default,l=le(e,n,n[12],hl);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,r){l&&l.p&&(!t||r&4100)&&ne(l,e,s,s[12],t?oe(e,s[12],r,bs):se(s[12]),hl)},i(s){t||(O(l,s),t=!0)},o(s){R(l,s),t=!1},d(s){l&&l.d(s)}}}function ks(n){let t,e,l,s;const r=[ws,vs],o=[];function i(a,u){return a[1]?0:1}return t=i(n),e=o[t]=r[t](n),{c(){e.c(),l=Ot()},l(a){e.l(a),l=Ot()},m(a,u){o[t].m(a,u),L(a,l,u),s=!0},p(a,[u]){let c=t;t=i(a),t===c?o[t].p(a,u):(zt(),R(o[c],1,1,()=>{o[c]=null}),Ft(),e=o[t],e?e.p(a,u):(e=o[t]=r[t](a),e.c()),O(e,1),e.m(l.parentNode,l))},i(a){s||(O(e),s=!0)},o(a){R(e),s=!1},d(a){a&&m(l),o[t].d(a)}}}function ys(n,t,e){let l,s;const r=["disabled","asChild","id","el"];let o=Ve(t,r),i,a,{$$slots:u={},$$scope:c}=t,{disabled:d=!1}=t,{asChild:y=!1}=t,{id:v=void 0}=t,{el:_=void 0}=t;const{elements:{subTrigger:b},ids:h,getAttrs:w,options:E}=jn();ot(n,b,T=>e(11,a=T));const{disabled:D}=E;ot(n,D,T=>e(10,i=T));const C=sn();function P(T){pt[T?"unshift":"push"](()=>{_=T,e(0,_)})}return n.$$set=T=>{t=re(re({},t),Xl(T)),e(6,o=Ve(t,r)),"disabled"in T&&e(7,d=T.disabled),"asChild"in T&&e(1,y=T.asChild),"id"in T&&e(8,v=T.id),"el"in T&&e(0,_=T.el),"$$scope"in T&&e(12,c=T.$$scope)},n.$$.update=()=>{n.$$.dirty&256&&v&&h.trigger.set(v),n.$$.dirty&2048&&e(2,l=a),n.$$.dirty&1152&&e(9,s={...w("sub-trigger"),...Ln(d||i)}),n.$$.dirty&516&&Object.assign(l,s)},[_,y,l,b,D,C,o,d,v,s,i,a,c,u,P]}class Es extends Zt{constructor(t){super(),Gt(this,t,ys,ks,Wt,{disabled:7,asChild:1,id:8,el:0})}}function gl(n,t,e){const l=n.slice();return l[11]=t[e],l[13]=e,l}function pl(n){let t,e,l,s='<div class="text-lg font-semibold mt-2">/</div>',r,o,i,a,u,c,d='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg>',y,v,_=n[2].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"",b,h=ee(n[1]),w=[];for(let E=0;E<h.length;E+=1)w[E]=_l(gl(n,h,E));return{c(){t=I("div"),e=I("div"),l=I("div"),l.innerHTML=s,r=J(),o=I("div"),i=I("div");for(let E=0;E<w.length;E+=1)w[E].c();a=J(),u=I("div"),c=I("div"),c.innerHTML=d,y=J(),v=I("div"),b=_t(_),this.h()},l(E){t=M(E,"DIV",{class:!0});var D=S(t);e=M(D,"DIV",{class:!0});var C=S(e);l=M(C,"DIV",{class:!0,"data-svelte-h":!0}),Kt(l)!=="svelte-1ynv172"&&(l.innerHTML=s),r=Q(C),o=M(C,"DIV",{class:!0});var P=S(o);i=M(P,"DIV",{class:!0});var T=S(i);for(let Y=0;Y<w.length;Y+=1)w[Y].l(T);T.forEach(m),a=Q(P),u=M(P,"DIV",{class:!0});var V=S(u);c=M(V,"DIV",{"data-svelte-h":!0}),Kt(c)!=="svelte-cdi12d"&&(c.innerHTML=d),y=Q(V),v=M(V,"DIV",{class:!0});var B=S(v);b=bt(B,_),B.forEach(m),V.forEach(m),P.forEach(m),C.forEach(m),D.forEach(m),this.h()},h(){f(l,"class","bg-gray-100 dark:bg-gray-700 w-10 rounded-l-xl text-center"),f(i,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5"),f(v,"class","line-clamp-1"),f(u,"class","px-2 pb-1 text-xs text-gray-600 bg-white rounded-br-xl flex items-center space-x-1"),f(o,"class","max-h-60 flex flex-col w-full rounded-r-xl bg-white"),f(e,"class","flex w-full px-2"),f(t,"class","md:px-2 mb-3 text-left w-full absolute bottom-0 left-0 right-0")},m(E,D){L(E,t,D),k(t,e),k(e,l),k(e,r),k(e,o),k(o,i);for(let C=0;C<w.length;C+=1)w[C]&&w[C].m(i,null);k(o,a),k(o,u),k(u,c),k(u,y),k(u,v),k(v,b)},p(E,D){if(D&19){h=ee(E[1]);let C;for(C=0;C<h.length;C+=1){const P=gl(E,h,C);w[C]?w[C].p(P,D):(w[C]=_l(P),w[C].c(),w[C].m(i,null))}for(;C<w.length;C+=1)w[C].d(1);w.length=h.length}D&4&&_!==(_=E[2].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"")&&yt(b,_)},d(E){E&&m(t),ye(w,E)}}}function _l(n){let t,e,l=n[11].command+"",s,r,o,i=n[11].title+"",a,u,c,d,y;function v(){return n[9](n[11])}function _(){return n[10](n[13])}return{c(){t=I("button"),e=I("div"),s=_t(l),r=J(),o=I("div"),a=_t(i),u=J(),this.h()},l(b){t=M(b,"BUTTON",{class:!0,type:!0});var h=S(t);e=M(h,"DIV",{class:!0});var w=S(e);s=bt(w,l),w.forEach(m),r=Q(h),o=M(h,"DIV",{class:!0});var E=S(o);a=bt(E,i),E.forEach(m),u=Q(h),h.forEach(m),this.h()},h(){f(e,"class","font-medium text-black"),f(o,"class","text-xs text-gray-600"),f(t,"class",c="px-3 py-1.5 rounded-xl w-full text-left "+(n[13]===n[0]?" bg-gray-100 selected-command-option-button":"")),f(t,"type","button")},m(b,h){L(b,t,h),k(t,e),k(e,s),k(t,r),k(t,o),k(o,a),k(t,u),d||(y=[x(t,"click",v),x(t,"mousemove",_),x(t,"focus",Is)],d=!0)},p(b,h){n=b,h&2&&l!==(l=n[11].command+"")&&yt(s,l),h&2&&i!==(i=n[11].title+"")&&yt(a,i),h&1&&c!==(c="px-3 py-1.5 rounded-xl w-full text-left "+(n[13]===n[0]?" bg-gray-100 selected-command-option-button":""))&&f(t,"class",c)},d(b){b&&m(t),d=!1,ie(y)}}}function Ss(n){let t,e=n[1].length>0&&pl(n);return{c(){e&&e.c(),t=Ot()},l(l){e&&e.l(l),t=Ot()},m(l,s){e&&e.m(l,s),L(l,t,s)},p(l,[s]){l[1].length>0?e?e.p(l,s):(e=pl(l),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:Mt,o:Mt,d(l){l&&m(t),e&&e.d(l)}}}const Is=()=>{};function Ms(n,t,e){let l,s;ot(n,_n,_=>e(8,s=_));const r=ce("i18n");ot(n,r,_=>e(2,l=_));let{prompt:o=""}=t,i=0,a=[];const u=()=>{e(0,i=Math.max(0,i-1))},c=()=>{e(0,i=Math.min(i+1,a.length-1))},d=async _=>{let b=_.content;if(_.content.includes("{{CLIPBOARD}}")){const E=await navigator.clipboard.readText().catch(D=>(gt.error(l.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));b=_.content.replaceAll("{{CLIPBOARD}}",E)}e(5,o=b);const h=document.getElementById("chat-textarea");await kt(),h.style.height="",h.style.height=Math.min(h.scrollHeight,200)+"px",h==null||h.focus(),await kt();const w=nn(o);if(w.length>0){const E=w.at(0);h.setSelectionRange(E==null?void 0:E.startIndex,E.endIndex+1)}},y=_=>{d(_)},v=_=>{e(0,i=_)};return n.$$set=_=>{"prompt"in _&&e(5,o=_.prompt)},n.$$.update=()=>{n.$$.dirty&288&&e(1,a=s.filter(_=>_.command.includes(o)).sort((_,b)=>_.title.localeCompare(b.title))),n.$$.dirty&32&&o&&e(0,i=0)},[i,a,l,r,d,o,u,c,s,y,v]}class Ds extends Zt{constructor(t){super(),Gt(this,t,Ms,Ss,Wt,{prompt:5,selectUp:6,selectDown:7})}get selectUp(){return this.$$.ctx[6]}get selectDown(){return this.$$.ctx[7]}}function bl(n,t,e){const l=n.slice();return l[19]=t[e],l[21]=e,l}function vl(n){let t,e,l,s='<div class="text-lg font-semibold mt-2">#</div>',r,o,i,a,u,c,d=ee(n[3]),y=[];for(let h=0;h<d.length;h+=1)y[h]=wl(bl(n,d,h));function v(h,w){var E,D;if(w&1&&(u=null),w&1&&(c=null),u==null&&(u=!!h[0].split(" ").some(Hs)),u)return Bs;if(c==null&&(c=!!((D=(E=h[0].split(" "))==null?void 0:E.at(0))!=null&&D.substring(1).startsWith("http"))),c)return Vs}let _=v(n,-1),b=_&&_(n);return{c(){t=I("div"),e=I("div"),l=I("div"),l.innerHTML=s,r=J(),o=I("div"),i=I("div");for(let h=0;h<y.length;h+=1)y[h].c();a=J(),b&&b.c(),this.h()},l(h){t=M(h,"DIV",{class:!0});var w=S(t);e=M(w,"DIV",{class:!0});var E=S(e);l=M(E,"DIV",{class:!0,"data-svelte-h":!0}),Kt(l)!=="svelte-czbw16"&&(l.innerHTML=s),r=Q(E),o=M(E,"DIV",{class:!0});var D=S(o);i=M(D,"DIV",{class:!0});var C=S(i);for(let P=0;P<y.length;P+=1)y[P].l(C);a=Q(C),b&&b.l(C),C.forEach(m),D.forEach(m),E.forEach(m),w.forEach(m),this.h()},h(){f(l,"class","bg-gray-100 dark:bg-gray-700 w-10 rounded-l-xl text-center"),f(i,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5"),f(o,"class","max-h-60 flex flex-col w-full rounded-r-xl bg-white"),f(e,"class","flex w-full px-2"),f(t,"class","md:px-2 mb-3 text-left w-full absolute bottom-0 left-0 right-0")},m(h,w){L(h,t,w),k(t,e),k(e,l),k(e,r),k(e,o),k(o,i);for(let E=0;E<y.length;E+=1)y[E]&&y[E].m(i,null);k(i,a),b&&b.m(i,null)},p(h,w){if(w&46){d=ee(h[3]);let E;for(E=0;E<d.length;E+=1){const D=bl(h,d,E);y[E]?y[E].p(D,w):(y[E]=wl(D),y[E].c(),y[E].m(i,a))}for(;E<y.length;E+=1)y[E].d(1);y.length=d.length}_===(_=v(h,w))&&b?b.p(h,w):(b&&b.d(1),b=_&&_(h),b&&(b.c(),b.m(i,null)))},d(h){h&&m(t),ye(y,h),b&&b.d()}}}function Cs(n){let t,e,l=n[19].name+"",s,r,o=n[19].filename+"",i,a,u,c,d=n[19].title+"",y;return{c(){t=I("div"),e=_t("#"),s=_t(l),r=_t(" ("),i=_t(o),a=_t(")"),u=J(),c=I("div"),y=_t(d),this.h()},l(v){t=M(v,"DIV",{class:!0});var _=S(t);e=bt(_,"#"),s=bt(_,l),r=bt(_," ("),i=bt(_,o),a=bt(_,")"),_.forEach(m),u=Q(v),c=M(v,"DIV",{class:!0});var b=S(c);y=bt(b,d),b.forEach(m),this.h()},h(){f(t,"class","font-medium text-black line-clamp-1"),f(c,"class","text-xs text-gray-600 line-clamp-1")},m(v,_){L(v,t,_),k(t,e),k(t,s),k(t,r),k(t,i),k(t,a),L(v,u,_),L(v,c,_),k(c,y)},p(v,_){_&8&&l!==(l=v[19].name+"")&&yt(s,l),_&8&&o!==(o=v[19].filename+"")&&yt(i,o),_&8&&d!==(d=v[19].title+"")&&yt(y,d)},d(v){v&&(m(t),m(u),m(c))}}}function Ts(n){var a;let t,e=(((a=n[19])==null?void 0:a.title)??`#${n[19].name}`)+"",l,s,r,o=n[1].t("Collection")+"",i;return{c(){t=I("div"),l=_t(e),s=J(),r=I("div"),i=_t(o),this.h()},l(u){t=M(u,"DIV",{class:!0});var c=S(t);l=bt(c,e),c.forEach(m),s=Q(u),r=M(u,"DIV",{class:!0});var d=S(r);i=bt(d,o),d.forEach(m),this.h()},h(){f(t,"class","font-medium text-black line-clamp-1"),f(r,"class","text-xs text-gray-600 line-clamp-1")},m(u,c){L(u,t,c),k(t,l),L(u,s,c),L(u,r,c),k(r,i)},p(u,c){var d;c&8&&e!==(e=(((d=u[19])==null?void 0:d.title)??`#${u[19].name}`)+"")&&yt(l,e),c&2&&o!==(o=u[1].t("Collection")+"")&&yt(i,o)},d(u){u&&(m(t),m(s),m(r))}}}function wl(n){let t,e,l,s;function r(c,d){return c[19].type==="collection"?Ts:Cs}let o=r(n),i=o(n);function a(){return n[14](n[19])}function u(){return n[15](n[21])}return{c(){t=I("button"),i.c(),this.h()},l(c){t=M(c,"BUTTON",{class:!0,type:!0});var d=S(t);i.l(d),d.forEach(m),this.h()},h(){f(t,"class",e="px-3 py-1.5 rounded-xl w-full text-left "+(n[21]===n[2]?" bg-gray-100 selected-command-option-button":"")),f(t,"type","button")},m(c,d){L(c,t,d),i.m(t,null),l||(s=[x(t,"click",a),x(t,"mousemove",u),x(t,"focus",Os)],l=!0)},p(c,d){n=c,o===(o=r(n))&&i?i.p(n,d):(i.d(1),i=o(n),i&&(i.c(),i.m(t,null))),d&4&&e!==(e="px-3 py-1.5 rounded-xl w-full text-left "+(n[21]===n[2]?" bg-gray-100 selected-command-option-button":""))&&f(t,"class",e)},d(c){c&&m(t),i.d(),l=!1,ie(s)}}}function Vs(n){var d,y;let t,e,l=((y=(d=n[0].split(" "))==null?void 0:d.at(0))==null?void 0:y.substring(1))+"",s,r,o,i=n[1].t("Web")+"",a,u,c;return{c(){t=I("button"),e=I("div"),s=_t(l),r=J(),o=I("div"),a=_t(i),this.h()},l(v){t=M(v,"BUTTON",{class:!0,type:!0});var _=S(t);e=M(_,"DIV",{class:!0});var b=S(e);s=bt(b,l),b.forEach(m),r=Q(_),o=M(_,"DIV",{class:!0});var h=S(o);a=bt(h,i),h.forEach(m),_.forEach(m),this.h()},h(){f(e,"class","font-medium text-black line-clamp-1"),f(o,"class","text-xs text-gray-600 line-clamp-1"),f(t,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-100 selected-command-option-button"),f(t,"type","button")},m(v,_){L(v,t,_),k(t,e),k(e,s),k(t,r),k(t,o),k(o,a),u||(c=x(t,"click",n[17]),u=!0)},p(v,_){var b,h;_&1&&l!==(l=((h=(b=v[0].split(" "))==null?void 0:b.at(0))==null?void 0:h.substring(1))+"")&&yt(s,l),_&2&&i!==(i=v[1].t("Web")+"")&&yt(a,i)},d(v){v&&m(t),u=!1,c()}}}function Bs(n){var d,y;let t,e,l=((y=(d=n[0].split(" "))==null?void 0:d.at(0))==null?void 0:y.substring(1))+"",s,r,o,i=n[1].t("Youtube")+"",a,u,c;return{c(){t=I("button"),e=I("div"),s=_t(l),r=J(),o=I("div"),a=_t(i),this.h()},l(v){t=M(v,"BUTTON",{class:!0,type:!0});var _=S(t);e=M(_,"DIV",{class:!0});var b=S(e);s=bt(b,l),b.forEach(m),r=Q(_),o=M(_,"DIV",{class:!0});var h=S(o);a=bt(h,i),h.forEach(m),_.forEach(m),this.h()},h(){f(e,"class","font-medium text-black line-clamp-1"),f(o,"class","text-xs text-gray-600 line-clamp-1"),f(t,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-100 selected-command-option-button"),f(t,"type","button")},m(v,_){L(v,t,_),k(t,e),k(e,s),k(t,r),k(t,o),k(o,a),u||(c=x(t,"click",n[16]),u=!0)},p(v,_){var b,h;_&1&&l!==(l=((h=(b=v[0].split(" "))==null?void 0:b.at(0))==null?void 0:h.substring(1))+"")&&yt(s,l),_&2&&i!==(i=v[1].t("Youtube")+"")&&yt(a,i)},d(v){v&&m(t),u=!1,c()}}}function Ns(n){var s,r;let t=n[3].length>0||((r=(s=n[0].split(" "))==null?void 0:s.at(0))==null?void 0:r.substring(1).startsWith("http")),e,l=t&&vl(n);return{c(){l&&l.c(),e=Ot()},l(o){l&&l.l(o),e=Ot()},m(o,i){l&&l.m(o,i),L(o,e,i)},p(o,[i]){var a,u;i&9&&(t=o[3].length>0||((u=(a=o[0].split(" "))==null?void 0:a.at(0))==null?void 0:u.substring(1).startsWith("http"))),t?l?l.p(o,i):(l=vl(o),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:Mt,o:Mt,d(o){o&&m(e),l&&l.d(o)}}}const Hs=n=>n.substring(1).startsWith("https://www.youtube.com")||n.substring(1).startsWith("https://youtu.be"),Os=()=>{};function As(n,t,e){let l,s,r;ot(n,bn,T=>e(13,s=T));const o=ce("i18n");ot(n,o,T=>e(1,r=T));let{prompt:i=""}=t;const a=Fe();let u=0,c=[],d=[],y=[];const v=()=>{e(2,u=Math.max(0,u-1))},_=()=>{e(2,u=Math.min(u+1,c.length-1))},b=async T=>{a("select",T),e(0,i=Re(i));const V=document.getElementById("chat-textarea");await kt(),V==null||V.focus(),await kt()},h=async T=>{a("url",T),e(0,i=Re(i));const V=document.getElementById("chat-textarea");await kt(),V==null||V.focus(),await kt()},w=async T=>{a("youtube",T),e(0,i=Re(i));const V=document.getElementById("chat-textarea");await kt(),V==null||V.focus(),await kt()},E=T=>{console.log(T),b(T)},D=T=>{e(2,u=T)},C=()=>{var V,B;const T=(B=(V=i.split(" "))==null?void 0:V.at(0))==null?void 0:B.substring(1);$e(T)?w(T):gt.error(r.t("Oops! Looks like the URL is invalid. Please double-check and try again."))},P=()=>{var V,B;const T=(B=(V=i.split(" "))==null?void 0:V.at(0))==null?void 0:B.substring(1);$e(T)?h(T):gt.error(r.t("Oops! Looks like the URL is invalid. Please double-check and try again."))};return n.$$set=T=>{"prompt"in T&&e(0,i=T.prompt)},n.$$.update=()=>{n.$$.dirty&8194&&e(11,y=[...s.length>0?[{name:"All Documents",type:"collection",title:r.t("All Documents"),collection_names:s.map(T=>T.collection_name)}]:[],...s.reduce((T,V,B,Y)=>{var U;return[...new Set([...T,...(((U=V==null?void 0:V.content)==null?void 0:U.tags)??[]).map(A=>A.name)])]},[]).map(T=>({name:T,type:"collection",collection_names:s.filter(V=>{var B;return(((B=V==null?void 0:V.content)==null?void 0:B.tags)??[]).map(Y=>Y.name).includes(T)}).map(V=>V.collection_name)}))]),n.$$.dirty&2049&&e(12,l=y.filter(T=>{var V,B;return T.name.includes(((B=(V=i.split(" "))==null?void 0:V.at(0))==null?void 0:B.substring(1))??"")}).sort((T,V)=>T.name.localeCompare(V.name))),n.$$.dirty&8193&&e(10,d=s.filter(T=>{var V,B;return T.name.includes(((B=(V=i.split(" "))==null?void 0:V.at(0))==null?void 0:B.substring(1))??"")}).sort((T,V)=>T.title.localeCompare(V.title))),n.$$.dirty&5120&&e(3,c=[...l,...d]),n.$$.dirty&4097&&i&&(e(2,u=0),console.log(l))},[i,r,u,c,o,b,h,w,v,_,d,y,l,s,E,D,C,P]}class Ls extends Zt{constructor(t){super(),Gt(this,t,As,Ns,Wt,{prompt:0,selectUp:8,selectDown:9})}get selectUp(){return this.$$.ctx[8]}get selectDown(){return this.$$.ctx[9]}}function kl(n,t,e){const l=n.slice();return l[16]=t[e],l[18]=e,l}function yl(n){let t,e=n[2].length>0&&El(n);return{c(){e&&e.c(),t=Ot()},l(l){e&&e.l(l),t=Ot()},m(l,s){e&&e.m(l,s),L(l,t,s)},p(l,s){l[2].length>0?e?e.p(l,s):(e=El(l),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(l){l&&m(t),e&&e.d(l)}}}function El(n){let t,e,l,s='<div class="text-lg font-semibold mt-2">@</div>',r,o,i,a=ee(n[2]),u=[];for(let c=0;c<a.length;c+=1)u[c]=Sl(kl(n,a,c));return{c(){t=I("div"),e=I("div"),l=I("div"),l.innerHTML=s,r=J(),o=I("div"),i=I("div");for(let c=0;c<u.length;c+=1)u[c].c();this.h()},l(c){t=M(c,"DIV",{class:!0});var d=S(t);e=M(d,"DIV",{class:!0});var y=S(e);l=M(y,"DIV",{class:!0,"data-svelte-h":!0}),Kt(l)!=="svelte-1ourwwn"&&(l.innerHTML=s),r=Q(y),o=M(y,"DIV",{class:!0});var v=S(o);i=M(v,"DIV",{class:!0});var _=S(i);for(let b=0;b<u.length;b+=1)u[b].l(_);_.forEach(m),v.forEach(m),y.forEach(m),d.forEach(m),this.h()},h(){f(l,"class","bg-gray-100 dark:bg-gray-700 w-10 rounded-l-xl text-center"),f(i,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5"),f(o,"class","max-h-60 flex flex-col w-full rounded-r-xl bg-white"),f(e,"class","flex w-full px-2"),f(t,"class","md:px-2 mb-3 text-left w-full absolute bottom-0 left-0 right-0")},m(c,d){L(c,t,d),k(t,e),k(e,l),k(e,r),k(e,o),k(o,i);for(let y=0;y<u.length;y+=1)u[y]&&u[y].m(i,null)},p(c,d){if(d&22){a=ee(c[2]);let y;for(y=0;y<a.length;y+=1){const v=kl(c,a,y);u[y]?u[y].p(v,d):(u[y]=Sl(v),u[y].c(),u[y].m(i,null))}for(;y<u.length;y+=1)u[y].d(1);u.length=a.length}},d(c){c&&m(t),ye(u,c)}}}function Sl(n){let t,e,l=n[16].name+"",s,r,o,i,a;function u(){return n[11](n[16])}function c(){return n[12](n[18])}return{c(){t=I("button"),e=I("div"),s=_t(l),r=J(),this.h()},l(d){t=M(d,"BUTTON",{class:!0,type:!0});var y=S(t);e=M(y,"DIV",{class:!0});var v=S(e);s=bt(v,l),v.forEach(m),r=Q(y),y.forEach(m),this.h()},h(){f(e,"class","font-medium text-black line-clamp-1"),f(t,"class",o="px-3 py-1.5 rounded-xl w-full text-left "+(n[18]===n[1]?" bg-gray-100 selected-command-option-button":"")),f(t,"type","button")},m(d,y){L(d,t,y),k(t,e),k(e,s),k(t,r),i||(a=[x(t,"click",u),x(t,"mousemove",c),x(t,"focus",Us)],i=!0)},p(d,y){n=d,y&4&&l!==(l=n[16].name+"")&&yt(s,l),y&2&&o!==(o="px-3 py-1.5 rounded-xl w-full text-left "+(n[18]===n[1]?" bg-gray-100 selected-command-option-button":""))&&f(t,"class",o)},d(d){d&&m(t),i=!1,ie(a)}}}function Ps(n){let t=n[0].charAt(0)==="@",e,l=t&&yl(n);return{c(){l&&l.c(),e=Ot()},l(s){l&&l.l(s),e=Ot()},m(s,r){l&&l.m(s,r),L(s,e,r)},p(s,[r]){r&1&&(t=s[0].charAt(0)==="@"),t?l?l.p(s,r):(l=yl(s),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:Mt,o:Mt,d(s){s&&m(e),l&&l.d(s)}}}const Us=()=>{};function Rs(n,t,e){let l;ot(n,Le,w=>e(10,l=w));const s=ce("i18n");ot(n,s,w=>e(13,w));const r=Fe();let{prompt:o=""}=t,{user:i=null}=t,{chatInputPlaceholder:a=""}=t,{messages:u=[]}=t,c=0,d=[];const y=()=>{e(1,c=Math.max(0,c-1))},v=()=>{e(1,c=Math.min(c+1,d.length-1))},_=async w=>{e(0,o=""),r("select",w)},b=w=>{_(w)},h=w=>{e(1,c=w)};return n.$$set=w=>{"prompt"in w&&e(0,o=w.prompt),"user"in w&&e(5,i=w.user),"chatInputPlaceholder"in w&&e(6,a=w.chatInputPlaceholder),"messages"in w&&e(7,u=w.messages)},n.$$.update=()=>{n.$$.dirty&1025&&e(2,d=l.filter(w=>{var E,D;return w.name.includes(((D=(E=o.split(" "))==null?void 0:E.at(0))==null?void 0:D.substring(1))??"")}).sort((w,E)=>w.name.localeCompare(E.name))),n.$$.dirty&1&&o&&e(1,c=0)},[o,c,d,s,_,i,a,u,y,v,l,b,h]}class js extends Zt{constructor(t){super(),Gt(this,t,Rs,Ps,Wt,{prompt:0,user:5,chatInputPlaceholder:6,messages:7,selectUp:8,selectDown:9})}get selectUp(){return this.$$.ctx[8]}get selectDown(){return this.$$.ctx[9]}}function zs(n){let t,e;return{c(){t=mt("svg"),e=mt("path"),this.h()},l(l){t=ht(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=S(t);e=ht(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(e).forEach(m),s.forEach(m),this.h()},h(){f(e,"stroke-linecap","round"),f(e,"stroke-linejoin","round"),f(e,"d","M6 18 18 6M6 6l12 12"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"fill","none"),f(t,"viewBox","0 0 24 24"),f(t,"stroke-width",n[1]),f(t,"stroke","currentColor"),f(t,"class",n[0])},m(l,s){L(l,t,s),k(t,e)},p(l,[s]){s&2&&f(t,"stroke-width",l[1]),s&1&&f(t,"class",l[0])},i:Mt,o:Mt,d(l){l&&m(t)}}}function Fs(n,t,e){let{className:l="size-3.5"}=t,{strokeWidth:s="2"}=t;return n.$$set=r=>{"className"in r&&e(0,l=r.className),"strokeWidth"in r&&e(1,s=r.strokeWidth)},[l,s]}class qs extends Zt{constructor(t){super(),Gt(this,t,Fs,zs,Wt,{className:0,strokeWidth:1})}}function Ws(n){let t,e,l;return{c(){t=mt("svg"),e=mt("path"),l=mt("path"),this.h()},l(s){t=ht(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var r=S(t);e=ht(r,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(e).forEach(m),l=ht(r,"path",{d:!0}),S(l).forEach(m),r.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M5.625 1.5H9a3.75 3.75 0 0 1 3.75 3.75v1.875c0 1.036.84 1.875 1.875 1.875H16.5a3.75 3.75 0 0 1 3.75 3.75v7.875c0 1.035-.84 1.875-1.875 1.875H5.625a1.875 1.875 0 0 1-1.875-1.875V3.375c0-1.036.84-1.875 1.875-1.875Zm6.905 9.97a.75.75 0 0 0-1.06 0l-3 3a.75.75 0 1 0 1.06 1.06l1.72-1.72V18a.75.75 0 0 0 1.5 0v-4.19l1.72 1.72a.75.75 0 1 0 1.06-1.06l-3-3Z"),f(e,"clip-rule","evenodd"),f(l,"d","M14.25 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 16.5 7.5h-1.875a.375.375 0 0 1-.375-.375V5.25Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class",n[0])},m(s,r){L(s,t,r),k(t,e),k(t,l)},p(s,[r]){r&1&&f(t,"class",s[0])},i:Mt,o:Mt,d(s){s&&m(t)}}}function Zs(n,t,e){let{className:l="size-4"}=t;return n.$$set=s=>{"className"in s&&e(0,l=s.className)},[l]}class Gs extends Zt{constructor(t){super(),Gt(this,t,Zs,Ws,Wt,{className:0})}}function Js(n){let t,e;return{c(){t=mt("svg"),e=mt("path"),this.h()},l(l){t=ht(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var s=S(t);e=ht(s,"path",{d:!0}),S(e).forEach(m),s.forEach(m),this.h()},h(){f(e,"d","M21.721 12.752a9.711 9.711 0 0 0-.945-5.003 12.754 12.754 0 0 1-4.339 2.708 18.991 18.991 0 0 1-.214 4.772 17.165 17.165 0 0 0 5.498-2.477ZM14.634 15.55a17.324 17.324 0 0 0 .332-4.647c-.952.227-1.945.347-2.966.347-1.021 0-2.014-.12-2.966-.347a17.515 17.515 0 0 0 .332 4.647 17.385 17.385 0 0 0 5.268 0ZM9.772 17.119a18.963 18.963 0 0 0 4.456 0A17.182 17.182 0 0 1 12 21.724a17.18 17.18 0 0 1-2.228-4.605ZM7.777 15.23a18.87 18.87 0 0 1-.214-4.774 12.753 12.753 0 0 1-4.34-2.708 9.711 9.711 0 0 0-.944 5.004 17.165 17.165 0 0 0 5.498 2.477ZM21.356 14.752a9.765 9.765 0 0 1-7.478 6.817 18.64 18.64 0 0 0 1.988-4.718 18.627 18.627 0 0 0 5.49-2.098ZM2.644 14.752c1.682.971 3.53 1.688 5.49 2.099a18.64 18.64 0 0 0 1.988 4.718 9.765 9.765 0 0 1-7.478-6.816ZM13.878 2.43a9.755 9.755 0 0 1 6.116 3.986 11.267 11.267 0 0 1-3.746 2.504 18.63 18.63 0 0 0-2.37-6.49ZM12 2.276a17.152 17.152 0 0 1 2.805 7.121c-.897.23-1.837.353-2.805.353-.968 0-1.908-.122-2.805-.353A17.151 17.151 0 0 1 12 2.276ZM10.122 2.43a18.629 18.629 0 0 0-2.37 6.49 11.266 11.266 0 0 1-3.746-2.504 9.754 9.754 0 0 1 6.116-3.985Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class",n[0])},m(l,s){L(l,t,s),k(t,e)},p(l,[s]){s&1&&f(t,"class",l[0])},i:Mt,o:Mt,d(l){l&&m(t)}}}function Qs(n,t,e){let{className:l="size-4"}=t;return n.$$set=s=>{"className"in s&&e(0,l=s.className)},[l]}class Ys extends Zt{constructor(t){super(),Gt(this,t,Qs,Js,Wt,{className:0})}}function Xs(n){let t;const e=n[7].default,l=le(e,n,n[12],null);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,r){l&&l.p&&(!t||r&4096)&&ne(l,e,s,s[12],t?oe(e,s[12],r,null):se(s[12]),null)},i(s){t||(O(l,s),t=!0)},o(s){R(l,s),t=!1},d(s){l&&l.d(s)}}}function Ks(n){let t,e;return t=new me({props:{content:n[5].t("More"),$$slots:{default:[Xs]},$$scope:{ctx:n}}}),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,s){const r={};s&32&&(r.content=l[5].t("More")),s&4096&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(O(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function Il(n){let t,e,l,s,r,o=n[5].t("Web Search")+"",i,a,u,c,d,y,v;l=new Ys({});function _(h){n[8](h)}let b={};return n[0]!==void 0&&(b.state=n[0]),u=new zn({props:b}),pt.push(()=>Ht(u,"state",_)),{c(){t=I("div"),e=I("div"),rt(l.$$.fragment),s=J(),r=I("div"),i=_t(o),a=J(),rt(u.$$.fragment),d=J(),y=I("hr"),this.h()},l(h){t=M(h,"DIV",{class:!0});var w=S(t);e=M(w,"DIV",{class:!0});var E=S(e);it(l.$$.fragment,E),s=Q(E),r=M(E,"DIV",{class:!0});var D=S(r);i=bt(D,o),D.forEach(m),E.forEach(m),a=Q(w),it(u.$$.fragment,w),w.forEach(m),d=Q(h),y=M(h,"HR",{class:!0}),this.h()},h(){f(r,"class","flex items-center"),f(e,"class","flex-1 flex items-center gap-2"),f(t,"class","flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl"),f(y,"class","border-gray-100 dark:border-gray-800 my-1")},m(h,w){L(h,t,w),k(t,e),at(l,e,null),k(e,s),k(e,r),k(r,i),k(t,a),at(u,t,null),L(h,d,w),L(h,y,w),v=!0},p(h,w){(!v||w&32)&&o!==(o=h[5].t("Web Search")+"")&&yt(i,o);const E={};!c&&w&1&&(c=!0,E.state=h[0],Nt(()=>c=!1)),u.$set(E)},i(h){v||(O(l.$$.fragment,h),O(u.$$.fragment,h),v=!0)},o(h){R(l.$$.fragment,h),R(u.$$.fragment,h),v=!1},d(h){h&&(m(t),m(d),m(y)),ct(l),ct(u)}}}function xs(n){let t,e,l,s=n[5].t("Upload Files")+"",r,o;return t=new Gs({}),{c(){rt(t.$$.fragment),e=J(),l=I("div"),r=_t(s),this.h()},l(i){it(t.$$.fragment,i),e=Q(i),l=M(i,"DIV",{class:!0});var a=S(l);r=bt(a,s),a.forEach(m),this.h()},h(){f(l,"class","flex items-center")},m(i,a){at(t,i,a),L(i,e,a),L(i,l,a),k(l,r),o=!0},p(i,a){(!o||a&32)&&s!==(s=i[5].t("Upload Files")+"")&&yt(r,s)},i(i){o||(O(t.$$.fragment,i),o=!0)},o(i){R(t.$$.fragment,i),o=!1},d(i){i&&(m(e),m(l)),ct(t,i)}}}function $s(n){var r,o;let t,e,l,s=((o=(r=n[4])==null?void 0:r.features)==null?void 0:o.enable_web_search)&&Il(n);return e=new Oe({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl",$$slots:{default:[xs]},$$scope:{ctx:n}}}),e.$on("click",n[9]),{c(){s&&s.c(),t=J(),rt(e.$$.fragment)},l(i){s&&s.l(i),t=Q(i),it(e.$$.fragment,i)},m(i,a){s&&s.m(i,a),L(i,t,a),at(e,i,a),l=!0},p(i,a){var c,d;(d=(c=i[4])==null?void 0:c.features)!=null&&d.enable_web_search?s?(s.p(i,a),a&16&&O(s,1)):(s=Il(i),s.c(),O(s,1),s.m(t.parentNode,t)):s&&(zt(),R(s,1,1,()=>{s=null}),Ft());const u={};a&4128&&(u.$$scope={dirty:a,ctx:i}),e.$set(u)},i(i){l||(O(s),O(e.$$.fragment,i),l=!0)},o(i){R(s),R(e.$$.fragment,i),l=!1},d(i){i&&m(t),s&&s.d(i),ct(e,i)}}}function to(n){let t,e,l;return e=new rn({props:{class:"w-full max-w-[190px] rounded-xl px-1 py-1  border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow",sideOffset:15,alignOffset:-8,side:"top",align:"start",transition:We,$$slots:{default:[$s]},$$scope:{ctx:n}}}),{c(){t=I("div"),rt(e.$$.fragment),this.h()},l(s){t=M(s,"DIV",{slot:!0});var r=S(t);it(e.$$.fragment,r),r.forEach(m),this.h()},h(){f(t,"slot","content")},m(s,r){L(s,t,r),at(e,t,null),l=!0},p(s,r){const o={};r&4147&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){l||(O(e.$$.fragment,s),l=!0)},o(s){R(e.$$.fragment,s),l=!1},d(s){s&&m(t),ct(e)}}}function eo(n){let t,e,l;function s(o){n[10](o)}let r={$$slots:{content:[to],default:[Ks]},$$scope:{ctx:n}};return n[3]!==void 0&&(r.show=n[3]),t=new on({props:r}),pt.push(()=>Ht(t,"show",s)),t.$on("change",n[11]),{c(){rt(t.$$.fragment)},l(o){it(t.$$.fragment,o)},m(o,i){at(t,o,i),l=!0},p(o,[i]){const a={};i&4147&&(a.$$scope={dirty:i,ctx:o}),!e&&i&8&&(e=!0,a.show=o[3],Nt(()=>e=!1)),t.$set(a)},i(o){l||(O(t.$$.fragment,o),l=!0)},o(o){R(t.$$.fragment,o),l=!1},d(o){ct(t,o)}}}function lo(n,t,e){let l,s;ot(n,$l,h=>e(4,l=h));let{$$slots:r={},$$scope:o}=t;const i=ce("i18n");ot(n,i,h=>e(5,s=h));let{uploadFilesHandler:a}=t,{webSearchEnabled:u}=t,{onClose:c}=t,d=!1;function y(h){u=h,e(0,u)}const v=()=>{a()};function _(h){d=h,e(3,d)}const b=h=>{h.detail===!1&&c()};return n.$$set=h=>{"uploadFilesHandler"in h&&e(1,a=h.uploadFilesHandler),"webSearchEnabled"in h&&e(0,u=h.webSearchEnabled),"onClose"in h&&e(2,c=h.onClose),"$$scope"in h&&e(12,o=h.$$scope)},[u,a,c,d,l,s,i,r,y,v,_,b,o]}class no extends Zt{constructor(t){super(),Gt(this,t,lo,eo,Wt,{uploadFilesHandler:1,webSearchEnabled:0,onClose:2})}}function Ml(n,t,e){const l=n.slice();return l[70]=t[e],l[72]=e,l}function Dl(n){let t,e,l,s,r,o,i;return r=new Bn({}),{c(){t=I("div"),e=I("div"),l=I("div"),s=I("div"),rt(r.$$.fragment),this.h()},l(a){t=M(a,"DIV",{class:!0,id:!0,role:!0,"aria-label":!0});var u=S(t);e=M(u,"DIV",{class:!0});var c=S(e);l=M(c,"DIV",{class:!0});var d=S(l);s=M(d,"DIV",{class:!0});var y=S(s);it(r.$$.fragment,y),y.forEach(m),d.forEach(m),c.forEach(m),u.forEach(m),this.h()},h(){f(s,"class","max-w-md"),f(l,"class","m-auto pt-64 flex flex-col justify-center"),f(e,"class","absolute w-full h-full backdrop-blur bg-gray-800/40 flex justify-center"),f(t,"class",o="fixed "+(n[24]?"left-0 md:left-[260px] md:w-[calc(100%-260px)]":"left-0")+" w-full h-full flex z-50 touch-none pointer-events-none"),f(t,"id","dropzone"),f(t,"role","region"),f(t,"aria-label","Drag and Drop Container")},m(a,u){L(a,t,u),k(t,e),k(e,l),k(l,s),at(r,s,null),i=!0},p(a,u){(!i||u[0]&16777216&&o!==(o="fixed "+(a[24]?"left-0 md:left-[260px] md:w-[calc(100%-260px)]":"left-0")+" w-full h-full flex z-50 touch-none pointer-events-none"))&&f(t,"class",o)},i(a){i||(O(r.$$.fragment,a),i=!0)},o(a){R(r.$$.fragment,a),i=!1},d(a){a&&m(t),ct(r)}}}function Cl(n){let t,e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z" clip-rule="evenodd"></path></svg>',s,r;return{c(){t=I("div"),e=I("button"),e.innerHTML=l,this.h()},l(o){t=M(o,"DIV",{class:!0});var i=S(t);e=M(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Kt(e)!=="svelte-a2mahu"&&(e.innerHTML=l),i.forEach(m),this.h()},h(){f(e,"class","bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full"),f(t,"class","absolute -top-12 left-0 right-0 flex justify-center z-30")},m(o,i){L(o,t,i),k(t,e),s||(r=x(e,"click",n[32]),s=!0)},p:Mt,d(o){o&&m(t),s=!1,r()}}}function so(n){let t,e,l;function s(o){n[36](o)}let r={};return n[1]!==void 0&&(r.prompt=n[1]),t=new Ls({props:r}),n[35](t),pt.push(()=>Ht(t,"prompt",s)),t.$on("youtube",n[37]),t.$on("url",n[38]),t.$on("select",n[39]),{c(){rt(t.$$.fragment)},l(o){it(t.$$.fragment,o)},m(o,i){at(t,o,i),l=!0},p(o,i){const a={};!e&&i[0]&2&&(e=!0,a.prompt=o[1],Nt(()=>e=!1)),t.$set(a)},i(o){l||(O(t.$$.fragment,o),l=!0)},o(o){R(t.$$.fragment,o),l=!1},d(o){n[35](null),ct(t,o)}}}function oo(n){let t,e,l;function s(o){n[34](o)}let r={};return n[1]!==void 0&&(r.prompt=n[1]),t=new Ds({props:r}),n[33](t),pt.push(()=>Ht(t,"prompt",s)),{c(){rt(t.$$.fragment)},l(o){it(t.$$.fragment,o)},m(o,i){at(t,o,i),l=!0},p(o,i){const a={};!e&&i[0]&2&&(e=!0,a.prompt=o[1],Nt(()=>e=!1)),t.$set(a)},i(o){l||(O(t.$$.fragment,o),l=!0)},o(o){R(t.$$.fragment,o),l=!1},d(o){n[33](null),ct(t,o)}}}function Tl(n){let t,e,l,s,r,o,i,a,u=n[0].name+"",c,d,y,v,_,b,h,w;return _=new qs({}),{c(){t=I("div"),e=I("div"),l=I("img"),r=J(),o=I("div"),i=_t("Talking to "),a=I("span"),c=_t(u),d=J(),y=I("div"),v=I("button"),rt(_.$$.fragment),this.h()},l(E){t=M(E,"DIV",{class:!0});var D=S(t);e=M(D,"DIV",{class:!0});var C=S(e);l=M(C,"IMG",{crossorigin:!0,alt:!0,class:!0,src:!0}),r=Q(C),o=M(C,"DIV",{});var P=S(o);i=bt(P,"Talking to "),a=M(P,"SPAN",{class:!0});var T=S(a);c=bt(T,u),T.forEach(m),P.forEach(m),C.forEach(m),d=Q(D),y=M(D,"DIV",{});var V=S(y);v=M(V,"BUTTON",{class:!0});var B=S(v);it(_.$$.fragment,B),B.forEach(m),V.forEach(m),D.forEach(m),this.h()},h(){var E,D,C;f(l,"crossorigin","anonymous"),f(l,"alt","model profile"),f(l,"class","size-5 max-w-[28px] object-cover rounded-full"),we(l.src,s=((C=(D=(E=n[11].find(n[45]))==null?void 0:E.info)==null?void 0:D.meta)==null?void 0:C.profile_image_url)??(n[22].language==="dg-DG"?"/doge.png":`${He}/static/favicon.png`))||f(l,"src",s),f(a,"class","font-medium"),f(e,"class","flex items-center gap-2 text-sm dark:text-gray-500"),f(v,"class","flex items-center"),f(t,"class","px-3 py-2.5 text-left w-full flex justify-between items-center absolute bottom-0 left-0 right-0 bg-gradient-to-t from-50% from-white dark:from-gray-900")},m(E,D){L(E,t,D),k(t,e),k(e,l),k(e,r),k(e,o),k(o,i),k(o,a),k(a,c),k(t,d),k(t,y),k(y,v),at(_,v,null),b=!0,h||(w=x(v,"click",n[46]),h=!0)},p(E,D){var C,P,T;(!b||D[0]&4196353&&!we(l.src,s=((T=(P=(C=E[11].find(E[45]))==null?void 0:C.info)==null?void 0:P.meta)==null?void 0:T.profile_image_url)??(E[22].language==="dg-DG"?"/doge.png":`${He}/static/favicon.png`)))&&f(l,"src",s),(!b||D[0]&1)&&u!==(u=E[0].name+"")&&yt(c,u)},i(E){b||(O(_.$$.fragment,E),b=!0)},o(E){R(_.$$.fragment,E),b=!1},d(E){E&&m(t),ct(_),h=!1,w()}}}function Vl(n){let t,e,l=ee(n[3]),s=[];for(let o=0;o<l.length;o+=1)s[o]=Nl(Ml(n,l,o));const r=o=>R(s[o],1,1,()=>{s[o]=null});return{c(){t=I("div");for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){t=M(o,"DIV",{class:!0});var i=S(t);for(let a=0;a<s.length;a+=1)s[a].l(i);i.forEach(m),this.h()},h(){f(t,"class","mx-2 mt-2 mb-1 flex flex-wrap gap-2")},m(o,i){L(o,t,i);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(t,null);e=!0},p(o,i){if(i[0]&5243017){l=ee(o[3]);let a;for(a=0;a<l.length;a+=1){const u=Ml(o,l,a);s[a]?(s[a].p(u,i),O(s[a],1)):(s[a]=Nl(u),s[a].c(),O(s[a],1),s[a].m(t,null))}for(zt(),a=l.length;a<s.length;a+=1)r(a);Ft()}},i(o){if(!e){for(let i=0;i<l.length;i+=1)O(s[i]);e=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)R(s[i]);e=!1},d(o){o&&m(t),ye(s,o)}}}function ro(n){var v;let t,e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6"><path d="M7.5 3.375c0-1.036.84-1.875 1.875-1.875h.375a3.75 3.75 0 0 1 3.75 3.75v1.875C13.5 8.161 14.34 9 15.375 9h1.875A3.75 3.75 0 0 1 21 12.75v3.375C21 17.16 20.16 18 19.125 18h-9.75A1.875 1.875 0 0 1 7.5 16.125V3.375Z"></path><path d="M15 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 17.25 7.5h-1.875A.375.375 0 0 1 15 7.125V5.25ZM4.875 6H6v10.125A3.375 3.375 0 0 0 9.375 19.5H16.5v1.125c0 1.035-.84 1.875-1.875 1.875h-9.75A1.875 1.875 0 0 1 3 20.625V7.875C3 6.839 3.84 6 4.875 6Z"></path></svg>',s,r,o,i=(((v=n[70])==null?void 0:v.title)??`#${n[70].name}`)+"",a,u,c,d=n[22].t("Collection")+"",y;return{c(){t=I("div"),e=I("div"),e.innerHTML=l,s=J(),r=I("div"),o=I("div"),a=_t(i),u=J(),c=I("div"),y=_t(d),this.h()},l(_){t=M(_,"DIV",{class:!0});var b=S(t);e=M(b,"DIV",{class:!0,"data-svelte-h":!0}),Kt(e)!=="svelte-1h7831u"&&(e.innerHTML=l),s=Q(b),r=M(b,"DIV",{class:!0});var h=S(r);o=M(h,"DIV",{class:!0});var w=S(o);a=bt(w,i),w.forEach(m),u=Q(h),c=M(h,"DIV",{class:!0});var E=S(c);y=bt(E,d),E.forEach(m),h.forEach(m),b.forEach(m),this.h()},h(){f(e,"class","p-2.5 bg-red-400 text-white rounded-lg"),f(o,"class","dark:text-gray-100 text-sm font-medium line-clamp-1"),f(c,"class","text-gray-500 text-sm"),f(r,"class","flex flex-col justify-center -space-y-0.5"),f(t,"class","h-16 w-[15rem] flex items-center space-x-3 px-2.5 dark:bg-gray-600 rounded-xl border border-gray-200 dark:border-none")},m(_,b){L(_,t,b),k(t,e),k(t,s),k(t,r),k(r,o),k(o,a),k(r,u),k(r,c),k(c,y)},p(_,b){var h;b[0]&8&&i!==(i=(((h=_[70])==null?void 0:h.title)??`#${_[70].name}`)+"")&&yt(a,i),b[0]&4194304&&d!==(d=_[22].t("Collection")+"")&&yt(y,d)},i:Mt,o:Mt,d(_){_&&m(t)}}}function io(n){let t,e,l,s,r,o=n[70].name+"",i,a,u,c=n[22].t("Document")+"",d;function y(b,h){return b[70].upload_status?uo:co}let v=y(n),_=v(n);return{c(){t=I("div"),e=I("div"),_.c(),l=J(),s=I("div"),r=I("div"),i=_t(o),a=J(),u=I("div"),d=_t(c),this.h()},l(b){t=M(b,"DIV",{class:!0});var h=S(t);e=M(h,"DIV",{class:!0});var w=S(e);_.l(w),w.forEach(m),l=Q(h),s=M(h,"DIV",{class:!0});var E=S(s);r=M(E,"DIV",{class:!0});var D=S(r);i=bt(D,o),D.forEach(m),a=Q(E),u=M(E,"DIV",{class:!0});var C=S(u);d=bt(C,c),C.forEach(m),E.forEach(m),h.forEach(m),this.h()},h(){f(e,"class","p-2.5 bg-red-400 text-white rounded-lg"),f(r,"class","dark:text-gray-100 text-sm font-medium line-clamp-1"),f(u,"class","text-gray-500 text-sm"),f(s,"class","flex flex-col justify-center -space-y-0.5"),f(t,"class","h-16 w-[15rem] flex items-center space-x-3 px-2.5 dark:bg-gray-600 rounded-xl border border-gray-200 dark:border-none")},m(b,h){L(b,t,h),k(t,e),_.m(e,null),k(t,l),k(t,s),k(s,r),k(r,i),k(s,a),k(s,u),k(u,d)},p(b,h){v!==(v=y(b))&&(_.d(1),_=v(b),_&&(_.c(),_.m(e,null))),h[0]&8&&o!==(o=b[70].name+"")&&yt(i,o),h[0]&4194304&&c!==(c=b[22].t("Document")+"")&&yt(d,c)},i:Mt,o:Mt,d(b){b&&m(t),_.d()}}}function ao(n){let t,e,l,s,r,o=(n[0]?n[20].length===0:n[7].length!==n[20].length)&&Bl(n);return{c(){t=I("div"),e=I("img"),s=J(),o&&o.c(),this.h()},l(i){t=M(i,"DIV",{class:!0});var a=S(t);e=M(a,"IMG",{src:!0,alt:!0,class:!0}),s=Q(a),o&&o.l(a),a.forEach(m),this.h()},h(){we(e.src,l=n[70].url)||f(e,"src",l),f(e,"alt","input"),f(e,"class","h-16 w-16 rounded-xl object-cover"),f(t,"class","relative")},m(i,a){L(i,t,a),k(t,e),k(t,s),o&&o.m(t,null),r=!0},p(i,a){(!r||a[0]&8&&!we(e.src,l=i[70].url))&&f(e,"src",l),(i[0]?i[20].length===0:i[7].length!==i[20].length)?o?(o.p(i,a),a[0]&1048705&&O(o,1)):(o=Bl(i),o.c(),O(o,1),o.m(t,null)):o&&(zt(),R(o,1,1,()=>{o=null}),Ft())},i(i){r||(O(o),r=!0)},o(i){R(o),r=!1},d(i){i&&m(t),o&&o.d()}}}function co(n){let t,e,l,s,r,o;return{c(){t=mt("svg"),e=mt("style"),l=_t(`.spinner_qM83 {
																animation: spinner_8HQG 1.05s infinite;
															}
															.spinner_oXPr {
																animation-delay: 0.1s;
															}
															.spinner_ZTLf {
																animation-delay: 0.2s;
															}
															@keyframes spinner_8HQG {
																0%,
																57.14% {
																	animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																	transform: translate(0);
																}
																28.57% {
																	animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																	transform: translateY(-6px);
																}
																100% {
																	transform: translate(0);
																}
															}
														`),s=mt("circle"),r=mt("circle"),o=mt("circle"),this.h()},l(i){t=ht(i,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=S(t);e=ht(a,"style",{});var u=S(e);l=bt(u,`.spinner_qM83 {
																animation: spinner_8HQG 1.05s infinite;
															}
															.spinner_oXPr {
																animation-delay: 0.1s;
															}
															.spinner_ZTLf {
																animation-delay: 0.2s;
															}
															@keyframes spinner_8HQG {
																0%,
																57.14% {
																	animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																	transform: translate(0);
																}
																28.57% {
																	animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																	transform: translateY(-6px);
																}
																100% {
																	transform: translate(0);
																}
															}
														`),u.forEach(m),s=ht(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(s).forEach(m),r=ht(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(r).forEach(m),o=ht(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(o).forEach(m),a.forEach(m),this.h()},h(){f(s,"class","spinner_qM83"),f(s,"cx","4"),f(s,"cy","12"),f(s,"r","2.5"),f(r,"class","spinner_qM83 spinner_oXPr"),f(r,"cx","12"),f(r,"cy","12"),f(r,"r","2.5"),f(o,"class","spinner_qM83 spinner_ZTLf"),f(o,"cx","20"),f(o,"cy","12"),f(o,"r","2.5"),f(t,"class","w-6 h-6 translate-y-[0.5px]"),f(t,"fill","currentColor"),f(t,"viewBox","0 0 24 24"),f(t,"xmlns","http://www.w3.org/2000/svg")},m(i,a){L(i,t,a),k(t,e),k(e,l),k(t,s),k(t,r),k(t,o)},d(i){i&&m(t)}}}function uo(n){let t,e,l;return{c(){t=mt("svg"),e=mt("path"),l=mt("path"),this.h()},l(s){t=ht(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var r=S(t);e=ht(r,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(e).forEach(m),l=ht(r,"path",{d:!0}),S(l).forEach(m),r.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z"),f(e,"clip-rule","evenodd"),f(l,"d","M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class","w-6 h-6")},m(s,r){L(s,t,r),k(t,e),k(t,l)},d(s){s&&m(t)}}}function Bl(n){let t,e;return t=new me({props:{className:" absolute top-1 left-1",content:n[22].t("{{ models }}",{models:[...n[0]?[n[0]]:n[7]].filter(n[50]).join(", ")}),$$slots:{default:[fo]},$$scope:{ctx:n}}}),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,s){const r={};s[0]&5243009&&(r.content=l[22].t("{{ models }}",{models:[...l[0]?[l[0]]:l[7]].filter(l[50]).join(", ")})),s[2]&2048&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(O(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function fo(n){let t,e;return{c(){t=mt("svg"),e=mt("path"),this.h()},l(l){t=ht(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var s=S(t);e=ht(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(e).forEach(m),s.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"),f(e,"clip-rule","evenodd"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class","size-4 fill-yellow-300")},m(l,s){L(l,t,s),k(t,e)},p:Mt,d(l){l&&m(t)}}}function Nl(n){let t,e,l,s,r,o,i='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',a,u,c,d;const y=[ao,io,ro],v=[];function _(h,w){return h[70].type==="image"?0:h[70].type==="doc"?1:h[70].type==="collection"?2:-1}~(e=_(n))&&(l=v[e]=y[e](n));function b(){return n[51](n[72])}return{c(){t=I("div"),l&&l.c(),s=J(),r=I("div"),o=I("button"),o.innerHTML=i,a=J(),this.h()},l(h){t=M(h,"DIV",{class:!0});var w=S(t);l&&l.l(w),s=Q(w),r=M(w,"DIV",{class:!0});var E=S(r);o=M(E,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Kt(o)!=="svelte-3nr9d3"&&(o.innerHTML=i),E.forEach(m),a=Q(w),w.forEach(m),this.h()},h(){f(o,"class","bg-gray-400 text-white border border-white rounded-full group-hover:visible invisible transition"),f(o,"type","button"),f(r,"class","absolute -top-1 -right-1"),f(t,"class","relative group")},m(h,w){L(h,t,w),~e&&v[e].m(t,null),k(t,s),k(t,r),k(r,o),k(t,a),u=!0,c||(d=x(o,"click",b),c=!0)},p(h,w){n=h;let E=e;e=_(n),e===E?~e&&v[e].p(n,w):(l&&(zt(),R(v[E],1,1,()=>{v[E]=null}),Ft()),~e?(l=v[e],l?l.p(n,w):(l=v[e]=y[e](n),l.c()),O(l,1),l.m(t,s)):l=null)},i(h){u||(O(l),u=!0)},o(h){R(l),u=!1},d(h){h&&m(t),~e&&v[e].d(),c=!1,d()}}}function mo(n){let t,e='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-5"><path d="M8.75 3.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z"></path></svg>';return{c(){t=I("button"),t.innerHTML=e,this.h()},l(l){t=M(l,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-wy6pwi"&&(t.innerHTML=e),this.h()},h(){f(t,"class","bg-gray-50 hover:bg-gray-100 text-gray-800 dark:bg-gray-850 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5 outline-none focus:outline-none"),f(t,"type","button")},m(l,s){L(l,t,s)},p:Mt,d(l){l&&m(t)}}}function ho(n){let t,e='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z" clip-rule="evenodd"></path></svg>',l,s;return{c(){t=I("button"),t.innerHTML=e,this.h()},l(r){t=M(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-tod56q"&&(t.innerHTML=e),this.h()},h(){f(t,"class","bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5")},m(r,o){L(r,t,o),l||(s=x(t,"click",function(){fn(n[6])&&n[6].apply(this,arguments)}),l=!0)},p(r,o){n=r},i:Mt,o:Mt,d(r){r&&m(t),l=!1,s()}}}function go(n){let t,e,l,s;return t=new me({props:{content:n[22].t("Record voice"),$$slots:{default:[bo]},$$scope:{ctx:n}}}),l=new me({props:{content:n[22].t("Send message"),$$slots:{default:[vo]},$$scope:{ctx:n}}}),{c(){rt(t.$$.fragment),e=J(),rt(l.$$.fragment)},l(r){it(t.$$.fragment,r),e=Q(r),it(l.$$.fragment,r)},m(r,o){at(t,r,o),L(r,e,o),at(l,r,o),s=!0},p(r,o){const i={};o[0]&4194304&&(i.content=r[22].t("Record voice")),o[0]&2097408|o[2]&2048&&(i.$$scope={dirty:o,ctx:r}),t.$set(i);const a={};o[0]&4194304&&(a.content=r[22].t("Send message")),o[0]&2|o[2]&2048&&(a.$$scope={dirty:o,ctx:r}),l.$set(a)},i(r){s||(O(t.$$.fragment,r),O(l.$$.fragment,r),s=!0)},o(r){R(t.$$.fragment,r),R(l.$$.fragment,r),s=!1},d(r){r&&m(e),ct(t,r),ct(l,r)}}}function Hl(n){let t,e,l;function s(i,a){return i[21]?_o:po}let r=s(n),o=r(n);return{c(){t=I("button"),o.c(),this.h()},l(i){t=M(i,"BUTTON",{id:!0,class:!0,type:!0});var a=S(t);o.l(a),a.forEach(m),this.h()},h(){f(t,"id","voice-input-button"),f(t,"class","text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-850 transition rounded-full p-1.5 mr-0.5 self-center"),f(t,"type","button")},m(i,a){L(i,t,a),o.m(t,null),e||(l=x(t,"click",n[61]),e=!0)},p(i,a){r!==(r=s(i))&&(o.d(1),o=r(i),o&&(o.c(),o.m(t,null)))},d(i){i&&m(t),o.d(),e=!1,l()}}}function po(n){let t,e,l;return{c(){t=mt("svg"),e=mt("path"),l=mt("path"),this.h()},l(s){t=ht(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var r=S(t);e=ht(r,"path",{d:!0}),S(e).forEach(m),l=ht(r,"path",{d:!0}),S(l).forEach(m),r.forEach(m),this.h()},h(){f(e,"d","M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"),f(l,"d","M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 20 20"),f(t,"fill","currentColor"),f(t,"class","w-5 h-5 translate-y-[0.5px]")},m(s,r){L(s,t,r),k(t,e),k(t,l)},d(s){s&&m(t)}}}function _o(n){let t,e,l,s,r,o;return{c(){t=mt("svg"),e=mt("style"),l=_t(`.spinner_qM83 {
															animation: spinner_8HQG 1.05s infinite;
														}
														.spinner_oXPr {
															animation-delay: 0.1s;
														}
														.spinner_ZTLf {
															animation-delay: 0.2s;
														}
														@keyframes spinner_8HQG {
															0%,
															57.14% {
																animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																transform: translate(0);
															}
															28.57% {
																animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																transform: translateY(-6px);
															}
															100% {
																transform: translate(0);
															}
														}
													`),s=mt("circle"),r=mt("circle"),o=mt("circle"),this.h()},l(i){t=ht(i,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=S(t);e=ht(a,"style",{});var u=S(e);l=bt(u,`.spinner_qM83 {
															animation: spinner_8HQG 1.05s infinite;
														}
														.spinner_oXPr {
															animation-delay: 0.1s;
														}
														.spinner_ZTLf {
															animation-delay: 0.2s;
														}
														@keyframes spinner_8HQG {
															0%,
															57.14% {
																animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																transform: translate(0);
															}
															28.57% {
																animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																transform: translateY(-6px);
															}
															100% {
																transform: translate(0);
															}
														}
													`),u.forEach(m),s=ht(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(s).forEach(m),r=ht(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(r).forEach(m),o=ht(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(o).forEach(m),a.forEach(m),this.h()},h(){f(s,"class","spinner_qM83"),f(s,"cx","4"),f(s,"cy","12"),f(s,"r","2.5"),f(r,"class","spinner_qM83 spinner_oXPr"),f(r,"cx","12"),f(r,"cy","12"),f(r,"r","2.5"),f(o,"class","spinner_qM83 spinner_ZTLf"),f(o,"cx","20"),f(o,"cy","12"),f(o,"r","2.5"),f(t,"class","w-5 h-5 translate-y-[0.5px]"),f(t,"fill","currentColor"),f(t,"viewBox","0 0 24 24"),f(t,"xmlns","http://www.w3.org/2000/svg")},m(i,a){L(i,t,a),k(t,e),k(e,l),k(t,s),k(t,r),k(t,o)},d(i){i&&m(t)}}}function bo(n){let t,e=n[8]&&Hl(n);return{c(){e&&e.c(),t=Ot()},l(l){e&&e.l(l),t=Ot()},m(l,s){e&&e.m(l,s),L(l,t,s)},p(l,s){l[8]?e?e.p(l,s):(e=Hl(l),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(l){l&&m(t),e&&e.d(l)}}}function vo(n){let t,e,l,s,r;return{c(){t=I("button"),e=mt("svg"),l=mt("path"),this.h()},l(o){t=M(o,"BUTTON",{id:!0,class:!0,type:!0});var i=S(t);e=ht(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=S(e);l=ht(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(l).forEach(m),a.forEach(m),i.forEach(m),this.h()},h(){f(l,"fill-rule","evenodd"),f(l,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),f(l,"clip-rule","evenodd"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"viewBox","0 0 16 16"),f(e,"fill","currentColor"),f(e,"class","w-5 h-5"),f(t,"id","send-message-button"),f(t,"class",s=(n[1]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 self-center"),f(t,"type","submit"),t.disabled=r=n[1]===""},m(o,i){L(o,t,i),k(t,e),k(e,l)},p(o,i){i[0]&2&&s!==(s=(o[1]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 self-center")&&f(t,"class",s),i[0]&2&&r!==(r=o[1]==="")&&(t.disabled=r)},d(o){o&&m(t)}}}function wo(n){let t,e,l,s,r,o,i,a,u,c,d,y,v,_,b,h,w,E,D,C,P,T,V,B,Y,U,A,N,ut,tt,lt,Dt,Jt,At,St,Lt,Vt,qt,Yt,Qt,z=n[22].t("LLMs can make mistakes. Verify important information.")+"",W,et,Ut,Rt,ft=n[17]&&Dl(n),Pt=n[2]===!1&&n[9].length>0&&Cl(n);const he=[oo,so],xt=[];function ge(g,H){return H[0]&2&&(a=null),H[0]&2&&(u=null),a==null&&(a=g[1].charAt(0)==="/"),a?0:(u==null&&(u=g[1].charAt(0)==="#"),u?1:-1)}~(c=ge(n,[-1,-1,-1]))&&(d=xt[c]=he[c](n));function Se(g){n[41](g)}function Ie(g){n[42](g)}function Me(g){n[43](g)}let ue={messages:n[9]};n[1]!==void 0&&(ue.prompt=n[1]),n[18]!==void 0&&(ue.user=n[18]),n[19]!==void 0&&(ue.chatInputPlaceholder=n[19]),v=new js({props:ue}),n[40](v),pt.push(()=>Ht(v,"prompt",Se)),pt.push(()=>Ht(v,"user",Ie)),pt.push(()=>Ht(v,"chatInputPlaceholder",Me)),v.$on("select",n[44]);let Ct=n[0]!==void 0&&Tl(n),Tt=n[3].length>0&&Vl(n);function De(g){n[54](g)}let pe={uploadFilesHandler:n[52],onClose:n[53],$$slots:{default:[mo]},$$scope:{ctx:n}};n[4]!==void 0&&(pe.webSearchEnabled=n[4]),N=new no({props:pe}),pt.push(()=>Ht(N,"webSearchEnabled",De));const _e=[go,ho],$t=[];function be(g,H){return H[0]&512&&(St=null),St==null&&(St=g[9].length==0||g[9].at(-1).done==!0),St?0:1}return Lt=be(n,[-1,-1,-1]),Vt=$t[Lt]=_e[Lt](n),{c(){ft&&ft.c(),t=J(),e=I("div"),l=I("div"),s=I("div"),r=I("div"),Pt&&Pt.c(),o=J(),i=I("div"),d&&d.c(),y=J(),rt(v.$$.fragment),w=J(),Ct&&Ct.c(),E=J(),D=I("div"),C=I("div"),P=I("div"),T=I("input"),V=J(),B=I("form"),Tt&&Tt.c(),Y=J(),U=I("div"),A=I("div"),rt(N.$$.fragment),tt=J(),lt=I("textarea"),Jt=J(),At=I("div"),Vt.c(),Yt=J(),Qt=I("div"),W=_t(z),this.h()},l(g){ft&&ft.l(g),t=Q(g),e=M(g,"DIV",{class:!0});var H=S(e);l=M(H,"DIV",{class:!0});var X=S(l);s=M(X,"DIV",{class:!0});var F=S(s);r=M(F,"DIV",{class:!0});var j=S(r);Pt&&Pt.l(j),j.forEach(m),o=Q(F),i=M(F,"DIV",{class:!0});var G=S(i);d&&d.l(G),y=Q(G),it(v.$$.fragment,G),w=Q(G),Ct&&Ct.l(G),G.forEach(m),F.forEach(m),X.forEach(m),E=Q(H),D=M(H,"DIV",{class:!0});var wt=S(D);C=M(wt,"DIV",{class:!0});var It=S(C);P=M(It,"DIV",{class:!0});var vt=S(P);T=M(vt,"INPUT",{type:!0}),V=Q(vt),B=M(vt,"FORM",{dir:!0,class:!0});var jt=S(B);Tt&&Tt.l(jt),Y=Q(jt),U=M(jt,"DIV",{class:!0});var p=S(U);A=M(p,"DIV",{class:!0});var K=S(A);it(N.$$.fragment,K),K.forEach(m),tt=Q(p),lt=M(p,"TEXTAREA",{id:!0,class:!0,placeholder:!0,rows:!0}),S(lt).forEach(m),Jt=Q(p),At=M(p,"DIV",{class:!0});var $=S(At);Vt.l($),$.forEach(m),p.forEach(m),jt.forEach(m),Yt=Q(vt),Qt=M(vt,"DIV",{class:!0});var Z=S(Qt);W=bt(Z,z),Z.forEach(m),vt.forEach(m),It.forEach(m),wt.forEach(m),H.forEach(m),this.h()},h(){var g;f(r,"class","relative"),f(i,"class","w-full relative"),f(s,"class","flex flex-col max-w-6xl px-2.5 md:px-6 w-full"),f(l,"class","-mb-0.5 mx-auto inset-x-0 bg-transparent flex justify-center"),f(T,"type","file"),T.hidden=!0,T.multiple=!0,f(A,"class","ml-1 self-end mb-2 flex space-x-1"),f(lt,"id","chat-textarea"),f(lt,"class","scrollbar-hidden bg-gray-50 dark:bg-gray-850 dark:text-gray-100 outline-none w-full py-3 px-3 rounded-xl resize-none h-[48px] svelte-141e0sl"),f(lt,"placeholder",Dt=n[19]!==""?n[19]:n[21]?n[22].t("Listening..."):n[22].t("Send a Message")),f(lt,"rows","1"),f(At,"class","self-end mb-2 flex space-x-1 mr-1"),f(U,"class","flex"),f(B,"dir",qt=((g=n[23])==null?void 0:g.chatDirection)??"LTR"),f(B,"class","flex flex-col relative w-full rounded-3xl px-1.5 bg-gray-50 dark:bg-gray-850 dark:text-gray-100"),f(Qt,"class","mt-1.5 text-xs text-gray-500 text-center"),f(P,"class","pb-2"),f(C,"class","max-w-6xl px-2.5 md:px-6 mx-auto inset-x-0"),f(D,"class","bg-white dark:bg-gray-900"),f(e,"class","w-full")},m(g,H){ft&&ft.m(g,H),L(g,t,H),L(g,e,H),k(e,l),k(l,s),k(s,r),Pt&&Pt.m(r,null),k(s,o),k(s,i),~c&&xt[c].m(i,null),k(i,y),at(v,i,null),k(i,w),Ct&&Ct.m(i,null),k(e,E),k(e,D),k(D,C),k(C,P),k(P,T),n[47](T),k(P,V),k(P,B),Tt&&Tt.m(B,null),k(B,Y),k(B,U),k(U,A),at(N,A,null),k(U,tt),k(U,lt),n[55](lt),Qe(lt,n[1]),k(U,Jt),k(U,At),$t[Lt].m(At,null),k(P,Yt),k(P,Qt),k(Qt,W),et=!0,Ut||(Rt=[x(T,"change",n[48]),x(T,"change",n[49]),x(lt,"input",n[56]),x(lt,"keypress",ko),x(lt,"keydown",n[57]),x(lt,"input",n[58]),x(lt,"focus",n[59]),x(lt,"paste",n[60]),x(B,"submit",un(n[62]))],Ut=!0)},p(g,H){var wt;g[17]?ft?(ft.p(g,H),H[0]&131072&&O(ft,1)):(ft=Dl(g),ft.c(),O(ft,1),ft.m(t.parentNode,t)):ft&&(zt(),R(ft,1,1,()=>{ft=null}),Ft()),g[2]===!1&&g[9].length>0?Pt?Pt.p(g,H):(Pt=Cl(g),Pt.c(),Pt.m(r,null)):Pt&&(Pt.d(1),Pt=null);let X=c;c=ge(g,H),c===X?~c&&xt[c].p(g,H):(d&&(zt(),R(xt[X],1,1,()=>{xt[X]=null}),Ft()),~c?(d=xt[c],d?d.p(g,H):(d=xt[c]=he[c](g),d.c()),O(d,1),d.m(i,y)):d=null);const F={};H[0]&512&&(F.messages=g[9]),!_&&H[0]&2&&(_=!0,F.prompt=g[1],Nt(()=>_=!1)),!b&&H[0]&262144&&(b=!0,F.user=g[18],Nt(()=>b=!1)),!h&&H[0]&524288&&(h=!0,F.chatInputPlaceholder=g[19],Nt(()=>h=!1)),v.$set(F),g[0]!==void 0?Ct?(Ct.p(g,H),H[0]&1&&O(Ct,1)):(Ct=Tl(g),Ct.c(),O(Ct,1),Ct.m(i,null)):Ct&&(zt(),R(Ct,1,1,()=>{Ct=null}),Ft()),g[3].length>0?Tt?(Tt.p(g,H),H[0]&8&&O(Tt,1)):(Tt=Vl(g),Tt.c(),O(Tt,1),Tt.m(B,Y)):Tt&&(zt(),R(Tt,1,1,()=>{Tt=null}),Ft());const j={};H[0]&4096&&(j.uploadFilesHandler=g[52]),H[0]&1024&&(j.onClose=g[53]),H[2]&2048&&(j.$$scope={dirty:H,ctx:g}),!ut&&H[0]&16&&(ut=!0,j.webSearchEnabled=g[4],Nt(()=>ut=!1)),N.$set(j),(!et||H[0]&6815744&&Dt!==(Dt=g[19]!==""?g[19]:g[21]?g[22].t("Listening..."):g[22].t("Send a Message")))&&f(lt,"placeholder",Dt),H[0]&2&&Qe(lt,g[1]);let G=Lt;Lt=be(g,H),Lt===G?$t[Lt].p(g,H):(zt(),R($t[G],1,1,()=>{$t[G]=null}),Ft(),Vt=$t[Lt],Vt?Vt.p(g,H):(Vt=$t[Lt]=_e[Lt](g),Vt.c()),O(Vt,1),Vt.m(At,null)),(!et||H[0]&8388608&&qt!==(qt=((wt=g[23])==null?void 0:wt.chatDirection)??"LTR"))&&f(B,"dir",qt),(!et||H[0]&4194304)&&z!==(z=g[22].t("LLMs can make mistakes. Verify important information.")+"")&&yt(W,z)},i(g){et||(O(ft),O(d),O(v.$$.fragment,g),O(Ct),O(Tt),O(N.$$.fragment,g),O(Vt),et=!0)},o(g){R(ft),R(d),R(v.$$.fragment,g),R(Ct),R(Tt),R(N.$$.fragment,g),R(Vt),et=!1},d(g){g&&(m(t),m(e)),ft&&ft.d(g),Pt&&Pt.d(),~c&&xt[c].d(),n[40](null),ct(v),Ct&&Ct.d(),n[47](null),Tt&&Tt.d(),ct(N),n[55](null),$t[Lt].d(),Ut=!1,ie(Rt)}}}const ko=n=>{};function yo(n,t,e){let l,s,r,o,i;ot(n,ae,p=>e(23,s=p)),ot(n,Le,p=>e(11,r=p)),ot(n,Ne,p=>e(24,o=p)),ot(n,tn,p=>e(25,i=p));const a=ce("i18n");ot(n,a,p=>e(22,l=p));let{submitPrompt:u}=t,{stopResponse:c}=t,{autoScroll:d=!0}=t,{atSelectedModel:y}=t,{selectedModels:v}=t,_,b,h,w,E,D,C=!1,P=null,T="",{files:V=[]}=t,{speechRecognitionEnabled:B=!0}=t,{webSearchEnabled:Y=!1}=t,{prompt:U=""}=t,{messages:A=[]}=t,N,ut=[],tt,lt=[],Dt=!1;const Jt=-45,At=()=>{const p=document.getElementById("messages-container");p.scrollTop=p.scrollHeight},St=async()=>{const p=await navigator.mediaDevices.getUserMedia({audio:!0});tt=new MediaRecorder(p),tt.onstart=()=>{e(21,Dt=!0),console.log("Recording started")},tt.ondataavailable=K=>lt.push(K.data),tt.onstop=async()=>{e(21,Dt=!1),console.log("Recording stopped");const K=new Blob(lt,{type:"audio/wav"}),$=tl(K,"recording.wav"),Z=await ol(localStorage.token,$).catch(q=>(gt.error(q),null));Z&&(e(1,U=Z.text),await kt(),_==null||_.focus(),U!==""&&(s==null?void 0:s.speechAutoSend)===!0&&u(U,P)),lt=[]},tt.start(),Lt(p)},Lt=p=>{const K=new AudioContext,$=K.createMediaStreamSource(p),Z=K.createAnalyser();Z.minDecibels=Jt,$.connect(Z);const q=Z.frequencyBinCount,dt=new Uint8Array(q);let Et=Date.now();const Bt=()=>{if(Z.getByteFrequencyData(dt),dt.some(st=>st>0)&&(Et=Date.now()),Dt&&Date.now()-Et>3e3){tt.stop(),K.close();return}window.requestAnimationFrame(Bt)};window.requestAnimationFrame(Bt)},Vt=()=>{var p;if(Dt)N&&N.stop(),tt&&tt.stop();else if(e(21,Dt=!0),((p=s==null?void 0:s.audio)==null?void 0:p.STTEngine)??!1)St();else if("SpeechRecognition"in window||"webkitSpeechRecognition"in window){N=new(window.SpeechRecognition||window.webkitSpeechRecognition),N.continuous=!0;const K=3e3;let $;N.start(),N.onresult=async Z=>{clearTimeout($),console.log(Z);const q=Z.results[Object.keys(Z.results).length-1][0].transcript;e(1,U=`${U}${q}`),await kt(),_==null||_.focus(),$=setTimeout(()=>{console.log("Speech recognition turned off due to inactivity."),N.stop()},K)},N.onend=function(){console.log("recognition ended"),e(21,Dt=!1),U!==""&&(s==null?void 0:s.speechAutoSend)===!0&&u(U,P)},N.onerror=function(Z){console.log(Z),gt.error(l.t("Speech recognition error: {{error}}",{error:Z.error})),e(21,Dt=!1)}}else gt.error(l.t("SpeechRecognition API is not supported in this browser."))},qt=async p=>{console.log(p);const K={type:"doc",name:p.name,collection_name:"",upload_status:!1,error:""};try{if(e(3,V=[...V,K]),["audio/mpeg","audio/wav"].includes(p.type)){const Z=await ol(localStorage.token,p).catch(q=>(gt.error(q),null));if(Z){console.log(Z);const q=new Blob([Z.text],{type:"text/plain"});p=tl(q,`${p.name}.txt`)}}const $=await Nn(localStorage.token,"",p);$&&(K.upload_status=!0,K.collection_name=$.collection_name,e(3,V))}catch($){e(3,V=V.filter(Z=>Z.name!==p.name)),gt.error($)}},Yt=async p=>{console.log(p);const K={type:"doc",name:p,collection_name:"",upload_status:!1,url:p,error:""};try{e(3,V=[...V,K]);const $=await Hn(localStorage.token,"",p);$&&(K.upload_status=!0,K.collection_name=$.collection_name,e(3,V))}catch($){e(3,V=V.filter(Z=>Z.name!==p)),gt.error($)}},Qt=async p=>{console.log(p);const K={type:"doc",name:p,collection_name:"",upload_status:!1,url:p,error:""};try{e(3,V=[...V,K]);const $=await On(localStorage.token,p);$&&(K.upload_status=!0,K.collection_name=$.collection_name,e(3,V))}catch($){e(3,V=V.filter(Z=>Z.name!==p)),gt.error($)}};qe(()=>{window.setTimeout(()=>_==null?void 0:_.focus(),0);const p=document.querySelector("body"),K=dt=>{dt.key==="Escape"&&(console.log("Escape"),e(17,C=!1))},$=dt=>{dt.preventDefault(),e(17,C=!0)},Z=()=>{e(17,C=!1)},q=async dt=>{var Et,Bt;if(dt.preventDefault(),console.log(dt),(Et=dt.dataTransfer)!=null&&Et.files){const st=Array.from((Bt=dt.dataTransfer)==null?void 0:Bt.files);st&&st.length>0?st.forEach(nt=>{if(console.log(nt,nt.name.split(".").at(-1)),["image/gif","image/webp","image/jpeg","image/png"].includes(nt.type)){if(ut.length===0){gt.error(l.t("Selected model(s) do not support image inputs"));return}let Xt=new FileReader;Xt.onload=fe=>{e(3,V=[...V,{type:"image",url:`${fe.target.result}`}])},Xt.readAsDataURL(nt)}else Xe.includes(nt.type)||Ke.includes(nt.name.split(".").at(-1))||gt.error(l.t("Unknown File Type '{{file_type}}', but accepting and treating as plain text",{file_type:nt.type})),qt(nt)}):gt.error(l.t("File not found."))}e(17,C=!1)};return window.addEventListener("keydown",K),p==null||p.addEventListener("dragover",$),p==null||p.addEventListener("drop",q),p==null||p.addEventListener("dragleave",Z),()=>{window.removeEventListener("keydown",K),p==null||p.removeEventListener("dragover",$),p==null||p.removeEventListener("drop",q),p==null||p.removeEventListener("dragleave",Z)}});const z=()=>{e(2,d=!0),At()};function W(p){pt[p?"unshift":"push"](()=>{h=p,e(13,h)})}function et(p){U=p,e(1,U)}function Ut(p){pt[p?"unshift":"push"](()=>{w=p,e(14,w)})}function Rt(p){U=p,e(1,U)}const ft=p=>{console.log(p),Qt(p.detail)},Pt=p=>{console.log(p),Yt(p.detail)},he=p=>{var K;console.log(p),e(3,V=[...V,{type:((K=p==null?void 0:p.detail)==null?void 0:K.type)??"doc",...p.detail,upload_status:!0}])};function xt(p){pt[p?"unshift":"push"](()=>{E=p,e(15,E)})}function ge(p){U=p,e(1,U)}function Se(p){P=p,e(18,P)}function Ie(p){T=p,e(19,T)}const Me=p=>{e(0,y=p.detail),_==null||_.focus()},ue=p=>p.id===y.id,Ct=()=>{e(0,y=void 0)};function Tt(p){pt[p?"unshift":"push"](()=>{b=p,e(12,b)})}function De(){D=this.files,e(16,D)}const pe=async()=>{D&&D.length>0?Array.from(D).forEach(K=>{if(["image/gif","image/webp","image/jpeg","image/png"].includes(K.type)){if(ut.length===0){gt.error(l.t("Selected model(s) do not support image inputs")),e(16,D=null),e(12,b.value="",b);return}let $=new FileReader;$.onload=Z=>{e(3,V=[...V,{type:"image",url:`${Z.target.result}`}]),e(16,D=null),e(12,b.value="",b)},$.readAsDataURL(K)}else Xe.includes(K.type)||Ke.includes(K.name.split(".").at(-1))?(qt(K),e(12,b.value="",b)):(gt.error(l.t("Unknown File Type '{{file_type}}', but accepting and treating as plain text",{file_type:K.type})),qt(K),e(12,b.value="",b))}):gt.error(l.t("File not found."))},_e=p=>!ut.includes(p),$t=p=>{V.splice(p,1),e(3,V)},be=()=>{b.click()},g=async()=>{await kt(),_==null||_.focus()};function H(p){Y=p,e(4,Y)}function X(p){pt[p?"unshift":"push"](()=>{_=p,e(10,_),e(1,U)})}function F(){U=this.value,e(1,U)}const j=async p=>{var $;if(!i||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)){if(p.key==="Enter"&&!p.shiftKey&&p.preventDefault(),p.key==="Enter"&&!p.shiftKey&&U!==""){u(U,P);return}if(p.key==="Enter"&&p.shiftKey&&U!=="")return}const K=p.ctrlKey||p.metaKey;if(U===""&&K&&p.key.toLowerCase()==="r"){p.preventDefault(),console.log("regenerate");const Z=[...document.getElementsByClassName("regenerate-response-button")].at(-1);Z==null||Z.click()}if(U===""&&p.key=="ArrowUp"){p.preventDefault();const Z=[...document.getElementsByClassName("user-message")].at(-1),q=[...document.getElementsByClassName("edit-user-message-button")].at(-1);console.log(Z),Z.scrollIntoView({block:"center"}),q==null||q.click()}if(["/","#","@"].includes(U.charAt(0))&&p.key==="ArrowUp"&&(p.preventDefault(),(h||w||E).selectUp(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),["/","#","@"].includes(U.charAt(0))&&p.key==="ArrowDown"&&(p.preventDefault(),(h||w||E).selectDown(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),["/","#","@"].includes(U.charAt(0))&&p.key==="Enter"){p.preventDefault();const Z=[...document.getElementsByClassName("selected-command-option-button")].at(-1);Z?Z==null||Z.click():($=document.getElementById("send-message-button"))==null||$.click()}if(["/","#","@"].includes(U.charAt(0))&&p.key==="Tab"){p.preventDefault();const Z=[...document.getElementsByClassName("selected-command-option-button")].at(-1);Z==null||Z.click()}else if(p.key==="Tab"){const Z=nn(U);if(Z.length>0){const q=Z.at(0),dt=U;e(1,U=U.substring(0,(q==null?void 0:q.endIndex)+1)),await kt(),p.target.scrollTop=p.target.scrollHeight,e(1,U=dt),await kt(),p.preventDefault(),p.target.setSelectionRange(q==null?void 0:q.startIndex,q.endIndex+1)}p.target.style.height="",p.target.style.height=Math.min(p.target.scrollHeight,200)+"px"}p.key==="Escape"&&(console.log("Escape"),e(0,y=void 0))},G=p=>{p.target.style.height="",p.target.style.height=Math.min(p.target.scrollHeight,200)+"px",e(18,P=null)},wt=p=>{p.target.style.height="",p.target.style.height=Math.min(p.target.scrollHeight,200)+"px"},It=p=>{const K=p.clipboardData||window.clipboardData;if(K&&K.items){for(const $ of K.items)if($.type.indexOf("image")!==-1){const Z=$.getAsFile(),q=new FileReader;q.onload=function(dt){e(3,V=[...V,{type:"image",url:`${dt.target.result}`}])},q.readAsDataURL(Z)}}},vt=()=>{Vt()},jt=()=>{u(U,P)};return n.$$set=p=>{"submitPrompt"in p&&e(5,u=p.submitPrompt),"stopResponse"in p&&e(6,c=p.stopResponse),"autoScroll"in p&&e(2,d=p.autoScroll),"atSelectedModel"in p&&e(0,y=p.atSelectedModel),"selectedModels"in p&&e(7,v=p.selectedModels),"files"in p&&e(3,V=p.files),"speechRecognitionEnabled"in p&&e(8,B=p.speechRecognitionEnabled),"webSearchEnabled"in p&&e(4,Y=p.webSearchEnabled),"prompt"in p&&e(1,U=p.prompt),"messages"in p&&e(9,A=p.messages)},n.$$.update=()=>{n.$$.dirty[0]&2177&&e(20,ut=[...y?[y]:v].filter(p=>{var K,$,Z,q;return((q=(Z=($=(K=r.find(dt=>dt.id===p))==null?void 0:K.info)==null?void 0:$.meta)==null?void 0:Z.capabilities)==null?void 0:q.vision)??!0})),n.$$.dirty[0]&1026&&U&&_&&(e(10,_.style.height="",_),e(10,_.style.height=Math.min(_.scrollHeight,200)+"px",_))},[y,U,d,V,Y,u,c,v,B,A,_,r,b,h,w,E,D,C,P,T,ut,Dt,l,s,o,i,a,At,Vt,qt,Yt,Qt,z,W,et,Ut,Rt,ft,Pt,he,xt,ge,Se,Ie,Me,ue,Ct,Tt,De,pe,_e,$t,be,g,H,X,F,j,G,wt,It,vt,jt]}class Eo extends Zt{constructor(t){super(),Gt(this,t,yo,wo,Wt,{submitPrompt:5,stopResponse:6,autoScroll:2,atSelectedModel:0,selectedModels:7,files:3,speechRecognitionEnabled:8,webSearchEnabled:4,prompt:1,messages:9},null,[-1,-1,-1])}}function Ol(n,t,e){const l=n.slice();return l[12]=t[e],l[13]=t,l[14]=e,l}function So(n){let t,e,l;return e=new me({props:{content:n[4].t("Remove Model"),$$slots:{default:[Mo]},$$scope:{ctx:n}}}),{c(){t=I("div"),rt(e.$$.fragment),this.h()},l(s){t=M(s,"DIV",{class:!0});var r=S(t);it(e.$$.fragment,r),r.forEach(m),this.h()},h(){f(t,"class","self-center disabled:text-gray-600 disabled:hover:text-gray-600 mr-2")},m(s,r){L(s,t,r),at(e,t,null),l=!0},p(s,r){const o={};r&16&&(o.content=s[4].t("Remove Model")),r&32771&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){l||(O(e.$$.fragment,s),l=!0)},o(s){R(e.$$.fragment,s),l=!1},d(s){s&&m(t),ct(e)}}}function Io(n){let t,e,l;return e=new me({props:{content:n[4].t("Add Model"),$$slots:{default:[Do]},$$scope:{ctx:n}}}),{c(){t=I("div"),rt(e.$$.fragment),this.h()},l(s){t=M(s,"DIV",{class:!0});var r=S(t);it(e.$$.fragment,r),r.forEach(m),this.h()},h(){f(t,"class","self-center mr-2 disabled:text-gray-600 disabled:hover:text-gray-600")},m(s,r){L(s,t,r),at(e,t,null),l=!0},p(s,r){const o={};r&16&&(o.content=s[4].t("Add Model")),r&32771&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){l||(O(e.$$.fragment,s),l=!0)},o(s){R(e.$$.fragment,s),l=!1},d(s){s&&m(t),ct(e)}}}function Mo(n){let t,e,l,s,r;function o(){return n[10](n[14])}return{c(){t=I("button"),e=mt("svg"),l=mt("path"),this.h()},l(i){t=M(i,"BUTTON",{});var a=S(t);e=ht(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=S(e);l=ht(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(l).forEach(m),u.forEach(m),a.forEach(m),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"stroke-linejoin","round"),f(l,"d","M19.5 12h-15"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","2"),f(e,"stroke","currentColor"),f(e,"class","size-3.5"),t.disabled=n[1]},m(i,a){L(i,t,a),k(t,e),k(e,l),s||(r=x(t,"click",o),s=!0)},p(i,a){n=i,a&2&&(t.disabled=n[1])},d(i){i&&m(t),s=!1,r()}}}function Do(n){let t,e,l,s,r;return{c(){t=I("button"),e=mt("svg"),l=mt("path"),this.h()},l(o){t=M(o,"BUTTON",{class:!0});var i=S(t);e=ht(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=S(e);l=ht(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(l).forEach(m),a.forEach(m),i.forEach(m),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"stroke-linejoin","round"),f(l,"d","M12 6v12m6-6H6"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","2"),f(e,"stroke","currentColor"),f(e,"class","size-3.5"),f(t,"class",""),t.disabled=n[1]},m(o,i){L(o,t,i),k(t,e),k(e,l),s||(r=x(t,"click",n[9]),s=!0)},p(o,i){i&2&&(t.disabled=o[1])},d(o){o&&m(t),s=!1,r()}}}function Al(n){let t,e,l,s,r,o,i,a,u,c;function d(h){n[8](h,n[12],n[13],n[14])}let y={placeholder:n[4].t("Select a model"),items:n[3].map(Pl)};n[12]!==void 0&&(y.value=n[12]),s=new Gn({props:y}),pt.push(()=>Ht(s,"value",d));const v=[Io,So],_=[];function b(h,w){return h[14]===0?0:1}return i=b(n),a=_[i]=v[i](n),{c(){t=I("div"),e=I("div"),l=I("div"),rt(s.$$.fragment),o=J(),a.c(),u=J(),this.h()},l(h){t=M(h,"DIV",{class:!0});var w=S(t);e=M(w,"DIV",{class:!0});var E=S(e);l=M(E,"DIV",{class:!0});var D=S(l);it(s.$$.fragment,D),D.forEach(m),E.forEach(m),o=Q(w),a.l(w),u=Q(w),w.forEach(m),this.h()},h(){f(l,"class","mr-1 max-w-full"),f(e,"class","overflow-hidden w-full"),f(t,"class","flex w-full max-w-fit")},m(h,w){L(h,t,w),k(t,e),k(e,l),at(s,l,null),k(t,o),_[i].m(t,null),k(t,u),c=!0},p(h,w){n=h;const E={};w&16&&(E.placeholder=n[4].t("Select a model")),w&8&&(E.items=n[3].map(Pl)),!r&&w&1&&(r=!0,E.value=n[12],Nt(()=>r=!1)),s.$set(E),a.p(n,w)},i(h){c||(O(s.$$.fragment,h),O(a),c=!0)},o(h){R(s.$$.fragment,h),R(a),c=!1},d(h){h&&m(t),ct(s),_[i].d()}}}function Ll(n){let t,e,l=n[4].t("Set as default")+"",s,r,o;return{c(){t=I("div"),e=I("button"),s=_t(l),this.h()},l(i){t=M(i,"DIV",{class:!0});var a=S(t);e=M(a,"BUTTON",{});var u=S(e);s=bt(u,l),u.forEach(m),a.forEach(m),this.h()},h(){f(t,"class","text-left mt-0.5 ml-1 text-[0.7rem] text-gray-500")},m(i,a){L(i,t,a),k(t,e),k(e,s),r||(o=x(e,"click",n[7]),r=!0)},p(i,a){a&16&&l!==(l=i[4].t("Set as default")+"")&&yt(s,l)},d(i){i&&m(t),r=!1,o()}}}function Co(n){let t,e,l,s,r=ee(n[0]),o=[];for(let u=0;u<r.length;u+=1)o[u]=Al(Ol(n,r,u));const i=u=>R(o[u],1,1,()=>{o[u]=null});let a=n[2]&&!n[5]&&Ll(n);return{c(){t=I("div");for(let u=0;u<o.length;u+=1)o[u].c();e=J(),a&&a.c(),l=Ot(),this.h()},l(u){t=M(u,"DIV",{class:!0});var c=S(t);for(let d=0;d<o.length;d+=1)o[d].l(c);c.forEach(m),e=Q(u),a&&a.l(u),l=Ot(),this.h()},h(){f(t,"class","flex flex-col w-full items-center md:items-start")},m(u,c){L(u,t,c);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(t,null);L(u,e,c),a&&a.m(u,c),L(u,l,c),s=!0},p(u,[c]){if(c&27){r=ee(u[0]);let d;for(d=0;d<r.length;d+=1){const y=Ol(u,r,d);o[d]?(o[d].p(y,c),O(o[d],1)):(o[d]=Al(y),o[d].c(),O(o[d],1),o[d].m(t,null))}for(zt(),d=r.length;d<o.length;d+=1)i(d);Ft()}u[2]&&!u[5]?a?a.p(u,c):(a=Ll(u),a.c(),a.m(l.parentNode,l)):a&&(a.d(1),a=null)},i(u){if(!s){for(let c=0;c<r.length;c+=1)O(o[c]);s=!0}},o(u){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)R(o[c]);s=!1},d(u){u&&(m(t),m(e),m(l)),ye(o,u),a&&a.d(u)}}}const Pl=n=>({value:n.id,label:n.name,model:n});function To(n,t,e){let l,s,r,o;ot(n,Le,b=>e(3,l=b)),ot(n,ae,b=>e(11,r=b)),ot(n,tn,b=>e(5,o=b));const i=ce("i18n");ot(n,i,b=>e(4,s=b));let{selectedModels:a=[""]}=t,{disabled:u=!1}=t,{showSetDefault:c=!0}=t;const d=async()=>{if(a.filter(h=>h==="").length){gt.error(s.t("Choose a model before saving..."));return}ae.set({...r,models:a}),await Dn(localStorage.token,{ui:r}),gt.success(s.t("Default model updated"))};function y(b,h,w,E){w[E]=b,e(0,a),e(3,l)}const v=()=>{e(0,a=[...a,""])},_=b=>{a.splice(b,1),e(0,a),e(3,l)};return n.$$set=b=>{"selectedModels"in b&&e(0,a=b.selectedModels),"disabled"in b&&e(1,u=b.disabled),"showSetDefault"in b&&e(2,c=b.showSetDefault)},n.$$.update=()=>{n.$$.dirty&9&&a.length>0&&l.length>0&&e(0,a=a.map(b=>l.map(h=>h.id).includes(b)?b:""))},[a,u,c,l,s,o,i,d,y,v,_]}class Vo extends Zt{constructor(t){super(),Gt(this,t,To,Co,Wt,{selectedModels:0,disabled:1,showSetDefault:2})}}function Bo(n){let t;const e=n[9].default,l=le(e,n,n[14],null);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,r){l&&l.p&&(!t||r&16384)&&ne(l,e,s,s[14],t?oe(e,s[14],r,null):se(s[14]),null)},i(s){t||(O(l,s),t=!0)},o(s){R(l,s),t=!1},d(s){l&&l.d(s)}}}function No(n){let t,e,l,s,r=n[3].t("Share")+"",o;return{c(){t=mt("svg"),e=mt("path"),l=J(),s=I("div"),o=_t(r),this.h()},l(i){t=ht(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=S(t);e=ht(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(e).forEach(m),a.forEach(m),l=Q(i),s=M(i,"DIV",{class:!0});var u=S(s);o=bt(u,r),u.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M15.75 4.5a3 3 0 1 1 .825 2.066l-8.421 4.679a3.002 3.002 0 0 1 0 1.51l8.421 4.679a3 3 0 1 1-.729 1.31l-8.421-4.678a3 3 0 1 1 0-4.132l8.421-4.679a3 3 0 0 1-.096-.755Z"),f(e,"clip-rule","evenodd"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class","size-4"),f(s,"class","flex items-center")},m(i,a){L(i,t,a),k(t,e),L(i,l,a),L(i,s,a),k(s,o)},p(i,a){a&8&&r!==(r=i[3].t("Share")+"")&&yt(o,r)},d(i){i&&(m(t),m(l),m(s))}}}function Ho(n){let t,e,l,s,r=n[3].t("Download")+"",o;return{c(){t=mt("svg"),e=mt("path"),l=J(),s=I("div"),o=_t(r),this.h()},l(i){t=ht(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=S(t);e=ht(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(e).forEach(m),a.forEach(m),l=Q(i),s=M(i,"DIV",{class:!0});var u=S(s);o=bt(u,r),u.forEach(m),this.h()},h(){f(e,"stroke-linecap","round"),f(e,"stroke-linejoin","round"),f(e,"d","M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"fill","none"),f(t,"viewBox","0 0 24 24"),f(t,"stroke-width","1.5"),f(t,"stroke","currentColor"),f(t,"class","size-4"),f(s,"class","flex items-center")},m(i,a){L(i,t,a),k(t,e),L(i,l,a),L(i,s,a),k(s,o)},p(i,a){a&8&&r!==(r=i[3].t("Download")+"")&&yt(o,r)},d(i){i&&(m(t),m(l),m(s))}}}function Oo(n){let t,e=n[3].t("Plain text (.txt)")+"",l;return{c(){t=I("div"),l=_t(e),this.h()},l(s){t=M(s,"DIV",{class:!0});var r=S(t);l=bt(r,e),r.forEach(m),this.h()},h(){f(t,"class","flex items-center line-clamp-1")},m(s,r){L(s,t,r),k(t,l)},p(s,r){r&8&&e!==(e=s[3].t("Plain text (.txt)")+"")&&yt(l,e)},d(s){s&&m(t)}}}function Ao(n){let t,e=n[3].t("PDF document (.pdf)")+"",l;return{c(){t=I("div"),l=_t(e),this.h()},l(s){t=M(s,"DIV",{class:!0});var r=S(t);l=bt(r,e),r.forEach(m),this.h()},h(){f(t,"class","flex items-center line-clamp-1")},m(s,r){L(s,t,r),k(t,l)},p(s,r){r&8&&e!==(e=s[3].t("PDF document (.pdf)")+"")&&yt(l,e)},d(s){s&&m(t)}}}function Lo(n){let t,e,l,s;return t=new Oe({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Oo]},$$scope:{ctx:n}}}),t.$on("click",n[11]),l=new Oe({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Ao]},$$scope:{ctx:n}}}),l.$on("click",n[12]),{c(){rt(t.$$.fragment),e=J(),rt(l.$$.fragment)},l(r){it(t.$$.fragment,r),e=Q(r),it(l.$$.fragment,r)},m(r,o){at(t,r,o),L(r,e,o),at(l,r,o),s=!0},p(r,o){const i={};o&16392&&(i.$$scope={dirty:o,ctx:r}),t.$set(i);const a={};o&16392&&(a.$$scope={dirty:o,ctx:r}),l.$set(a)},i(r){s||(O(t.$$.fragment,r),O(l.$$.fragment,r),s=!0)},o(r){R(t.$$.fragment,r),R(l.$$.fragment,r),s=!1},d(r){r&&m(e),ct(t,r),ct(l,r)}}}function Po(n){let t,e,l,s;return t=new Es({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Ho]},$$scope:{ctx:n}}}),l=new ps({props:{class:"w-full rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",transition:We,sideOffset:8,$$slots:{default:[Lo]},$$scope:{ctx:n}}}),{c(){rt(t.$$.fragment),e=J(),rt(l.$$.fragment)},l(r){it(t.$$.fragment,r),e=Q(r),it(l.$$.fragment,r)},m(r,o){at(t,r,o),L(r,e,o),at(l,r,o),s=!0},p(r,o){const i={};o&16392&&(i.$$scope={dirty:o,ctx:r}),t.$set(i);const a={};o&16392&&(a.$$scope={dirty:o,ctx:r}),l.$set(a)},i(r){s||(O(t.$$.fragment,r),O(l.$$.fragment,r),s=!0)},o(r){R(t.$$.fragment,r),R(l.$$.fragment,r),s=!1},d(r){r&&m(e),ct(t,r),ct(l,r)}}}function Uo(n){let t,e,l,s,r,o,i,a,u;return t=new Oe({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[No]},$$scope:{ctx:n}}}),t.$on("click",n[10]),l=new es({props:{$$slots:{default:[Po]},$$scope:{ctx:n}}}),a=new Fn({props:{chatId:n[1].id}}),{c(){rt(t.$$.fragment),e=J(),rt(l.$$.fragment),s=J(),r=I("hr"),o=J(),i=I("div"),rt(a.$$.fragment),this.h()},l(c){it(t.$$.fragment,c),e=Q(c),it(l.$$.fragment,c),s=Q(c),r=M(c,"HR",{class:!0}),o=Q(c),i=M(c,"DIV",{class:!0});var d=S(i);it(a.$$.fragment,d),d.forEach(m),this.h()},h(){f(r,"class","border-gray-100 dark:border-gray-800 mt-2.5 mb-1.5"),f(i,"class","flex p-1")},m(c,d){at(t,c,d),L(c,e,d),at(l,c,d),L(c,s,d),L(c,r,d),L(c,o,d),L(c,i,d),at(a,i,null),u=!0},p(c,d){const y={};d&16392&&(y.$$scope={dirty:d,ctx:c}),t.$set(y);const v={};d&16392&&(v.$$scope={dirty:d,ctx:c}),l.$set(v);const _={};d&2&&(_.chatId=c[1].id),a.$set(_)},i(c){u||(O(t.$$.fragment,c),O(l.$$.fragment,c),O(a.$$.fragment,c),u=!0)},o(c){R(t.$$.fragment,c),R(l.$$.fragment,c),R(a.$$.fragment,c),u=!1},d(c){c&&(m(e),m(s),m(r),m(o),m(i)),ct(t,c),ct(l,c),ct(a)}}}function Ro(n){let t,e,l;return e=new rn({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:8,side:"bottom",align:"end",transition:We,$$slots:{default:[Uo]},$$scope:{ctx:n}}}),{c(){t=I("div"),rt(e.$$.fragment),this.h()},l(s){t=M(s,"DIV",{slot:!0});var r=S(t);it(e.$$.fragment,r),r.forEach(m),this.h()},h(){f(t,"slot","content")},m(s,r){L(s,t,r),at(e,t,null),l=!0},p(s,r){const o={};r&16395&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){l||(O(e.$$.fragment,s),l=!0)},o(s){R(e.$$.fragment,s),l=!1},d(s){s&&m(t),ct(e)}}}function jo(n){let t,e;return t=new on({props:{$$slots:{content:[Ro],default:[Bo]},$$scope:{ctx:n}}}),t.$on("change",n[13]),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,[s]){const r={};s&16395&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(O(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function zo(n,t,e){let l,{$$slots:s={},$$scope:r}=t;const{saveAs:o}=Qn,i=ce("i18n");ot(n,i,D=>e(3,l=D));let{shareEnabled:a=!1}=t,{shareHandler:u}=t,{downloadHandler:c}=t,{chat:d}=t,{onClose:y=()=>{}}=t;const v=async()=>{const D=d.chat;console.log("download",d);const C=D.messages.reduce((T,V,B,Y)=>`${T}### ${V.role.toUpperCase()}
${V.content}

`,"");let P=new Blob([C],{type:"text/plain"});o(P,`chat-${D.title}.txt`)},_=async()=>{const D=d.chat;console.log("download",d);const C=await Yn(D),P=window.URL.createObjectURL(C),T=document.createElement("a");T.href=P,T.download=`chat-${D.title}.pdf`,document.body.appendChild(T),T.click(),document.body.removeChild(T),window.URL.revokeObjectURL(P)},b=()=>{u()},h=()=>{v()},w=()=>{_()},E=D=>{D.detail===!1&&y()};return n.$$set=D=>{"shareEnabled"in D&&e(7,a=D.shareEnabled),"shareHandler"in D&&e(0,u=D.shareHandler),"downloadHandler"in D&&e(8,c=D.downloadHandler),"chat"in D&&e(1,d=D.chat),"onClose"in D&&e(2,y=D.onClose),"$$scope"in D&&e(14,r=D.$$scope)},[u,d,y,l,i,v,_,a,c,s,b,h,w,E,r]}class Fo extends Zt{constructor(t){super(),Gt(this,t,zo,jo,Wt,{shareEnabled:7,shareHandler:0,downloadHandler:8,chat:1,onClose:2})}}function Ul(n){let t,e,l;function s(o){n[15](o)}let r={showSetDefault:!n[2]};return n[0]!==void 0&&(r.selectedModels=n[0]),t=new Vo({props:r}),pt.push(()=>Ht(t,"selectedModels",s)),{c(){rt(t.$$.fragment)},l(o){it(t.$$.fragment,o)},m(o,i){at(t,o,i),l=!0},p(o,i){const a={};i&4&&(a.showSetDefault=!o[2]),!e&&i&1&&(e=!0,a.selectedModels=o[0],Nt(()=>e=!1)),t.$set(a)},i(o){l||(O(t.$$.fragment,o),l=!0)},o(o){R(t.$$.fragment,o),l=!1},d(o){ct(t,o)}}}function Rl(n){let t,e;return t=new Fo({props:{chat:n[3],shareEnabled:n[2],shareHandler:n[16],downloadHandler:n[17],$$slots:{default:[qo]},$$scope:{ctx:n}}}),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,s){const r={};s&8&&(r.chat=l[3]),s&4&&(r.shareEnabled=l[2]),s&32&&(r.shareHandler=l[16]),s&64&&(r.downloadHandler=l[17]),s&2097152&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(O(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function qo(n){let t,e='<div class="m-auto self-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"></path></svg></div>';return{c(){t=I("button"),t.innerHTML=e,this.h()},l(l){t=M(l,"BUTTON",{class:!0,id:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-9m6068"&&(t.innerHTML=e),this.h()},h(){f(t,"class","hidden md:flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition"),f(t,"id","chat-context-menu-button")},m(l,s){L(l,t,s)},p:Mt,d(l){l&&m(t)}}}function Wo(n){let t,e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"></path><path d="M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"></path></svg>',s,r,o;return{c(){t=I("button"),e=I("div"),e.innerHTML=l,this.h()},l(i){t=M(i,"BUTTON",{id:!0,class:!0});var a=S(t);e=M(a,"DIV",{class:!0,"data-svelte-h":!0}),Kt(e)!=="svelte-1fcii9y"&&(e.innerHTML=l),a.forEach(m),this.h()},h(){f(e,"class","m-auto self-center"),f(t,"id","new-chat-button"),f(t,"class",s="flex "+(n[8]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition")},m(i,a){L(i,t,a),k(t,e),r||(o=x(t,"click",n[18]),r=!0)},p(i,a){a&256&&s!==(s="flex "+(i[8]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition")&&f(t,"class",s)},d(i){i&&m(t),r=!1,o()}}}function jl(n){let t,e;return t=new Wn({props:{className:"max-w-[200px]",role:n[10].role,$$slots:{default:[Zo]},$$scope:{ctx:n}}}),t.$on("show",n[19]),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,s){const r={};s&1024&&(r.role=l[10].role),s&2098176&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(O(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function Zo(n){let t,e,l,s;return{c(){t=I("button"),e=I("div"),l=I("img"),this.h()},l(r){t=M(r,"BUTTON",{class:!0,"aria-label":!0});var o=S(t);e=M(o,"DIV",{class:!0});var i=S(e);l=M(i,"IMG",{src:!0,class:!0,alt:!0,draggable:!0}),i.forEach(m),o.forEach(m),this.h()},h(){we(l.src,s=n[10].profile_image_url)||f(l,"src",s),f(l,"class","size-6 object-cover rounded-full"),f(l,"alt","User profile"),f(l,"draggable","false"),f(e,"class","self-center"),f(t,"class","select-none flex rounded-xl p-1.5 w-full hover:bg-gray-100 dark:hover:bg-gray-850 transition"),f(t,"aria-label","User Menu")},m(r,o){L(r,t,o),k(t,e),k(e,l)},p(r,o){o&1024&&!we(l.src,s=r[10].profile_image_url)&&f(l,"src",s)},d(r){r&&m(t)}}}function Go(n){let t,e,l,s,r,o,i,a,u,c,d,y,v,_,b,h,w,E,D,C,P;function T(A){n[13](A)}let V={chatId:n[7]};n[5]!==void 0&&(V.show=n[5]),t=new qn({props:V}),pt.push(()=>Ht(t,"show",T)),c=new Xn({});let B=n[4]&&Ul(n),Y=n[2]&&Rl(n);w=new me({props:{content:n[9].t("New Chat"),$$slots:{default:[Wo]},$$scope:{ctx:n}}});let U=n[10]!==void 0&&jl(n);return{c(){rt(t.$$.fragment),l=J(),s=I("nav"),r=I("div"),o=I("div"),i=I("div"),a=I("button"),u=I("div"),rt(c.$$.fragment),y=J(),v=I("div"),B&&B.c(),_=J(),b=I("div"),Y&&Y.c(),h=J(),rt(w.$$.fragment),E=J(),U&&U.c(),this.h()},l(A){it(t.$$.fragment,A),l=Q(A),s=M(A,"NAV",{id:!0,class:!0});var N=S(s);r=M(N,"DIV",{class:!0});var ut=S(r);o=M(ut,"DIV",{class:!0});var tt=S(o);i=M(tt,"DIV",{class:!0});var lt=S(i);a=M(lt,"BUTTON",{id:!0,class:!0});var Dt=S(a);u=M(Dt,"DIV",{class:!0});var Jt=S(u);it(c.$$.fragment,Jt),Jt.forEach(m),Dt.forEach(m),lt.forEach(m),y=Q(tt),v=M(tt,"DIV",{class:!0});var At=S(v);B&&B.l(At),At.forEach(m),_=Q(tt),b=M(tt,"DIV",{class:!0});var St=S(b);Y&&Y.l(St),h=Q(St),it(w.$$.fragment,St),E=Q(St),U&&U.l(St),St.forEach(m),tt.forEach(m),ut.forEach(m),N.forEach(m),this.h()},h(){f(u,"class","m-auto self-center"),f(a,"id","sidebar-toggle-button"),f(a,"class","cursor-pointer px-2 py-2 flex rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition"),f(i,"class",d=(n[8]?"md:hidden":"")+" mr-3 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),f(v,"class","flex-1 overflow-hidden max-w-full"),f(b,"class","self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),f(o,"class","flex items-center w-full max-w-full"),f(r,"class","flex max-w-full w-full mx-auto px-5 pt-0.5 md:px-[1rem]"),f(s,"id","nav"),f(s,"class","sticky py-2.5 top-0 flex flex-row justify-center z-30")},m(A,N){at(t,A,N),L(A,l,N),L(A,s,N),k(s,r),k(r,o),k(o,i),k(i,a),k(a,u),at(c,u,null),k(o,y),k(o,v),B&&B.m(v,null),k(o,_),k(o,b),Y&&Y.m(b,null),k(b,h),at(w,b,null),k(b,E),U&&U.m(b,null),D=!0,C||(P=x(a,"click",n[14]),C=!0)},p(A,[N]){const ut={};N&128&&(ut.chatId=A[7]),!e&&N&32&&(e=!0,ut.show=A[5],Nt(()=>e=!1)),t.$set(ut),(!D||N&256&&d!==(d=(A[8]?"md:hidden":"")+" mr-3 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"))&&f(i,"class",d),A[4]?B?(B.p(A,N),N&16&&O(B,1)):(B=Ul(A),B.c(),O(B,1),B.m(v,null)):B&&(zt(),R(B,1,1,()=>{B=null}),Ft()),A[2]?Y?(Y.p(A,N),N&4&&O(Y,1)):(Y=Rl(A),Y.c(),O(Y,1),Y.m(b,h)):Y&&(zt(),R(Y,1,1,()=>{Y=null}),Ft());const tt={};N&512&&(tt.content=A[9].t("New Chat")),N&2097410&&(tt.$$scope={dirty:N,ctx:A}),w.$set(tt),A[10]!==void 0?U?(U.p(A,N),N&1024&&O(U,1)):(U=jl(A),U.c(),O(U,1),U.m(b,null)):U&&(zt(),R(U,1,1,()=>{U=null}),Ft())},i(A){D||(O(t.$$.fragment,A),O(c.$$.fragment,A),O(B),O(Y),O(w.$$.fragment,A),O(U),D=!0)},o(A){R(t.$$.fragment,A),R(c.$$.fragment,A),R(B),R(Y),R(w.$$.fragment,A),R(U),D=!1},d(A){A&&(m(l),m(s)),ct(t,A),ct(c),B&&B.d(),Y&&Y.d(),ct(w),U&&U.d(),C=!1,P()}}}function Jo(n,t,e){let l,s,r,o,i;ot(n,en,B=>e(20,l=B)),ot(n,ve,B=>e(7,s=B)),ot(n,Ne,B=>e(8,r=B)),ot(n,ln,B=>e(10,i=B));const a=ce("i18n");ot(n,a,B=>e(9,o=B));let{initNewChat:u}=t,{title:c=l}=t,{shareEnabled:d=!1}=t,{chat:y}=t,{selectedModels:v}=t,{showModelSelector:_=!0}=t,b=!1,h=!1;function w(B){b=B,e(5,b)}const E=()=>{Ne.set(!r)};function D(B){v=B,e(0,v)}const C=()=>{e(5,b=!b)},P=()=>{e(6,h=!h)},T=()=>{u()},V=B=>{B.detail==="archived-chat"&&vn.set(!0)};return n.$$set=B=>{"initNewChat"in B&&e(1,u=B.initNewChat),"title"in B&&e(12,c=B.title),"shareEnabled"in B&&e(2,d=B.shareEnabled),"chat"in B&&e(3,y=B.chat),"selectedModels"in B&&e(0,v=B.selectedModels),"showModelSelector"in B&&e(4,_=B.showModelSelector)},[v,u,d,y,_,b,h,s,r,o,i,a,c,w,E,D,C,P,T,V]}class Qo extends Zt{constructor(t){super(),Gt(this,t,Jo,Go,Wt,{initNewChat:1,title:12,shareEnabled:2,chat:3,selectedModels:0,showModelSelector:4})}}function Yo(n){let t,e,l,s,r,o,i;return a(),{feed:u,reset:a};function a(){t=!0,e="",l=0,s=-1,r=void 0,o=void 0,i=""}function u(d){e=e?e+d:d,t&&Xo(e)&&(e=e.slice(an.length)),t=!1;const y=e.length;let v=0,_=!1;for(;v<y;){_&&(e[v]===`
`&&++v,_=!1);let b=-1,h=s,w;for(let E=l;b<0&&E<y;++E)w=e[E],w===":"&&h<0?h=E-v:w==="\r"?(_=!0,b=E-v):w===`
`&&(b=E-v);if(b<0){l=y-v,s=h;break}else l=0,s=-1;c(e,v,h,b),v+=b+1}v===y?e="":v>0&&(e=e.slice(v))}function c(d,y,v,_){if(_===0){i.length>0&&(n({type:"event",id:r,event:o||void 0,data:i.slice(0,-1)}),i="",r=void 0),o=void 0;return}const b=v<0,h=d.slice(y,y+(b?_:v));let w=0;b?w=_:d[y+v+1]===" "?w=v+2:w=v+1;const E=y+w,D=_-w,C=d.slice(E,E+D).toString();if(h==="data")i+=C?"".concat(C,`
`):`
`;else if(h==="event")o=C;else if(h==="id"&&!C.includes("\0"))r=C;else if(h==="retry"){const P=parseInt(C,10);Number.isNaN(P)||n({type:"reconnect-interval",value:P})}}}const an=[239,187,191];function Xo(n){return an.every((t,e)=>n.charCodeAt(e)===t)}class Ko extends TransformStream{constructor(){let t;super({start(e){t=Yo(l=>{l.type==="event"&&e.enqueue(l)})},transform(e){t.feed(e)}})}}async function xo(n,t){const e=n.pipeThrough(new TextDecoderStream).pipeThrough(new Ko).getReader();let l=$o(e);return t&&(l=tr(l)),l}async function*$o(n){var t,e,l;for(;;){const{value:s,done:r}=await n.read();if(r){yield{done:!0,value:""};break}if(!s)continue;const o=s.data;if(o.startsWith("[DONE]")){yield{done:!0,value:""};break}try{const i=JSON.parse(o);if(console.log(i),i.error){yield{done:!0,value:"",error:i.error};break}if(i.citations){yield{done:!1,value:"",citations:i.citations};continue}yield{done:!1,value:((l=(e=(t=i.choices)==null?void 0:t[0])==null?void 0:e.delta)==null?void 0:l.content)??"",usage:i.usage}}catch(i){console.error("Error extracting delta from SSE event:",i)}}}async function*tr(n){for await(const t of n){if(t.done){yield t;return}if(t.citations){yield t;continue}let e=t.value;if(e.length<5){yield{done:!1,value:e};continue}for(;e!="";){const l=Math.min(Math.floor(Math.random()*3)+1,e.length);yield{done:!1,value:e.slice(0,l)},(document==null?void 0:document.visibilityState)!=="hidden"&&await er(5),e=e.slice(l)}}}const er=n=>new Promise(t=>setTimeout(t,n));function zl(n){let t,e=n[2]&&Fl(n);return{c(){e&&e.c(),t=Ot()},l(l){e&&e.l(l),t=Ot()},m(l,s){e&&e.m(l,s),L(l,t,s)},p(l,s){l[2]?e?(e.p(l,s),s&4&&O(e,1)):(e=Fl(l),e.c(),O(e,1),e.m(t.parentNode,t)):e&&(zt(),R(e,1,1,()=>{e=null}),Ft())},d(l){l&&m(t),e&&e.d(l)}}}function Fl(n){let t,e,l,s,r=n[1].type+"",o,i,a,u,c,d=n[1].content+"",y,v,_,b,h,w,E=n[1].url&&ql(),D=n[1].url&&Wl(),C=n[1].dismissible&&Zl(n);return{c(){t=I("div"),e=I("div"),l=I("div"),s=I("div"),o=_t(r),a=J(),E&&E.c(),u=J(),c=I("div"),y=_t(d),v=J(),D&&D.c(),_=J(),b=I("div"),C&&C.c(),this.h()},l(P){t=M(P,"DIV",{class:!0});var T=S(t);e=M(T,"DIV",{class:!0});var V=S(e);l=M(V,"DIV",{class:!0});var B=S(l);s=M(B,"DIV",{class:!0});var Y=S(s);o=bt(Y,r),Y.forEach(m),a=Q(B),E&&E.l(B),B.forEach(m),u=Q(V),c=M(V,"DIV",{class:!0});var U=S(c);y=bt(U,d),U.forEach(m),V.forEach(m),v=Q(T),D&&D.l(T),_=Q(T),b=M(T,"DIV",{class:!0});var A=S(b);C&&C.l(A),A.forEach(m),T.forEach(m),this.h()},h(){f(s,"class",i="text-xs font-black "+(n[3][n[1].type]??n[3].info)+" w-fit px-2 rounded uppercase line-clamp-1 mr-0.5"),f(l,"class","flex justify-between self-start"),f(c,"class","flex-1 text-xs text-gray-700 dark:text-white"),f(e,"class","flex flex-col md:flex-row md:items-center flex-1 text-sm w-fit gap-1.5"),f(b,"class","flex self-start"),f(t,"class","top-0 left-0 right-0 p-2 mx-4 px-3 flex justify-center items-center relative rounded-xl border border-gray-50 dark:border-gray-850 text-gray-800 dark:text-gary-100 bg-white dark:bg-gray-900 backdrop-blur-xl z-40")},m(P,T){L(P,t,T),k(t,e),k(e,l),k(l,s),k(s,o),k(l,a),E&&E.m(l,null),k(e,u),k(e,c),k(c,y),k(t,v),D&&D.m(t,null),k(t,_),k(t,b),C&&C.m(b,null),w=!0},p(P,T){(!w||T&2)&&r!==(r=P[1].type+"")&&yt(o,r),(!w||T&2&&i!==(i="text-xs font-black "+(P[3][P[1].type]??P[3].info)+" w-fit px-2 rounded uppercase line-clamp-1 mr-0.5"))&&f(s,"class",i),P[1].url?E||(E=ql(),E.c(),E.m(l,null)):E&&(E.d(1),E=null),(!w||T&2)&&d!==(d=P[1].content+"")&&yt(y,d),P[1].url?D||(D=Wl(),D.c(),D.m(t,_)):D&&(D.d(1),D=null),P[1].dismissible?C?C.p(P,T):(C=Zl(P),C.c(),C.m(b,null)):C&&(C.d(1),C=null)},i(P){w||(P&&Ae(()=>{w&&(h||(h=Be(t,Ye,{delay:100,duration:300},!0)),h.run(1))}),w=!0)},o(P){P&&(h||(h=Be(t,Ye,{delay:100,duration:300},!1)),h.run(0)),w=!1},d(P){P&&m(t),E&&E.d(),D&&D.d(),C&&C.d(),P&&h&&h.end()}}}function ql(n){let t,e='<a class="text-gray-700 dark:text-white text-xs font-bold underline" href="/assets/files/whitepaper.pdf" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-4 h-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){t=I("div"),t.innerHTML=e,this.h()},l(l){t=M(l,"DIV",{class:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-1ofrdjc"&&(t.innerHTML=e),this.h()},h(){f(t,"class","flex md:hidden group w-fit md:items-center")},m(l,s){L(l,t,s)},d(l){l&&m(t)}}}function Wl(n){let t,e='<a class="text-gray-700 dark:text-white text-xs font-bold underline" href="/" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){t=I("div"),t.innerHTML=e,this.h()},l(l){t=M(l,"DIV",{class:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-15ujvd1"&&(t.innerHTML=e),this.h()},h(){f(t,"class","hidden md:flex group w-fit md:items-center")},m(l,s){L(l,t,s)},d(l){l&&m(t)}}}function Zl(n){let t,e="×",l,s;return{c(){t=I("button"),t.textContent=e,this.h()},l(r){t=M(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-17pf3tf"&&(t.textContent=e),this.h()},h(){f(t,"class","-mt-[3px] ml-1.5 mr-1 text-gray-400 dark:hover:text-white h-1")},m(r,o){L(r,t,o),l||(s=x(t,"click",n[5]),l=!0)},p:Mt,d(r){r&&m(t),l=!1,s()}}}function lr(n){let t,e=!n[0]&&zl(n);return{c(){e&&e.c(),t=Ot()},l(l){e&&e.l(l),t=Ot()},m(l,s){e&&e.m(l,s),L(l,t,s)},p(l,[s]){l[0]?e&&(e.d(1),e=null):e?e.p(l,s):(e=zl(l),e.c(),e.m(t.parentNode,t))},i:Mt,o:Mt,d(l){l&&m(t),e&&e.d(l)}}}function nr(n,t,e){const l=Fe();let{banner:s={id:"",type:"info",title:"",content:"",url:"",dismissable:!0,timestamp:Math.floor(Date.now()/1e3)}}=t,{dismissed:r=!1}=t,o=!1;const i={info:"bg-blue-500/20 text-blue-700 dark:text-blue-200 ",success:"bg-green-500/20 text-green-700 dark:text-green-200",warning:"bg-yellow-500/20 text-yellow-700 dark:text-yellow-200",error:"bg-red-500/20 text-red-700 dark:text-red-200"},a=c=>{e(0,r=!0),l("dismiss",c)};qe(()=>{e(2,o=!0)});const u=()=>{a(s.id)};return n.$$set=c=>{"banner"in c&&e(1,s=c.banner),"dismissed"in c&&e(0,r=c.dismissed)},[r,s,o,i,a,u]}class sr extends Zt{constructor(t){super(),Gt(this,t,nr,lr,Wt,{banner:1,dismissed:0})}}const{document:ze}=mn;function Gl(n,t,e){const l=n.slice();return l[62]=t[e],l}function Jl(n){let t,e,l,s,r,o,i,a,u,c,d,y,v,_,b,h,w,E,D,C,P,T,V,B,Y,U;function A(W){n[25](W)}function N(W){n[26](W)}let ut={title:n[10],shareEnabled:n[13].length>0,chat:n[9],initNewChat:n[19]};n[6]!==void 0&&(ut.selectedModels=n[6]),n[5]!==void 0&&(ut.showModelSelector=n[5]),e=new Qo({props:ut}),pt.push(()=>Ht(e,"selectedModels",A)),pt.push(()=>Ht(e,"showModelSelector",N));let tt=n[17].length>0&&n[13].length===0&&!n[14]&&n[6].length<=1&&Ql(n);function lt(W){n[29](W)}function Dt(W){n[30](W)}function Jt(W){n[31](W)}function At(W){n[32](W)}let St={chatId:n[14],selectedModels:n[6],processing:rr,bottomPadding:n[12].length>0,sendPrompt:n[21],continueGeneration:n[24],regenerateResponse:n[23]};n[1]!==void 0&&(St.history=n[1]),n[13]!==void 0&&(St.messages=n[13]),n[3]!==void 0&&(St.autoScroll=n[3]),n[11]!==void 0&&(St.prompt=n[11]),c=new hn({props:St}),pt.push(()=>Ht(c,"history",lt)),pt.push(()=>Ht(c,"messages",Dt)),pt.push(()=>Ht(c,"autoScroll",Jt)),pt.push(()=>Ht(c,"prompt",At));function Lt(W){n[35](W)}function Vt(W){n[36](W)}function qt(W){n[37](W)}function Yt(W){n[38](W)}function Qt(W){n[39](W)}let z={selectedModels:n[6],messages:n[13],submitPrompt:n[20],stopResponse:n[22]};return n[12]!==void 0&&(z.files=n[12]),n[11]!==void 0&&(z.prompt=n[11]),n[3]!==void 0&&(z.autoScroll=n[3]),n[8]!==void 0&&(z.webSearchEnabled=n[8]),n[7]!==void 0&&(z.atSelectedModel=n[7]),w=new Eo({props:z}),pt.push(()=>Ht(w,"files",Lt)),pt.push(()=>Ht(w,"prompt",Vt)),pt.push(()=>Ht(w,"autoScroll",qt)),pt.push(()=>Ht(w,"webSearchEnabled",Yt)),pt.push(()=>Ht(w,"atSelectedModel",Qt)),{c(){t=I("div"),rt(e.$$.fragment),r=J(),tt&&tt.c(),o=J(),i=I("div"),a=I("div"),u=I("div"),rt(c.$$.fragment),h=J(),rt(w.$$.fragment),this.h()},l(W){t=M(W,"DIV",{class:!0});var et=S(t);it(e.$$.fragment,et),r=Q(et),tt&&tt.l(et),o=Q(et),i=M(et,"DIV",{class:!0});var Ut=S(i);a=M(Ut,"DIV",{class:!0,id:!0});var Rt=S(a);u=M(Rt,"DIV",{class:!0});var ft=S(u);it(c.$$.fragment,ft),ft.forEach(m),Rt.forEach(m),h=Q(Ut),it(w.$$.fragment,Ut),Ut.forEach(m),et.forEach(m),this.h()},h(){f(u,"class",b="h-full w-full flex flex-col "+(n[0]?"py-4":"pt-2 pb-4")),f(a,"class","pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0 max-w-full"),f(a,"id","messages-container"),f(i,"class","flex flex-col flex-auto"),f(t,"class",V="min-h-screen max-h-screen "+(n[16]?"md:max-w-[calc(100%-260px)]":"")+" w-full max-w-full flex flex-col")},m(W,et){L(W,t,et),at(e,t,null),k(t,r),tt&&tt.m(t,null),k(t,o),k(t,i),k(i,a),k(a,u),at(c,u,null),n[33](a),k(i,h),at(w,i,null),B=!0,Y||(U=x(a,"scroll",n[34]),Y=!0)},p(W,et){const Ut={};et[0]&1024&&(Ut.title=W[10]),et[0]&8192&&(Ut.shareEnabled=W[13].length>0),et[0]&512&&(Ut.chat=W[9]),!l&&et[0]&64&&(l=!0,Ut.selectedModels=W[6],Nt(()=>l=!1)),!s&&et[0]&32&&(s=!0,Ut.showModelSelector=W[5],Nt(()=>s=!1)),e.$set(Ut),W[17].length>0&&W[13].length===0&&!W[14]&&W[6].length<=1?tt?(tt.p(W,et),et[0]&155712&&O(tt,1)):(tt=Ql(W),tt.c(),O(tt,1),tt.m(t,o)):tt&&(zt(),R(tt,1,1,()=>{tt=null}),Ft());const Rt={};et[0]&16384&&(Rt.chatId=W[14]),et[0]&64&&(Rt.selectedModels=W[6]),et[0]&4096&&(Rt.bottomPadding=W[12].length>0),!d&&et[0]&2&&(d=!0,Rt.history=W[1],Nt(()=>d=!1)),!y&&et[0]&8192&&(y=!0,Rt.messages=W[13],Nt(()=>y=!1)),!v&&et[0]&8&&(v=!0,Rt.autoScroll=W[3],Nt(()=>v=!1)),!_&&et[0]&2048&&(_=!0,Rt.prompt=W[11],Nt(()=>_=!1)),c.$set(Rt),(!B||et[0]&1&&b!==(b="h-full w-full flex flex-col "+(W[0]?"py-4":"pt-2 pb-4")))&&f(u,"class",b);const ft={};et[0]&64&&(ft.selectedModels=W[6]),et[0]&8192&&(ft.messages=W[13]),!E&&et[0]&4096&&(E=!0,ft.files=W[12],Nt(()=>E=!1)),!D&&et[0]&2048&&(D=!0,ft.prompt=W[11],Nt(()=>D=!1)),!C&&et[0]&8&&(C=!0,ft.autoScroll=W[3],Nt(()=>C=!1)),!P&&et[0]&256&&(P=!0,ft.webSearchEnabled=W[8],Nt(()=>P=!1)),!T&&et[0]&128&&(T=!0,ft.atSelectedModel=W[7],Nt(()=>T=!1)),w.$set(ft),(!B||et[0]&65536&&V!==(V="min-h-screen max-h-screen "+(W[16]?"md:max-w-[calc(100%-260px)]":"")+" w-full max-w-full flex flex-col"))&&f(t,"class",V)},i(W){B||(O(e.$$.fragment,W),O(tt),O(c.$$.fragment,W),O(w.$$.fragment,W),B=!0)},o(W){R(e.$$.fragment,W),R(tt),R(c.$$.fragment,W),R(w.$$.fragment,W),B=!1},d(W){W&&m(t),ct(e),tt&&tt.d(),ct(c),n[33](null),ct(w),Y=!1,U()}}}function Ql(n){let t,e,l,s,r=ee(n[17].filter(n[27])),o=[];for(let a=0;a<r.length;a+=1)o[a]=Yl(Gl(n,r,a));const i=a=>R(o[a],1,1,()=>{o[a]=null});return{c(){t=I("div"),e=I("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){t=M(a,"DIV",{class:!0});var u=S(t);e=M(u,"DIV",{class:!0});var c=S(e);for(let d=0;d<o.length;d+=1)o[d].l(c);c.forEach(m),u.forEach(m),this.h()},h(){f(e,"class","flex flex-col gap-1 w-full"),f(t,"class",l="absolute top-[4.25rem] w-full "+(n[16]?"md:max-w-[calc(100%-260px)]":""))},m(a,u){L(a,t,u),k(t,e);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(e,null);s=!0},p(a,u){if(u[0]&131072){r=ee(a[17].filter(a[27]));let c;for(c=0;c<r.length;c+=1){const d=Gl(a,r,c);o[c]?(o[c].p(d,u),O(o[c],1)):(o[c]=Yl(d),o[c].c(),O(o[c],1),o[c].m(e,null))}for(zt(),c=r.length;c<o.length;c+=1)i(c);Ft()}(!s||u[0]&65536&&l!==(l="absolute top-[4.25rem] w-full "+(a[16]?"md:max-w-[calc(100%-260px)]":"")))&&f(t,"class",l)},i(a){if(!s){for(let u=0;u<r.length;u+=1)O(o[u]);s=!0}},o(a){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)R(o[u]);s=!1},d(a){a&&m(t),ye(o,a)}}}function Yl(n){let t,e;return t=new sr({props:{banner:n[62]}}),t.$on("dismiss",n[28]),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,s){const r={};s[0]&131072&&(r.banner=l[62]),t.$set(r)},i(l){e||(O(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function or(n){let t,e,l,s;ze.title=t=`
		`+(n[10]?`${n[10].length>30?`${n[10].slice(0,30)}...`:n[10]} | ${n[15]}`:`${n[15]}`)+`
	`;let r=(!n[0]||n[2]&&n[0])&&Jl(n);return{c(){e=J(),r&&r.c(),l=Ot()},l(o){dn("svelte-1123lr8",ze.head).forEach(m),e=Q(o),r&&r.l(o),l=Ot()},m(o,i){L(o,e,i),r&&r.m(o,i),L(o,l,i),s=!0},p(o,i){(!s||i[0]&33792)&&t!==(t=`
		`+(o[10]?`${o[10].length>30?`${o[10].slice(0,30)}...`:o[10]} | ${o[15]}`:`${o[15]}`)+`
	`)&&(ze.title=t),!o[0]||o[2]&&o[0]?r?(r.p(o,i),i[0]&5&&O(r,1)):(r=Jl(o),r.c(),O(r,1),r.m(l.parentNode,l)):r&&(zt(),R(r,1,1,()=>{r=null}),Ft())},i(o){s||(O(r),s=!0)},o(o){R(r),s=!1},d(o){o&&(m(e),m(l)),r&&r.d(o)}}}let rr="";function ir(n,t,e){let l,s,r,o,i,a,u,c,d,y;ot(n,ve,g=>e(14,l=g)),ot(n,ae,g=>e(42,s=g)),ot(n,Le,g=>e(43,r=g)),ot(n,ln,g=>e(45,i=g)),ot(n,pn,g=>e(46,a=g)),ot(n,$l,g=>e(47,u=g)),ot(n,en,g=>e(15,c=g)),ot(n,Ne,g=>e(16,d=g)),ot(n,wn,g=>e(17,y=g));const v=ce("i18n");ot(n,v,g=>e(44,o=g));let{chatIdProp:_=""}=t,b=!1,h=!1,w=!0,E,D=!0,C=[""],P,T=!1,V=null,B="",Y="",U=[],A=[],N={messages:{},currentId:null};qe(async()=>{l?(s.saveChatHistory??!0)||await Pe("/"):await ut()});const ut=async()=>{var X;window.history.replaceState(N.state,"","/"),await ve.set(""),e(3,w=!0),e(10,B=""),e(13,A=[]),e(1,N={messages:{},currentId:null}),a.url.searchParams.get("models")?e(6,C=(X=a.url.searchParams.get("models"))==null?void 0:X.split(",")):s!=null&&s.models?e(6,C=s==null?void 0:s.models):u!=null&&u.default_models?(console.log((u==null?void 0:u.default_models.split(","))??""),e(6,C=u==null?void 0:u.default_models.split(","))):e(6,C=[""]),a.url.searchParams.get("q")&&(e(11,Y=a.url.searchParams.get("q")??""),Y&&(await kt(),At(Y))),e(6,C=C.map(F=>r.map(j=>j.id).includes(F)?F:""));const g=await sl(localStorage.token);g?ae.set(g.ui):ae.set(JSON.parse(localStorage.getItem("settings")??"{}"));const H=document.getElementById("chat-textarea");setTimeout(()=>H==null?void 0:H.focus(),0)},tt=async()=>{if(ve.set(_),e(9,V=await Tn(localStorage.token,l).catch(async g=>(await Pe("/"),null))),V){await ft();const g=V.chat;if(g){console.log(g),e(6,C=((g==null?void 0:g.models)??void 0)!==void 0?g.models:[g.models??""]),e(1,N=((g==null?void 0:g.history)??void 0)!==void 0?g.history:yn(g.messages)),e(10,B=g.title);const H=await sl(localStorage.token);return H?await ae.set(H.ui):await ae.set(JSON.parse(localStorage.getItem("settings")??"{}")),await ae.set({...s,system:g.system??s.system,params:g.options??s.params}),e(3,w=!0),await kt(),A.length>0&&e(1,N.messages[A.at(-1).id].done=!0,N),await kt(),!0}else return null}},lt=async()=>{await kt(),E&&e(4,E.scrollTop=E.scrollHeight,E)},Dt=g=>{const H=N.messages[g];return H.parentId?[...Dt(H.parentId),H]:[H]},Jt=async(g,H)=>{await gn.run({querySelector:".mermaid"});const X=await Kn(localStorage.token,{model:g.id,messages:H.map(F=>({id:F.id,role:F.role,content:F.content,timestamp:F.timestamp})),chat_id:l}).catch(F=>(console.error(F),null));if(X!==null)for(const F of X.messages)e(1,N.messages[F.id]={...N.messages[F.id],...N.messages[F.id].content!==F.content?{originalContent:N.messages[F.id].content}:{},...F},N)},At=async(g,H=null)=>{if(console.log("submitPrompt",l),e(6,C=C.map(X=>r.map(F=>F.id).includes(X)?X:"")),C.includes(""))gt.error(o.t("Model not selected"));else if(A.length!=0&&A.at(-1).done!=!0)console.log("wait");else if(U.length>0&&U.filter(X=>X.upload_status===!1).length>0)gt.error(o.t("Oops! Hold tight! Your files are still in the processing oven. We're cooking them up to perfection. Please be patient and we'll let you know once they're ready."));else{document.getElementById("chat-textarea").style.height="";let X=el(),F={id:X,parentId:A.length!==0?A.at(-1).id:null,childrenIds:[],role:"user",user:H??void 0,content:g,files:U.length>0?U:void 0,timestamp:Math.floor(Date.now()/1e3),models:C.filter((j,G)=>C.indexOf(j)===G)};e(1,N.messages[X]=F,N),e(1,N.currentId=X,N),A.length!==0&&N.messages[A.at(-1).id].childrenIds.push(X),await kt(),A.length==1&&(s.saveChatHistory??!0?(e(9,V=await Cn(localStorage.token,{id:l,title:o.t("New Chat"),models:C,system:s.system??void 0,options:{...s.params??{}},messages:A,history:N,tags:[],timestamp:Date.now()})),await Ce.set(await Te(localStorage.token)),await ve.set(V.id)):await ve.set("local"),await kt()),e(11,Y=""),document.getElementById("chat-textarea").style.height="",e(12,U=[]),await St(g,X)}},St=async(g,H,X=null)=>{const F=JSON.parse(JSON.stringify(l));await Promise.all((X?[X]:P!==void 0?[P.id]:C).map(async j=>{var wt,It,vt;console.log("modelId",j);const G=r.filter(jt=>jt.id===j).at(0);if(G){A.some(Z=>{var q;return(q=Z.files)==null?void 0:q.some(dt=>dt.type==="image")})&&!(((vt=(It=(wt=G.info)==null?void 0:wt.meta)==null?void 0:It.capabilities)==null?void 0:vt.vision)??!0)&&gt.error(o.t("Model {{modelName}} is not vision capable",{modelName:G.name??G.id}));let p=el(),K={parentId:H,id:p,childrenIds:[],role:"assistant",content:"",model:G.id,modelName:G.name??G.id,userContext:null,timestamp:Math.floor(Date.now()/1e3)};e(1,N.messages[p]=K,N),e(1,N.currentId=p,N),H!==null&&e(1,N.messages[H].childrenIds=[...N.messages[H].childrenIds,p],N),await kt();let $=null;if(((s==null?void 0:s.memory)??!1)&&$===null){const Z=await Zn(localStorage.token,g).catch(q=>(gt.error(q),null));Z&&(Z.documents[0].length>0&&($=Z.documents.reduce((q,dt,Et)=>{const Bt=Z.metadatas[Et][0].created_at,st=new Date(Bt*1e3).toISOString().split("T")[0];return q.push(`${Et+1}. [${st}]. ${dt[0]}`),q},[])),console.log($))}K.userContext=$,T&&await Lt(G.id,H,p),(G==null?void 0:G.owned_by)==="openai"?await qt(G,g,p,F):G&&await Vt(G,g,p,F)}else gt.error(o.t("Model {{modelId}} not found",{modelId:j}))})),await Ce.set(await Te(localStorage.token))},Lt=async(g,H,X)=>{const F=N.messages[X];F.status={done:!1,action:"web_search",description:o.t("Generating search query")},e(13,A),e(1,N);const j=N.messages[H].content;let G=j;if(j.length>100&&(G=await Ut(g,j),!G)){gt.warning(o.t("No search query generated")),F.status={...F.status,done:!0,error:!0,description:"No search query generated"},e(13,A),e(1,N);return}F.status={...F.status,description:o.t("Searching the web for '{{searchQuery}}'",{searchQuery:G})},e(13,A),e(1,N);const wt=await An(localStorage.token,G).catch(It=>(console.log(It),gt.error(It),null));wt?(F.status={...F.status,done:!0,description:o.t("Searched {{count}} sites",{count:wt.filenames.length}),urls:wt.filenames},((F==null?void 0:F.files)??!0)&&(F.files=[]),F.files.push({collection_name:wt.collection_name,name:G,type:"web_search_results",urls:wt.filenames}),e(13,A),e(1,N)):(F.status={...F.status,done:!0,error:!0,description:"No search results found"},e(13,A),e(1,N))},Vt=async(g,H,X,F)=>{var p,K,$,Z;g=g.id;const j=N.messages[X];await kt(),lt();const G=[s.system||((j==null?void 0:j.userContext)??null)?{role:"system",content:`${ll((s==null?void 0:s.system)??"",i.name)}${(j==null?void 0:j.userContext)??null?`

User Context:
${((j==null?void 0:j.userContext)??[]).join(`
`)}`:""}`}:void 0,...A].filter(q=>{var dt;return(dt=q==null?void 0:q.content)==null?void 0:dt.trim()}).map((q,dt,Et)=>{var nt;const Bt={role:q.role,content:q.content},st=(nt=q.files)==null?void 0:nt.filter(Xt=>Xt.type==="image").map(Xt=>Xt.url.slice(Xt.url.indexOf(",")+1));return st&&st.length>0&&q.role==="user"&&(Bt.images=st),Bt});let wt=-1;G.forEach((q,dt)=>{q.images&&(wt=dt)}),G.forEach((q,dt)=>{dt!==wt&&delete q.images});const It=A.filter(q=>(q==null?void 0:q.files)??null).map(q=>q.files.filter(dt=>["doc","collection","web_search_results"].includes(dt.type))).flat(1),[vt,jt]=await En(localStorage.token,{model:g,messages:G,options:{...s.params??{},stop:((p=s==null?void 0:s.params)==null?void 0:p.stop)??void 0?s.params.stop.map(q=>decodeURIComponent(JSON.parse('"'+q.replace(/\"/g,'\\"')+'"'))):void 0,num_predict:((K=s==null?void 0:s.params)==null?void 0:K.max_tokens)??void 0,repeat_penalty:(($=s==null?void 0:s.params)==null?void 0:$.frequency_penalty)??void 0},format:s.requestFormat??void 0,keep_alive:s.keepAlive??void 0,docs:It.length>0?It:void 0,citations:It.length>0,chat_id:l});if(vt&&vt.ok){console.log("controller",jt);const q=vt.body.pipeThrough(new TextDecoderStream).pipeThrough(kn(`
`)).getReader();for(;;){const{value:dt,done:Et}=await q.read();if(Et||h||F!==l){if(j.done=!0,e(13,A),e(1,N),h)jt.abort("User: Stop Response");else{const Bt=Dt(X);await Jt(g,Bt)}break}try{let Bt=dt.split(`
`);for(const st of Bt)if(st!==""){console.log(st);let nt=JSON.parse(st);if("citations"in nt){j.citations=nt.citations;continue}if("detail"in nt)throw nt;if(nt.done==!1){if(j.content==""&&nt.message.content==`
`)continue;j.content+=nt.message.content,e(13,A),e(1,N)}else{if(j.done=!0,j.content==""&&(j.error={code:400,content:"Oops! No text generated from Ollama, Please try again."}),j.context=nt.context??null,j.info={total_duration:nt.total_duration,load_duration:nt.load_duration,sample_count:nt.sample_count,sample_duration:nt.sample_duration,prompt_eval_count:nt.prompt_eval_count,prompt_eval_duration:nt.prompt_eval_duration,eval_count:nt.eval_count,eval_duration:nt.eval_duration},e(13,A),e(1,N),s.notificationEnabled&&!document.hasFocus()){const Xt=new Notification(selectedModelfile?`${selectedModelfile.title.charAt(0).toUpperCase()+selectedModelfile.title.slice(1)}`:`${g}`,{body:j.content,icon:(selectedModelfile==null?void 0:selectedModelfile.imageUrl)??`${He}/static/favicon.png`})}s.responseAutoCopy&&nl(j.content),s.responseAutoPlayback&&(await kt(),(Z=document.getElementById(`speak-button-${j.id}`))==null||Z.click())}}}catch(Bt){console.log(Bt),"detail"in Bt&&gt.error(Bt.detail);break}w&&lt()}l==F&&(s.saveChatHistory??!0)&&(e(9,V=await je(localStorage.token,F,{messages:A,history:N,models:C})),await Ce.set(await Te(localStorage.token)))}else{if(vt!==null){const q=await vt.json();console.log(q),"detail"in q?(gt.error(q.detail),j.error={content:q.detail}):(gt.error(q.error),j.error={content:q.error})}else gt.error(o.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:"Ollama"})),j.error={content:o.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:"Ollama"})};j.done=!0,e(13,A),e(1,N)}if(h=!1,await kt(),w&&lt(),A.length==2&&A.at(1).content!==""){window.history.replaceState(N.state,"",`/c/${F}`);const q=await et(H);await Rt(F,q)}},qt=async(g,H,X,F)=>{var wt,It,vt,jt,p,K,$,Z,q,dt;const j=N.messages[X],G=A.filter(Et=>(Et==null?void 0:Et.files)??null).map(Et=>Et.files.filter(Bt=>["doc","collection","web_search_results"].includes(Bt.type))).flat(1);console.log(G),lt();try{const[Et,Bt]=await Sn(localStorage.token,{model:g.id,stream:!0,stream_options:((vt=(It=(wt=g.info)==null?void 0:wt.meta)==null?void 0:It.capabilities)==null?void 0:vt.usage)??!1?{include_usage:!0}:void 0,messages:[s.system||((j==null?void 0:j.userContext)??null)?{role:"system",content:`${ll((s==null?void 0:s.system)??"",i.name)}${(j==null?void 0:j.userContext)??null?`

User Context:
${((j==null?void 0:j.userContext)??[]).join(`
`)}`:""}`}:void 0,...A].filter(st=>{var nt;return(nt=st==null?void 0:st.content)==null?void 0:nt.trim()}).map((st,nt,Xt)=>{var fe;return{role:st.role,...((fe=st.files)==null?void 0:fe.filter(de=>de.type==="image").length)>0&&st.role==="user"?{content:[{type:"text",text:Xt.length-1!==nt?st.content:(st==null?void 0:st.raContent)??st.content},...st.files.filter(de=>de.type==="image").map(de=>({type:"image_url",image_url:{url:de.url}}))]}:{content:Xt.length-1!==nt?st.content:(st==null?void 0:st.raContent)??st.content}}}),seed:((jt=s==null?void 0:s.params)==null?void 0:jt.seed)??void 0,stop:((p=s==null?void 0:s.params)==null?void 0:p.stop)??void 0?s.params.stop.map(st=>decodeURIComponent(JSON.parse('"'+st.replace(/\"/g,'\\"')+'"'))):void 0,temperature:((K=s==null?void 0:s.params)==null?void 0:K.temperature)??void 0,top_p:(($=s==null?void 0:s.params)==null?void 0:$.top_p)??void 0,frequency_penalty:((Z=s==null?void 0:s.params)==null?void 0:Z.frequency_penalty)??void 0,max_tokens:((q=s==null?void 0:s.params)==null?void 0:q.max_tokens)??void 0,docs:G.length>0?G:void 0,citations:G.length>0,chat_id:l},`${Ue}`);if(await kt(),lt(),Et&&Et.ok&&Et.body){const st=await xo(Et.body,s.splitLargeChunks);let nt=null;for await(const Xt of st){const{value:fe,done:de,citations:Ze,error:Ge,usage:Je}=Xt;if(Ge){await Yt(Ge,null,g,j);break}if(de||h||F!==l){if(j.done=!0,e(13,A),e(1,N),h)Bt.abort("User: Stop Response");else{const cn=Dt(X);await Jt(g,cn)}break}if(Je&&(nt=Je),Ze){j.citations=Ze;continue}j.content==""&&fe==`
`||(j.content+=fe,e(13,A),e(1,N),w&&lt())}if(s.notificationEnabled&&!document.hasFocus()){const Xt=new Notification(`OpenAI ${g}`,{body:j.content,icon:`${He}/static/favicon.png`})}s.responseAutoCopy&&nl(j.content),s.responseAutoPlayback&&(await kt(),(dt=document.getElementById(`speak-button-${j.id}`))==null||dt.click()),nt&&(j.info={...nt,openai:!0}),l==F&&(s.saveChatHistory??!0)&&(e(9,V=await je(localStorage.token,F,{models:C,messages:A,history:N})),await Ce.set(await Te(localStorage.token)))}else await Yt(null,Et,g,j)}catch(Et){await Yt(Et,null,g,j)}if(e(13,A),e(1,N),h=!1,await kt(),w&&lt(),A.length==2){window.history.replaceState(N.state,"",`/c/${F}`);const Et=await et(H);await Rt(F,Et)}},Yt=async(g,H,X,F)=>{let j="",G;g?G=g:H!==null&&(G=await H.json()),console.error(G),"detail"in G?(gt.error(G.detail),j=G.detail):"error"in G?"message"in G.error?(gt.error(G.error.message),j=G.error.message):(gt.error(G.error),j=G.error):"message"in G&&(gt.error(G.message),j=G.message),F.error={content:o.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:X.name??X.id})+`
`+j},F.done=!0,e(13,A),e(1,N)},Qt=()=>{h=!0,console.log("stopResponse")},z=async g=>{if(console.log("regenerateResponse"),A.length!=0){let H=N.messages[g.parentId],X=H.content;((H==null?void 0:H.models)??[...C]).length==1?await St(X,H.id):await St(X,H.id,g.model)}},W=async()=>{console.log("continueGeneration");const g=JSON.parse(JSON.stringify(l));if(A.length!=0&&A.at(-1).done==!0){const H=N.messages[N.currentId];H.done=!1,await kt();const X=r.filter(F=>F.id===H.model).at(0);X&&((X==null?void 0:X.owned_by)==="openai"?await qt(X,N.messages[H.parentId].content,H.id,g):await Vt(X,N.messages[H.parentId].content,H.id,g))}else gt.error(o.t("Model {{modelId}} not found",{modelId}))},et=async g=>{var H,X,F,j;if(((H=s==null?void 0:s.title)==null?void 0:H.auto)??!0){const G=r.find(jt=>jt.id===C[0]),wt=(G==null?void 0:G.owned_by)==="openai"?((X=s==null?void 0:s.title)==null?void 0:X.modelExternal)??C[0]:((F=s==null?void 0:s.title)==null?void 0:F.model)??C[0],It=r.find(jt=>jt.id===wt);return console.log(It),await In(localStorage.token,((j=s==null?void 0:s.title)==null?void 0:j.prompt)??o.t("Create a concise, 3-5 word phrase as a header for the following query, strictly adhering to the 3-5 word limit and avoiding the use of the word 'title':")+" {{prompt}}",wt,g,l,(It==null?void 0:It.owned_by)==="openai"?`${Ue}`:`${xe}/v1`)}else return`${g}`},Ut=async(g,H)=>{var wt,It;const X=r.find(vt=>vt.id===g),F=(X==null?void 0:X.owned_by)==="openai"?((wt=s==null?void 0:s.title)==null?void 0:wt.modelExternal)??g:((It=s==null?void 0:s.title)==null?void 0:It.model)??g,j=r.find(vt=>vt.id===F),G=A.filter(vt=>vt.role==="user").map(vt=>vt.content);return await Mn(localStorage.token,F,G,H,(j==null?void 0:j.owned_by)==="openai"?`${Ue}`:`${xe}/v1`)},Rt=async(g,H)=>{g===l&&e(10,B=H),(s.saveChatHistory??!0)&&(e(9,V=await je(localStorage.token,g,{title:H})),await Ce.set(await Te(localStorage.token)))},ft=async()=>await Vn(localStorage.token,l).catch(async g=>[]);function Pt(g){C=g,e(6,C)}function he(g){D=g,e(5,D)}const xt=g=>g.dismissible?!JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]").includes(g.id):!0,ge=g=>{const H=g.detail;localStorage.setItem("dismissedBannerIds",JSON.stringify([H,...JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]")].filter(X=>y.find(F=>F.id===X))))};function Se(g){N=g,e(1,N)}function Ie(g){A=g,e(13,A),e(1,N)}function Me(g){w=g,e(3,w)}function ue(g){Y=g,e(11,Y)}function Ct(g){pt[g?"unshift":"push"](()=>{E=g,e(4,E)})}const Tt=g=>{e(3,w=E.scrollHeight-E.scrollTop<=E.clientHeight+5)};function De(g){U=g,e(12,U)}function pe(g){Y=g,e(11,Y)}function _e(g){w=g,e(3,w)}function $t(g){T=g,e(8,T)}function be(g){P=g,e(7,P)}return n.$$set=g=>{"chatIdProp"in g&&e(0,_=g.chatIdProp)},n.$$.update=()=>{if(n.$$.dirty[0]&2)if(N.currentId!==null){let g=[],H=N.messages[N.currentId];for(;H!==null;)g.unshift({...H}),H=H.parentId!==null?N.messages[H.parentId]:null;e(13,A=g)}else e(13,A=[]);n.$$.dirty[0]&1&&_&&(async()=>{if(await tt()){await kt(),e(2,b=!0),window.setTimeout(()=>lt(),0);const g=document.getElementById("chat-textarea");g==null||g.focus()}else await Pe("/")})()},[_,N,b,w,E,D,C,P,T,V,B,Y,U,A,l,c,d,y,v,ut,At,St,Qt,z,W,Pt,he,xt,ge,Se,Ie,Me,ue,Ct,Tt,De,pe,_e,$t,be]}class Rr extends Zt{constructor(t){super(),Gt(this,t,ir,or,Wt,{chatIdProp:0},null,[-1,-1,-1])}}export{Rr as C};
//# sourceMappingURL=Chat.bb5ce20a.js.map
