import{s as Zt,E as ne,F as se,G as oe,H as re,w as ot,e as Ht,i as L,d as m,I as Be,x as ie,y as tn,p as gt,f as I,g as M,h as S,L as ee,Z as ye,u as tt,v as ae,U as Le,C as Dt,P as ue,a as Q,l as pt,R as Kt,c as Y,m as _t,j as f,r as k,n as Et,K as Ee,t as yt,W as qe,z as dt,A as mt,X as Nt,Q as Xe,O as hn,o as We,S as ke,B as gn,M as pn}from"./scheduler.96ee3362.js";import{S as Gt,i as Jt,a as H,t as R,g as zt,c as Ft,h as en,j as ln,k as Ne,f as Ot,b as rt,d as it,m as at,e as ct}from"./index.7d87350f.js";import{g as _n}from"./globals.7f7f1b26.js";import{e as le}from"./each.8122eab6.js";import{a as ht}from"./Toaster.svelte_svelte_type_style_lang.e88c75e4.js";import{g as Ue}from"./navigation.ac6ee7c0.js";import{p as bn}from"./stores.19f7c999.js";import{p as vn,n as wn,e as Pe,c as nn,f as ce,i as Oe,m as sn,a as He,S as Ke,r as xe,W as on,h as we,u as rn,j as kn,o as yn,g as Te,O as Re,v as $e}from"./index.bd50bea7.js";import{f as an,r as je,i as tl,h as el,v as ll,p as nl,s as En,a as sl,j as Sn}from"./index.9217c1fa.js";import{r as In,s as Mn,t as Dn,c as ol,v as Cn}from"./index.01b4d1e3.js";import{u as Tn,n as rl,c as Vn,b as Ve,j as ze,i as Bn,x as Nn}from"./index.b3602e5d.js";import{A as On,u as Hn,a as An,b as Ln,r as Pn}from"./AddFilesPlaceholder.b819c4dd.js";import{t as il}from"./index.86717fb2.js";import{M as Un}from"./Messages.b5c8666b.js";import"./sha256.8dba905a.js";import{T as he}from"./Tooltip.534e2f98.js";import{h as cn,j as Rn,f as Ze}from"./updater.31a4828a.js";import{D as un,M as Ae}from"./Dropdown.d3bf0ddf.js";import{s as jn,g as zn,u as Fn,a as qn,M as fn}from"./menu-trigger.f5ee63a5.js";import{S as Wn}from"./Switch.e0bc0fb7.js";import"./i18next.16542173.js";import{T as Zn,S as Gn,U as Jn,q as Qn}from"./UserMenu.cf8efcbb.js";import{S as Yn}from"./Selector.7e37d522.js";import{d as Xn}from"./index.14530a0e.js";import{g as Se}from"./spread.8a54911c.js";import{f as Kn}from"./FileSaver.min.898eb36f.js";import{b as xn}from"./index.799bfa7e.js";import"./paths.06673b34.js";import{M as $n}from"./MenuLines.fb3813b6.js";import{f as al}from"./dayjs.min.f771e3da.js";import{p as cl}from"./index.5a400d83.js";const ts=n=>({subIds:n&1}),ul=n=>({subIds:n[0]});function es(n){let t;const e=n[6].default,l=ne(e,n,n[5],ul);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,[r]){l&&l.p&&(!t||r&33)&&se(l,e,s,s[5],t?re(e,s[5],r,ts):oe(s[5]),ul)},i(s){t||(H(l,s),t=!0)},o(s){R(l,s),t=!1},d(s){l&&l.d(s)}}}function ls(n,t,e){let l,{$$slots:s={},$$scope:r}=t,{disabled:o=void 0}=t,{open:i=void 0}=t,{onOpenChange:a=void 0}=t;const{updateOption:u,ids:c,states:{subOpen:d}}=jn({disabled:o,onOpenChange:({next:v})=>(i!==v&&(a==null||a(v),e(2,i=v)),v)}),y=Xn([c.menu,c.trigger],([v,_])=>({menu:v,trigger:_}));return ot(n,y,v=>e(0,l=v)),n.$$set=v=>{"disabled"in v&&e(3,o=v.disabled),"open"in v&&e(2,i=v.open),"onOpenChange"in v&&e(4,a=v.onOpenChange),"$$scope"in v&&e(5,r=v.$$scope)},n.$$.update=()=>{n.$$.dirty&4&&i!==void 0&&d.set(i),n.$$.dirty&8&&u("disabled",o)},[l,y,i,o,a,r,s]}class ns extends Gt{constructor(t){super(),Jt(this,t,ls,es,Zt,{disabled:3,open:2,onOpenChange:4})}}const ss=n=>({builder:n[0]&256}),fl=n=>({builder:n[8]}),os=n=>({builder:n[0]&256}),dl=n=>({builder:n[8]}),rs=n=>({builder:n[0]&256}),ml=n=>({builder:n[8]}),is=n=>({builder:n[0]&256}),hl=n=>({builder:n[8]}),as=n=>({builder:n[0]&256}),gl=n=>({builder:n[8]}),cs=n=>({builder:n[0]&256}),pl=n=>({builder:n[8]});function us(n){let t,e,l,s;const r=n[28].default,o=ne(r,n,n[27],fl);let i=[n[8],n[13]],a={};for(let u=0;u<i.length;u+=1)a=ie(a,i[u]);return{c(){t=I("div"),o&&o.c(),this.h()},l(u){t=M(u,"DIV",{});var c=S(t);o&&o.l(c),c.forEach(m),this.h()},h(){ee(t,a)},m(u,c){L(u,t,c),o&&o.m(t,null),n[33](t),e=!0,l||(s=[ye(n[8].action(t)),tt(t,"m-focusout",n[12]),tt(t,"m-keydown",n[12]),tt(t,"m-pointermove",n[12])],l=!0)},p(u,c){o&&o.p&&(!e||c[0]&134217984)&&se(o,r,u,u[27],e?re(r,u[27],c,ss):oe(u[27]),fl),ee(t,a=Se(i,[c[0]&256&&u[8],c[0]&8192&&u[13]]))},i(u){e||(H(o,u),e=!0)},o(u){R(o,u),e=!1},d(u){u&&m(t),o&&o.d(u),n[33](null),l=!1,ae(s)}}}function fs(n){let t,e,l,s,r;const o=n[28].default,i=ne(o,n,n[27],dl);let a=[n[8],n[13]],u={};for(let c=0;c<a.length;c+=1)u=ie(u,a[c]);return{c(){t=I("div"),i&&i.c(),this.h()},l(c){t=M(c,"DIV",{});var d=S(t);i&&i.l(d),d.forEach(m),this.h()},h(){ee(t,u)},m(c,d){L(c,t,d),i&&i.m(t,null),n[32](t),l=!0,s||(r=[ye(n[8].action(t)),tt(t,"m-focusout",n[12]),tt(t,"m-keydown",n[12]),tt(t,"m-pointermove",n[12])],s=!0)},p(c,d){n=c,i&&i.p&&(!l||d[0]&134217984)&&se(i,o,n,n[27],l?re(o,n[27],d,os):oe(n[27]),dl),ee(t,u=Se(a,[d[0]&256&&n[8],d[0]&8192&&n[13]]))},i(c){l||(H(i,c),e&&e.end(1),l=!0)},o(c){R(i,c),c&&(e=en(t,n[5],n[6])),l=!1},d(c){c&&m(t),i&&i.d(c),n[32](null),c&&e&&e.end(),s=!1,ae(r)}}}function ds(n){let t,e,l,s,r;const o=n[28].default,i=ne(o,n,n[27],ml);let a=[n[8],n[13]],u={};for(let c=0;c<a.length;c+=1)u=ie(u,a[c]);return{c(){t=I("div"),i&&i.c(),this.h()},l(c){t=M(c,"DIV",{});var d=S(t);i&&i.l(d),d.forEach(m),this.h()},h(){ee(t,u)},m(c,d){L(c,t,d),i&&i.m(t,null),n[31](t),l=!0,s||(r=[ye(n[8].action(t)),tt(t,"m-focusout",n[12]),tt(t,"m-keydown",n[12]),tt(t,"m-pointermove",n[12])],s=!0)},p(c,d){n=c,i&&i.p&&(!l||d[0]&134217984)&&se(i,o,n,n[27],l?re(o,n[27],d,rs):oe(n[27]),ml),ee(t,u=Se(a,[d[0]&256&&n[8],d[0]&8192&&n[13]]))},i(c){l||(H(i,c),c&&(e||Le(()=>{e=ln(t,n[3],n[4]),e.start()})),l=!0)},o(c){R(i,c),l=!1},d(c){c&&m(t),i&&i.d(c),n[31](null),s=!1,ae(r)}}}function ms(n){let t,e,l,s,r,o;const i=n[28].default,a=ne(i,n,n[27],hl);let u=[n[8],n[13]],c={};for(let d=0;d<u.length;d+=1)c=ie(c,u[d]);return{c(){t=I("div"),a&&a.c(),this.h()},l(d){t=M(d,"DIV",{});var y=S(t);a&&a.l(y),y.forEach(m),this.h()},h(){ee(t,c)},m(d,y){L(d,t,y),a&&a.m(t,null),n[30](t),s=!0,r||(o=[ye(n[8].action(t)),tt(t,"m-focusout",n[12]),tt(t,"m-keydown",n[12]),tt(t,"m-pointermove",n[12])],r=!0)},p(d,y){n=d,a&&a.p&&(!s||y[0]&134217984)&&se(a,i,n,n[27],s?re(i,n[27],y,is):oe(n[27]),hl),ee(t,c=Se(u,[y[0]&256&&n[8],y[0]&8192&&n[13]]))},i(d){s||(H(a,d),d&&Le(()=>{s&&(l&&l.end(1),e=ln(t,n[3],n[4]),e.start())}),s=!0)},o(d){R(a,d),e&&e.invalidate(),d&&(l=en(t,n[5],n[6])),s=!1},d(d){d&&m(t),a&&a.d(d),n[30](null),d&&l&&l.end(),r=!1,ae(o)}}}function hs(n){let t,e,l,s,r;const o=n[28].default,i=ne(o,n,n[27],gl);let a=[n[8],n[13]],u={};for(let c=0;c<a.length;c+=1)u=ie(u,a[c]);return{c(){t=I("div"),i&&i.c(),this.h()},l(c){t=M(c,"DIV",{});var d=S(t);i&&i.l(d),d.forEach(m),this.h()},h(){ee(t,u)},m(c,d){L(c,t,d),i&&i.m(t,null),n[29](t),l=!0,s||(r=[ye(n[8].action(t)),tt(t,"m-focusout",n[12]),tt(t,"m-keydown",n[12]),tt(t,"m-pointermove",n[12])],s=!0)},p(c,d){n=c,i&&i.p&&(!l||d[0]&134217984)&&se(i,o,n,n[27],l?re(o,n[27],d,as):oe(n[27]),gl),ee(t,u=Se(a,[d[0]&256&&n[8],d[0]&8192&&n[13]]))},i(c){l||(H(i,c),c&&Le(()=>{l&&(e||(e=Ne(t,n[1],n[2],!0)),e.run(1))}),l=!0)},o(c){R(i,c),c&&(e||(e=Ne(t,n[1],n[2],!1)),e.run(0)),l=!1},d(c){c&&m(t),i&&i.d(c),n[29](null),c&&e&&e.end(),s=!1,ae(r)}}}function gs(n){let t;const e=n[28].default,l=ne(e,n,n[27],pl);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,r){l&&l.p&&(!t||r[0]&134217984)&&se(l,e,s,s[27],t?re(e,s[27],r,cs):oe(s[27]),pl)},i(s){t||(H(l,s),t=!0)},o(s){R(l,s),t=!1},d(s){l&&l.d(s)}}}function ps(n){let t,e,l,s;const r=[gs,hs,ms,ds,fs,us],o=[];function i(a,u){return a[7]&&a[9]?0:a[1]&&a[9]?1:a[3]&&a[5]&&a[9]?2:a[3]&&a[9]?3:a[5]&&a[9]?4:a[9]?5:-1}return~(t=i(n))&&(e=o[t]=r[t](n)),{c(){e&&e.c(),l=Ht()},l(a){e&&e.l(a),l=Ht()},m(a,u){~t&&o[t].m(a,u),L(a,l,u),s=!0},p(a,u){let c=t;t=i(a),t===c?~t&&o[t].p(a,u):(e&&(zt(),R(o[c],1,1,()=>{o[c]=null}),Ft()),~t?(e=o[t],e?e.p(a,u):(e=o[t]=r[t](a),e.c()),H(e,1),e.m(l.parentNode,l)):e=null)},i(a){s||(H(e),s=!0)},o(a){R(e),s=!1},d(a){a&&m(l),~t&&o[t].d(a)}}}function _s(n,t,e){let l;const s=["transition","transitionConfig","inTransition","inTransitionConfig","outTransition","outTransitionConfig","asChild","id","side","align","sideOffset","alignOffset","collisionPadding","avoidCollisions","collisionBoundary","sameWidth","fitViewport","strategy","overlap","el"];let r=Be(t,s),o,i,{$$slots:a={},$$scope:u}=t,{transition:c=void 0}=t,{transitionConfig:d=void 0}=t,{inTransition:y=void 0}=t,{inTransitionConfig:v=void 0}=t,{outTransition:_=void 0}=t,{outTransitionConfig:b=void 0}=t,{asChild:h=!1}=t,{id:w=void 0}=t,{side:E="right"}=t,{align:D="start"}=t,{sideOffset:B=0}=t,{alignOffset:V=0}=t,{collisionPadding:C=8}=t,{avoidCollisions:N=!0}=t,{collisionBoundary:T=void 0}=t,{sameWidth:$=!1}=t,{fitViewport:P=!1}=t,{strategy:G="absolute"}=t,{overlap:U=!1}=t,{el:A=void 0}=t;const{elements:{subMenu:et},states:{subOpen:bt},ids:vt,getAttrs:Wt}=zn();ot(n,et,z=>e(26,o=z)),ot(n,bt,z=>e(9,i=z));const At=cn(),It=Wt("sub-content");function Lt(z){gt[z?"unshift":"push"](()=>{A=z,e(0,A)})}function Vt(z){gt[z?"unshift":"push"](()=>{A=z,e(0,A)})}function qt(z){gt[z?"unshift":"push"](()=>{A=z,e(0,A)})}function Yt(z){gt[z?"unshift":"push"](()=>{A=z,e(0,A)})}function Qt(z){gt[z?"unshift":"push"](()=>{A=z,e(0,A)})}return n.$$set=z=>{t=ie(ie({},t),tn(z)),e(13,r=Be(t,s)),"transition"in z&&e(1,c=z.transition),"transitionConfig"in z&&e(2,d=z.transitionConfig),"inTransition"in z&&e(3,y=z.inTransition),"inTransitionConfig"in z&&e(4,v=z.inTransitionConfig),"outTransition"in z&&e(5,_=z.outTransition),"outTransitionConfig"in z&&e(6,b=z.outTransitionConfig),"asChild"in z&&e(7,h=z.asChild),"id"in z&&e(14,w=z.id),"side"in z&&e(15,E=z.side),"align"in z&&e(16,D=z.align),"sideOffset"in z&&e(17,B=z.sideOffset),"alignOffset"in z&&e(18,V=z.alignOffset),"collisionPadding"in z&&e(19,C=z.collisionPadding),"avoidCollisions"in z&&e(20,N=z.avoidCollisions),"collisionBoundary"in z&&e(21,T=z.collisionBoundary),"sameWidth"in z&&e(22,$=z.sameWidth),"fitViewport"in z&&e(23,P=z.fitViewport),"strategy"in z&&e(24,G=z.strategy),"overlap"in z&&e(25,U=z.overlap),"el"in z&&e(0,A=z.el),"$$scope"in z&&e(27,u=z.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&16384&&w&&vt.menu.set(w),n.$$.dirty[0]&67108864&&e(8,l=o),n.$$.dirty[0]&256&&Object.assign(l,It),n.$$.dirty[0]&67076096&&Fn({side:E,align:D,sideOffset:B,alignOffset:V,collisionPadding:C,avoidCollisions:N,collisionBoundary:T,sameWidth:$,fitViewport:P,strategy:G,overlap:U})},[A,c,d,y,v,_,b,h,l,i,et,bt,At,r,w,E,D,B,V,C,N,T,$,P,G,U,o,u,a,Lt,Vt,qt,Yt,Qt]}class bs extends Gt{constructor(t){super(),Jt(this,t,_s,ps,Zt,{transition:1,transitionConfig:2,inTransition:3,inTransitionConfig:4,outTransition:5,outTransitionConfig:6,asChild:7,id:14,side:15,align:16,sideOffset:17,alignOffset:18,collisionPadding:19,avoidCollisions:20,collisionBoundary:21,sameWidth:22,fitViewport:23,strategy:24,overlap:25,el:0},null,[-1,-1])}}const vs=n=>({builder:n&4}),_l=n=>({builder:n[2]}),ws=n=>({builder:n&4}),bl=n=>({builder:n[2]});function ks(n){let t,e,l,s;const r=n[13].default,o=ne(r,n,n[12],_l);let i=[n[2],n[6]],a={};for(let u=0;u<i.length;u+=1)a=ie(a,i[u]);return{c(){t=I("div"),o&&o.c(),this.h()},l(u){t=M(u,"DIV",{});var c=S(t);o&&o.l(c),c.forEach(m),this.h()},h(){ee(t,a)},m(u,c){L(u,t,c),o&&o.m(t,null),n[14](t),e=!0,l||(s=[ye(n[2].action(t)),tt(t,"m-click",n[5]),tt(t,"m-focusin",n[5]),tt(t,"m-focusout",n[5]),tt(t,"m-keydown",n[5]),tt(t,"m-pointerleave",n[5]),tt(t,"m-pointermove",n[5])],l=!0)},p(u,c){o&&o.p&&(!e||c&4100)&&se(o,r,u,u[12],e?re(r,u[12],c,vs):oe(u[12]),_l),ee(t,a=Se(i,[c&4&&u[2],c&64&&u[6]]))},i(u){e||(H(o,u),e=!0)},o(u){R(o,u),e=!1},d(u){u&&m(t),o&&o.d(u),n[14](null),l=!1,ae(s)}}}function ys(n){let t;const e=n[13].default,l=ne(e,n,n[12],bl);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,r){l&&l.p&&(!t||r&4100)&&se(l,e,s,s[12],t?re(e,s[12],r,ws):oe(s[12]),bl)},i(s){t||(H(l,s),t=!0)},o(s){R(l,s),t=!1},d(s){l&&l.d(s)}}}function Es(n){let t,e,l,s;const r=[ys,ks],o=[];function i(a,u){return a[1]?0:1}return t=i(n),e=o[t]=r[t](n),{c(){e.c(),l=Ht()},l(a){e.l(a),l=Ht()},m(a,u){o[t].m(a,u),L(a,l,u),s=!0},p(a,[u]){let c=t;t=i(a),t===c?o[t].p(a,u):(zt(),R(o[c],1,1,()=>{o[c]=null}),Ft(),e=o[t],e?e.p(a,u):(e=o[t]=r[t](a),e.c()),H(e,1),e.m(l.parentNode,l))},i(a){s||(H(e),s=!0)},o(a){R(e),s=!1},d(a){a&&m(l),o[t].d(a)}}}function Ss(n,t,e){let l,s;const r=["disabled","asChild","id","el"];let o=Be(t,r),i,a,{$$slots:u={},$$scope:c}=t,{disabled:d=!1}=t,{asChild:y=!1}=t,{id:v=void 0}=t,{el:_=void 0}=t;const{elements:{subTrigger:b},ids:h,getAttrs:w,options:E}=qn();ot(n,b,C=>e(11,a=C));const{disabled:D}=E;ot(n,D,C=>e(10,i=C));const B=cn();function V(C){gt[C?"unshift":"push"](()=>{_=C,e(0,_)})}return n.$$set=C=>{t=ie(ie({},t),tn(C)),e(6,o=Be(t,r)),"disabled"in C&&e(7,d=C.disabled),"asChild"in C&&e(1,y=C.asChild),"id"in C&&e(8,v=C.id),"el"in C&&e(0,_=C.el),"$$scope"in C&&e(12,c=C.$$scope)},n.$$.update=()=>{n.$$.dirty&256&&v&&h.trigger.set(v),n.$$.dirty&2048&&e(2,l=a),n.$$.dirty&1152&&e(9,s={...w("sub-trigger"),...Rn(d||i)}),n.$$.dirty&516&&Object.assign(l,s)},[_,y,l,b,D,B,o,d,v,s,i,a,c,u,V]}class Is extends Gt{constructor(t){super(),Jt(this,t,Ss,Es,Zt,{disabled:7,asChild:1,id:8,el:0})}}function vl(n,t,e){const l=n.slice();return l[11]=t[e],l[13]=e,l}function wl(n){let t,e,l,s='<div class="text-lg font-semibold mt-2">/</div>',r,o,i,a,u,c,d='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg>',y,v,_=n[2].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"",b,h=le(n[1]),w=[];for(let E=0;E<h.length;E+=1)w[E]=kl(vl(n,h,E));return{c(){t=I("div"),e=I("div"),l=I("div"),l.innerHTML=s,r=Q(),o=I("div"),i=I("div");for(let E=0;E<w.length;E+=1)w[E].c();a=Q(),u=I("div"),c=I("div"),c.innerHTML=d,y=Q(),v=I("div"),b=pt(_),this.h()},l(E){t=M(E,"DIV",{class:!0});var D=S(t);e=M(D,"DIV",{class:!0});var B=S(e);l=M(B,"DIV",{class:!0,"data-svelte-h":!0}),Kt(l)!=="svelte-1ynv172"&&(l.innerHTML=s),r=Y(B),o=M(B,"DIV",{class:!0});var V=S(o);i=M(V,"DIV",{class:!0});var C=S(i);for(let $=0;$<w.length;$+=1)w[$].l(C);C.forEach(m),a=Y(V),u=M(V,"DIV",{class:!0});var N=S(u);c=M(N,"DIV",{"data-svelte-h":!0}),Kt(c)!=="svelte-cdi12d"&&(c.innerHTML=d),y=Y(N),v=M(N,"DIV",{class:!0});var T=S(v);b=_t(T,_),T.forEach(m),N.forEach(m),V.forEach(m),B.forEach(m),D.forEach(m),this.h()},h(){f(l,"class","bg-gray-100 dark:bg-gray-700 w-10 rounded-l-xl text-center"),f(i,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5"),f(v,"class","line-clamp-1"),f(u,"class","px-2 pb-1 text-xs text-gray-600 bg-white rounded-br-xl flex items-center space-x-1"),f(o,"class","max-h-60 flex flex-col w-full rounded-r-xl bg-white"),f(e,"class","flex w-full px-2"),f(t,"class","md:px-2 mb-3 text-left w-full absolute bottom-0 left-0 right-0")},m(E,D){L(E,t,D),k(t,e),k(e,l),k(e,r),k(e,o),k(o,i);for(let B=0;B<w.length;B+=1)w[B]&&w[B].m(i,null);k(o,a),k(o,u),k(u,c),k(u,y),k(u,v),k(v,b)},p(E,D){if(D&19){h=le(E[1]);let B;for(B=0;B<h.length;B+=1){const V=vl(E,h,B);w[B]?w[B].p(V,D):(w[B]=kl(V),w[B].c(),w[B].m(i,null))}for(;B<w.length;B+=1)w[B].d(1);w.length=h.length}D&4&&_!==(_=E[2].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"")&&Et(b,_)},d(E){E&&m(t),Ee(w,E)}}}function kl(n){let t,e,l=n[11].command+"",s,r,o,i=n[11].title+"",a,u,c,d,y;function v(){return n[9](n[11])}function _(){return n[10](n[13])}return{c(){t=I("button"),e=I("div"),s=pt(l),r=Q(),o=I("div"),a=pt(i),u=Q(),this.h()},l(b){t=M(b,"BUTTON",{class:!0,type:!0});var h=S(t);e=M(h,"DIV",{class:!0});var w=S(e);s=_t(w,l),w.forEach(m),r=Y(h),o=M(h,"DIV",{class:!0});var E=S(o);a=_t(E,i),E.forEach(m),u=Y(h),h.forEach(m),this.h()},h(){f(e,"class","font-medium text-black"),f(o,"class","text-xs text-gray-600"),f(t,"class",c="px-3 py-1.5 rounded-xl w-full text-left "+(n[13]===n[0]?" bg-gray-100 selected-command-option-button":"")),f(t,"type","button")},m(b,h){L(b,t,h),k(t,e),k(e,s),k(t,r),k(t,o),k(o,a),k(t,u),d||(y=[tt(t,"click",v),tt(t,"mousemove",_),tt(t,"focus",Ds)],d=!0)},p(b,h){n=b,h&2&&l!==(l=n[11].command+"")&&Et(s,l),h&2&&i!==(i=n[11].title+"")&&Et(a,i),h&1&&c!==(c="px-3 py-1.5 rounded-xl w-full text-left "+(n[13]===n[0]?" bg-gray-100 selected-command-option-button":""))&&f(t,"class",c)},d(b){b&&m(t),d=!1,ae(y)}}}function Ms(n){let t,e=n[1].length>0&&wl(n);return{c(){e&&e.c(),t=Ht()},l(l){e&&e.l(l),t=Ht()},m(l,s){e&&e.m(l,s),L(l,t,s)},p(l,[s]){l[1].length>0?e?e.p(l,s):(e=wl(l),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:Dt,o:Dt,d(l){l&&m(t),e&&e.d(l)}}}const Ds=()=>{};function Cs(n,t,e){let l,s;ot(n,vn,_=>e(8,s=_));const r=ue("i18n");ot(n,r,_=>e(2,l=_));let{prompt:o=""}=t,i=0,a=[];const u=()=>{e(0,i=Math.max(0,i-1))},c=()=>{e(0,i=Math.min(i+1,a.length-1))},d=async _=>{let b=_.content;if(_.content.includes("{{CLIPBOARD}}")){const E=await navigator.clipboard.readText().catch(D=>(ht.error(l.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));b=_.content.replaceAll("{{CLIPBOARD}}",E)}e(5,o=b);const h=document.getElementById("chat-textarea");await yt(),h.style.height="",h.style.height=Math.min(h.scrollHeight,200)+"px",h==null||h.focus(),await yt();const w=an(o);if(w.length>0){const E=w.at(0);h.setSelectionRange(E==null?void 0:E.startIndex,E.endIndex+1)}},y=_=>{d(_)},v=_=>{e(0,i=_)};return n.$$set=_=>{"prompt"in _&&e(5,o=_.prompt)},n.$$.update=()=>{n.$$.dirty&288&&e(1,a=s.filter(_=>_.command.includes(o)).sort((_,b)=>_.title.localeCompare(b.title))),n.$$.dirty&32&&o&&e(0,i=0)},[i,a,l,r,d,o,u,c,s,y,v]}class Ts extends Gt{constructor(t){super(),Jt(this,t,Cs,Ms,Zt,{prompt:5,selectUp:6,selectDown:7})}get selectUp(){return this.$$.ctx[6]}get selectDown(){return this.$$.ctx[7]}}function yl(n,t,e){const l=n.slice();return l[19]=t[e],l[21]=e,l}function El(n){let t,e,l,s='<div class="text-lg font-semibold mt-2">#</div>',r,o,i,a,u,c,d=le(n[3]),y=[];for(let h=0;h<d.length;h+=1)y[h]=Sl(yl(n,d,h));function v(h,w){var E,D;if(w&1&&(u=null),w&1&&(c=null),u==null&&(u=!!h[0].split(" ").some(As)),u)return Os;if(c==null&&(c=!!((D=(E=h[0].split(" "))==null?void 0:E.at(0))!=null&&D.substring(1).startsWith("http"))),c)return Ns}let _=v(n,-1),b=_&&_(n);return{c(){t=I("div"),e=I("div"),l=I("div"),l.innerHTML=s,r=Q(),o=I("div"),i=I("div");for(let h=0;h<y.length;h+=1)y[h].c();a=Q(),b&&b.c(),this.h()},l(h){t=M(h,"DIV",{class:!0});var w=S(t);e=M(w,"DIV",{class:!0});var E=S(e);l=M(E,"DIV",{class:!0,"data-svelte-h":!0}),Kt(l)!=="svelte-czbw16"&&(l.innerHTML=s),r=Y(E),o=M(E,"DIV",{class:!0});var D=S(o);i=M(D,"DIV",{class:!0});var B=S(i);for(let V=0;V<y.length;V+=1)y[V].l(B);a=Y(B),b&&b.l(B),B.forEach(m),D.forEach(m),E.forEach(m),w.forEach(m),this.h()},h(){f(l,"class","bg-gray-100 dark:bg-gray-700 w-10 rounded-l-xl text-center"),f(i,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5"),f(o,"class","max-h-60 flex flex-col w-full rounded-r-xl bg-white"),f(e,"class","flex w-full px-2"),f(t,"class","md:px-2 mb-3 text-left w-full absolute bottom-0 left-0 right-0")},m(h,w){L(h,t,w),k(t,e),k(e,l),k(e,r),k(e,o),k(o,i);for(let E=0;E<y.length;E+=1)y[E]&&y[E].m(i,null);k(i,a),b&&b.m(i,null)},p(h,w){if(w&46){d=le(h[3]);let E;for(E=0;E<d.length;E+=1){const D=yl(h,d,E);y[E]?y[E].p(D,w):(y[E]=Sl(D),y[E].c(),y[E].m(i,a))}for(;E<y.length;E+=1)y[E].d(1);y.length=d.length}_===(_=v(h,w))&&b?b.p(h,w):(b&&b.d(1),b=_&&_(h),b&&(b.c(),b.m(i,null)))},d(h){h&&m(t),Ee(y,h),b&&b.d()}}}function Vs(n){let t,e,l=n[19].name+"",s,r,o=n[19].filename+"",i,a,u,c,d=n[19].title+"",y;return{c(){t=I("div"),e=pt("#"),s=pt(l),r=pt(" ("),i=pt(o),a=pt(")"),u=Q(),c=I("div"),y=pt(d),this.h()},l(v){t=M(v,"DIV",{class:!0});var _=S(t);e=_t(_,"#"),s=_t(_,l),r=_t(_," ("),i=_t(_,o),a=_t(_,")"),_.forEach(m),u=Y(v),c=M(v,"DIV",{class:!0});var b=S(c);y=_t(b,d),b.forEach(m),this.h()},h(){f(t,"class","font-medium text-black line-clamp-1"),f(c,"class","text-xs text-gray-600 line-clamp-1")},m(v,_){L(v,t,_),k(t,e),k(t,s),k(t,r),k(t,i),k(t,a),L(v,u,_),L(v,c,_),k(c,y)},p(v,_){_&8&&l!==(l=v[19].name+"")&&Et(s,l),_&8&&o!==(o=v[19].filename+"")&&Et(i,o),_&8&&d!==(d=v[19].title+"")&&Et(y,d)},d(v){v&&(m(t),m(u),m(c))}}}function Bs(n){var a;let t,e=(((a=n[19])==null?void 0:a.title)??`#${n[19].name}`)+"",l,s,r,o=n[1].t("Collection")+"",i;return{c(){t=I("div"),l=pt(e),s=Q(),r=I("div"),i=pt(o),this.h()},l(u){t=M(u,"DIV",{class:!0});var c=S(t);l=_t(c,e),c.forEach(m),s=Y(u),r=M(u,"DIV",{class:!0});var d=S(r);i=_t(d,o),d.forEach(m),this.h()},h(){f(t,"class","font-medium text-black line-clamp-1"),f(r,"class","text-xs text-gray-600 line-clamp-1")},m(u,c){L(u,t,c),k(t,l),L(u,s,c),L(u,r,c),k(r,i)},p(u,c){var d;c&8&&e!==(e=(((d=u[19])==null?void 0:d.title)??`#${u[19].name}`)+"")&&Et(l,e),c&2&&o!==(o=u[1].t("Collection")+"")&&Et(i,o)},d(u){u&&(m(t),m(s),m(r))}}}function Sl(n){let t,e,l,s;function r(c,d){return c[19].type==="collection"?Bs:Vs}let o=r(n),i=o(n);function a(){return n[14](n[19])}function u(){return n[15](n[21])}return{c(){t=I("button"),i.c(),this.h()},l(c){t=M(c,"BUTTON",{class:!0,type:!0});var d=S(t);i.l(d),d.forEach(m),this.h()},h(){f(t,"class",e="px-3 py-1.5 rounded-xl w-full text-left "+(n[21]===n[2]?" bg-gray-100 selected-command-option-button":"")),f(t,"type","button")},m(c,d){L(c,t,d),i.m(t,null),l||(s=[tt(t,"click",a),tt(t,"mousemove",u),tt(t,"focus",Ls)],l=!0)},p(c,d){n=c,o===(o=r(n))&&i?i.p(n,d):(i.d(1),i=o(n),i&&(i.c(),i.m(t,null))),d&4&&e!==(e="px-3 py-1.5 rounded-xl w-full text-left "+(n[21]===n[2]?" bg-gray-100 selected-command-option-button":""))&&f(t,"class",e)},d(c){c&&m(t),i.d(),l=!1,ae(s)}}}function Ns(n){var d,y;let t,e,l=((y=(d=n[0].split(" "))==null?void 0:d.at(0))==null?void 0:y.substring(1))+"",s,r,o,i=n[1].t("Web")+"",a,u,c;return{c(){t=I("button"),e=I("div"),s=pt(l),r=Q(),o=I("div"),a=pt(i),this.h()},l(v){t=M(v,"BUTTON",{class:!0,type:!0});var _=S(t);e=M(_,"DIV",{class:!0});var b=S(e);s=_t(b,l),b.forEach(m),r=Y(_),o=M(_,"DIV",{class:!0});var h=S(o);a=_t(h,i),h.forEach(m),_.forEach(m),this.h()},h(){f(e,"class","font-medium text-black line-clamp-1"),f(o,"class","text-xs text-gray-600 line-clamp-1"),f(t,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-100 selected-command-option-button"),f(t,"type","button")},m(v,_){L(v,t,_),k(t,e),k(e,s),k(t,r),k(t,o),k(o,a),u||(c=tt(t,"click",n[17]),u=!0)},p(v,_){var b,h;_&1&&l!==(l=((h=(b=v[0].split(" "))==null?void 0:b.at(0))==null?void 0:h.substring(1))+"")&&Et(s,l),_&2&&i!==(i=v[1].t("Web")+"")&&Et(a,i)},d(v){v&&m(t),u=!1,c()}}}function Os(n){var d,y;let t,e,l=((y=(d=n[0].split(" "))==null?void 0:d.at(0))==null?void 0:y.substring(1))+"",s,r,o,i=n[1].t("Youtube")+"",a,u,c;return{c(){t=I("button"),e=I("div"),s=pt(l),r=Q(),o=I("div"),a=pt(i),this.h()},l(v){t=M(v,"BUTTON",{class:!0,type:!0});var _=S(t);e=M(_,"DIV",{class:!0});var b=S(e);s=_t(b,l),b.forEach(m),r=Y(_),o=M(_,"DIV",{class:!0});var h=S(o);a=_t(h,i),h.forEach(m),_.forEach(m),this.h()},h(){f(e,"class","font-medium text-black line-clamp-1"),f(o,"class","text-xs text-gray-600 line-clamp-1"),f(t,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-100 selected-command-option-button"),f(t,"type","button")},m(v,_){L(v,t,_),k(t,e),k(e,s),k(t,r),k(t,o),k(o,a),u||(c=tt(t,"click",n[16]),u=!0)},p(v,_){var b,h;_&1&&l!==(l=((h=(b=v[0].split(" "))==null?void 0:b.at(0))==null?void 0:h.substring(1))+"")&&Et(s,l),_&2&&i!==(i=v[1].t("Youtube")+"")&&Et(a,i)},d(v){v&&m(t),u=!1,c()}}}function Hs(n){var s,r;let t=n[3].length>0||((r=(s=n[0].split(" "))==null?void 0:s.at(0))==null?void 0:r.substring(1).startsWith("http")),e,l=t&&El(n);return{c(){l&&l.c(),e=Ht()},l(o){l&&l.l(o),e=Ht()},m(o,i){l&&l.m(o,i),L(o,e,i)},p(o,[i]){var a,u;i&9&&(t=o[3].length>0||((u=(a=o[0].split(" "))==null?void 0:a.at(0))==null?void 0:u.substring(1).startsWith("http"))),t?l?l.p(o,i):(l=El(o),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:Dt,o:Dt,d(o){o&&m(e),l&&l.d(o)}}}const As=n=>n.substring(1).startsWith("https://www.youtube.com")||n.substring(1).startsWith("https://youtu.be"),Ls=()=>{};function Ps(n,t,e){let l,s,r;ot(n,wn,C=>e(13,s=C));const o=ue("i18n");ot(n,o,C=>e(1,r=C));let{prompt:i=""}=t;const a=qe();let u=0,c=[],d=[],y=[];const v=()=>{e(2,u=Math.max(0,u-1))},_=()=>{e(2,u=Math.min(u+1,c.length-1))},b=async C=>{a("select",C),e(0,i=je(i));const N=document.getElementById("chat-textarea");await yt(),N==null||N.focus(),await yt()},h=async C=>{a("url",C),e(0,i=je(i));const N=document.getElementById("chat-textarea");await yt(),N==null||N.focus(),await yt()},w=async C=>{a("youtube",C),e(0,i=je(i));const N=document.getElementById("chat-textarea");await yt(),N==null||N.focus(),await yt()},E=C=>{console.log(C),b(C)},D=C=>{e(2,u=C)},B=()=>{var N,T;const C=(T=(N=i.split(" "))==null?void 0:N.at(0))==null?void 0:T.substring(1);tl(C)?w(C):ht.error(r.t("Oops! Looks like the URL is invalid. Please double-check and try again."))},V=()=>{var N,T;const C=(T=(N=i.split(" "))==null?void 0:N.at(0))==null?void 0:T.substring(1);tl(C)?h(C):ht.error(r.t("Oops! Looks like the URL is invalid. Please double-check and try again."))};return n.$$set=C=>{"prompt"in C&&e(0,i=C.prompt)},n.$$.update=()=>{n.$$.dirty&8194&&e(11,y=[...s.length>0?[{name:"All Documents",type:"collection",title:r.t("All Documents"),collection_names:s.map(C=>C.collection_name)}]:[],...s.reduce((C,N,T,$)=>{var P;return[...new Set([...C,...(((P=N==null?void 0:N.content)==null?void 0:P.tags)??[]).map(G=>G.name)])]},[]).map(C=>({name:C,type:"collection",collection_names:s.filter(N=>{var T;return(((T=N==null?void 0:N.content)==null?void 0:T.tags)??[]).map($=>$.name).includes(C)}).map(N=>N.collection_name)}))]),n.$$.dirty&2049&&e(12,l=y.filter(C=>{var N,T;return C.name.includes(((T=(N=i.split(" "))==null?void 0:N.at(0))==null?void 0:T.substring(1))??"")}).sort((C,N)=>C.name.localeCompare(N.name))),n.$$.dirty&8193&&e(10,d=s.filter(C=>{var N,T;return C.name.includes(((T=(N=i.split(" "))==null?void 0:N.at(0))==null?void 0:T.substring(1))??"")}).sort((C,N)=>C.title.localeCompare(N.title))),n.$$.dirty&5120&&e(3,c=[...l,...d]),n.$$.dirty&4097&&i&&(e(2,u=0),console.log(l))},[i,r,u,c,o,b,h,w,v,_,d,y,l,s,E,D,B,V]}class Us extends Gt{constructor(t){super(),Jt(this,t,Ps,Hs,Zt,{prompt:0,selectUp:8,selectDown:9})}get selectUp(){return this.$$.ctx[8]}get selectDown(){return this.$$.ctx[9]}}function Il(n,t,e){const l=n.slice();return l[16]=t[e],l[18]=e,l}function Ml(n){let t,e=n[2].length>0&&Dl(n);return{c(){e&&e.c(),t=Ht()},l(l){e&&e.l(l),t=Ht()},m(l,s){e&&e.m(l,s),L(l,t,s)},p(l,s){l[2].length>0?e?e.p(l,s):(e=Dl(l),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(l){l&&m(t),e&&e.d(l)}}}function Dl(n){let t,e,l,s='<div class="text-lg font-semibold mt-2">@</div>',r,o,i,a=le(n[2]),u=[];for(let c=0;c<a.length;c+=1)u[c]=Cl(Il(n,a,c));return{c(){t=I("div"),e=I("div"),l=I("div"),l.innerHTML=s,r=Q(),o=I("div"),i=I("div");for(let c=0;c<u.length;c+=1)u[c].c();this.h()},l(c){t=M(c,"DIV",{class:!0});var d=S(t);e=M(d,"DIV",{class:!0});var y=S(e);l=M(y,"DIV",{class:!0,"data-svelte-h":!0}),Kt(l)!=="svelte-1ourwwn"&&(l.innerHTML=s),r=Y(y),o=M(y,"DIV",{class:!0});var v=S(o);i=M(v,"DIV",{class:!0});var _=S(i);for(let b=0;b<u.length;b+=1)u[b].l(_);_.forEach(m),v.forEach(m),y.forEach(m),d.forEach(m),this.h()},h(){f(l,"class","bg-gray-100 dark:bg-gray-700 w-10 rounded-l-xl text-center"),f(i,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5"),f(o,"class","max-h-60 flex flex-col w-full rounded-r-xl bg-white"),f(e,"class","flex w-full px-2"),f(t,"class","md:px-2 mb-3 text-left w-full absolute bottom-0 left-0 right-0")},m(c,d){L(c,t,d),k(t,e),k(e,l),k(e,r),k(e,o),k(o,i);for(let y=0;y<u.length;y+=1)u[y]&&u[y].m(i,null)},p(c,d){if(d&22){a=le(c[2]);let y;for(y=0;y<a.length;y+=1){const v=Il(c,a,y);u[y]?u[y].p(v,d):(u[y]=Cl(v),u[y].c(),u[y].m(i,null))}for(;y<u.length;y+=1)u[y].d(1);u.length=a.length}},d(c){c&&m(t),Ee(u,c)}}}function Cl(n){let t,e,l=n[16].name+"",s,r,o,i,a;function u(){return n[11](n[16])}function c(){return n[12](n[18])}return{c(){t=I("button"),e=I("div"),s=pt(l),r=Q(),this.h()},l(d){t=M(d,"BUTTON",{class:!0,type:!0});var y=S(t);e=M(y,"DIV",{class:!0});var v=S(e);s=_t(v,l),v.forEach(m),r=Y(y),y.forEach(m),this.h()},h(){f(e,"class","font-medium text-black line-clamp-1"),f(t,"class",o="px-3 py-1.5 rounded-xl w-full text-left "+(n[18]===n[1]?" bg-gray-100 selected-command-option-button":"")),f(t,"type","button")},m(d,y){L(d,t,y),k(t,e),k(e,s),k(t,r),i||(a=[tt(t,"click",u),tt(t,"mousemove",c),tt(t,"focus",js)],i=!0)},p(d,y){n=d,y&4&&l!==(l=n[16].name+"")&&Et(s,l),y&2&&o!==(o="px-3 py-1.5 rounded-xl w-full text-left "+(n[18]===n[1]?" bg-gray-100 selected-command-option-button":""))&&f(t,"class",o)},d(d){d&&m(t),i=!1,ae(a)}}}function Rs(n){let t=n[0].charAt(0)==="@",e,l=t&&Ml(n);return{c(){l&&l.c(),e=Ht()},l(s){l&&l.l(s),e=Ht()},m(s,r){l&&l.m(s,r),L(s,e,r)},p(s,[r]){r&1&&(t=s[0].charAt(0)==="@"),t?l?l.p(s,r):(l=Ml(s),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:Dt,o:Dt,d(s){s&&m(e),l&&l.d(s)}}}const js=()=>{};function zs(n,t,e){let l;ot(n,Pe,w=>e(10,l=w));const s=ue("i18n");ot(n,s,w=>e(13,w));const r=qe();let{prompt:o=""}=t,{user:i=null}=t,{chatInputPlaceholder:a=""}=t,{messages:u=[]}=t,c=0,d=[];const y=()=>{e(1,c=Math.max(0,c-1))},v=()=>{e(1,c=Math.min(c+1,d.length-1))},_=async w=>{e(0,o=""),r("select",w)},b=w=>{_(w)},h=w=>{e(1,c=w)};return n.$$set=w=>{"prompt"in w&&e(0,o=w.prompt),"user"in w&&e(5,i=w.user),"chatInputPlaceholder"in w&&e(6,a=w.chatInputPlaceholder),"messages"in w&&e(7,u=w.messages)},n.$$.update=()=>{n.$$.dirty&1025&&e(2,d=l.filter(w=>{var E,D;return w.name.includes(((D=(E=o.split(" "))==null?void 0:E.at(0))==null?void 0:D.substring(1))??"")}).sort((w,E)=>w.name.localeCompare(E.name))),n.$$.dirty&1&&o&&e(1,c=0)},[o,c,d,s,_,i,a,u,y,v,l,b,h]}class Fs extends Gt{constructor(t){super(),Jt(this,t,zs,Rs,Zt,{prompt:0,user:5,chatInputPlaceholder:6,messages:7,selectUp:8,selectDown:9})}get selectUp(){return this.$$.ctx[8]}get selectDown(){return this.$$.ctx[9]}}function qs(n){let t,e;return{c(){t=dt("svg"),e=dt("path"),this.h()},l(l){t=mt(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=S(t);e=mt(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(e).forEach(m),s.forEach(m),this.h()},h(){f(e,"stroke-linecap","round"),f(e,"stroke-linejoin","round"),f(e,"d","M6 18 18 6M6 6l12 12"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"fill","none"),f(t,"viewBox","0 0 24 24"),f(t,"stroke-width",n[1]),f(t,"stroke","currentColor"),f(t,"class",n[0])},m(l,s){L(l,t,s),k(t,e)},p(l,[s]){s&2&&f(t,"stroke-width",l[1]),s&1&&f(t,"class",l[0])},i:Dt,o:Dt,d(l){l&&m(t)}}}function Ws(n,t,e){let{className:l="size-3.5"}=t,{strokeWidth:s="2"}=t;return n.$$set=r=>{"className"in r&&e(0,l=r.className),"strokeWidth"in r&&e(1,s=r.strokeWidth)},[l,s]}class Zs extends Gt{constructor(t){super(),Jt(this,t,Ws,qs,Zt,{className:0,strokeWidth:1})}}function Gs(n){let t,e,l;return{c(){t=dt("svg"),e=dt("path"),l=dt("path"),this.h()},l(s){t=mt(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var r=S(t);e=mt(r,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(e).forEach(m),l=mt(r,"path",{d:!0}),S(l).forEach(m),r.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M5.625 1.5H9a3.75 3.75 0 0 1 3.75 3.75v1.875c0 1.036.84 1.875 1.875 1.875H16.5a3.75 3.75 0 0 1 3.75 3.75v7.875c0 1.035-.84 1.875-1.875 1.875H5.625a1.875 1.875 0 0 1-1.875-1.875V3.375c0-1.036.84-1.875 1.875-1.875Zm6.905 9.97a.75.75 0 0 0-1.06 0l-3 3a.75.75 0 1 0 1.06 1.06l1.72-1.72V18a.75.75 0 0 0 1.5 0v-4.19l1.72 1.72a.75.75 0 1 0 1.06-1.06l-3-3Z"),f(e,"clip-rule","evenodd"),f(l,"d","M14.25 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 16.5 7.5h-1.875a.375.375 0 0 1-.375-.375V5.25Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class",n[0])},m(s,r){L(s,t,r),k(t,e),k(t,l)},p(s,[r]){r&1&&f(t,"class",s[0])},i:Dt,o:Dt,d(s){s&&m(t)}}}function Js(n,t,e){let{className:l="size-4"}=t;return n.$$set=s=>{"className"in s&&e(0,l=s.className)},[l]}class Qs extends Gt{constructor(t){super(),Jt(this,t,Js,Gs,Zt,{className:0})}}function Ys(n){let t,e;return{c(){t=dt("svg"),e=dt("path"),this.h()},l(l){t=mt(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var s=S(t);e=mt(s,"path",{d:!0}),S(e).forEach(m),s.forEach(m),this.h()},h(){f(e,"d","M21.721 12.752a9.711 9.711 0 0 0-.945-5.003 12.754 12.754 0 0 1-4.339 2.708 18.991 18.991 0 0 1-.214 4.772 17.165 17.165 0 0 0 5.498-2.477ZM14.634 15.55a17.324 17.324 0 0 0 .332-4.647c-.952.227-1.945.347-2.966.347-1.021 0-2.014-.12-2.966-.347a17.515 17.515 0 0 0 .332 4.647 17.385 17.385 0 0 0 5.268 0ZM9.772 17.119a18.963 18.963 0 0 0 4.456 0A17.182 17.182 0 0 1 12 21.724a17.18 17.18 0 0 1-2.228-4.605ZM7.777 15.23a18.87 18.87 0 0 1-.214-4.774 12.753 12.753 0 0 1-4.34-2.708 9.711 9.711 0 0 0-.944 5.004 17.165 17.165 0 0 0 5.498 2.477ZM21.356 14.752a9.765 9.765 0 0 1-7.478 6.817 18.64 18.64 0 0 0 1.988-4.718 18.627 18.627 0 0 0 5.49-2.098ZM2.644 14.752c1.682.971 3.53 1.688 5.49 2.099a18.64 18.64 0 0 0 1.988 4.718 9.765 9.765 0 0 1-7.478-6.816ZM13.878 2.43a9.755 9.755 0 0 1 6.116 3.986 11.267 11.267 0 0 1-3.746 2.504 18.63 18.63 0 0 0-2.37-6.49ZM12 2.276a17.152 17.152 0 0 1 2.805 7.121c-.897.23-1.837.353-2.805.353-.968 0-1.908-.122-2.805-.353A17.151 17.151 0 0 1 12 2.276ZM10.122 2.43a18.629 18.629 0 0 0-2.37 6.49 11.266 11.266 0 0 1-3.746-2.504 9.754 9.754 0 0 1 6.116-3.985Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class",n[0])},m(l,s){L(l,t,s),k(t,e)},p(l,[s]){s&1&&f(t,"class",l[0])},i:Dt,o:Dt,d(l){l&&m(t)}}}function Xs(n,t,e){let{className:l="size-4"}=t;return n.$$set=s=>{"className"in s&&e(0,l=s.className)},[l]}class Ks extends Gt{constructor(t){super(),Jt(this,t,Xs,Ys,Zt,{className:0})}}function xs(n){let t;const e=n[7].default,l=ne(e,n,n[12],null);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,r){l&&l.p&&(!t||r&4096)&&se(l,e,s,s[12],t?re(e,s[12],r,null):oe(s[12]),null)},i(s){t||(H(l,s),t=!0)},o(s){R(l,s),t=!1},d(s){l&&l.d(s)}}}function $s(n){let t,e;return t=new he({props:{content:n[5].t("More"),$$slots:{default:[xs]},$$scope:{ctx:n}}}),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,s){const r={};s&32&&(r.content=l[5].t("More")),s&4096&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(H(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function Tl(n){let t,e,l,s,r,o=n[5].t("Web Search")+"",i,a,u,c,d,y,v;l=new Ks({});function _(h){n[8](h)}let b={};return n[0]!==void 0&&(b.state=n[0]),u=new Wn({props:b}),gt.push(()=>Ot(u,"state",_)),{c(){t=I("div"),e=I("div"),rt(l.$$.fragment),s=Q(),r=I("div"),i=pt(o),a=Q(),rt(u.$$.fragment),d=Q(),y=I("hr"),this.h()},l(h){t=M(h,"DIV",{class:!0});var w=S(t);e=M(w,"DIV",{class:!0});var E=S(e);it(l.$$.fragment,E),s=Y(E),r=M(E,"DIV",{class:!0});var D=S(r);i=_t(D,o),D.forEach(m),E.forEach(m),a=Y(w),it(u.$$.fragment,w),w.forEach(m),d=Y(h),y=M(h,"HR",{class:!0}),this.h()},h(){f(r,"class","flex items-center"),f(e,"class","flex-1 flex items-center gap-2"),f(t,"class","flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl"),f(y,"class","border-gray-100 dark:border-gray-800 my-1")},m(h,w){L(h,t,w),k(t,e),at(l,e,null),k(e,s),k(e,r),k(r,i),k(t,a),at(u,t,null),L(h,d,w),L(h,y,w),v=!0},p(h,w){(!v||w&32)&&o!==(o=h[5].t("Web Search")+"")&&Et(i,o);const E={};!c&&w&1&&(c=!0,E.state=h[0],Nt(()=>c=!1)),u.$set(E)},i(h){v||(H(l.$$.fragment,h),H(u.$$.fragment,h),v=!0)},o(h){R(l.$$.fragment,h),R(u.$$.fragment,h),v=!1},d(h){h&&(m(t),m(d),m(y)),ct(l),ct(u)}}}function to(n){let t,e,l,s=n[5].t("Upload Files")+"",r,o;return t=new Qs({}),{c(){rt(t.$$.fragment),e=Q(),l=I("div"),r=pt(s),this.h()},l(i){it(t.$$.fragment,i),e=Y(i),l=M(i,"DIV",{class:!0});var a=S(l);r=_t(a,s),a.forEach(m),this.h()},h(){f(l,"class","flex items-center")},m(i,a){at(t,i,a),L(i,e,a),L(i,l,a),k(l,r),o=!0},p(i,a){(!o||a&32)&&s!==(s=i[5].t("Upload Files")+"")&&Et(r,s)},i(i){o||(H(t.$$.fragment,i),o=!0)},o(i){R(t.$$.fragment,i),o=!1},d(i){i&&(m(e),m(l)),ct(t,i)}}}function eo(n){var r,o;let t,e,l,s=((o=(r=n[4])==null?void 0:r.features)==null?void 0:o.enable_web_search)&&Tl(n);return e=new Ae({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl",$$slots:{default:[to]},$$scope:{ctx:n}}}),e.$on("click",n[9]),{c(){s&&s.c(),t=Q(),rt(e.$$.fragment)},l(i){s&&s.l(i),t=Y(i),it(e.$$.fragment,i)},m(i,a){s&&s.m(i,a),L(i,t,a),at(e,i,a),l=!0},p(i,a){var c,d;(d=(c=i[4])==null?void 0:c.features)!=null&&d.enable_web_search?s?(s.p(i,a),a&16&&H(s,1)):(s=Tl(i),s.c(),H(s,1),s.m(t.parentNode,t)):s&&(zt(),R(s,1,1,()=>{s=null}),Ft());const u={};a&4128&&(u.$$scope={dirty:a,ctx:i}),e.$set(u)},i(i){l||(H(s),H(e.$$.fragment,i),l=!0)},o(i){R(s),R(e.$$.fragment,i),l=!1},d(i){i&&m(t),s&&s.d(i),ct(e,i)}}}function lo(n){let t,e,l;return e=new fn({props:{class:"w-full max-w-[190px] rounded-xl px-1 py-1  border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow",sideOffset:15,alignOffset:-8,side:"top",align:"start",transition:Ze,$$slots:{default:[eo]},$$scope:{ctx:n}}}),{c(){t=I("div"),rt(e.$$.fragment),this.h()},l(s){t=M(s,"DIV",{slot:!0});var r=S(t);it(e.$$.fragment,r),r.forEach(m),this.h()},h(){f(t,"slot","content")},m(s,r){L(s,t,r),at(e,t,null),l=!0},p(s,r){const o={};r&4147&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){l||(H(e.$$.fragment,s),l=!0)},o(s){R(e.$$.fragment,s),l=!1},d(s){s&&m(t),ct(e)}}}function no(n){let t,e,l;function s(o){n[10](o)}let r={$$slots:{content:[lo],default:[$s]},$$scope:{ctx:n}};return n[3]!==void 0&&(r.show=n[3]),t=new un({props:r}),gt.push(()=>Ot(t,"show",s)),t.$on("change",n[11]),{c(){rt(t.$$.fragment)},l(o){it(t.$$.fragment,o)},m(o,i){at(t,o,i),l=!0},p(o,[i]){const a={};i&4147&&(a.$$scope={dirty:i,ctx:o}),!e&&i&8&&(e=!0,a.show=o[3],Nt(()=>e=!1)),t.$set(a)},i(o){l||(H(t.$$.fragment,o),l=!0)},o(o){R(t.$$.fragment,o),l=!1},d(o){ct(t,o)}}}function so(n,t,e){let l,s;ot(n,nn,h=>e(4,l=h));let{$$slots:r={},$$scope:o}=t;const i=ue("i18n");ot(n,i,h=>e(5,s=h));let{uploadFilesHandler:a}=t,{webSearchEnabled:u}=t,{onClose:c}=t,d=!1;function y(h){u=h,e(0,u)}const v=()=>{a()};function _(h){d=h,e(3,d)}const b=h=>{h.detail===!1&&c()};return n.$$set=h=>{"uploadFilesHandler"in h&&e(1,a=h.uploadFilesHandler),"webSearchEnabled"in h&&e(0,u=h.webSearchEnabled),"onClose"in h&&e(2,c=h.onClose),"$$scope"in h&&e(12,o=h.$$scope)},[u,a,c,d,l,s,i,r,y,v,_,b,o]}class oo extends Gt{constructor(t){super(),Jt(this,t,so,no,Zt,{uploadFilesHandler:1,webSearchEnabled:0,onClose:2})}}function Vl(n,t,e){const l=n.slice();return l[70]=t[e],l[72]=e,l}function Bl(n){let t,e,l,s,r,o,i;return r=new On({}),{c(){t=I("div"),e=I("div"),l=I("div"),s=I("div"),rt(r.$$.fragment),this.h()},l(a){t=M(a,"DIV",{class:!0,id:!0,role:!0,"aria-label":!0});var u=S(t);e=M(u,"DIV",{class:!0});var c=S(e);l=M(c,"DIV",{class:!0});var d=S(l);s=M(d,"DIV",{class:!0});var y=S(s);it(r.$$.fragment,y),y.forEach(m),d.forEach(m),c.forEach(m),u.forEach(m),this.h()},h(){f(s,"class","max-w-md"),f(l,"class","m-auto pt-64 flex flex-col justify-center"),f(e,"class","absolute w-full h-full backdrop-blur bg-gray-800/40 flex justify-center"),f(t,"class",o="fixed "+(n[24]?"left-0 md:left-[260px] md:w-[calc(100%-260px)]":"left-0")+" w-full h-full flex z-50 touch-none pointer-events-none"),f(t,"id","dropzone"),f(t,"role","region"),f(t,"aria-label","Drag and Drop Container")},m(a,u){L(a,t,u),k(t,e),k(e,l),k(l,s),at(r,s,null),i=!0},p(a,u){(!i||u[0]&16777216&&o!==(o="fixed "+(a[24]?"left-0 md:left-[260px] md:w-[calc(100%-260px)]":"left-0")+" w-full h-full flex z-50 touch-none pointer-events-none"))&&f(t,"class",o)},i(a){i||(H(r.$$.fragment,a),i=!0)},o(a){R(r.$$.fragment,a),i=!1},d(a){a&&m(t),ct(r)}}}function Nl(n){let t,e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z" clip-rule="evenodd"></path></svg>',s,r;return{c(){t=I("div"),e=I("button"),e.innerHTML=l,this.h()},l(o){t=M(o,"DIV",{class:!0});var i=S(t);e=M(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Kt(e)!=="svelte-a2mahu"&&(e.innerHTML=l),i.forEach(m),this.h()},h(){f(e,"class","bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full"),f(t,"class","absolute -top-12 left-0 right-0 flex justify-center z-30")},m(o,i){L(o,t,i),k(t,e),s||(r=tt(e,"click",n[32]),s=!0)},p:Dt,d(o){o&&m(t),s=!1,r()}}}function ro(n){let t,e,l;function s(o){n[36](o)}let r={};return n[1]!==void 0&&(r.prompt=n[1]),t=new Us({props:r}),n[35](t),gt.push(()=>Ot(t,"prompt",s)),t.$on("youtube",n[37]),t.$on("url",n[38]),t.$on("select",n[39]),{c(){rt(t.$$.fragment)},l(o){it(t.$$.fragment,o)},m(o,i){at(t,o,i),l=!0},p(o,i){const a={};!e&&i[0]&2&&(e=!0,a.prompt=o[1],Nt(()=>e=!1)),t.$set(a)},i(o){l||(H(t.$$.fragment,o),l=!0)},o(o){R(t.$$.fragment,o),l=!1},d(o){n[35](null),ct(t,o)}}}function io(n){let t,e,l;function s(o){n[34](o)}let r={};return n[1]!==void 0&&(r.prompt=n[1]),t=new Ts({props:r}),n[33](t),gt.push(()=>Ot(t,"prompt",s)),{c(){rt(t.$$.fragment)},l(o){it(t.$$.fragment,o)},m(o,i){at(t,o,i),l=!0},p(o,i){const a={};!e&&i[0]&2&&(e=!0,a.prompt=o[1],Nt(()=>e=!1)),t.$set(a)},i(o){l||(H(t.$$.fragment,o),l=!0)},o(o){R(t.$$.fragment,o),l=!1},d(o){n[33](null),ct(t,o)}}}function Ol(n){let t,e,l,s,r,o,i,a,u=n[0].name+"",c,d,y,v,_,b,h,w;return _=new Zs({}),{c(){t=I("div"),e=I("div"),l=I("img"),r=Q(),o=I("div"),i=pt("Talking to "),a=I("span"),c=pt(u),d=Q(),y=I("div"),v=I("button"),rt(_.$$.fragment),this.h()},l(E){t=M(E,"DIV",{class:!0});var D=S(t);e=M(D,"DIV",{class:!0});var B=S(e);l=M(B,"IMG",{crossorigin:!0,alt:!0,class:!0,src:!0}),r=Y(B),o=M(B,"DIV",{});var V=S(o);i=_t(V,"Talking to "),a=M(V,"SPAN",{class:!0});var C=S(a);c=_t(C,u),C.forEach(m),V.forEach(m),B.forEach(m),d=Y(D),y=M(D,"DIV",{});var N=S(y);v=M(N,"BUTTON",{class:!0});var T=S(v);it(_.$$.fragment,T),T.forEach(m),N.forEach(m),D.forEach(m),this.h()},h(){var E,D,B;f(l,"crossorigin","anonymous"),f(l,"alt","model profile"),f(l,"class","size-5 max-w-[28px] object-cover rounded-full"),ke(l.src,s=((B=(D=(E=n[11].find(n[45]))==null?void 0:E.info)==null?void 0:D.meta)==null?void 0:B.profile_image_url)??(n[22].language==="dg-DG"?"/doge.png":`${He}/static/favicon.png`))||f(l,"src",s),f(a,"class","font-medium"),f(e,"class","flex items-center gap-2 text-sm dark:text-gray-500"),f(v,"class","flex items-center"),f(t,"class","px-3 py-2.5 text-left w-full flex justify-between items-center absolute bottom-0 left-0 right-0 bg-gradient-to-t from-50% from-white dark:from-gray-900")},m(E,D){L(E,t,D),k(t,e),k(e,l),k(e,r),k(e,o),k(o,i),k(o,a),k(a,c),k(t,d),k(t,y),k(y,v),at(_,v,null),b=!0,h||(w=tt(v,"click",n[46]),h=!0)},p(E,D){var B,V,C;(!b||D[0]&4196353&&!ke(l.src,s=((C=(V=(B=E[11].find(E[45]))==null?void 0:B.info)==null?void 0:V.meta)==null?void 0:C.profile_image_url)??(E[22].language==="dg-DG"?"/doge.png":`${He}/static/favicon.png`)))&&f(l,"src",s),(!b||D[0]&1)&&u!==(u=E[0].name+"")&&Et(c,u)},i(E){b||(H(_.$$.fragment,E),b=!0)},o(E){R(_.$$.fragment,E),b=!1},d(E){E&&m(t),ct(_),h=!1,w()}}}function Hl(n){let t,e,l=le(n[3]),s=[];for(let o=0;o<l.length;o+=1)s[o]=Ll(Vl(n,l,o));const r=o=>R(s[o],1,1,()=>{s[o]=null});return{c(){t=I("div");for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){t=M(o,"DIV",{class:!0});var i=S(t);for(let a=0;a<s.length;a+=1)s[a].l(i);i.forEach(m),this.h()},h(){f(t,"class","mx-2 mt-2 mb-1 flex flex-wrap gap-2")},m(o,i){L(o,t,i);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(t,null);e=!0},p(o,i){if(i[0]&5243017){l=le(o[3]);let a;for(a=0;a<l.length;a+=1){const u=Vl(o,l,a);s[a]?(s[a].p(u,i),H(s[a],1)):(s[a]=Ll(u),s[a].c(),H(s[a],1),s[a].m(t,null))}for(zt(),a=l.length;a<s.length;a+=1)r(a);Ft()}},i(o){if(!e){for(let i=0;i<l.length;i+=1)H(s[i]);e=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)R(s[i]);e=!1},d(o){o&&m(t),Ee(s,o)}}}function ao(n){var v;let t,e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6"><path d="M7.5 3.375c0-1.036.84-1.875 1.875-1.875h.375a3.75 3.75 0 0 1 3.75 3.75v1.875C13.5 8.161 14.34 9 15.375 9h1.875A3.75 3.75 0 0 1 21 12.75v3.375C21 17.16 20.16 18 19.125 18h-9.75A1.875 1.875 0 0 1 7.5 16.125V3.375Z"></path><path d="M15 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 17.25 7.5h-1.875A.375.375 0 0 1 15 7.125V5.25ZM4.875 6H6v10.125A3.375 3.375 0 0 0 9.375 19.5H16.5v1.125c0 1.035-.84 1.875-1.875 1.875h-9.75A1.875 1.875 0 0 1 3 20.625V7.875C3 6.839 3.84 6 4.875 6Z"></path></svg>',s,r,o,i=(((v=n[70])==null?void 0:v.title)??`#${n[70].name}`)+"",a,u,c,d=n[22].t("Collection")+"",y;return{c(){t=I("div"),e=I("div"),e.innerHTML=l,s=Q(),r=I("div"),o=I("div"),a=pt(i),u=Q(),c=I("div"),y=pt(d),this.h()},l(_){t=M(_,"DIV",{class:!0});var b=S(t);e=M(b,"DIV",{class:!0,"data-svelte-h":!0}),Kt(e)!=="svelte-1h7831u"&&(e.innerHTML=l),s=Y(b),r=M(b,"DIV",{class:!0});var h=S(r);o=M(h,"DIV",{class:!0});var w=S(o);a=_t(w,i),w.forEach(m),u=Y(h),c=M(h,"DIV",{class:!0});var E=S(c);y=_t(E,d),E.forEach(m),h.forEach(m),b.forEach(m),this.h()},h(){f(e,"class","p-2.5 bg-red-400 text-white rounded-lg"),f(o,"class","dark:text-gray-100 text-sm font-medium line-clamp-1"),f(c,"class","text-gray-500 text-sm"),f(r,"class","flex flex-col justify-center -space-y-0.5"),f(t,"class","h-16 w-[15rem] flex items-center space-x-3 px-2.5 dark:bg-gray-600 rounded-xl border border-gray-200 dark:border-none")},m(_,b){L(_,t,b),k(t,e),k(t,s),k(t,r),k(r,o),k(o,a),k(r,u),k(r,c),k(c,y)},p(_,b){var h;b[0]&8&&i!==(i=(((h=_[70])==null?void 0:h.title)??`#${_[70].name}`)+"")&&Et(a,i),b[0]&4194304&&d!==(d=_[22].t("Collection")+"")&&Et(y,d)},i:Dt,o:Dt,d(_){_&&m(t)}}}function co(n){let t,e,l,s,r,o=n[70].name+"",i,a,u,c=n[22].t("Document")+"",d;function y(b,h){return b[70].upload_status?mo:fo}let v=y(n),_=v(n);return{c(){t=I("div"),e=I("div"),_.c(),l=Q(),s=I("div"),r=I("div"),i=pt(o),a=Q(),u=I("div"),d=pt(c),this.h()},l(b){t=M(b,"DIV",{class:!0});var h=S(t);e=M(h,"DIV",{class:!0});var w=S(e);_.l(w),w.forEach(m),l=Y(h),s=M(h,"DIV",{class:!0});var E=S(s);r=M(E,"DIV",{class:!0});var D=S(r);i=_t(D,o),D.forEach(m),a=Y(E),u=M(E,"DIV",{class:!0});var B=S(u);d=_t(B,c),B.forEach(m),E.forEach(m),h.forEach(m),this.h()},h(){f(e,"class","p-2.5 bg-red-400 text-white rounded-lg"),f(r,"class","dark:text-gray-100 text-sm font-medium line-clamp-1"),f(u,"class","text-gray-500 text-sm"),f(s,"class","flex flex-col justify-center -space-y-0.5"),f(t,"class","h-16 w-[15rem] flex items-center space-x-3 px-2.5 dark:bg-gray-600 rounded-xl border border-gray-200 dark:border-none")},m(b,h){L(b,t,h),k(t,e),_.m(e,null),k(t,l),k(t,s),k(s,r),k(r,i),k(s,a),k(s,u),k(u,d)},p(b,h){v!==(v=y(b))&&(_.d(1),_=v(b),_&&(_.c(),_.m(e,null))),h[0]&8&&o!==(o=b[70].name+"")&&Et(i,o),h[0]&4194304&&c!==(c=b[22].t("Document")+"")&&Et(d,c)},i:Dt,o:Dt,d(b){b&&m(t),_.d()}}}function uo(n){let t,e,l,s,r,o=(n[0]?n[20].length===0:n[7].length!==n[20].length)&&Al(n);return{c(){t=I("div"),e=I("img"),s=Q(),o&&o.c(),this.h()},l(i){t=M(i,"DIV",{class:!0});var a=S(t);e=M(a,"IMG",{src:!0,alt:!0,class:!0}),s=Y(a),o&&o.l(a),a.forEach(m),this.h()},h(){ke(e.src,l=n[70].url)||f(e,"src",l),f(e,"alt","input"),f(e,"class","h-16 w-16 rounded-xl object-cover"),f(t,"class","relative")},m(i,a){L(i,t,a),k(t,e),k(t,s),o&&o.m(t,null),r=!0},p(i,a){(!r||a[0]&8&&!ke(e.src,l=i[70].url))&&f(e,"src",l),(i[0]?i[20].length===0:i[7].length!==i[20].length)?o?(o.p(i,a),a[0]&1048705&&H(o,1)):(o=Al(i),o.c(),H(o,1),o.m(t,null)):o&&(zt(),R(o,1,1,()=>{o=null}),Ft())},i(i){r||(H(o),r=!0)},o(i){R(o),r=!1},d(i){i&&m(t),o&&o.d()}}}function fo(n){let t,e,l,s,r,o;return{c(){t=dt("svg"),e=dt("style"),l=pt(`.spinner_qM83 {
																animation: spinner_8HQG 1.05s infinite;
															}
															.spinner_oXPr {
																animation-delay: 0.1s;
															}
															.spinner_ZTLf {
																animation-delay: 0.2s;
															}
															@keyframes spinner_8HQG {
																0%,
																57.14% {
																	animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																	transform: translate(0);
																}
																28.57% {
																	animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																	transform: translateY(-6px);
																}
																100% {
																	transform: translate(0);
																}
															}
														`),s=dt("circle"),r=dt("circle"),o=dt("circle"),this.h()},l(i){t=mt(i,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=S(t);e=mt(a,"style",{});var u=S(e);l=_t(u,`.spinner_qM83 {
																animation: spinner_8HQG 1.05s infinite;
															}
															.spinner_oXPr {
																animation-delay: 0.1s;
															}
															.spinner_ZTLf {
																animation-delay: 0.2s;
															}
															@keyframes spinner_8HQG {
																0%,
																57.14% {
																	animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																	transform: translate(0);
																}
																28.57% {
																	animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																	transform: translateY(-6px);
																}
																100% {
																	transform: translate(0);
																}
															}
														`),u.forEach(m),s=mt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(s).forEach(m),r=mt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(r).forEach(m),o=mt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(o).forEach(m),a.forEach(m),this.h()},h(){f(s,"class","spinner_qM83"),f(s,"cx","4"),f(s,"cy","12"),f(s,"r","2.5"),f(r,"class","spinner_qM83 spinner_oXPr"),f(r,"cx","12"),f(r,"cy","12"),f(r,"r","2.5"),f(o,"class","spinner_qM83 spinner_ZTLf"),f(o,"cx","20"),f(o,"cy","12"),f(o,"r","2.5"),f(t,"class","w-6 h-6 translate-y-[0.5px]"),f(t,"fill","currentColor"),f(t,"viewBox","0 0 24 24"),f(t,"xmlns","http://www.w3.org/2000/svg")},m(i,a){L(i,t,a),k(t,e),k(e,l),k(t,s),k(t,r),k(t,o)},d(i){i&&m(t)}}}function mo(n){let t,e,l;return{c(){t=dt("svg"),e=dt("path"),l=dt("path"),this.h()},l(s){t=mt(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var r=S(t);e=mt(r,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(e).forEach(m),l=mt(r,"path",{d:!0}),S(l).forEach(m),r.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z"),f(e,"clip-rule","evenodd"),f(l,"d","M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class","w-6 h-6")},m(s,r){L(s,t,r),k(t,e),k(t,l)},d(s){s&&m(t)}}}function Al(n){let t,e;return t=new he({props:{className:" absolute top-1 left-1",content:n[22].t("{{ models }}",{models:[...n[0]?[n[0]]:n[7]].filter(n[50]).join(", ")}),$$slots:{default:[ho]},$$scope:{ctx:n}}}),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,s){const r={};s[0]&5243009&&(r.content=l[22].t("{{ models }}",{models:[...l[0]?[l[0]]:l[7]].filter(l[50]).join(", ")})),s[2]&2048&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(H(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function ho(n){let t,e;return{c(){t=dt("svg"),e=dt("path"),this.h()},l(l){t=mt(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var s=S(t);e=mt(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(e).forEach(m),s.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"),f(e,"clip-rule","evenodd"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class","size-4 fill-yellow-300")},m(l,s){L(l,t,s),k(t,e)},p:Dt,d(l){l&&m(t)}}}function Ll(n){let t,e,l,s,r,o,i='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',a,u,c,d;const y=[uo,co,ao],v=[];function _(h,w){return h[70].type==="image"?0:h[70].type==="doc"?1:h[70].type==="collection"?2:-1}~(e=_(n))&&(l=v[e]=y[e](n));function b(){return n[51](n[72])}return{c(){t=I("div"),l&&l.c(),s=Q(),r=I("div"),o=I("button"),o.innerHTML=i,a=Q(),this.h()},l(h){t=M(h,"DIV",{class:!0});var w=S(t);l&&l.l(w),s=Y(w),r=M(w,"DIV",{class:!0});var E=S(r);o=M(E,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Kt(o)!=="svelte-3nr9d3"&&(o.innerHTML=i),E.forEach(m),a=Y(w),w.forEach(m),this.h()},h(){f(o,"class","bg-gray-400 text-white border border-white rounded-full group-hover:visible invisible transition"),f(o,"type","button"),f(r,"class","absolute -top-1 -right-1"),f(t,"class","relative group")},m(h,w){L(h,t,w),~e&&v[e].m(t,null),k(t,s),k(t,r),k(r,o),k(t,a),u=!0,c||(d=tt(o,"click",b),c=!0)},p(h,w){n=h;let E=e;e=_(n),e===E?~e&&v[e].p(n,w):(l&&(zt(),R(v[E],1,1,()=>{v[E]=null}),Ft()),~e?(l=v[e],l?l.p(n,w):(l=v[e]=y[e](n),l.c()),H(l,1),l.m(t,s)):l=null)},i(h){u||(H(l),u=!0)},o(h){R(l),u=!1},d(h){h&&m(t),~e&&v[e].d(),c=!1,d()}}}function go(n){let t,e='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-5"><path d="M8.75 3.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z"></path></svg>';return{c(){t=I("button"),t.innerHTML=e,this.h()},l(l){t=M(l,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-wy6pwi"&&(t.innerHTML=e),this.h()},h(){f(t,"class","bg-gray-50 hover:bg-gray-100 text-gray-800 dark:bg-gray-850 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5 outline-none focus:outline-none"),f(t,"type","button")},m(l,s){L(l,t,s)},p:Dt,d(l){l&&m(t)}}}function po(n){let t,e='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z" clip-rule="evenodd"></path></svg>',l,s;return{c(){t=I("button"),t.innerHTML=e,this.h()},l(r){t=M(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-tod56q"&&(t.innerHTML=e),this.h()},h(){f(t,"class","bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5")},m(r,o){L(r,t,o),l||(s=tt(t,"click",function(){gn(n[6])&&n[6].apply(this,arguments)}),l=!0)},p(r,o){n=r},i:Dt,o:Dt,d(r){r&&m(t),l=!1,s()}}}function _o(n){let t,e,l,s;return t=new he({props:{content:n[22].t("Record voice"),$$slots:{default:[wo]},$$scope:{ctx:n}}}),l=new he({props:{content:n[22].t("Send message"),$$slots:{default:[ko]},$$scope:{ctx:n}}}),{c(){rt(t.$$.fragment),e=Q(),rt(l.$$.fragment)},l(r){it(t.$$.fragment,r),e=Y(r),it(l.$$.fragment,r)},m(r,o){at(t,r,o),L(r,e,o),at(l,r,o),s=!0},p(r,o){const i={};o[0]&4194304&&(i.content=r[22].t("Record voice")),o[0]&2097408|o[2]&2048&&(i.$$scope={dirty:o,ctx:r}),t.$set(i);const a={};o[0]&4194304&&(a.content=r[22].t("Send message")),o[0]&2|o[2]&2048&&(a.$$scope={dirty:o,ctx:r}),l.$set(a)},i(r){s||(H(t.$$.fragment,r),H(l.$$.fragment,r),s=!0)},o(r){R(t.$$.fragment,r),R(l.$$.fragment,r),s=!1},d(r){r&&m(e),ct(t,r),ct(l,r)}}}function Pl(n){let t,e,l;function s(i,a){return i[21]?vo:bo}let r=s(n),o=r(n);return{c(){t=I("button"),o.c(),this.h()},l(i){t=M(i,"BUTTON",{id:!0,class:!0,type:!0});var a=S(t);o.l(a),a.forEach(m),this.h()},h(){f(t,"id","voice-input-button"),f(t,"class","text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-850 transition rounded-full p-1.5 mr-0.5 self-center"),f(t,"type","button")},m(i,a){L(i,t,a),o.m(t,null),e||(l=tt(t,"click",n[61]),e=!0)},p(i,a){r!==(r=s(i))&&(o.d(1),o=r(i),o&&(o.c(),o.m(t,null)))},d(i){i&&m(t),o.d(),e=!1,l()}}}function bo(n){let t,e,l;return{c(){t=dt("svg"),e=dt("path"),l=dt("path"),this.h()},l(s){t=mt(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var r=S(t);e=mt(r,"path",{d:!0}),S(e).forEach(m),l=mt(r,"path",{d:!0}),S(l).forEach(m),r.forEach(m),this.h()},h(){f(e,"d","M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"),f(l,"d","M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 20 20"),f(t,"fill","currentColor"),f(t,"class","w-5 h-5 translate-y-[0.5px]")},m(s,r){L(s,t,r),k(t,e),k(t,l)},d(s){s&&m(t)}}}function vo(n){let t,e,l,s,r,o;return{c(){t=dt("svg"),e=dt("style"),l=pt(`.spinner_qM83 {
															animation: spinner_8HQG 1.05s infinite;
														}
														.spinner_oXPr {
															animation-delay: 0.1s;
														}
														.spinner_ZTLf {
															animation-delay: 0.2s;
														}
														@keyframes spinner_8HQG {
															0%,
															57.14% {
																animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																transform: translate(0);
															}
															28.57% {
																animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																transform: translateY(-6px);
															}
															100% {
																transform: translate(0);
															}
														}
													`),s=dt("circle"),r=dt("circle"),o=dt("circle"),this.h()},l(i){t=mt(i,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=S(t);e=mt(a,"style",{});var u=S(e);l=_t(u,`.spinner_qM83 {
															animation: spinner_8HQG 1.05s infinite;
														}
														.spinner_oXPr {
															animation-delay: 0.1s;
														}
														.spinner_ZTLf {
															animation-delay: 0.2s;
														}
														@keyframes spinner_8HQG {
															0%,
															57.14% {
																animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																transform: translate(0);
															}
															28.57% {
																animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																transform: translateY(-6px);
															}
															100% {
																transform: translate(0);
															}
														}
													`),u.forEach(m),s=mt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(s).forEach(m),r=mt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(r).forEach(m),o=mt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(o).forEach(m),a.forEach(m),this.h()},h(){f(s,"class","spinner_qM83"),f(s,"cx","4"),f(s,"cy","12"),f(s,"r","2.5"),f(r,"class","spinner_qM83 spinner_oXPr"),f(r,"cx","12"),f(r,"cy","12"),f(r,"r","2.5"),f(o,"class","spinner_qM83 spinner_ZTLf"),f(o,"cx","20"),f(o,"cy","12"),f(o,"r","2.5"),f(t,"class","w-5 h-5 translate-y-[0.5px]"),f(t,"fill","currentColor"),f(t,"viewBox","0 0 24 24"),f(t,"xmlns","http://www.w3.org/2000/svg")},m(i,a){L(i,t,a),k(t,e),k(e,l),k(t,s),k(t,r),k(t,o)},d(i){i&&m(t)}}}function wo(n){let t,e=n[8]&&Pl(n);return{c(){e&&e.c(),t=Ht()},l(l){e&&e.l(l),t=Ht()},m(l,s){e&&e.m(l,s),L(l,t,s)},p(l,s){l[8]?e?e.p(l,s):(e=Pl(l),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(l){l&&m(t),e&&e.d(l)}}}function ko(n){let t,e,l,s,r;return{c(){t=I("button"),e=dt("svg"),l=dt("path"),this.h()},l(o){t=M(o,"BUTTON",{id:!0,class:!0,type:!0});var i=S(t);e=mt(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=S(e);l=mt(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(l).forEach(m),a.forEach(m),i.forEach(m),this.h()},h(){f(l,"fill-rule","evenodd"),f(l,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),f(l,"clip-rule","evenodd"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"viewBox","0 0 16 16"),f(e,"fill","currentColor"),f(e,"class","w-5 h-5"),f(t,"id","send-message-button"),f(t,"class",s=(n[1]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 self-center"),f(t,"type","submit"),t.disabled=r=n[1]===""},m(o,i){L(o,t,i),k(t,e),k(e,l)},p(o,i){i[0]&2&&s!==(s=(o[1]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 self-center")&&f(t,"class",s),i[0]&2&&r!==(r=o[1]==="")&&(t.disabled=r)},d(o){o&&m(t)}}}function yo(n){let t,e,l,s,r,o,i,a,u,c,d,y,v,_,b,h,w,E,D,B,V,C,N,T,$,P,G,U,A,et,bt,vt,Wt,At,It,Lt,Vt,qt,Yt,Qt,z=n[22].t("LLMs can make mistakes. Verify important information.")+"",q,nt,Ut,Rt,ut=n[17]&&Bl(n),Pt=n[2]===!1&&n[9].length>0&&Nl(n);const ge=[io,ro],$t=[];function pe(g,O){return O[0]&2&&(a=null),O[0]&2&&(u=null),a==null&&(a=g[1].charAt(0)==="/"),a?0:(u==null&&(u=g[1].charAt(0)==="#"),u?1:-1)}~(c=pe(n,[-1,-1,-1]))&&(d=$t[c]=ge[c](n));function Ie(g){n[41](g)}function Me(g){n[42](g)}function De(g){n[43](g)}let fe={messages:n[9]};n[1]!==void 0&&(fe.prompt=n[1]),n[18]!==void 0&&(fe.user=n[18]),n[19]!==void 0&&(fe.chatInputPlaceholder=n[19]),v=new Fs({props:fe}),n[40](v),gt.push(()=>Ot(v,"prompt",Ie)),gt.push(()=>Ot(v,"user",Me)),gt.push(()=>Ot(v,"chatInputPlaceholder",De)),v.$on("select",n[44]);let Ct=n[0]!==void 0&&Ol(n),Tt=n[3].length>0&&Hl(n);function Ce(g){n[54](g)}let _e={uploadFilesHandler:n[52],onClose:n[53],$$slots:{default:[go]},$$scope:{ctx:n}};n[4]!==void 0&&(_e.webSearchEnabled=n[4]),U=new oo({props:_e}),gt.push(()=>Ot(U,"webSearchEnabled",Ce));const be=[_o,po],te=[];function ve(g,O){return O[0]&512&&(It=null),It==null&&(It=g[9].length==0||g[9].at(-1).done==!0),It?0:1}return Lt=ve(n,[-1,-1,-1]),Vt=te[Lt]=be[Lt](n),{c(){ut&&ut.c(),t=Q(),e=I("div"),l=I("div"),s=I("div"),r=I("div"),Pt&&Pt.c(),o=Q(),i=I("div"),d&&d.c(),y=Q(),rt(v.$$.fragment),w=Q(),Ct&&Ct.c(),E=Q(),D=I("div"),B=I("div"),V=I("div"),C=I("input"),N=Q(),T=I("form"),Tt&&Tt.c(),$=Q(),P=I("div"),G=I("div"),rt(U.$$.fragment),et=Q(),bt=I("textarea"),Wt=Q(),At=I("div"),Vt.c(),Yt=Q(),Qt=I("div"),q=pt(z),this.h()},l(g){ut&&ut.l(g),t=Y(g),e=M(g,"DIV",{class:!0});var O=S(e);l=M(O,"DIV",{class:!0});var x=S(l);s=M(x,"DIV",{class:!0});var J=S(s);r=M(J,"DIV",{class:!0});var j=S(r);Pt&&Pt.l(j),j.forEach(m),o=Y(J),i=M(J,"DIV",{class:!0});var Z=S(i);d&&d.l(Z),y=Y(Z),it(v.$$.fragment,Z),w=Y(Z),Ct&&Ct.l(Z),Z.forEach(m),J.forEach(m),x.forEach(m),E=Y(O),D=M(O,"DIV",{class:!0});var kt=S(D);B=M(kt,"DIV",{class:!0});var Mt=S(B);V=M(Mt,"DIV",{class:!0});var wt=S(V);C=M(wt,"INPUT",{type:!0}),N=Y(wt),T=M(wt,"FORM",{dir:!0,class:!0});var jt=S(T);Tt&&Tt.l(jt),$=Y(jt),P=M(jt,"DIV",{class:!0});var p=S(P);G=M(p,"DIV",{class:!0});var X=S(G);it(U.$$.fragment,X),X.forEach(m),et=Y(p),bt=M(p,"TEXTAREA",{id:!0,class:!0,placeholder:!0,rows:!0}),S(bt).forEach(m),Wt=Y(p),At=M(p,"DIV",{class:!0});var lt=S(At);Vt.l(lt),lt.forEach(m),p.forEach(m),jt.forEach(m),Yt=Y(wt),Qt=M(wt,"DIV",{class:!0});var W=S(Qt);q=_t(W,z),W.forEach(m),wt.forEach(m),Mt.forEach(m),kt.forEach(m),O.forEach(m),this.h()},h(){var g;f(r,"class","relative"),f(i,"class","w-full relative"),f(s,"class","flex flex-col max-w-6xl px-2.5 md:px-6 w-full"),f(l,"class","-mb-0.5 mx-auto inset-x-0 bg-transparent flex justify-center"),f(C,"type","file"),C.hidden=!0,C.multiple=!0,f(G,"class","ml-1 self-end mb-2 flex space-x-1"),f(bt,"id","chat-textarea"),f(bt,"class","scrollbar-hidden bg-gray-50 dark:bg-gray-850 dark:text-gray-100 outline-none w-full py-3 px-3 rounded-xl resize-none h-[48px] svelte-141e0sl"),f(bt,"placeholder",vt=n[19]!==""?n[19]:n[21]?n[22].t("Listening..."):n[22].t("Send a Message")),f(bt,"rows","1"),f(At,"class","self-end mb-2 flex space-x-1 mr-1"),f(P,"class","flex"),f(T,"dir",qt=((g=n[23])==null?void 0:g.chatDirection)??"LTR"),f(T,"class","flex flex-col relative w-full rounded-3xl px-1.5 bg-gray-50 dark:bg-gray-850 dark:text-gray-100"),f(Qt,"class","mt-1.5 text-xs text-gray-500 text-center"),f(V,"class","pb-2"),f(B,"class","max-w-6xl px-2.5 md:px-6 mx-auto inset-x-0"),f(D,"class","bg-white dark:bg-gray-900"),f(e,"class","w-full")},m(g,O){ut&&ut.m(g,O),L(g,t,O),L(g,e,O),k(e,l),k(l,s),k(s,r),Pt&&Pt.m(r,null),k(s,o),k(s,i),~c&&$t[c].m(i,null),k(i,y),at(v,i,null),k(i,w),Ct&&Ct.m(i,null),k(e,E),k(e,D),k(D,B),k(B,V),k(V,C),n[47](C),k(V,N),k(V,T),Tt&&Tt.m(T,null),k(T,$),k(T,P),k(P,G),at(U,G,null),k(P,et),k(P,bt),n[55](bt),Xe(bt,n[1]),k(P,Wt),k(P,At),te[Lt].m(At,null),k(V,Yt),k(V,Qt),k(Qt,q),nt=!0,Ut||(Rt=[tt(C,"change",n[48]),tt(C,"change",n[49]),tt(bt,"input",n[56]),tt(bt,"keypress",Eo),tt(bt,"keydown",n[57]),tt(bt,"input",n[58]),tt(bt,"focus",n[59]),tt(bt,"paste",n[60]),tt(T,"submit",hn(n[62]))],Ut=!0)},p(g,O){var kt;g[17]?ut?(ut.p(g,O),O[0]&131072&&H(ut,1)):(ut=Bl(g),ut.c(),H(ut,1),ut.m(t.parentNode,t)):ut&&(zt(),R(ut,1,1,()=>{ut=null}),Ft()),g[2]===!1&&g[9].length>0?Pt?Pt.p(g,O):(Pt=Nl(g),Pt.c(),Pt.m(r,null)):Pt&&(Pt.d(1),Pt=null);let x=c;c=pe(g,O),c===x?~c&&$t[c].p(g,O):(d&&(zt(),R($t[x],1,1,()=>{$t[x]=null}),Ft()),~c?(d=$t[c],d?d.p(g,O):(d=$t[c]=ge[c](g),d.c()),H(d,1),d.m(i,y)):d=null);const J={};O[0]&512&&(J.messages=g[9]),!_&&O[0]&2&&(_=!0,J.prompt=g[1],Nt(()=>_=!1)),!b&&O[0]&262144&&(b=!0,J.user=g[18],Nt(()=>b=!1)),!h&&O[0]&524288&&(h=!0,J.chatInputPlaceholder=g[19],Nt(()=>h=!1)),v.$set(J),g[0]!==void 0?Ct?(Ct.p(g,O),O[0]&1&&H(Ct,1)):(Ct=Ol(g),Ct.c(),H(Ct,1),Ct.m(i,null)):Ct&&(zt(),R(Ct,1,1,()=>{Ct=null}),Ft()),g[3].length>0?Tt?(Tt.p(g,O),O[0]&8&&H(Tt,1)):(Tt=Hl(g),Tt.c(),H(Tt,1),Tt.m(T,$)):Tt&&(zt(),R(Tt,1,1,()=>{Tt=null}),Ft());const j={};O[0]&4096&&(j.uploadFilesHandler=g[52]),O[0]&1024&&(j.onClose=g[53]),O[2]&2048&&(j.$$scope={dirty:O,ctx:g}),!A&&O[0]&16&&(A=!0,j.webSearchEnabled=g[4],Nt(()=>A=!1)),U.$set(j),(!nt||O[0]&6815744&&vt!==(vt=g[19]!==""?g[19]:g[21]?g[22].t("Listening..."):g[22].t("Send a Message")))&&f(bt,"placeholder",vt),O[0]&2&&Xe(bt,g[1]);let Z=Lt;Lt=ve(g,O),Lt===Z?te[Lt].p(g,O):(zt(),R(te[Z],1,1,()=>{te[Z]=null}),Ft(),Vt=te[Lt],Vt?Vt.p(g,O):(Vt=te[Lt]=be[Lt](g),Vt.c()),H(Vt,1),Vt.m(At,null)),(!nt||O[0]&8388608&&qt!==(qt=((kt=g[23])==null?void 0:kt.chatDirection)??"LTR"))&&f(T,"dir",qt),(!nt||O[0]&4194304)&&z!==(z=g[22].t("LLMs can make mistakes. Verify important information.")+"")&&Et(q,z)},i(g){nt||(H(ut),H(d),H(v.$$.fragment,g),H(Ct),H(Tt),H(U.$$.fragment,g),H(Vt),nt=!0)},o(g){R(ut),R(d),R(v.$$.fragment,g),R(Ct),R(Tt),R(U.$$.fragment,g),R(Vt),nt=!1},d(g){g&&(m(t),m(e)),ut&&ut.d(g),Pt&&Pt.d(),~c&&$t[c].d(),n[40](null),ct(v),Ct&&Ct.d(),n[47](null),Tt&&Tt.d(),ct(U),n[55](null),te[Lt].d(),Ut=!1,ae(Rt)}}}const Eo=n=>{};function So(n,t,e){let l,s,r,o,i;ot(n,ce,p=>e(23,s=p)),ot(n,Pe,p=>e(11,r=p)),ot(n,Oe,p=>e(24,o=p)),ot(n,sn,p=>e(25,i=p));const a=ue("i18n");ot(n,a,p=>e(22,l=p));let{submitPrompt:u}=t,{stopResponse:c}=t,{autoScroll:d=!0}=t,{atSelectedModel:y}=t,{selectedModels:v}=t,_,b,h,w,E,D,B=!1,V=null,C="",{files:N=[]}=t,{speechRecognitionEnabled:T=!0}=t,{webSearchEnabled:$=!1}=t,{prompt:P=""}=t,{messages:G=[]}=t,U,A=[],et,bt=[],vt=!1;const Wt=-45,At=()=>{const p=document.getElementById("messages-container");p.scrollTop=p.scrollHeight},It=async()=>{const p=await navigator.mediaDevices.getUserMedia({audio:!0});et=new MediaRecorder(p),et.onstart=()=>{e(21,vt=!0),console.log("Recording started")},et.ondataavailable=X=>bt.push(X.data),et.onstop=async()=>{e(21,vt=!1),console.log("Recording stopped");const X=new Blob(bt,{type:"audio/wav"}),lt=el(X,"recording.wav"),W=await il(localStorage.token,lt).catch(F=>(ht.error(F),null));W&&(e(1,P=W.text),await yt(),_==null||_.focus(),P!==""&&(s==null?void 0:s.speechAutoSend)===!0&&u(P,V)),bt=[]},et.start(),Lt(p)},Lt=p=>{const X=new AudioContext,lt=X.createMediaStreamSource(p),W=X.createAnalyser();W.minDecibels=Wt,lt.connect(W);const F=W.frequencyBinCount,ft=new Uint8Array(F);let St=Date.now();const Bt=()=>{if(W.getByteFrequencyData(ft),ft.some(st=>st>0)&&(St=Date.now()),vt&&Date.now()-St>3e3){et.stop(),X.close();return}window.requestAnimationFrame(Bt)};window.requestAnimationFrame(Bt)},Vt=()=>{var p;if(vt)U&&U.stop(),et&&et.stop();else if(e(21,vt=!0),((p=s==null?void 0:s.audio)==null?void 0:p.STTEngine)??!1)It();else if("SpeechRecognition"in window||"webkitSpeechRecognition"in window){U=new(window.SpeechRecognition||window.webkitSpeechRecognition),U.continuous=!0;const X=3e3;let lt;U.start(),U.onresult=async W=>{clearTimeout(lt),console.log(W);const F=W.results[Object.keys(W.results).length-1][0].transcript;e(1,P=`${P}${F}`),await yt(),_==null||_.focus(),lt=setTimeout(()=>{console.log("Speech recognition turned off due to inactivity."),U.stop()},X)},U.onend=function(){console.log("recognition ended"),e(21,vt=!1),P!==""&&(s==null?void 0:s.speechAutoSend)===!0&&u(P,V)},U.onerror=function(W){console.log(W),ht.error(l.t("Speech recognition error: {{error}}",{error:W.error})),e(21,vt=!1)}}else ht.error(l.t("SpeechRecognition API is not supported in this browser."))},qt=async p=>{console.log(p);const X={type:"doc",name:p.name,collection_name:"",upload_status:!1,error:""};try{if(e(3,N=[...N,X]),["audio/mpeg","audio/wav"].includes(p.type)){const W=await il(localStorage.token,p).catch(F=>(ht.error(F),null));if(W){console.log(W);const F=new Blob([W.text],{type:"text/plain"});p=el(F,`${p.name}.txt`)}}const lt=await Hn(localStorage.token,"",p);lt&&(X.upload_status=!0,X.collection_name=lt.collection_name,e(3,N))}catch(lt){e(3,N=N.filter(W=>W.name!==p.name)),ht.error(lt)}},Yt=async p=>{console.log(p);const X={type:"doc",name:p,collection_name:"",upload_status:!1,url:p,error:""};try{e(3,N=[...N,X]);const lt=await An(localStorage.token,"",p);lt&&(X.upload_status=!0,X.collection_name=lt.collection_name,e(3,N))}catch(lt){e(3,N=N.filter(W=>W.name!==p)),ht.error(lt)}},Qt=async p=>{console.log(p);const X={type:"doc",name:p,collection_name:"",upload_status:!1,url:p,error:""};try{e(3,N=[...N,X]);const lt=await Ln(localStorage.token,p);lt&&(X.upload_status=!0,X.collection_name=lt.collection_name,e(3,N))}catch(lt){e(3,N=N.filter(W=>W.name!==p)),ht.error(lt)}};We(()=>{window.setTimeout(()=>_==null?void 0:_.focus(),0);const p=document.querySelector("body"),X=ft=>{ft.key==="Escape"&&(console.log("Escape"),e(17,B=!1))},lt=ft=>{ft.preventDefault(),e(17,B=!0)},W=()=>{e(17,B=!1)},F=async ft=>{var St,Bt;if(ft.preventDefault(),console.log(ft),(St=ft.dataTransfer)!=null&&St.files){const st=Array.from((Bt=ft.dataTransfer)==null?void 0:Bt.files);st&&st.length>0?st.forEach(K=>{if(console.log(K,K.name.split(".").at(-1)),["image/gif","image/webp","image/jpeg","image/png"].includes(K.type)){if(A.length===0){ht.error(l.t("Selected model(s) do not support image inputs"));return}let Xt=new FileReader;Xt.onload=de=>{e(3,N=[...N,{type:"image",url:`${de.target.result}`}])},Xt.readAsDataURL(K)}else Ke.includes(K.type)||xe.includes(K.name.split(".").at(-1))||ht.error(l.t("Unknown File Type '{{file_type}}', but accepting and treating as plain text",{file_type:K.type})),qt(K)}):ht.error(l.t("File not found."))}e(17,B=!1)};return window.addEventListener("keydown",X),p==null||p.addEventListener("dragover",lt),p==null||p.addEventListener("drop",F),p==null||p.addEventListener("dragleave",W),()=>{window.removeEventListener("keydown",X),p==null||p.removeEventListener("dragover",lt),p==null||p.removeEventListener("drop",F),p==null||p.removeEventListener("dragleave",W)}});const z=()=>{e(2,d=!0),At()};function q(p){gt[p?"unshift":"push"](()=>{h=p,e(13,h)})}function nt(p){P=p,e(1,P)}function Ut(p){gt[p?"unshift":"push"](()=>{w=p,e(14,w)})}function Rt(p){P=p,e(1,P)}const ut=p=>{console.log(p),Qt(p.detail)},Pt=p=>{console.log(p),Yt(p.detail)},ge=p=>{var X;console.log(p),e(3,N=[...N,{type:((X=p==null?void 0:p.detail)==null?void 0:X.type)??"doc",...p.detail,upload_status:!0}])};function $t(p){gt[p?"unshift":"push"](()=>{E=p,e(15,E)})}function pe(p){P=p,e(1,P)}function Ie(p){V=p,e(18,V)}function Me(p){C=p,e(19,C)}const De=p=>{e(0,y=p.detail),_==null||_.focus()},fe=p=>p.id===y.id,Ct=()=>{e(0,y=void 0)};function Tt(p){gt[p?"unshift":"push"](()=>{b=p,e(12,b)})}function Ce(){D=this.files,e(16,D)}const _e=async()=>{D&&D.length>0?Array.from(D).forEach(X=>{if(["image/gif","image/webp","image/jpeg","image/png"].includes(X.type)){if(A.length===0){ht.error(l.t("Selected model(s) do not support image inputs")),e(16,D=null),e(12,b.value="",b);return}let lt=new FileReader;lt.onload=W=>{e(3,N=[...N,{type:"image",url:`${W.target.result}`}]),e(16,D=null),e(12,b.value="",b)},lt.readAsDataURL(X)}else Ke.includes(X.type)||xe.includes(X.name.split(".").at(-1))?(qt(X),e(12,b.value="",b)):(ht.error(l.t("Unknown File Type '{{file_type}}', but accepting and treating as plain text",{file_type:X.type})),qt(X),e(12,b.value="",b))}):ht.error(l.t("File not found."))},be=p=>!A.includes(p),te=p=>{N.splice(p,1),e(3,N)},ve=()=>{b.click()},g=async()=>{await yt(),_==null||_.focus()};function O(p){$=p,e(4,$)}function x(p){gt[p?"unshift":"push"](()=>{_=p,e(10,_),e(1,P)})}function J(){P=this.value,e(1,P)}const j=async p=>{var lt;if(!i||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)){if(p.key==="Enter"&&!p.shiftKey&&p.preventDefault(),p.key==="Enter"&&!p.shiftKey&&P!==""){u(P,V);return}if(p.key==="Enter"&&p.shiftKey&&P!=="")return}const X=p.ctrlKey||p.metaKey;if(P===""&&X&&p.key.toLowerCase()==="r"){p.preventDefault(),console.log("regenerate");const W=[...document.getElementsByClassName("regenerate-response-button")].at(-1);W==null||W.click()}if(P===""&&p.key=="ArrowUp"){p.preventDefault();const W=[...document.getElementsByClassName("user-message")].at(-1),F=[...document.getElementsByClassName("edit-user-message-button")].at(-1);console.log(W),W.scrollIntoView({block:"center"}),F==null||F.click()}if(["/","#","@"].includes(P.charAt(0))&&p.key==="ArrowUp"&&(p.preventDefault(),(h||w||E).selectUp(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),["/","#","@"].includes(P.charAt(0))&&p.key==="ArrowDown"&&(p.preventDefault(),(h||w||E).selectDown(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),["/","#","@"].includes(P.charAt(0))&&p.key==="Enter"){p.preventDefault();const W=[...document.getElementsByClassName("selected-command-option-button")].at(-1);W?W==null||W.click():(lt=document.getElementById("send-message-button"))==null||lt.click()}if(["/","#","@"].includes(P.charAt(0))&&p.key==="Tab"){p.preventDefault();const W=[...document.getElementsByClassName("selected-command-option-button")].at(-1);W==null||W.click()}else if(p.key==="Tab"){const W=an(P);if(W.length>0){const F=W.at(0),ft=P;e(1,P=P.substring(0,(F==null?void 0:F.endIndex)+1)),await yt(),p.target.scrollTop=p.target.scrollHeight,e(1,P=ft),await yt(),p.preventDefault(),p.target.setSelectionRange(F==null?void 0:F.startIndex,F.endIndex+1)}p.target.style.height="",p.target.style.height=Math.min(p.target.scrollHeight,200)+"px"}p.key==="Escape"&&(console.log("Escape"),e(0,y=void 0))},Z=p=>{p.target.style.height="",p.target.style.height=Math.min(p.target.scrollHeight,200)+"px",e(18,V=null)},kt=p=>{p.target.style.height="",p.target.style.height=Math.min(p.target.scrollHeight,200)+"px"},Mt=p=>{const X=p.clipboardData||window.clipboardData;if(X&&X.items){for(const lt of X.items)if(lt.type.indexOf("image")!==-1){const W=lt.getAsFile(),F=new FileReader;F.onload=function(ft){e(3,N=[...N,{type:"image",url:`${ft.target.result}`}])},F.readAsDataURL(W)}}},wt=()=>{Vt()},jt=()=>{u(P,V)};return n.$$set=p=>{"submitPrompt"in p&&e(5,u=p.submitPrompt),"stopResponse"in p&&e(6,c=p.stopResponse),"autoScroll"in p&&e(2,d=p.autoScroll),"atSelectedModel"in p&&e(0,y=p.atSelectedModel),"selectedModels"in p&&e(7,v=p.selectedModels),"files"in p&&e(3,N=p.files),"speechRecognitionEnabled"in p&&e(8,T=p.speechRecognitionEnabled),"webSearchEnabled"in p&&e(4,$=p.webSearchEnabled),"prompt"in p&&e(1,P=p.prompt),"messages"in p&&e(9,G=p.messages)},n.$$.update=()=>{n.$$.dirty[0]&2177&&e(20,A=[...y?[y]:v].filter(p=>{var X,lt,W,F;return((F=(W=(lt=(X=r.find(ft=>ft.id===p))==null?void 0:X.info)==null?void 0:lt.meta)==null?void 0:W.capabilities)==null?void 0:F.vision)??!0})),n.$$.dirty[0]&1026&&P&&_&&(e(10,_.style.height="",_),e(10,_.style.height=Math.min(_.scrollHeight,200)+"px",_))},[y,P,d,N,$,u,c,v,T,G,_,r,b,h,w,E,D,B,V,C,A,vt,l,s,o,i,a,At,Vt,qt,Yt,Qt,z,q,nt,Ut,Rt,ut,Pt,ge,$t,pe,Ie,Me,De,fe,Ct,Tt,Ce,_e,be,te,ve,g,O,x,J,j,Z,kt,Mt,wt,jt]}class Io extends Gt{constructor(t){super(),Jt(this,t,So,yo,Zt,{submitPrompt:5,stopResponse:6,autoScroll:2,atSelectedModel:0,selectedModels:7,files:3,speechRecognitionEnabled:8,webSearchEnabled:4,prompt:1,messages:9},null,[-1,-1,-1])}}function Ul(n,t,e){const l=n.slice();return l[12]=t[e],l[13]=t,l[14]=e,l}function Mo(n){let t,e,l;return e=new he({props:{content:n[4].t("Remove Model"),$$slots:{default:[Co]},$$scope:{ctx:n}}}),{c(){t=I("div"),rt(e.$$.fragment),this.h()},l(s){t=M(s,"DIV",{class:!0});var r=S(t);it(e.$$.fragment,r),r.forEach(m),this.h()},h(){f(t,"class","self-center disabled:text-gray-600 disabled:hover:text-gray-600 mr-2")},m(s,r){L(s,t,r),at(e,t,null),l=!0},p(s,r){const o={};r&16&&(o.content=s[4].t("Remove Model")),r&32771&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){l||(H(e.$$.fragment,s),l=!0)},o(s){R(e.$$.fragment,s),l=!1},d(s){s&&m(t),ct(e)}}}function Do(n){let t,e,l;return e=new he({props:{content:n[4].t("Add Model"),$$slots:{default:[To]},$$scope:{ctx:n}}}),{c(){t=I("div"),rt(e.$$.fragment),this.h()},l(s){t=M(s,"DIV",{class:!0});var r=S(t);it(e.$$.fragment,r),r.forEach(m),this.h()},h(){f(t,"class","self-center mr-2 disabled:text-gray-600 disabled:hover:text-gray-600")},m(s,r){L(s,t,r),at(e,t,null),l=!0},p(s,r){const o={};r&16&&(o.content=s[4].t("Add Model")),r&32771&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){l||(H(e.$$.fragment,s),l=!0)},o(s){R(e.$$.fragment,s),l=!1},d(s){s&&m(t),ct(e)}}}function Co(n){let t,e,l,s,r;function o(){return n[10](n[14])}return{c(){t=I("button"),e=dt("svg"),l=dt("path"),this.h()},l(i){t=M(i,"BUTTON",{});var a=S(t);e=mt(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=S(e);l=mt(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(l).forEach(m),u.forEach(m),a.forEach(m),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"stroke-linejoin","round"),f(l,"d","M19.5 12h-15"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","2"),f(e,"stroke","currentColor"),f(e,"class","size-3.5"),t.disabled=n[1]},m(i,a){L(i,t,a),k(t,e),k(e,l),s||(r=tt(t,"click",o),s=!0)},p(i,a){n=i,a&2&&(t.disabled=n[1])},d(i){i&&m(t),s=!1,r()}}}function To(n){let t,e,l,s,r;return{c(){t=I("button"),e=dt("svg"),l=dt("path"),this.h()},l(o){t=M(o,"BUTTON",{class:!0});var i=S(t);e=mt(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=S(e);l=mt(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(l).forEach(m),a.forEach(m),i.forEach(m),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"stroke-linejoin","round"),f(l,"d","M12 6v12m6-6H6"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","2"),f(e,"stroke","currentColor"),f(e,"class","size-3.5"),f(t,"class",""),t.disabled=n[1]},m(o,i){L(o,t,i),k(t,e),k(e,l),s||(r=tt(t,"click",n[9]),s=!0)},p(o,i){i&2&&(t.disabled=o[1])},d(o){o&&m(t),s=!1,r()}}}function Rl(n){let t,e,l,s,r,o,i,a,u,c;function d(h){n[8](h,n[12],n[13],n[14])}let y={placeholder:n[4].t("Select a model"),items:n[3].map(zl)};n[12]!==void 0&&(y.value=n[12]),s=new Yn({props:y}),gt.push(()=>Ot(s,"value",d));const v=[Do,Mo],_=[];function b(h,w){return h[14]===0?0:1}return i=b(n),a=_[i]=v[i](n),{c(){t=I("div"),e=I("div"),l=I("div"),rt(s.$$.fragment),o=Q(),a.c(),u=Q(),this.h()},l(h){t=M(h,"DIV",{class:!0});var w=S(t);e=M(w,"DIV",{class:!0});var E=S(e);l=M(E,"DIV",{class:!0});var D=S(l);it(s.$$.fragment,D),D.forEach(m),E.forEach(m),o=Y(w),a.l(w),u=Y(w),w.forEach(m),this.h()},h(){f(l,"class","mr-1 max-w-full"),f(e,"class","overflow-hidden w-full"),f(t,"class","flex w-full max-w-fit")},m(h,w){L(h,t,w),k(t,e),k(e,l),at(s,l,null),k(t,o),_[i].m(t,null),k(t,u),c=!0},p(h,w){n=h;const E={};w&16&&(E.placeholder=n[4].t("Select a model")),w&8&&(E.items=n[3].map(zl)),!r&&w&1&&(r=!0,E.value=n[12],Nt(()=>r=!1)),s.$set(E),a.p(n,w)},i(h){c||(H(s.$$.fragment,h),H(a),c=!0)},o(h){R(s.$$.fragment,h),R(a),c=!1},d(h){h&&m(t),ct(s),_[i].d()}}}function jl(n){let t,e,l=n[4].t("Set as default")+"",s,r,o;return{c(){t=I("div"),e=I("button"),s=pt(l),this.h()},l(i){t=M(i,"DIV",{class:!0});var a=S(t);e=M(a,"BUTTON",{});var u=S(e);s=_t(u,l),u.forEach(m),a.forEach(m),this.h()},h(){f(t,"class","text-left mt-0.5 ml-1 text-[0.7rem] text-gray-500")},m(i,a){L(i,t,a),k(t,e),k(e,s),r||(o=tt(e,"click",n[7]),r=!0)},p(i,a){a&16&&l!==(l=i[4].t("Set as default")+"")&&Et(s,l)},d(i){i&&m(t),r=!1,o()}}}function Vo(n){let t,e,l,s,r=le(n[0]),o=[];for(let u=0;u<r.length;u+=1)o[u]=Rl(Ul(n,r,u));const i=u=>R(o[u],1,1,()=>{o[u]=null});let a=n[2]&&!n[5]&&jl(n);return{c(){t=I("div");for(let u=0;u<o.length;u+=1)o[u].c();e=Q(),a&&a.c(),l=Ht(),this.h()},l(u){t=M(u,"DIV",{class:!0});var c=S(t);for(let d=0;d<o.length;d+=1)o[d].l(c);c.forEach(m),e=Y(u),a&&a.l(u),l=Ht(),this.h()},h(){f(t,"class","flex flex-col w-full items-center md:items-start")},m(u,c){L(u,t,c);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(t,null);L(u,e,c),a&&a.m(u,c),L(u,l,c),s=!0},p(u,[c]){if(c&27){r=le(u[0]);let d;for(d=0;d<r.length;d+=1){const y=Ul(u,r,d);o[d]?(o[d].p(y,c),H(o[d],1)):(o[d]=Rl(y),o[d].c(),H(o[d],1),o[d].m(t,null))}for(zt(),d=r.length;d<o.length;d+=1)i(d);Ft()}u[2]&&!u[5]?a?a.p(u,c):(a=jl(u),a.c(),a.m(l.parentNode,l)):a&&(a.d(1),a=null)},i(u){if(!s){for(let c=0;c<r.length;c+=1)H(o[c]);s=!0}},o(u){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)R(o[c]);s=!1},d(u){u&&(m(t),m(e),m(l)),Ee(o,u),a&&a.d(u)}}}const zl=n=>({value:n.id,label:n.name,model:n});function Bo(n,t,e){let l,s,r,o;ot(n,Pe,b=>e(3,l=b)),ot(n,ce,b=>e(11,r=b)),ot(n,sn,b=>e(5,o=b));const i=ue("i18n");ot(n,i,b=>e(4,s=b));let{selectedModels:a=[""]}=t,{disabled:u=!1}=t,{showSetDefault:c=!0}=t;const d=async()=>{if(a.filter(h=>h==="").length){ht.error(s.t("Choose a model before saving..."));return}ce.set({...r,models:a}),await Tn(localStorage.token,{ui:r}),ht.success(s.t("Default model updated"))};function y(b,h,w,E){w[E]=b,e(0,a),e(3,l)}const v=()=>{e(0,a=[...a,""])},_=b=>{a.splice(b,1),e(0,a),e(3,l)};return n.$$set=b=>{"selectedModels"in b&&e(0,a=b.selectedModels),"disabled"in b&&e(1,u=b.disabled),"showSetDefault"in b&&e(2,c=b.showSetDefault)},n.$$.update=()=>{n.$$.dirty&9&&a.length>0&&l.length>0&&e(0,a=a.map(b=>l.map(h=>h.id).includes(b)?b:""))},[a,u,c,l,s,o,i,d,y,v,_]}class No extends Gt{constructor(t){super(),Jt(this,t,Bo,Vo,Zt,{selectedModels:0,disabled:1,showSetDefault:2})}}function Oo(n){let t;const e=n[9].default,l=ne(e,n,n[14],null);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,r){l&&l.p&&(!t||r&16384)&&se(l,e,s,s[14],t?re(e,s[14],r,null):oe(s[14]),null)},i(s){t||(H(l,s),t=!0)},o(s){R(l,s),t=!1},d(s){l&&l.d(s)}}}function Ho(n){let t,e,l,s,r=n[3].t("Share")+"",o;return{c(){t=dt("svg"),e=dt("path"),l=Q(),s=I("div"),o=pt(r),this.h()},l(i){t=mt(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=S(t);e=mt(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(e).forEach(m),a.forEach(m),l=Y(i),s=M(i,"DIV",{class:!0});var u=S(s);o=_t(u,r),u.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M15.75 4.5a3 3 0 1 1 .825 2.066l-8.421 4.679a3.002 3.002 0 0 1 0 1.51l8.421 4.679a3 3 0 1 1-.729 1.31l-8.421-4.678a3 3 0 1 1 0-4.132l8.421-4.679a3 3 0 0 1-.096-.755Z"),f(e,"clip-rule","evenodd"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class","size-4"),f(s,"class","flex items-center")},m(i,a){L(i,t,a),k(t,e),L(i,l,a),L(i,s,a),k(s,o)},p(i,a){a&8&&r!==(r=i[3].t("Share")+"")&&Et(o,r)},d(i){i&&(m(t),m(l),m(s))}}}function Ao(n){let t,e,l,s,r=n[3].t("Download")+"",o;return{c(){t=dt("svg"),e=dt("path"),l=Q(),s=I("div"),o=pt(r),this.h()},l(i){t=mt(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=S(t);e=mt(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(e).forEach(m),a.forEach(m),l=Y(i),s=M(i,"DIV",{class:!0});var u=S(s);o=_t(u,r),u.forEach(m),this.h()},h(){f(e,"stroke-linecap","round"),f(e,"stroke-linejoin","round"),f(e,"d","M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"fill","none"),f(t,"viewBox","0 0 24 24"),f(t,"stroke-width","1.5"),f(t,"stroke","currentColor"),f(t,"class","size-4"),f(s,"class","flex items-center")},m(i,a){L(i,t,a),k(t,e),L(i,l,a),L(i,s,a),k(s,o)},p(i,a){a&8&&r!==(r=i[3].t("Download")+"")&&Et(o,r)},d(i){i&&(m(t),m(l),m(s))}}}function Lo(n){let t,e=n[3].t("Plain text (.txt)")+"",l;return{c(){t=I("div"),l=pt(e),this.h()},l(s){t=M(s,"DIV",{class:!0});var r=S(t);l=_t(r,e),r.forEach(m),this.h()},h(){f(t,"class","flex items-center line-clamp-1")},m(s,r){L(s,t,r),k(t,l)},p(s,r){r&8&&e!==(e=s[3].t("Plain text (.txt)")+"")&&Et(l,e)},d(s){s&&m(t)}}}function Po(n){let t,e=n[3].t("PDF document (.pdf)")+"",l;return{c(){t=I("div"),l=pt(e),this.h()},l(s){t=M(s,"DIV",{class:!0});var r=S(t);l=_t(r,e),r.forEach(m),this.h()},h(){f(t,"class","flex items-center line-clamp-1")},m(s,r){L(s,t,r),k(t,l)},p(s,r){r&8&&e!==(e=s[3].t("PDF document (.pdf)")+"")&&Et(l,e)},d(s){s&&m(t)}}}function Uo(n){let t,e,l,s;return t=new Ae({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Lo]},$$scope:{ctx:n}}}),t.$on("click",n[11]),l=new Ae({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Po]},$$scope:{ctx:n}}}),l.$on("click",n[12]),{c(){rt(t.$$.fragment),e=Q(),rt(l.$$.fragment)},l(r){it(t.$$.fragment,r),e=Y(r),it(l.$$.fragment,r)},m(r,o){at(t,r,o),L(r,e,o),at(l,r,o),s=!0},p(r,o){const i={};o&16392&&(i.$$scope={dirty:o,ctx:r}),t.$set(i);const a={};o&16392&&(a.$$scope={dirty:o,ctx:r}),l.$set(a)},i(r){s||(H(t.$$.fragment,r),H(l.$$.fragment,r),s=!0)},o(r){R(t.$$.fragment,r),R(l.$$.fragment,r),s=!1},d(r){r&&m(e),ct(t,r),ct(l,r)}}}function Ro(n){let t,e,l,s;return t=new Is({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Ao]},$$scope:{ctx:n}}}),l=new bs({props:{class:"w-full rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",transition:Ze,sideOffset:8,$$slots:{default:[Uo]},$$scope:{ctx:n}}}),{c(){rt(t.$$.fragment),e=Q(),rt(l.$$.fragment)},l(r){it(t.$$.fragment,r),e=Y(r),it(l.$$.fragment,r)},m(r,o){at(t,r,o),L(r,e,o),at(l,r,o),s=!0},p(r,o){const i={};o&16392&&(i.$$scope={dirty:o,ctx:r}),t.$set(i);const a={};o&16392&&(a.$$scope={dirty:o,ctx:r}),l.$set(a)},i(r){s||(H(t.$$.fragment,r),H(l.$$.fragment,r),s=!0)},o(r){R(t.$$.fragment,r),R(l.$$.fragment,r),s=!1},d(r){r&&m(e),ct(t,r),ct(l,r)}}}function jo(n){let t,e,l,s,r,o,i,a,u;return t=new Ae({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[Ho]},$$scope:{ctx:n}}}),t.$on("click",n[10]),l=new ns({props:{$$slots:{default:[Ro]},$$scope:{ctx:n}}}),a=new Zn({props:{chatId:n[1].id}}),{c(){rt(t.$$.fragment),e=Q(),rt(l.$$.fragment),s=Q(),r=I("hr"),o=Q(),i=I("div"),rt(a.$$.fragment),this.h()},l(c){it(t.$$.fragment,c),e=Y(c),it(l.$$.fragment,c),s=Y(c),r=M(c,"HR",{class:!0}),o=Y(c),i=M(c,"DIV",{class:!0});var d=S(i);it(a.$$.fragment,d),d.forEach(m),this.h()},h(){f(r,"class","border-gray-100 dark:border-gray-800 mt-2.5 mb-1.5"),f(i,"class","flex p-1")},m(c,d){at(t,c,d),L(c,e,d),at(l,c,d),L(c,s,d),L(c,r,d),L(c,o,d),L(c,i,d),at(a,i,null),u=!0},p(c,d){const y={};d&16392&&(y.$$scope={dirty:d,ctx:c}),t.$set(y);const v={};d&16392&&(v.$$scope={dirty:d,ctx:c}),l.$set(v);const _={};d&2&&(_.chatId=c[1].id),a.$set(_)},i(c){u||(H(t.$$.fragment,c),H(l.$$.fragment,c),H(a.$$.fragment,c),u=!0)},o(c){R(t.$$.fragment,c),R(l.$$.fragment,c),R(a.$$.fragment,c),u=!1},d(c){c&&(m(e),m(s),m(r),m(o),m(i)),ct(t,c),ct(l,c),ct(a)}}}function zo(n){let t,e,l;return e=new fn({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:8,side:"bottom",align:"end",transition:Ze,$$slots:{default:[jo]},$$scope:{ctx:n}}}),{c(){t=I("div"),rt(e.$$.fragment),this.h()},l(s){t=M(s,"DIV",{slot:!0});var r=S(t);it(e.$$.fragment,r),r.forEach(m),this.h()},h(){f(t,"slot","content")},m(s,r){L(s,t,r),at(e,t,null),l=!0},p(s,r){const o={};r&16395&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){l||(H(e.$$.fragment,s),l=!0)},o(s){R(e.$$.fragment,s),l=!1},d(s){s&&m(t),ct(e)}}}function Fo(n){let t,e;return t=new un({props:{$$slots:{content:[zo],default:[Oo]},$$scope:{ctx:n}}}),t.$on("change",n[13]),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,[s]){const r={};s&16395&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(H(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function qo(n,t,e){let l,{$$slots:s={},$$scope:r}=t;const{saveAs:o}=Kn,i=ue("i18n");ot(n,i,D=>e(3,l=D));let{shareEnabled:a=!1}=t,{shareHandler:u}=t,{downloadHandler:c}=t,{chat:d}=t,{onClose:y=()=>{}}=t;const v=async()=>{const D=d.chat;console.log("download",d);const B=D.messages.reduce((C,N,T,$)=>`${C}### ${N.role.toUpperCase()}
${N.content}

`,"");let V=new Blob([B],{type:"text/plain"});o(V,`chat-${D.title}.txt`)},_=async()=>{const D=d.chat;console.log("download",d);const B=await xn(D),V=window.URL.createObjectURL(B),C=document.createElement("a");C.href=V,C.download=`chat-${D.title}.pdf`,document.body.appendChild(C),C.click(),document.body.removeChild(C),window.URL.revokeObjectURL(V)},b=()=>{u()},h=()=>{v()},w=()=>{_()},E=D=>{D.detail===!1&&y()};return n.$$set=D=>{"shareEnabled"in D&&e(7,a=D.shareEnabled),"shareHandler"in D&&e(0,u=D.shareHandler),"downloadHandler"in D&&e(8,c=D.downloadHandler),"chat"in D&&e(1,d=D.chat),"onClose"in D&&e(2,y=D.onClose),"$$scope"in D&&e(14,r=D.$$scope)},[u,d,y,l,i,v,_,a,c,s,b,h,w,E,r]}class Wo extends Gt{constructor(t){super(),Jt(this,t,qo,Fo,Zt,{shareEnabled:7,shareHandler:0,downloadHandler:8,chat:1,onClose:2})}}function Fl(n){let t,e,l;function s(o){n[15](o)}let r={showSetDefault:!n[2]};return n[0]!==void 0&&(r.selectedModels=n[0]),t=new No({props:r}),gt.push(()=>Ot(t,"selectedModels",s)),{c(){rt(t.$$.fragment)},l(o){it(t.$$.fragment,o)},m(o,i){at(t,o,i),l=!0},p(o,i){const a={};i&4&&(a.showSetDefault=!o[2]),!e&&i&1&&(e=!0,a.selectedModels=o[0],Nt(()=>e=!1)),t.$set(a)},i(o){l||(H(t.$$.fragment,o),l=!0)},o(o){R(t.$$.fragment,o),l=!1},d(o){ct(t,o)}}}function ql(n){let t,e;return t=new Wo({props:{chat:n[3],shareEnabled:n[2],shareHandler:n[16],downloadHandler:n[17],$$slots:{default:[Zo]},$$scope:{ctx:n}}}),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,s){const r={};s&8&&(r.chat=l[3]),s&4&&(r.shareEnabled=l[2]),s&32&&(r.shareHandler=l[16]),s&64&&(r.downloadHandler=l[17]),s&2097152&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(H(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function Zo(n){let t,e='<div class="m-auto self-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"></path></svg></div>';return{c(){t=I("button"),t.innerHTML=e,this.h()},l(l){t=M(l,"BUTTON",{class:!0,id:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-9m6068"&&(t.innerHTML=e),this.h()},h(){f(t,"class","hidden md:flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition"),f(t,"id","chat-context-menu-button")},m(l,s){L(l,t,s)},p:Dt,d(l){l&&m(t)}}}function Go(n){let t,e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"></path><path d="M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"></path></svg>',s,r,o;return{c(){t=I("button"),e=I("div"),e.innerHTML=l,this.h()},l(i){t=M(i,"BUTTON",{id:!0,class:!0});var a=S(t);e=M(a,"DIV",{class:!0,"data-svelte-h":!0}),Kt(e)!=="svelte-1fcii9y"&&(e.innerHTML=l),a.forEach(m),this.h()},h(){f(e,"class","m-auto self-center"),f(t,"id","new-chat-button"),f(t,"class",s="flex "+(n[8]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition")},m(i,a){L(i,t,a),k(t,e),r||(o=tt(t,"click",n[18]),r=!0)},p(i,a){a&256&&s!==(s="flex "+(i[8]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition")&&f(t,"class",s)},d(i){i&&m(t),r=!1,o()}}}function Wl(n){let t,e;return t=new Jn({props:{className:"max-w-[200px]",role:n[10].role,$$slots:{default:[Jo]},$$scope:{ctx:n}}}),t.$on("show",n[19]),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,s){const r={};s&1024&&(r.role=l[10].role),s&2098176&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(H(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function Jo(n){let t,e,l,s;return{c(){t=I("button"),e=I("div"),l=I("img"),this.h()},l(r){t=M(r,"BUTTON",{class:!0,"aria-label":!0});var o=S(t);e=M(o,"DIV",{class:!0});var i=S(e);l=M(i,"IMG",{src:!0,class:!0,alt:!0,draggable:!0}),i.forEach(m),o.forEach(m),this.h()},h(){ke(l.src,s=n[10].profile_image_url)||f(l,"src",s),f(l,"class","size-6 object-cover rounded-full"),f(l,"alt","User profile"),f(l,"draggable","false"),f(e,"class","self-center"),f(t,"class","select-none flex rounded-xl p-1.5 w-full hover:bg-gray-100 dark:hover:bg-gray-850 transition"),f(t,"aria-label","User Menu")},m(r,o){L(r,t,o),k(t,e),k(e,l)},p(r,o){o&1024&&!ke(l.src,s=r[10].profile_image_url)&&f(l,"src",s)},d(r){r&&m(t)}}}function Qo(n){let t,e,l,s,r,o,i,a,u,c,d,y,v,_,b,h,w,E,D,B,V;function C(G){n[13](G)}let N={chatId:n[7]};n[5]!==void 0&&(N.show=n[5]),t=new Gn({props:N}),gt.push(()=>Ot(t,"show",C)),c=new $n({});let T=n[4]&&Fl(n),$=n[2]&&ql(n);w=new he({props:{content:n[9].t("New Chat"),$$slots:{default:[Go]},$$scope:{ctx:n}}});let P=n[10]!==void 0&&Wl(n);return{c(){rt(t.$$.fragment),l=Q(),s=I("nav"),r=I("div"),o=I("div"),i=I("div"),a=I("button"),u=I("div"),rt(c.$$.fragment),y=Q(),v=I("div"),T&&T.c(),_=Q(),b=I("div"),$&&$.c(),h=Q(),rt(w.$$.fragment),E=Q(),P&&P.c(),this.h()},l(G){it(t.$$.fragment,G),l=Y(G),s=M(G,"NAV",{id:!0,class:!0});var U=S(s);r=M(U,"DIV",{class:!0});var A=S(r);o=M(A,"DIV",{class:!0});var et=S(o);i=M(et,"DIV",{class:!0});var bt=S(i);a=M(bt,"BUTTON",{id:!0,class:!0});var vt=S(a);u=M(vt,"DIV",{class:!0});var Wt=S(u);it(c.$$.fragment,Wt),Wt.forEach(m),vt.forEach(m),bt.forEach(m),y=Y(et),v=M(et,"DIV",{class:!0});var At=S(v);T&&T.l(At),At.forEach(m),_=Y(et),b=M(et,"DIV",{class:!0});var It=S(b);$&&$.l(It),h=Y(It),it(w.$$.fragment,It),E=Y(It),P&&P.l(It),It.forEach(m),et.forEach(m),A.forEach(m),U.forEach(m),this.h()},h(){f(u,"class","m-auto self-center"),f(a,"id","sidebar-toggle-button"),f(a,"class","cursor-pointer px-2 py-2 flex rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition"),f(i,"class",d=(n[8]?"md:hidden":"")+" mr-3 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),f(v,"class","flex-1 overflow-hidden max-w-full"),f(b,"class","self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),f(o,"class","flex items-center w-full max-w-full"),f(r,"class","flex max-w-full w-full mx-auto px-5 pt-0.5 md:px-[1rem]"),f(s,"id","nav"),f(s,"class","sticky py-2.5 top-0 flex flex-row justify-center z-30")},m(G,U){at(t,G,U),L(G,l,U),L(G,s,U),k(s,r),k(r,o),k(o,i),k(i,a),k(a,u),at(c,u,null),k(o,y),k(o,v),T&&T.m(v,null),k(o,_),k(o,b),$&&$.m(b,null),k(b,h),at(w,b,null),k(b,E),P&&P.m(b,null),D=!0,B||(V=tt(a,"click",n[14]),B=!0)},p(G,[U]){const A={};U&128&&(A.chatId=G[7]),!e&&U&32&&(e=!0,A.show=G[5],Nt(()=>e=!1)),t.$set(A),(!D||U&256&&d!==(d=(G[8]?"md:hidden":"")+" mr-3 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"))&&f(i,"class",d),G[4]?T?(T.p(G,U),U&16&&H(T,1)):(T=Fl(G),T.c(),H(T,1),T.m(v,null)):T&&(zt(),R(T,1,1,()=>{T=null}),Ft()),G[2]?$?($.p(G,U),U&4&&H($,1)):($=ql(G),$.c(),H($,1),$.m(b,h)):$&&(zt(),R($,1,1,()=>{$=null}),Ft());const et={};U&512&&(et.content=G[9].t("New Chat")),U&2097410&&(et.$$scope={dirty:U,ctx:G}),w.$set(et),G[10]!==void 0?P?(P.p(G,U),U&1024&&H(P,1)):(P=Wl(G),P.c(),H(P,1),P.m(b,null)):P&&(zt(),R(P,1,1,()=>{P=null}),Ft())},i(G){D||(H(t.$$.fragment,G),H(c.$$.fragment,G),H(T),H($),H(w.$$.fragment,G),H(P),D=!0)},o(G){R(t.$$.fragment,G),R(c.$$.fragment,G),R(T),R($),R(w.$$.fragment,G),R(P),D=!1},d(G){G&&(m(l),m(s)),ct(t,G),ct(c),T&&T.d(),$&&$.d(),ct(w),P&&P.d(),B=!1,V()}}}function Yo(n,t,e){let l,s,r,o,i;ot(n,on,T=>e(20,l=T)),ot(n,we,T=>e(7,s=T)),ot(n,Oe,T=>e(8,r=T)),ot(n,rn,T=>e(10,i=T));const a=ue("i18n");ot(n,a,T=>e(9,o=T));let{initNewChat:u}=t,{title:c=l}=t,{shareEnabled:d=!1}=t,{chat:y}=t,{selectedModels:v}=t,{showModelSelector:_=!0}=t,b=!1,h=!1;function w(T){b=T,e(5,b)}const E=()=>{Oe.set(!r)};function D(T){v=T,e(0,v)}const B=()=>{e(5,b=!b)},V=()=>{e(6,h=!h)},C=()=>{u()},N=T=>{T.detail==="archived-chat"&&kn.set(!0)};return n.$$set=T=>{"initNewChat"in T&&e(1,u=T.initNewChat),"title"in T&&e(12,c=T.title),"shareEnabled"in T&&e(2,d=T.shareEnabled),"chat"in T&&e(3,y=T.chat),"selectedModels"in T&&e(0,v=T.selectedModels),"showModelSelector"in T&&e(4,_=T.showModelSelector)},[v,u,d,y,_,b,h,s,r,o,i,a,c,w,E,D,B,V,C,N]}class Xo extends Gt{constructor(t){super(),Jt(this,t,Yo,Qo,Zt,{initNewChat:1,title:12,shareEnabled:2,chat:3,selectedModels:0,showModelSelector:4})}}function Ko(n){let t,e,l,s,r,o,i;return a(),{feed:u,reset:a};function a(){t=!0,e="",l=0,s=-1,r=void 0,o=void 0,i=""}function u(d){e=e?e+d:d,t&&xo(e)&&(e=e.slice(dn.length)),t=!1;const y=e.length;let v=0,_=!1;for(;v<y;){_&&(e[v]===`
`&&++v,_=!1);let b=-1,h=s,w;for(let E=l;b<0&&E<y;++E)w=e[E],w===":"&&h<0?h=E-v:w==="\r"?(_=!0,b=E-v):w===`
`&&(b=E-v);if(b<0){l=y-v,s=h;break}else l=0,s=-1;c(e,v,h,b),v+=b+1}v===y?e="":v>0&&(e=e.slice(v))}function c(d,y,v,_){if(_===0){i.length>0&&(n({type:"event",id:r,event:o||void 0,data:i.slice(0,-1)}),i="",r=void 0),o=void 0;return}const b=v<0,h=d.slice(y,y+(b?_:v));let w=0;b?w=_:d[y+v+1]===" "?w=v+2:w=v+1;const E=y+w,D=_-w,B=d.slice(E,E+D).toString();if(h==="data")i+=B?"".concat(B,`
`):`
`;else if(h==="event")o=B;else if(h==="id"&&!B.includes("\0"))r=B;else if(h==="retry"){const V=parseInt(B,10);Number.isNaN(V)||n({type:"reconnect-interval",value:V})}}}const dn=[239,187,191];function xo(n){return dn.every((t,e)=>n.charCodeAt(e)===t)}class $o extends TransformStream{constructor(){let t;super({start(e){t=Ko(l=>{l.type==="event"&&e.enqueue(l)})},transform(e){t.feed(e)}})}}async function tr(n,t){const e=n.pipeThrough(new TextDecoderStream).pipeThrough(new $o).getReader();let l=er(e);return t&&(l=lr(l)),l}async function*er(n){var t,e,l;for(;;){const{value:s,done:r}=await n.read();if(r){yield{done:!0,value:""};break}if(!s)continue;const o=s.data;if(o.startsWith("[DONE]")){yield{done:!0,value:""};break}try{const i=JSON.parse(o);if(console.log(i),i.error){yield{done:!0,value:"",error:i.error};break}if(i.citations){yield{done:!1,value:"",citations:i.citations};continue}yield{done:!1,value:((l=(e=(t=i.choices)==null?void 0:t[0])==null?void 0:e.delta)==null?void 0:l.content)??"",usage:i.usage}}catch(i){console.error("Error extracting delta from SSE event:",i)}}}async function*lr(n){for await(const t of n){if(t.done){yield t;return}if(t.citations){yield t;continue}let e=t.value;if(e.length<5){yield{done:!1,value:e};continue}for(;e!="";){const l=Math.min(Math.floor(Math.random()*3)+1,e.length);yield{done:!1,value:e.slice(0,l)},(document==null?void 0:document.visibilityState)!=="hidden"&&await nr(5),e=e.slice(l)}}}const nr=n=>new Promise(t=>setTimeout(t,n));function Zl(n){let t,e=n[2]&&Gl(n);return{c(){e&&e.c(),t=Ht()},l(l){e&&e.l(l),t=Ht()},m(l,s){e&&e.m(l,s),L(l,t,s)},p(l,s){l[2]?e?(e.p(l,s),s&4&&H(e,1)):(e=Gl(l),e.c(),H(e,1),e.m(t.parentNode,t)):e&&(zt(),R(e,1,1,()=>{e=null}),Ft())},d(l){l&&m(t),e&&e.d(l)}}}function Gl(n){let t,e,l,s,r=n[1].type+"",o,i,a,u,c,d=n[1].content+"",y,v,_,b,h,w,E=n[1].url&&Jl(),D=n[1].url&&Ql(),B=n[1].dismissible&&Yl(n);return{c(){t=I("div"),e=I("div"),l=I("div"),s=I("div"),o=pt(r),a=Q(),E&&E.c(),u=Q(),c=I("div"),y=pt(d),v=Q(),D&&D.c(),_=Q(),b=I("div"),B&&B.c(),this.h()},l(V){t=M(V,"DIV",{class:!0});var C=S(t);e=M(C,"DIV",{class:!0});var N=S(e);l=M(N,"DIV",{class:!0});var T=S(l);s=M(T,"DIV",{class:!0});var $=S(s);o=_t($,r),$.forEach(m),a=Y(T),E&&E.l(T),T.forEach(m),u=Y(N),c=M(N,"DIV",{class:!0});var P=S(c);y=_t(P,d),P.forEach(m),N.forEach(m),v=Y(C),D&&D.l(C),_=Y(C),b=M(C,"DIV",{class:!0});var G=S(b);B&&B.l(G),G.forEach(m),C.forEach(m),this.h()},h(){f(s,"class",i="text-xs font-black "+(n[3][n[1].type]??n[3].info)+" w-fit px-2 rounded uppercase line-clamp-1 mr-0.5"),f(l,"class","flex justify-between self-start"),f(c,"class","flex-1 text-xs text-gray-700 dark:text-white"),f(e,"class","flex flex-col md:flex-row md:items-center flex-1 text-sm w-fit gap-1.5"),f(b,"class","flex self-start"),f(t,"class","top-0 left-0 right-0 p-2 mx-4 px-3 flex justify-center items-center relative rounded-xl border border-gray-50 dark:border-gray-850 text-gray-800 dark:text-gary-100 bg-white dark:bg-gray-900 backdrop-blur-xl z-40")},m(V,C){L(V,t,C),k(t,e),k(e,l),k(l,s),k(s,o),k(l,a),E&&E.m(l,null),k(e,u),k(e,c),k(c,y),k(t,v),D&&D.m(t,null),k(t,_),k(t,b),B&&B.m(b,null),w=!0},p(V,C){(!w||C&2)&&r!==(r=V[1].type+"")&&Et(o,r),(!w||C&2&&i!==(i="text-xs font-black "+(V[3][V[1].type]??V[3].info)+" w-fit px-2 rounded uppercase line-clamp-1 mr-0.5"))&&f(s,"class",i),V[1].url?E||(E=Jl(),E.c(),E.m(l,null)):E&&(E.d(1),E=null),(!w||C&2)&&d!==(d=V[1].content+"")&&Et(y,d),V[1].url?D||(D=Ql(),D.c(),D.m(t,_)):D&&(D.d(1),D=null),V[1].dismissible?B?B.p(V,C):(B=Yl(V),B.c(),B.m(b,null)):B&&(B.d(1),B=null)},i(V){w||(V&&Le(()=>{w&&(h||(h=Ne(t,al,{delay:100,duration:300},!0)),h.run(1))}),w=!0)},o(V){V&&(h||(h=Ne(t,al,{delay:100,duration:300},!1)),h.run(0)),w=!1},d(V){V&&m(t),E&&E.d(),D&&D.d(),B&&B.d(),V&&h&&h.end()}}}function Jl(n){let t,e='<a class="text-gray-700 dark:text-white text-xs font-bold underline" href="/assets/files/whitepaper.pdf" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-4 h-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){t=I("div"),t.innerHTML=e,this.h()},l(l){t=M(l,"DIV",{class:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-1ofrdjc"&&(t.innerHTML=e),this.h()},h(){f(t,"class","flex md:hidden group w-fit md:items-center")},m(l,s){L(l,t,s)},d(l){l&&m(t)}}}function Ql(n){let t,e='<a class="text-gray-700 dark:text-white text-xs font-bold underline" href="/" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){t=I("div"),t.innerHTML=e,this.h()},l(l){t=M(l,"DIV",{class:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-15ujvd1"&&(t.innerHTML=e),this.h()},h(){f(t,"class","hidden md:flex group w-fit md:items-center")},m(l,s){L(l,t,s)},d(l){l&&m(t)}}}function Yl(n){let t,e="×",l,s;return{c(){t=I("button"),t.textContent=e,this.h()},l(r){t=M(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-17pf3tf"&&(t.textContent=e),this.h()},h(){f(t,"class","-mt-[3px] ml-1.5 mr-1 text-gray-400 dark:hover:text-white h-1")},m(r,o){L(r,t,o),l||(s=tt(t,"click",n[5]),l=!0)},p:Dt,d(r){r&&m(t),l=!1,s()}}}function sr(n){let t,e=!n[0]&&Zl(n);return{c(){e&&e.c(),t=Ht()},l(l){e&&e.l(l),t=Ht()},m(l,s){e&&e.m(l,s),L(l,t,s)},p(l,[s]){l[0]?e&&(e.d(1),e=null):e?e.p(l,s):(e=Zl(l),e.c(),e.m(t.parentNode,t))},i:Dt,o:Dt,d(l){l&&m(t),e&&e.d(l)}}}function or(n,t,e){const l=qe();let{banner:s={id:"",type:"info",title:"",content:"",url:"",dismissable:!0,timestamp:Math.floor(Date.now()/1e3)}}=t,{dismissed:r=!1}=t,o=!1;const i={info:"bg-blue-500/20 text-blue-700 dark:text-blue-200 ",success:"bg-green-500/20 text-green-700 dark:text-green-200",warning:"bg-yellow-500/20 text-yellow-700 dark:text-yellow-200",error:"bg-red-500/20 text-red-700 dark:text-red-200"},a=c=>{e(0,r=!0),l("dismiss",c)};We(()=>{e(2,o=!0)});const u=()=>{a(s.id)};return n.$$set=c=>{"banner"in c&&e(1,s=c.banner),"dismissed"in c&&e(0,r=c.dismissed)},[r,s,o,i,a,u]}class rr extends Gt{constructor(t){super(),Jt(this,t,or,sr,Zt,{banner:1,dismissed:0})}}const{document:Fe}=_n;function Xl(n,t,e){const l=n.slice();return l[62]=t[e],l}function Kl(n){let t,e,l,s,r,o,i,a,u,c,d,y,v,_,b,h,w,E,D,B,V,C,N,T,$,P;function G(q){n[25](q)}function U(q){n[26](q)}let A={title:n[10],shareEnabled:n[13].length>0,chat:n[9],initNewChat:n[19]};n[6]!==void 0&&(A.selectedModels=n[6]),n[5]!==void 0&&(A.showModelSelector=n[5]),e=new Xo({props:A}),gt.push(()=>Ot(e,"selectedModels",G)),gt.push(()=>Ot(e,"showModelSelector",U));let et=n[17].length>0&&!n[14]&&n[6].length<=1&&xl(n);function bt(q){n[29](q)}function vt(q){n[30](q)}function Wt(q){n[31](q)}function At(q){n[32](q)}let It={chatId:n[14],selectedModels:n[6],processing:ar,bottomPadding:n[12].length>0,sendPrompt:n[21],continueGeneration:n[24],regenerateResponse:n[23]};n[1]!==void 0&&(It.history=n[1]),n[13]!==void 0&&(It.messages=n[13]),n[3]!==void 0&&(It.autoScroll=n[3]),n[11]!==void 0&&(It.prompt=n[11]),c=new Un({props:It}),gt.push(()=>Ot(c,"history",bt)),gt.push(()=>Ot(c,"messages",vt)),gt.push(()=>Ot(c,"autoScroll",Wt)),gt.push(()=>Ot(c,"prompt",At));function Lt(q){n[35](q)}function Vt(q){n[36](q)}function qt(q){n[37](q)}function Yt(q){n[38](q)}function Qt(q){n[39](q)}let z={selectedModels:n[6],messages:n[13],submitPrompt:n[20],stopResponse:n[22]};return n[12]!==void 0&&(z.files=n[12]),n[11]!==void 0&&(z.prompt=n[11]),n[3]!==void 0&&(z.autoScroll=n[3]),n[8]!==void 0&&(z.webSearchEnabled=n[8]),n[7]!==void 0&&(z.atSelectedModel=n[7]),w=new Io({props:z}),gt.push(()=>Ot(w,"files",Lt)),gt.push(()=>Ot(w,"prompt",Vt)),gt.push(()=>Ot(w,"autoScroll",qt)),gt.push(()=>Ot(w,"webSearchEnabled",Yt)),gt.push(()=>Ot(w,"atSelectedModel",Qt)),{c(){t=I("div"),rt(e.$$.fragment),r=Q(),et&&et.c(),o=Q(),i=I("div"),a=I("div"),u=I("div"),rt(c.$$.fragment),h=Q(),rt(w.$$.fragment),this.h()},l(q){t=M(q,"DIV",{class:!0});var nt=S(t);it(e.$$.fragment,nt),r=Y(nt),et&&et.l(nt),o=Y(nt),i=M(nt,"DIV",{class:!0});var Ut=S(i);a=M(Ut,"DIV",{class:!0,id:!0});var Rt=S(a);u=M(Rt,"DIV",{class:!0});var ut=S(u);it(c.$$.fragment,ut),ut.forEach(m),Rt.forEach(m),h=Y(Ut),it(w.$$.fragment,Ut),Ut.forEach(m),nt.forEach(m),this.h()},h(){f(u,"class",b="h-full w-full flex flex-col "+(n[0]?"py-4":"pt-2 pb-4")),f(a,"class","pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0 max-w-full"),f(a,"id","messages-container"),f(i,"class","flex flex-col flex-auto"),f(t,"class",N="min-h-screen max-h-screen "+(n[16]?"md:max-w-[calc(100%-260px)]":"")+" w-full max-w-full flex flex-col")},m(q,nt){L(q,t,nt),at(e,t,null),k(t,r),et&&et.m(t,null),k(t,o),k(t,i),k(i,a),k(a,u),at(c,u,null),n[33](a),k(i,h),at(w,i,null),T=!0,$||(P=tt(a,"scroll",n[34]),$=!0)},p(q,nt){const Ut={};nt[0]&1024&&(Ut.title=q[10]),nt[0]&8192&&(Ut.shareEnabled=q[13].length>0),nt[0]&512&&(Ut.chat=q[9]),!l&&nt[0]&64&&(l=!0,Ut.selectedModels=q[6],Nt(()=>l=!1)),!s&&nt[0]&32&&(s=!0,Ut.showModelSelector=q[5],Nt(()=>s=!1)),e.$set(Ut),q[17].length>0&&!q[14]&&q[6].length<=1?et?(et.p(q,nt),nt[0]&147520&&H(et,1)):(et=xl(q),et.c(),H(et,1),et.m(t,o)):et&&(zt(),R(et,1,1,()=>{et=null}),Ft());const Rt={};nt[0]&16384&&(Rt.chatId=q[14]),nt[0]&64&&(Rt.selectedModels=q[6]),nt[0]&4096&&(Rt.bottomPadding=q[12].length>0),!d&&nt[0]&2&&(d=!0,Rt.history=q[1],Nt(()=>d=!1)),!y&&nt[0]&8192&&(y=!0,Rt.messages=q[13],Nt(()=>y=!1)),!v&&nt[0]&8&&(v=!0,Rt.autoScroll=q[3],Nt(()=>v=!1)),!_&&nt[0]&2048&&(_=!0,Rt.prompt=q[11],Nt(()=>_=!1)),c.$set(Rt),(!T||nt[0]&1&&b!==(b="h-full w-full flex flex-col "+(q[0]?"py-4":"pt-2 pb-4")))&&f(u,"class",b);const ut={};nt[0]&64&&(ut.selectedModels=q[6]),nt[0]&8192&&(ut.messages=q[13]),!E&&nt[0]&4096&&(E=!0,ut.files=q[12],Nt(()=>E=!1)),!D&&nt[0]&2048&&(D=!0,ut.prompt=q[11],Nt(()=>D=!1)),!B&&nt[0]&8&&(B=!0,ut.autoScroll=q[3],Nt(()=>B=!1)),!V&&nt[0]&256&&(V=!0,ut.webSearchEnabled=q[8],Nt(()=>V=!1)),!C&&nt[0]&128&&(C=!0,ut.atSelectedModel=q[7],Nt(()=>C=!1)),w.$set(ut),(!T||nt[0]&65536&&N!==(N="min-h-screen max-h-screen "+(q[16]?"md:max-w-[calc(100%-260px)]":"")+" w-full max-w-full flex flex-col"))&&f(t,"class",N)},i(q){T||(H(e.$$.fragment,q),H(et),H(c.$$.fragment,q),H(w.$$.fragment,q),T=!0)},o(q){R(e.$$.fragment,q),R(et),R(c.$$.fragment,q),R(w.$$.fragment,q),T=!1},d(q){q&&m(t),ct(e),et&&et.d(),ct(c),n[33](null),ct(w),$=!1,P()}}}function xl(n){let t,e,l,s,r=le(n[17].filter(n[27])),o=[];for(let a=0;a<r.length;a+=1)o[a]=$l(Xl(n,r,a));const i=a=>R(o[a],1,1,()=>{o[a]=null});return{c(){t=I("div"),e=I("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){t=M(a,"DIV",{class:!0});var u=S(t);e=M(u,"DIV",{class:!0});var c=S(e);for(let d=0;d<o.length;d+=1)o[d].l(c);c.forEach(m),u.forEach(m),this.h()},h(){f(e,"class","flex flex-col gap-1 w-full"),f(t,"class",l="absolute top-[4.25rem] w-full "+(n[16]?"md:max-w-[calc(100%-260px)]":""))},m(a,u){L(a,t,u),k(t,e);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(e,null);s=!0},p(a,u){if(u[0]&131072){r=le(a[17].filter(a[27]));let c;for(c=0;c<r.length;c+=1){const d=Xl(a,r,c);o[c]?(o[c].p(d,u),H(o[c],1)):(o[c]=$l(d),o[c].c(),H(o[c],1),o[c].m(e,null))}for(zt(),c=r.length;c<o.length;c+=1)i(c);Ft()}(!s||u[0]&65536&&l!==(l="absolute top-[4.25rem] w-full "+(a[16]?"md:max-w-[calc(100%-260px)]":"")))&&f(t,"class",l)},i(a){if(!s){for(let u=0;u<r.length;u+=1)H(o[u]);s=!0}},o(a){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)R(o[u]);s=!1},d(a){a&&m(t),Ee(o,a)}}}function $l(n){let t,e;return t=new rr({props:{banner:n[62]}}),t.$on("dismiss",n[28]),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,s){const r={};s[0]&131072&&(r.banner=l[62]),t.$set(r)},i(l){e||(H(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function ir(n){let t,e,l,s;Fe.title=t=`
		`+(n[10]?`${n[10].length>30?`${n[10].slice(0,30)}...`:n[10]} | ${n[15]}`:`${n[15]}`)+`
	`;let r=(!n[0]||n[2]&&n[0])&&Kl(n);return{c(){e=Q(),r&&r.c(),l=Ht()},l(o){pn("svelte-1123lr8",Fe.head).forEach(m),e=Y(o),r&&r.l(o),l=Ht()},m(o,i){L(o,e,i),r&&r.m(o,i),L(o,l,i),s=!0},p(o,i){(!s||i[0]&33792)&&t!==(t=`
		`+(o[10]?`${o[10].length>30?`${o[10].slice(0,30)}...`:o[10]} | ${o[15]}`:`${o[15]}`)+`
	`)&&(Fe.title=t),!o[0]||o[2]&&o[0]?r?(r.p(o,i),i[0]&5&&H(r,1)):(r=Kl(o),r.c(),H(r,1),r.m(l.parentNode,l)):r&&(zt(),R(r,1,1,()=>{r=null}),Ft())},i(o){s||(H(r),s=!0)},o(o){R(r),s=!1},d(o){o&&(m(e),m(l)),r&&r.d(o)}}}let ar="";function cr(n,t,e){let l,s,r,o,i,a,u,c,d,y;ot(n,we,g=>e(14,l=g)),ot(n,ce,g=>e(43,s=g)),ot(n,Pe,g=>e(44,r=g)),ot(n,rn,g=>e(46,i=g)),ot(n,bn,g=>e(47,a=g)),ot(n,nn,g=>e(48,u=g)),ot(n,on,g=>e(15,c=g)),ot(n,Oe,g=>e(16,d=g)),ot(n,yn,g=>e(17,y=g));const v=ue("i18n");ot(n,v,g=>e(45,o=g));let{chatIdProp:_=""}=t,b=!1,h=!1,w=!0,E,D=null,B=!0,V=[""],C,N=!1,T=null,$="",P="",G=[],U=[],A={messages:{},currentId:null};We(async()=>{l?(s.saveChatHistory??!0)||await Ue("/"):await et()});const et=async()=>{var x;D!==null&&(await ol(localStorage.token,D),D=null),window.history.replaceState(A.state,"","/"),await we.set(""),e(3,w=!0),e(10,$=""),e(13,U=[]),e(1,A={messages:{},currentId:null}),a.url.searchParams.get("models")?e(6,V=(x=a.url.searchParams.get("models"))==null?void 0:x.split(",")):s!=null&&s.models?e(6,V=s==null?void 0:s.models):u!=null&&u.default_models?(console.log((u==null?void 0:u.default_models.split(","))??""),e(6,V=u==null?void 0:u.default_models.split(","))):e(6,V=[""]),a.url.searchParams.get("q")&&(e(11,P=a.url.searchParams.get("q")??""),P&&(await yt(),At(P))),e(6,V=V.map(J=>r.map(j=>j.id).includes(J)?J:""));const g=await rl(localStorage.token);g?ce.set(g.ui):ce.set(JSON.parse(localStorage.getItem("settings")??"{}"));const O=document.getElementById("chat-textarea");setTimeout(()=>O==null?void 0:O.focus(),0)},bt=async()=>{if(we.set(_),e(9,T=await Bn(localStorage.token,l).catch(async g=>(await Ue("/"),null))),T){await ut();const g=T.chat;if(g){console.log(g),e(6,V=((g==null?void 0:g.models)??void 0)!==void 0?g.models:[g.models??""]),e(1,A=((g==null?void 0:g.history)??void 0)!==void 0?g.history:Sn(g.messages)),e(10,$=g.title);const O=await rl(localStorage.token);return O?await ce.set(O.ui):await ce.set(JSON.parse(localStorage.getItem("settings")??"{}")),await ce.set({...s,system:g.system??s.system,params:g.options??s.params}),e(3,w=!0),await yt(),U.length>0&&e(1,A.messages[U.at(-1).id].done=!0,A),await yt(),!0}else return null}},vt=async()=>{await yt(),E&&e(4,E.scrollTop=E.scrollHeight,E)},Wt=g=>{const O=A.messages[g];return O.parentId?[...Wt(O.parentId),O]:[O]},At=async(g,O=null)=>{if(console.log("submitPrompt",l),e(6,V=V.map(x=>r.map(J=>J.id).includes(x)?x:"")),V.includes(""))ht.error(o.t("Model not selected"));else if(U.length!=0&&U.at(-1).done!=!0)console.log("wait");else if(G.length>0&&G.filter(x=>x.upload_status===!1).length>0)ht.error(o.t("Oops! Hold tight! Your files are still in the processing oven. We're cooking them up to perfection. Please be patient and we'll let you know once they're ready."));else{document.getElementById("chat-textarea").style.height="";let x=ll(),J={id:x,parentId:U.length!==0?U.at(-1).id:null,childrenIds:[],role:"user",user:O??void 0,content:g,files:G.length>0?G:void 0,timestamp:Math.floor(Date.now()/1e3),models:V.filter((j,Z)=>V.indexOf(j)===Z)};e(1,A.messages[x]=J,A),e(1,A.currentId=x,A),U.length!==0&&A.messages[U.at(-1).id].childrenIds.push(x),await yt(),U.length==1&&(s.saveChatHistory??!0?(e(9,T=await Vn(localStorage.token,{id:l,title:o.t("New Chat"),models:V,system:s.system??void 0,options:{...s.params??{}},messages:U,history:A,tags:[],timestamp:Date.now()})),await Te.set(await Ve(localStorage.token)),await we.set(T.id)):await we.set("local"),await yt()),e(11,P=""),document.getElementById("chat-textarea").style.height="",e(12,G=[]),await It(g,x)}},It=async(g,O,x=null)=>{const J=JSON.parse(JSON.stringify(l));await Promise.all((x?[x]:C!==void 0?[C.id]:V).map(async j=>{var kt,Mt,wt;console.log("modelId",j);const Z=r.filter(jt=>jt.id===j).at(0);if(Z){U.some(W=>{var F;return(F=W.files)==null?void 0:F.some(ft=>ft.type==="image")})&&!(((wt=(Mt=(kt=Z.info)==null?void 0:kt.meta)==null?void 0:Mt.capabilities)==null?void 0:wt.vision)??!0)&&ht.error(o.t("Model {{modelName}} is not vision capable",{modelName:Z.name??Z.id}));let p=ll(),X={parentId:O,id:p,childrenIds:[],role:"assistant",content:"",model:Z.id,modelName:Z.name??Z.id,userContext:null,timestamp:Math.floor(Date.now()/1e3)};e(1,A.messages[p]=X,A),e(1,A.currentId=p,A),O!==null&&e(1,A.messages[O].childrenIds=[...A.messages[O].childrenIds,p],A),await yt();let lt=null;if(((s==null?void 0:s.memory)??!1)&&lt===null){const W=await Qn(localStorage.token,g).catch(F=>(ht.error(F),null));W&&(W.documents[0].length>0&&(lt=W.documents.reduce((F,ft,St)=>{const Bt=W.metadatas[St][0].created_at,st=new Date(Bt*1e3).toISOString().split("T")[0];return F.push(`${St+1}. [${st}]. ${ft[0]}`),F},[])),console.log(lt))}X.userContext=lt,N&&await Lt(Z.id,O,p),(Z==null?void 0:Z.owned_by)==="openai"?await qt(Z,g,p,J):Z&&await Vt(Z,g,p,J)}else ht.error(o.t("Model {{modelId}} not found",{modelId:j}))})),await Te.set(await Ve(localStorage.token))},Lt=async(g,O,x)=>{const J=A.messages[x];J.status={done:!1,action:"web_search",description:o.t("Generating search query")},e(13,U),e(1,A);const j=A.messages[O].content;let Z=j;if(j.length>100&&(Z=await Ut(g,j),!Z)){ht.warning(o.t("No search query generated")),J.status={...J.status,done:!0,error:!0,description:"No search query generated"},e(13,U),e(1,A);return}J.status={...J.status,description:o.t("Searching the web for '{{searchQuery}}'",{searchQuery:Z})},e(13,U),e(1,A);const kt=await Pn(localStorage.token,Z).catch(Mt=>(console.log(Mt),ht.error(Mt),null));kt?(J.status={...J.status,done:!0,description:o.t("Searched {{count}} sites",{count:kt.filenames.length}),urls:kt.filenames},((J==null?void 0:J.files)??!0)&&(J.files=[]),J.files.push({collection_name:kt.collection_name,name:Z,type:"web_search_results",urls:kt.filenames}),e(13,U),e(1,A)):(J.status={...J.status,done:!0,error:!0,description:"No search results found"},e(13,U),e(1,A))},Vt=async(g,O,x,J)=>{var p,X,lt,W;g=g.id;const j=A.messages[x];await yt(),vt();const Z=[s.system||((j==null?void 0:j.userContext)??null)?{role:"system",content:`${nl((s==null?void 0:s.system)??"",i.name)}${(j==null?void 0:j.userContext)??null?`

User Context:
${((j==null?void 0:j.userContext)??[]).join(`
`)}`:""}`}:void 0,...U].filter(F=>{var ft;return(ft=F==null?void 0:F.content)==null?void 0:ft.trim()}).map((F,ft,St)=>{var K;const Bt={role:F.role,content:F.content},st=(K=F.files)==null?void 0:K.filter(Xt=>Xt.type==="image").map(Xt=>Xt.url.slice(Xt.url.indexOf(",")+1));return st&&st.length>0&&F.role==="user"&&(Bt.images=st),Bt});let kt=-1;Z.forEach((F,ft)=>{F.images&&(kt=ft)}),Z.forEach((F,ft)=>{ft!==kt&&delete F.images});const Mt=U.filter(F=>(F==null?void 0:F.files)??null).map(F=>F.files.filter(ft=>["doc","collection","web_search_results"].includes(ft.type))).flat(1),[wt,jt]=await In(localStorage.token,{model:g,messages:Z,options:{...s.params??{},stop:((p=s==null?void 0:s.params)==null?void 0:p.stop)??void 0?s.params.stop.map(F=>decodeURIComponent(JSON.parse('"'+F.replace(/\"/g,'\\"')+'"'))):void 0,num_predict:((X=s==null?void 0:s.params)==null?void 0:X.max_tokens)??void 0,repeat_penalty:((lt=s==null?void 0:s.params)==null?void 0:lt.frequency_penalty)??void 0},format:s.requestFormat??void 0,keep_alive:s.keepAlive??void 0,docs:Mt.length>0?Mt:void 0,citations:Mt.length>0,chat_id:l});if(wt&&wt.ok){console.log("controller",jt);const F=wt.body.pipeThrough(new TextDecoderStream).pipeThrough(En(`
`)).getReader();for(;;){const{value:ft,done:St}=await F.read();if(St||h||J!==l){if(j.done=!0,e(13,U),e(1,A),h)jt.abort("User: Stop Response"),await ol(localStorage.token,D);else{const Bt=Wt(x),st=await cl(localStorage.token,{model:g,messages:Bt.map(K=>({id:K.id,role:K.role,content:K.content,timestamp:K.timestamp})),chat_id:l}).catch(K=>(console.error(K),null));if(st!==null)for(const K of st.messages)e(1,A.messages[K.id]={...A.messages[K.id],...A.messages[K.id].content!==K.content?{originalContent:A.messages[K.id].content}:{},...K},A)}D=null;break}try{let Bt=ft.split(`
`);for(const st of Bt)if(st!==""){console.log(st);let K=JSON.parse(st);if("citations"in K){j.citations=K.citations;continue}if("detail"in K)throw K;if("id"in K)console.log(K),D=K.id;else if(K.done==!1){if(j.content==""&&K.message.content==`
`)continue;j.content+=K.message.content,e(13,U),e(1,A)}else{if(j.done=!0,j.content==""&&(j.error={code:400,content:"Oops! No text generated from Ollama, Please try again."}),j.context=K.context??null,j.info={total_duration:K.total_duration,load_duration:K.load_duration,sample_count:K.sample_count,sample_duration:K.sample_duration,prompt_eval_count:K.prompt_eval_count,prompt_eval_duration:K.prompt_eval_duration,eval_count:K.eval_count,eval_duration:K.eval_duration},e(13,U),e(1,A),s.notificationEnabled&&!document.hasFocus()){const Xt=new Notification(selectedModelfile?`${selectedModelfile.title.charAt(0).toUpperCase()+selectedModelfile.title.slice(1)}`:`${g}`,{body:j.content,icon:(selectedModelfile==null?void 0:selectedModelfile.imageUrl)??`${He}/static/favicon.png`})}s.responseAutoCopy&&sl(j.content),s.responseAutoPlayback&&(await yt(),(W=document.getElementById(`speak-button-${j.id}`))==null||W.click())}}}catch(Bt){console.log(Bt),"detail"in Bt&&ht.error(Bt.detail);break}w&&vt()}l==J&&(s.saveChatHistory??!0)&&(e(9,T=await ze(localStorage.token,J,{messages:U,history:A,models:V})),await Te.set(await Ve(localStorage.token)))}else{if(wt!==null){const F=await wt.json();console.log(F),"detail"in F?(ht.error(F.detail),j.error={content:F.detail}):(ht.error(F.error),j.error={content:F.error})}else ht.error(o.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:"Ollama"})),j.error={content:o.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:"Ollama"})};j.done=!0,e(13,U),e(1,A)}if(h=!1,await yt(),w&&vt(),U.length==2&&U.at(1).content!==""){window.history.replaceState(A.state,"",`/c/${J}`);const F=await nt(O);await Rt(J,F)}},qt=async(g,O,x,J)=>{var kt,Mt,wt,jt,p,X,lt,W,F,ft;const j=A.messages[x],Z=U.filter(St=>(St==null?void 0:St.files)??null).map(St=>St.files.filter(Bt=>["doc","collection","web_search_results"].includes(Bt.type))).flat(1);console.log(Z),vt();try{const[St,Bt]=await Mn(localStorage.token,{model:g.id,stream:!0,stream_options:((wt=(Mt=(kt=g.info)==null?void 0:kt.meta)==null?void 0:Mt.capabilities)==null?void 0:wt.usage)??!1?{include_usage:!0}:void 0,messages:[s.system||((j==null?void 0:j.userContext)??null)?{role:"system",content:`${nl((s==null?void 0:s.system)??"",i.name)}${(j==null?void 0:j.userContext)??null?`

User Context:
${((j==null?void 0:j.userContext)??[]).join(`
`)}`:""}`}:void 0,...U].filter(st=>{var K;return(K=st==null?void 0:st.content)==null?void 0:K.trim()}).map((st,K,Xt)=>{var de;return{role:st.role,...((de=st.files)==null?void 0:de.filter(me=>me.type==="image").length)>0&&st.role==="user"?{content:[{type:"text",text:Xt.length-1!==K?st.content:(st==null?void 0:st.raContent)??st.content},...st.files.filter(me=>me.type==="image").map(me=>({type:"image_url",image_url:{url:me.url}}))]}:{content:Xt.length-1!==K?st.content:(st==null?void 0:st.raContent)??st.content}}}),seed:((jt=s==null?void 0:s.params)==null?void 0:jt.seed)??void 0,stop:((p=s==null?void 0:s.params)==null?void 0:p.stop)??void 0?s.params.stop.map(st=>decodeURIComponent(JSON.parse('"'+st.replace(/\"/g,'\\"')+'"'))):void 0,temperature:((X=s==null?void 0:s.params)==null?void 0:X.temperature)??void 0,top_p:((lt=s==null?void 0:s.params)==null?void 0:lt.top_p)??void 0,frequency_penalty:((W=s==null?void 0:s.params)==null?void 0:W.frequency_penalty)??void 0,max_tokens:((F=s==null?void 0:s.params)==null?void 0:F.max_tokens)??void 0,docs:Z.length>0?Z:void 0,citations:Z.length>0,chat_id:l},`${Re}`);if(await yt(),vt(),St&&St.ok&&St.body){const st=await tr(St.body,s.splitLargeChunks);let K=null;for await(const Xt of st){const{value:de,done:me,citations:Ge,error:Je,usage:Qe}=Xt;if(Je){await Yt(Je,null,g,j);break}if(me||h||J!==l){if(j.done=!0,e(13,U),e(1,A),h)Bt.abort("User: Stop Response");else{const mn=Wt(x),Ye=await cl(localStorage.token,{model:g.id,messages:mn.map(xt=>({id:xt.id,role:xt.role,content:xt.content,timestamp:xt.timestamp})),chat_id:l}).catch(xt=>(console.error(xt),null));if(Ye!==null)for(const xt of Ye.messages)e(1,A.messages[xt.id]={...A.messages[xt.id],...A.messages[xt.id].content!==xt.content?{originalContent:A.messages[xt.id].content}:{},...xt},A)}break}if(Qe&&(K=Qe),Ge){j.citations=Ge;continue}j.content==""&&de==`
`||(j.content+=de,e(13,U),e(1,A),w&&vt())}if(s.notificationEnabled&&!document.hasFocus()){const Xt=new Notification(`OpenAI ${g}`,{body:j.content,icon:`${He}/static/favicon.png`})}s.responseAutoCopy&&sl(j.content),s.responseAutoPlayback&&(await yt(),(ft=document.getElementById(`speak-button-${j.id}`))==null||ft.click()),K&&(j.info={...K,openai:!0}),l==J&&(s.saveChatHistory??!0)&&(e(9,T=await ze(localStorage.token,J,{models:V,messages:U,history:A})),await Te.set(await Ve(localStorage.token)))}else await Yt(null,St,g,j)}catch(St){await Yt(St,null,g,j)}if(e(13,U),e(1,A),h=!1,await yt(),w&&vt(),U.length==2){window.history.replaceState(A.state,"",`/c/${J}`);const St=await nt(O);await Rt(J,St)}},Yt=async(g,O,x,J)=>{let j="",Z;g?Z=g:O!==null&&(Z=await O.json()),console.error(Z),"detail"in Z?(ht.error(Z.detail),j=Z.detail):"error"in Z?"message"in Z.error?(ht.error(Z.error.message),j=Z.error.message):(ht.error(Z.error),j=Z.error):"message"in Z&&(ht.error(Z.message),j=Z.message),J.error={content:o.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:x.name??x.id})+`
`+j},J.done=!0,e(13,U),e(1,A)},Qt=()=>{h=!0,console.log("stopResponse")},z=async g=>{if(console.log("regenerateResponse"),U.length!=0){let O=A.messages[g.parentId],x=O.content;((O==null?void 0:O.models)??[...V]).length==1?await It(x,O.id):await It(x,O.id,g.model)}},q=async()=>{console.log("continueGeneration");const g=JSON.parse(JSON.stringify(l));if(U.length!=0&&U.at(-1).done==!0){const O=A.messages[A.currentId];O.done=!1,await yt();const x=r.filter(J=>J.id===O.model).at(0);x&&((x==null?void 0:x.owned_by)==="openai"?await qt(x,A.messages[O.parentId].content,O.id,g):await Vt(x,A.messages[O.parentId].content,O.id,g))}else ht.error(o.t("Model {{modelId}} not found",{modelId}))},nt=async g=>{var O,x,J,j;if(((O=s==null?void 0:s.title)==null?void 0:O.auto)??!0){const Z=r.find(jt=>jt.id===V[0]),kt=(Z==null?void 0:Z.owned_by)==="openai"?((x=s==null?void 0:s.title)==null?void 0:x.modelExternal)??V[0]:((J=s==null?void 0:s.title)==null?void 0:J.model)??V[0],Mt=r.find(jt=>jt.id===kt);return console.log(Mt),await Dn(localStorage.token,((j=s==null?void 0:s.title)==null?void 0:j.prompt)??o.t("Create a concise, 3-5 word phrase as a header for the following query, strictly adhering to the 3-5 word limit and avoiding the use of the word 'title':")+" {{prompt}}",kt,g,l,(Mt==null?void 0:Mt.owned_by)==="openai"?`${Re}`:`${$e}/v1`)}else return`${g}`},Ut=async(g,O)=>{var kt,Mt;const x=r.find(wt=>wt.id===g),J=(x==null?void 0:x.owned_by)==="openai"?((kt=s==null?void 0:s.title)==null?void 0:kt.modelExternal)??g:((Mt=s==null?void 0:s.title)==null?void 0:Mt.model)??g,j=r.find(wt=>wt.id===J),Z=U.filter(wt=>wt.role==="user").map(wt=>wt.content);return await Cn(localStorage.token,J,Z,O,(j==null?void 0:j.owned_by)==="openai"?`${Re}`:`${$e}/v1`)},Rt=async(g,O)=>{g===l&&e(10,$=O),(s.saveChatHistory??!0)&&(e(9,T=await ze(localStorage.token,g,{title:O})),await Te.set(await Ve(localStorage.token)))},ut=async()=>await Nn(localStorage.token,l).catch(async g=>[]);function Pt(g){V=g,e(6,V)}function ge(g){B=g,e(5,B)}const $t=g=>g.dismissible?!JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]").includes(g.id):!0,pe=g=>{const O=g.detail;localStorage.setItem("dismissedBannerIds",JSON.stringify([O,...JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]")].filter(x=>y.find(J=>J.id===x))))};function Ie(g){A=g,e(1,A)}function Me(g){U=g,e(13,U),e(1,A)}function De(g){w=g,e(3,w)}function fe(g){P=g,e(11,P)}function Ct(g){gt[g?"unshift":"push"](()=>{E=g,e(4,E)})}const Tt=g=>{e(3,w=E.scrollHeight-E.scrollTop<=E.clientHeight+5)};function Ce(g){G=g,e(12,G)}function _e(g){P=g,e(11,P)}function be(g){w=g,e(3,w)}function te(g){N=g,e(8,N)}function ve(g){C=g,e(7,C)}return n.$$set=g=>{"chatIdProp"in g&&e(0,_=g.chatIdProp)},n.$$.update=()=>{if(n.$$.dirty[0]&2)if(A.currentId!==null){let g=[],O=A.messages[A.currentId];for(;O!==null;)g.unshift({...O}),O=O.parentId!==null?A.messages[O.parentId]:null;e(13,U=g)}else e(13,U=[]);n.$$.dirty[0]&1&&_&&(async()=>{if(await bt()){await yt(),e(2,b=!0),window.setTimeout(()=>vt(),0);const g=document.getElementById("chat-textarea");g==null||g.focus()}else await Ue("/")})()},[_,A,b,w,E,B,V,C,N,T,$,P,G,U,l,c,d,y,v,et,At,It,Qt,z,q,Pt,ge,$t,pe,Ie,Me,De,fe,Ct,Tt,Ce,_e,be,te,ve]}class zr extends Gt{constructor(t){super(),Jt(this,t,cr,ir,Zt,{chatIdProp:0},null,[-1,-1,-1])}}export{zr as C};
//# sourceMappingURL=Chat.eae1030e.js.map
