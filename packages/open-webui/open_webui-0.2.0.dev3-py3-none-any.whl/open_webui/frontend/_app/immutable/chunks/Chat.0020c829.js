import{s as Zt,E as ne,F as se,G as oe,H as re,w as ft,e as At,i as U,d as m,I as Be,x as ce,y as $l,p as gt,f as S,g as I,h as E,L as ee,Z as ke,u as x,v as ue,U as Le,C as It,P as de,a as Y,l as _t,R as Yt,c as X,m as pt,j as f,r as w,n as yt,K as ye,t as kt,W as We,z as dt,A as mt,X as Ot,Q as Xe,O as fn,o as qe,S as we,B as dn,M as mn}from"./scheduler.bc5a4ea8.js";import{S as Gt,i as Jt,a as A,t as R,g as Rt,c as jt,h as tn,j as en,k as Ne,f as Ht,b as rt,d as it,m as at,e as ct}from"./index.5e522d2c.js";import{g as hn}from"./globals.7f7f1b26.js";import{e as le}from"./each.eda84b85.js";import{a as ht}from"./Toaster.svelte_svelte_type_style_lang.264cdd7d.js";import{g as Pe}from"./navigation.a54d0b03.js";import{p as gn}from"./stores.3ea588a2.js";import{p as _n,n as pn,e as Ue,c as ln,f as fe,i as Oe,m as nn,a as He,S as Ke,r as xe,W as sn,h as ve,u as bn,j as vn,o as wn,g as Ce,O as Re,v as $e}from"./index.a679fc74.js";import{f as on,r as je,i as tl,h as el,v as ll,s as kn,a as nl,j as yn}from"./index.9a95918f.js";import{s as En,r as Sn,t as In,v as Mn,M as rn,w as Dn,x as Cn,y as Tn,c as sl,z as Vn}from"./menu-trigger.f7b2c633.js";import{u as Bn,m as ol,c as Nn,b as Te,j as ze,i as On,w as Hn}from"./index.c91489ce.js";import{A as An,u as Ln,a as Un,b as Pn,r as Rn}from"./AddFilesPlaceholder.3f26eb89.js";import{t as rl}from"./index.8249a28b.js";import{M as jn}from"./Messages.d90ebaaa.js";import"./sha256.8dba905a.js";import{f as an,h as zn,T as he}from"./updater.0c1a7d23.js";import{D as cn,M as Ae,T as Fn,S as Wn,U as qn,q as Zn}from"./UserMenu.e45cc5c4.js";import{f as Ze}from"./index.e8e699b3.js";import{S as Gn,a as Jn}from"./Switch.79b696c5.js";import"./i18next.16542173.js";import{S as Qn}from"./Selector.99a0a800.js";import{d as Yn}from"./index.85c0bfdf.js";import{g as Ee}from"./spread.8a54911c.js";import{f as Xn}from"./FileSaver.min.898eb36f.js";import"./paths.33ef1b89.js";import{M as Kn}from"./MenuLines.cadd813b.js";import{f as il}from"./dayjs.min.8884afd3.js";import{p as al}from"./index.955a9245.js";const xn=n=>({subIds:n&1}),cl=n=>({subIds:n[0]});function $n(n){let t;const e=n[6].default,l=ne(e,n,n[5],cl);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,[r]){l&&l.p&&(!t||r&33)&&se(l,e,s,s[5],t?re(e,s[5],r,xn):oe(s[5]),cl)},i(s){t||(A(l,s),t=!0)},o(s){R(l,s),t=!1},d(s){l&&l.d(s)}}}function ts(n,t,e){let l,{$$slots:s={},$$scope:r}=t,{disabled:o=void 0}=t,{open:i=void 0}=t,{onOpenChange:a=void 0}=t;const{updateOption:u,ids:c,states:{subOpen:d}}=En({disabled:o,onOpenChange:({next:k})=>(i!==k&&(a==null||a(k),e(2,i=k)),k)}),p=Yn([c.menu,c.trigger],([k,g])=>({menu:k,trigger:g}));return ft(n,p,k=>e(0,l=k)),n.$$set=k=>{"disabled"in k&&e(3,o=k.disabled),"open"in k&&e(2,i=k.open),"onOpenChange"in k&&e(4,a=k.onOpenChange),"$$scope"in k&&e(5,r=k.$$scope)},n.$$.update=()=>{n.$$.dirty&4&&i!==void 0&&d.set(i),n.$$.dirty&8&&u("disabled",o)},[l,p,i,o,a,r,s]}class es extends Gt{constructor(t){super(),Jt(this,t,ts,$n,Zt,{disabled:3,open:2,onOpenChange:4})}}const ls=n=>({builder:n[0]&256}),ul=n=>({builder:n[8]}),ns=n=>({builder:n[0]&256}),fl=n=>({builder:n[8]}),ss=n=>({builder:n[0]&256}),dl=n=>({builder:n[8]}),os=n=>({builder:n[0]&256}),ml=n=>({builder:n[8]}),rs=n=>({builder:n[0]&256}),hl=n=>({builder:n[8]}),is=n=>({builder:n[0]&256}),gl=n=>({builder:n[8]});function as(n){let t,e,l,s;const r=n[28].default,o=ne(r,n,n[27],ul);let i=[n[8],n[13]],a={};for(let u=0;u<i.length;u+=1)a=ce(a,i[u]);return{c(){t=S("div"),o&&o.c(),this.h()},l(u){t=I(u,"DIV",{});var c=E(t);o&&o.l(c),c.forEach(m),this.h()},h(){ee(t,a)},m(u,c){U(u,t,c),o&&o.m(t,null),n[33](t),e=!0,l||(s=[ke(n[8].action(t)),x(t,"m-focusout",n[12]),x(t,"m-keydown",n[12]),x(t,"m-pointermove",n[12])],l=!0)},p(u,c){o&&o.p&&(!e||c[0]&134217984)&&se(o,r,u,u[27],e?re(r,u[27],c,ls):oe(u[27]),ul),ee(t,a=Ee(i,[c[0]&256&&u[8],c[0]&8192&&u[13]]))},i(u){e||(A(o,u),e=!0)},o(u){R(o,u),e=!1},d(u){u&&m(t),o&&o.d(u),n[33](null),l=!1,ue(s)}}}function cs(n){let t,e,l,s,r;const o=n[28].default,i=ne(o,n,n[27],fl);let a=[n[8],n[13]],u={};for(let c=0;c<a.length;c+=1)u=ce(u,a[c]);return{c(){t=S("div"),i&&i.c(),this.h()},l(c){t=I(c,"DIV",{});var d=E(t);i&&i.l(d),d.forEach(m),this.h()},h(){ee(t,u)},m(c,d){U(c,t,d),i&&i.m(t,null),n[32](t),l=!0,s||(r=[ke(n[8].action(t)),x(t,"m-focusout",n[12]),x(t,"m-keydown",n[12]),x(t,"m-pointermove",n[12])],s=!0)},p(c,d){n=c,i&&i.p&&(!l||d[0]&134217984)&&se(i,o,n,n[27],l?re(o,n[27],d,ns):oe(n[27]),fl),ee(t,u=Ee(a,[d[0]&256&&n[8],d[0]&8192&&n[13]]))},i(c){l||(A(i,c),e&&e.end(1),l=!0)},o(c){R(i,c),c&&(e=tn(t,n[5],n[6])),l=!1},d(c){c&&m(t),i&&i.d(c),n[32](null),c&&e&&e.end(),s=!1,ue(r)}}}function us(n){let t,e,l,s,r;const o=n[28].default,i=ne(o,n,n[27],dl);let a=[n[8],n[13]],u={};for(let c=0;c<a.length;c+=1)u=ce(u,a[c]);return{c(){t=S("div"),i&&i.c(),this.h()},l(c){t=I(c,"DIV",{});var d=E(t);i&&i.l(d),d.forEach(m),this.h()},h(){ee(t,u)},m(c,d){U(c,t,d),i&&i.m(t,null),n[31](t),l=!0,s||(r=[ke(n[8].action(t)),x(t,"m-focusout",n[12]),x(t,"m-keydown",n[12]),x(t,"m-pointermove",n[12])],s=!0)},p(c,d){n=c,i&&i.p&&(!l||d[0]&134217984)&&se(i,o,n,n[27],l?re(o,n[27],d,ss):oe(n[27]),dl),ee(t,u=Ee(a,[d[0]&256&&n[8],d[0]&8192&&n[13]]))},i(c){l||(A(i,c),c&&(e||Le(()=>{e=en(t,n[3],n[4]),e.start()})),l=!0)},o(c){R(i,c),l=!1},d(c){c&&m(t),i&&i.d(c),n[31](null),s=!1,ue(r)}}}function fs(n){let t,e,l,s,r,o;const i=n[28].default,a=ne(i,n,n[27],ml);let u=[n[8],n[13]],c={};for(let d=0;d<u.length;d+=1)c=ce(c,u[d]);return{c(){t=S("div"),a&&a.c(),this.h()},l(d){t=I(d,"DIV",{});var p=E(t);a&&a.l(p),p.forEach(m),this.h()},h(){ee(t,c)},m(d,p){U(d,t,p),a&&a.m(t,null),n[30](t),s=!0,r||(o=[ke(n[8].action(t)),x(t,"m-focusout",n[12]),x(t,"m-keydown",n[12]),x(t,"m-pointermove",n[12])],r=!0)},p(d,p){n=d,a&&a.p&&(!s||p[0]&134217984)&&se(a,i,n,n[27],s?re(i,n[27],p,os):oe(n[27]),ml),ee(t,c=Ee(u,[p[0]&256&&n[8],p[0]&8192&&n[13]]))},i(d){s||(A(a,d),d&&Le(()=>{s&&(l&&l.end(1),e=en(t,n[3],n[4]),e.start())}),s=!0)},o(d){R(a,d),e&&e.invalidate(),d&&(l=tn(t,n[5],n[6])),s=!1},d(d){d&&m(t),a&&a.d(d),n[30](null),d&&l&&l.end(),r=!1,ue(o)}}}function ds(n){let t,e,l,s,r;const o=n[28].default,i=ne(o,n,n[27],hl);let a=[n[8],n[13]],u={};for(let c=0;c<a.length;c+=1)u=ce(u,a[c]);return{c(){t=S("div"),i&&i.c(),this.h()},l(c){t=I(c,"DIV",{});var d=E(t);i&&i.l(d),d.forEach(m),this.h()},h(){ee(t,u)},m(c,d){U(c,t,d),i&&i.m(t,null),n[29](t),l=!0,s||(r=[ke(n[8].action(t)),x(t,"m-focusout",n[12]),x(t,"m-keydown",n[12]),x(t,"m-pointermove",n[12])],s=!0)},p(c,d){n=c,i&&i.p&&(!l||d[0]&134217984)&&se(i,o,n,n[27],l?re(o,n[27],d,rs):oe(n[27]),hl),ee(t,u=Ee(a,[d[0]&256&&n[8],d[0]&8192&&n[13]]))},i(c){l||(A(i,c),c&&Le(()=>{l&&(e||(e=Ne(t,n[1],n[2],!0)),e.run(1))}),l=!0)},o(c){R(i,c),c&&(e||(e=Ne(t,n[1],n[2],!1)),e.run(0)),l=!1},d(c){c&&m(t),i&&i.d(c),n[29](null),c&&e&&e.end(),s=!1,ue(r)}}}function ms(n){let t;const e=n[28].default,l=ne(e,n,n[27],gl);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,r){l&&l.p&&(!t||r[0]&134217984)&&se(l,e,s,s[27],t?re(e,s[27],r,is):oe(s[27]),gl)},i(s){t||(A(l,s),t=!0)},o(s){R(l,s),t=!1},d(s){l&&l.d(s)}}}function hs(n){let t,e,l,s;const r=[ms,ds,fs,us,cs,as],o=[];function i(a,u){return a[7]&&a[9]?0:a[1]&&a[9]?1:a[3]&&a[5]&&a[9]?2:a[3]&&a[9]?3:a[5]&&a[9]?4:a[9]?5:-1}return~(t=i(n))&&(e=o[t]=r[t](n)),{c(){e&&e.c(),l=At()},l(a){e&&e.l(a),l=At()},m(a,u){~t&&o[t].m(a,u),U(a,l,u),s=!0},p(a,u){let c=t;t=i(a),t===c?~t&&o[t].p(a,u):(e&&(Rt(),R(o[c],1,1,()=>{o[c]=null}),jt()),~t?(e=o[t],e?e.p(a,u):(e=o[t]=r[t](a),e.c()),A(e,1),e.m(l.parentNode,l)):e=null)},i(a){s||(A(e),s=!0)},o(a){R(e),s=!1},d(a){a&&m(l),~t&&o[t].d(a)}}}function gs(n,t,e){let l;const s=["transition","transitionConfig","inTransition","inTransitionConfig","outTransition","outTransitionConfig","asChild","id","side","align","sideOffset","alignOffset","collisionPadding","avoidCollisions","collisionBoundary","sameWidth","fitViewport","strategy","overlap","el"];let r=Be(t,s),o,i,{$$slots:a={},$$scope:u}=t,{transition:c=void 0}=t,{transitionConfig:d=void 0}=t,{inTransition:p=void 0}=t,{inTransitionConfig:k=void 0}=t,{outTransition:g=void 0}=t,{outTransitionConfig:_=void 0}=t,{asChild:h=!1}=t,{id:y=void 0}=t,{side:v="right"}=t,{align:T="start"}=t,{sideOffset:C=0}=t,{alignOffset:P=0}=t,{collisionPadding:V=8}=t,{avoidCollisions:N=!0}=t,{collisionBoundary:L=void 0}=t,{sameWidth:G=!1}=t,{fitViewport:z=!1}=t,{strategy:O="absolute"}=t,{overlap:H=!1}=t,{el:nt=void 0}=t;const{elements:{subMenu:tt},states:{subOpen:Mt},ids:ot,getAttrs:Wt}=Sn();ft(n,tt,F=>e(26,o=F)),ft(n,Mt,F=>e(9,i=F));const zt=an(),Et=Wt("sub-content");function Xt(F){gt[F?"unshift":"push"](()=>{nt=F,e(0,nt)})}function Nt(F){gt[F?"unshift":"push"](()=>{nt=F,e(0,nt)})}function St(F){gt[F?"unshift":"push"](()=>{nt=F,e(0,nt)})}function Kt(F){gt[F?"unshift":"push"](()=>{nt=F,e(0,nt)})}function $t(F){gt[F?"unshift":"push"](()=>{nt=F,e(0,nt)})}return n.$$set=F=>{t=ce(ce({},t),$l(F)),e(13,r=Be(t,s)),"transition"in F&&e(1,c=F.transition),"transitionConfig"in F&&e(2,d=F.transitionConfig),"inTransition"in F&&e(3,p=F.inTransition),"inTransitionConfig"in F&&e(4,k=F.inTransitionConfig),"outTransition"in F&&e(5,g=F.outTransition),"outTransitionConfig"in F&&e(6,_=F.outTransitionConfig),"asChild"in F&&e(7,h=F.asChild),"id"in F&&e(14,y=F.id),"side"in F&&e(15,v=F.side),"align"in F&&e(16,T=F.align),"sideOffset"in F&&e(17,C=F.sideOffset),"alignOffset"in F&&e(18,P=F.alignOffset),"collisionPadding"in F&&e(19,V=F.collisionPadding),"avoidCollisions"in F&&e(20,N=F.avoidCollisions),"collisionBoundary"in F&&e(21,L=F.collisionBoundary),"sameWidth"in F&&e(22,G=F.sameWidth),"fitViewport"in F&&e(23,z=F.fitViewport),"strategy"in F&&e(24,O=F.strategy),"overlap"in F&&e(25,H=F.overlap),"el"in F&&e(0,nt=F.el),"$$scope"in F&&e(27,u=F.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&16384&&y&&ot.menu.set(y),n.$$.dirty[0]&67108864&&e(8,l=o),n.$$.dirty[0]&256&&Object.assign(l,Et),n.$$.dirty[0]&67076096&&In({side:v,align:T,sideOffset:C,alignOffset:P,collisionPadding:V,avoidCollisions:N,collisionBoundary:L,sameWidth:G,fitViewport:z,strategy:O,overlap:H})},[nt,c,d,p,k,g,_,h,l,i,tt,Mt,zt,r,y,v,T,C,P,V,N,L,G,z,O,H,o,u,a,Xt,Nt,St,Kt,$t]}class _s extends Gt{constructor(t){super(),Jt(this,t,gs,hs,Zt,{transition:1,transitionConfig:2,inTransition:3,inTransitionConfig:4,outTransition:5,outTransitionConfig:6,asChild:7,id:14,side:15,align:16,sideOffset:17,alignOffset:18,collisionPadding:19,avoidCollisions:20,collisionBoundary:21,sameWidth:22,fitViewport:23,strategy:24,overlap:25,el:0},null,[-1,-1])}}const ps=n=>({builder:n&4}),_l=n=>({builder:n[2]}),bs=n=>({builder:n&4}),pl=n=>({builder:n[2]});function vs(n){let t,e,l,s;const r=n[13].default,o=ne(r,n,n[12],_l);let i=[n[2],n[6]],a={};for(let u=0;u<i.length;u+=1)a=ce(a,i[u]);return{c(){t=S("div"),o&&o.c(),this.h()},l(u){t=I(u,"DIV",{});var c=E(t);o&&o.l(c),c.forEach(m),this.h()},h(){ee(t,a)},m(u,c){U(u,t,c),o&&o.m(t,null),n[14](t),e=!0,l||(s=[ke(n[2].action(t)),x(t,"m-click",n[5]),x(t,"m-focusin",n[5]),x(t,"m-focusout",n[5]),x(t,"m-keydown",n[5]),x(t,"m-pointerleave",n[5]),x(t,"m-pointermove",n[5])],l=!0)},p(u,c){o&&o.p&&(!e||c&4100)&&se(o,r,u,u[12],e?re(r,u[12],c,ps):oe(u[12]),_l),ee(t,a=Ee(i,[c&4&&u[2],c&64&&u[6]]))},i(u){e||(A(o,u),e=!0)},o(u){R(o,u),e=!1},d(u){u&&m(t),o&&o.d(u),n[14](null),l=!1,ue(s)}}}function ws(n){let t;const e=n[13].default,l=ne(e,n,n[12],pl);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,r){l&&l.p&&(!t||r&4100)&&se(l,e,s,s[12],t?re(e,s[12],r,bs):oe(s[12]),pl)},i(s){t||(A(l,s),t=!0)},o(s){R(l,s),t=!1},d(s){l&&l.d(s)}}}function ks(n){let t,e,l,s;const r=[ws,vs],o=[];function i(a,u){return a[1]?0:1}return t=i(n),e=o[t]=r[t](n),{c(){e.c(),l=At()},l(a){e.l(a),l=At()},m(a,u){o[t].m(a,u),U(a,l,u),s=!0},p(a,[u]){let c=t;t=i(a),t===c?o[t].p(a,u):(Rt(),R(o[c],1,1,()=>{o[c]=null}),jt(),e=o[t],e?e.p(a,u):(e=o[t]=r[t](a),e.c()),A(e,1),e.m(l.parentNode,l))},i(a){s||(A(e),s=!0)},o(a){R(e),s=!1},d(a){a&&m(l),o[t].d(a)}}}function ys(n,t,e){let l,s;const r=["disabled","asChild","id","el"];let o=Be(t,r),i,a,{$$slots:u={},$$scope:c}=t,{disabled:d=!1}=t,{asChild:p=!1}=t,{id:k=void 0}=t,{el:g=void 0}=t;const{elements:{subTrigger:_},ids:h,getAttrs:y,options:v}=Mn();ft(n,_,V=>e(11,a=V));const{disabled:T}=v;ft(n,T,V=>e(10,i=V));const C=an();function P(V){gt[V?"unshift":"push"](()=>{g=V,e(0,g)})}return n.$$set=V=>{t=ce(ce({},t),$l(V)),e(6,o=Be(t,r)),"disabled"in V&&e(7,d=V.disabled),"asChild"in V&&e(1,p=V.asChild),"id"in V&&e(8,k=V.id),"el"in V&&e(0,g=V.el),"$$scope"in V&&e(12,c=V.$$scope)},n.$$.update=()=>{n.$$.dirty&256&&k&&h.trigger.set(k),n.$$.dirty&2048&&e(2,l=a),n.$$.dirty&1152&&e(9,s={...y("sub-trigger"),...zn(d||i)}),n.$$.dirty&516&&Object.assign(l,s)},[g,p,l,_,T,C,o,d,k,s,i,a,c,u,P]}class Es extends Gt{constructor(t){super(),Jt(this,t,ys,ks,Zt,{disabled:7,asChild:1,id:8,el:0})}}function bl(n,t,e){const l=n.slice();return l[11]=t[e],l[13]=e,l}function vl(n){let t,e,l,s='<div class="text-lg font-semibold mt-2">/</div>',r,o,i,a,u,c,d='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg>',p,k,g=n[2].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"",_,h=le(n[1]),y=[];for(let v=0;v<h.length;v+=1)y[v]=wl(bl(n,h,v));return{c(){t=S("div"),e=S("div"),l=S("div"),l.innerHTML=s,r=Y(),o=S("div"),i=S("div");for(let v=0;v<y.length;v+=1)y[v].c();a=Y(),u=S("div"),c=S("div"),c.innerHTML=d,p=Y(),k=S("div"),_=_t(g),this.h()},l(v){t=I(v,"DIV",{class:!0});var T=E(t);e=I(T,"DIV",{class:!0});var C=E(e);l=I(C,"DIV",{class:!0,"data-svelte-h":!0}),Yt(l)!=="svelte-1ynv172"&&(l.innerHTML=s),r=X(C),o=I(C,"DIV",{class:!0});var P=E(o);i=I(P,"DIV",{class:!0});var V=E(i);for(let G=0;G<y.length;G+=1)y[G].l(V);V.forEach(m),a=X(P),u=I(P,"DIV",{class:!0});var N=E(u);c=I(N,"DIV",{"data-svelte-h":!0}),Yt(c)!=="svelte-cdi12d"&&(c.innerHTML=d),p=X(N),k=I(N,"DIV",{class:!0});var L=E(k);_=pt(L,g),L.forEach(m),N.forEach(m),P.forEach(m),C.forEach(m),T.forEach(m),this.h()},h(){f(l,"class","bg-gray-100 dark:bg-gray-700 w-10 rounded-l-xl text-center"),f(i,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5"),f(k,"class","line-clamp-1"),f(u,"class","px-2 pb-1 text-xs text-gray-600 bg-white rounded-br-xl flex items-center space-x-1"),f(o,"class","max-h-60 flex flex-col w-full rounded-r-xl bg-white"),f(e,"class","flex w-full px-2"),f(t,"class","md:px-2 mb-3 text-left w-full absolute bottom-0 left-0 right-0")},m(v,T){U(v,t,T),w(t,e),w(e,l),w(e,r),w(e,o),w(o,i);for(let C=0;C<y.length;C+=1)y[C]&&y[C].m(i,null);w(o,a),w(o,u),w(u,c),w(u,p),w(u,k),w(k,_)},p(v,T){if(T&19){h=le(v[1]);let C;for(C=0;C<h.length;C+=1){const P=bl(v,h,C);y[C]?y[C].p(P,T):(y[C]=wl(P),y[C].c(),y[C].m(i,null))}for(;C<y.length;C+=1)y[C].d(1);y.length=h.length}T&4&&g!==(g=v[2].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"")&&yt(_,g)},d(v){v&&m(t),ye(y,v)}}}function wl(n){let t,e,l=n[11].command+"",s,r,o,i=n[11].title+"",a,u,c,d,p;function k(){return n[9](n[11])}function g(){return n[10](n[13])}return{c(){t=S("button"),e=S("div"),s=_t(l),r=Y(),o=S("div"),a=_t(i),u=Y(),this.h()},l(_){t=I(_,"BUTTON",{class:!0,type:!0});var h=E(t);e=I(h,"DIV",{class:!0});var y=E(e);s=pt(y,l),y.forEach(m),r=X(h),o=I(h,"DIV",{class:!0});var v=E(o);a=pt(v,i),v.forEach(m),u=X(h),h.forEach(m),this.h()},h(){f(e,"class","font-medium text-black"),f(o,"class","text-xs text-gray-600"),f(t,"class",c="px-3 py-1.5 rounded-xl w-full text-left "+(n[13]===n[0]?" bg-gray-100 selected-command-option-button":"")),f(t,"type","button")},m(_,h){U(_,t,h),w(t,e),w(e,s),w(t,r),w(t,o),w(o,a),w(t,u),d||(p=[x(t,"click",k),x(t,"mousemove",g),x(t,"focus",Is)],d=!0)},p(_,h){n=_,h&2&&l!==(l=n[11].command+"")&&yt(s,l),h&2&&i!==(i=n[11].title+"")&&yt(a,i),h&1&&c!==(c="px-3 py-1.5 rounded-xl w-full text-left "+(n[13]===n[0]?" bg-gray-100 selected-command-option-button":""))&&f(t,"class",c)},d(_){_&&m(t),d=!1,ue(p)}}}function Ss(n){let t,e=n[1].length>0&&vl(n);return{c(){e&&e.c(),t=At()},l(l){e&&e.l(l),t=At()},m(l,s){e&&e.m(l,s),U(l,t,s)},p(l,[s]){l[1].length>0?e?e.p(l,s):(e=vl(l),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:It,o:It,d(l){l&&m(t),e&&e.d(l)}}}const Is=()=>{};function Ms(n,t,e){let l,s;ft(n,_n,g=>e(8,s=g));const r=de("i18n");ft(n,r,g=>e(2,l=g));let{prompt:o=""}=t,i=0,a=[];const u=()=>{e(0,i=Math.max(0,i-1))},c=()=>{e(0,i=Math.min(i+1,a.length-1))},d=async g=>{let _=g.content;if(g.content.includes("{{CLIPBOARD}}")){const v=await navigator.clipboard.readText().catch(T=>(ht.error(l.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));_=g.content.replaceAll("{{CLIPBOARD}}",v)}e(5,o=_);const h=document.getElementById("chat-textarea");await kt(),h.style.height="",h.style.height=Math.min(h.scrollHeight,200)+"px",h==null||h.focus(),await kt();const y=on(o);if(y.length>0){const v=y.at(0);h.setSelectionRange(v==null?void 0:v.startIndex,v.endIndex+1)}},p=g=>{d(g)},k=g=>{e(0,i=g)};return n.$$set=g=>{"prompt"in g&&e(5,o=g.prompt)},n.$$.update=()=>{n.$$.dirty&288&&e(1,a=s.filter(g=>g.command.includes(o)).sort((g,_)=>g.title.localeCompare(_.title))),n.$$.dirty&32&&o&&e(0,i=0)},[i,a,l,r,d,o,u,c,s,p,k]}class Ds extends Gt{constructor(t){super(),Jt(this,t,Ms,Ss,Zt,{prompt:5,selectUp:6,selectDown:7})}get selectUp(){return this.$$.ctx[6]}get selectDown(){return this.$$.ctx[7]}}function kl(n,t,e){const l=n.slice();return l[19]=t[e],l[21]=e,l}function yl(n){let t,e,l,s='<div class="text-lg font-semibold mt-2">#</div>',r,o,i,a,u,c,d=le(n[3]),p=[];for(let h=0;h<d.length;h+=1)p[h]=El(kl(n,d,h));function k(h,y){var v,T;if(y&1&&(u=null),y&1&&(c=null),u==null&&(u=!!h[0].split(" ").some(Os)),u)return Bs;if(c==null&&(c=!!((T=(v=h[0].split(" "))==null?void 0:v.at(0))!=null&&T.substring(1).startsWith("http"))),c)return Vs}let g=k(n,-1),_=g&&g(n);return{c(){t=S("div"),e=S("div"),l=S("div"),l.innerHTML=s,r=Y(),o=S("div"),i=S("div");for(let h=0;h<p.length;h+=1)p[h].c();a=Y(),_&&_.c(),this.h()},l(h){t=I(h,"DIV",{class:!0});var y=E(t);e=I(y,"DIV",{class:!0});var v=E(e);l=I(v,"DIV",{class:!0,"data-svelte-h":!0}),Yt(l)!=="svelte-czbw16"&&(l.innerHTML=s),r=X(v),o=I(v,"DIV",{class:!0});var T=E(o);i=I(T,"DIV",{class:!0});var C=E(i);for(let P=0;P<p.length;P+=1)p[P].l(C);a=X(C),_&&_.l(C),C.forEach(m),T.forEach(m),v.forEach(m),y.forEach(m),this.h()},h(){f(l,"class","bg-gray-100 dark:bg-gray-700 w-10 rounded-l-xl text-center"),f(i,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5"),f(o,"class","max-h-60 flex flex-col w-full rounded-r-xl bg-white"),f(e,"class","flex w-full px-2"),f(t,"class","md:px-2 mb-3 text-left w-full absolute bottom-0 left-0 right-0")},m(h,y){U(h,t,y),w(t,e),w(e,l),w(e,r),w(e,o),w(o,i);for(let v=0;v<p.length;v+=1)p[v]&&p[v].m(i,null);w(i,a),_&&_.m(i,null)},p(h,y){if(y&46){d=le(h[3]);let v;for(v=0;v<d.length;v+=1){const T=kl(h,d,v);p[v]?p[v].p(T,y):(p[v]=El(T),p[v].c(),p[v].m(i,a))}for(;v<p.length;v+=1)p[v].d(1);p.length=d.length}g===(g=k(h,y))&&_?_.p(h,y):(_&&_.d(1),_=g&&g(h),_&&(_.c(),_.m(i,null)))},d(h){h&&m(t),ye(p,h),_&&_.d()}}}function Cs(n){let t,e,l=n[19].name+"",s,r,o=n[19].filename+"",i,a,u,c,d=n[19].title+"",p;return{c(){t=S("div"),e=_t("#"),s=_t(l),r=_t(" ("),i=_t(o),a=_t(")"),u=Y(),c=S("div"),p=_t(d),this.h()},l(k){t=I(k,"DIV",{class:!0});var g=E(t);e=pt(g,"#"),s=pt(g,l),r=pt(g," ("),i=pt(g,o),a=pt(g,")"),g.forEach(m),u=X(k),c=I(k,"DIV",{class:!0});var _=E(c);p=pt(_,d),_.forEach(m),this.h()},h(){f(t,"class","font-medium text-black line-clamp-1"),f(c,"class","text-xs text-gray-600 line-clamp-1")},m(k,g){U(k,t,g),w(t,e),w(t,s),w(t,r),w(t,i),w(t,a),U(k,u,g),U(k,c,g),w(c,p)},p(k,g){g&8&&l!==(l=k[19].name+"")&&yt(s,l),g&8&&o!==(o=k[19].filename+"")&&yt(i,o),g&8&&d!==(d=k[19].title+"")&&yt(p,d)},d(k){k&&(m(t),m(u),m(c))}}}function Ts(n){var a;let t,e=(((a=n[19])==null?void 0:a.title)??`#${n[19].name}`)+"",l,s,r,o=n[1].t("Collection")+"",i;return{c(){t=S("div"),l=_t(e),s=Y(),r=S("div"),i=_t(o),this.h()},l(u){t=I(u,"DIV",{class:!0});var c=E(t);l=pt(c,e),c.forEach(m),s=X(u),r=I(u,"DIV",{class:!0});var d=E(r);i=pt(d,o),d.forEach(m),this.h()},h(){f(t,"class","font-medium text-black line-clamp-1"),f(r,"class","text-xs text-gray-600 line-clamp-1")},m(u,c){U(u,t,c),w(t,l),U(u,s,c),U(u,r,c),w(r,i)},p(u,c){var d;c&8&&e!==(e=(((d=u[19])==null?void 0:d.title)??`#${u[19].name}`)+"")&&yt(l,e),c&2&&o!==(o=u[1].t("Collection")+"")&&yt(i,o)},d(u){u&&(m(t),m(s),m(r))}}}function El(n){let t,e,l,s;function r(c,d){return c[19].type==="collection"?Ts:Cs}let o=r(n),i=o(n);function a(){return n[14](n[19])}function u(){return n[15](n[21])}return{c(){t=S("button"),i.c(),this.h()},l(c){t=I(c,"BUTTON",{class:!0,type:!0});var d=E(t);i.l(d),d.forEach(m),this.h()},h(){f(t,"class",e="px-3 py-1.5 rounded-xl w-full text-left "+(n[21]===n[2]?" bg-gray-100 selected-command-option-button":"")),f(t,"type","button")},m(c,d){U(c,t,d),i.m(t,null),l||(s=[x(t,"click",a),x(t,"mousemove",u),x(t,"focus",Hs)],l=!0)},p(c,d){n=c,o===(o=r(n))&&i?i.p(n,d):(i.d(1),i=o(n),i&&(i.c(),i.m(t,null))),d&4&&e!==(e="px-3 py-1.5 rounded-xl w-full text-left "+(n[21]===n[2]?" bg-gray-100 selected-command-option-button":""))&&f(t,"class",e)},d(c){c&&m(t),i.d(),l=!1,ue(s)}}}function Vs(n){var d,p;let t,e,l=((p=(d=n[0].split(" "))==null?void 0:d.at(0))==null?void 0:p.substring(1))+"",s,r,o,i=n[1].t("Web")+"",a,u,c;return{c(){t=S("button"),e=S("div"),s=_t(l),r=Y(),o=S("div"),a=_t(i),this.h()},l(k){t=I(k,"BUTTON",{class:!0,type:!0});var g=E(t);e=I(g,"DIV",{class:!0});var _=E(e);s=pt(_,l),_.forEach(m),r=X(g),o=I(g,"DIV",{class:!0});var h=E(o);a=pt(h,i),h.forEach(m),g.forEach(m),this.h()},h(){f(e,"class","font-medium text-black line-clamp-1"),f(o,"class","text-xs text-gray-600 line-clamp-1"),f(t,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-100 selected-command-option-button"),f(t,"type","button")},m(k,g){U(k,t,g),w(t,e),w(e,s),w(t,r),w(t,o),w(o,a),u||(c=x(t,"click",n[17]),u=!0)},p(k,g){var _,h;g&1&&l!==(l=((h=(_=k[0].split(" "))==null?void 0:_.at(0))==null?void 0:h.substring(1))+"")&&yt(s,l),g&2&&i!==(i=k[1].t("Web")+"")&&yt(a,i)},d(k){k&&m(t),u=!1,c()}}}function Bs(n){var d,p;let t,e,l=((p=(d=n[0].split(" "))==null?void 0:d.at(0))==null?void 0:p.substring(1))+"",s,r,o,i=n[1].t("Youtube")+"",a,u,c;return{c(){t=S("button"),e=S("div"),s=_t(l),r=Y(),o=S("div"),a=_t(i),this.h()},l(k){t=I(k,"BUTTON",{class:!0,type:!0});var g=E(t);e=I(g,"DIV",{class:!0});var _=E(e);s=pt(_,l),_.forEach(m),r=X(g),o=I(g,"DIV",{class:!0});var h=E(o);a=pt(h,i),h.forEach(m),g.forEach(m),this.h()},h(){f(e,"class","font-medium text-black line-clamp-1"),f(o,"class","text-xs text-gray-600 line-clamp-1"),f(t,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-100 selected-command-option-button"),f(t,"type","button")},m(k,g){U(k,t,g),w(t,e),w(e,s),w(t,r),w(t,o),w(o,a),u||(c=x(t,"click",n[16]),u=!0)},p(k,g){var _,h;g&1&&l!==(l=((h=(_=k[0].split(" "))==null?void 0:_.at(0))==null?void 0:h.substring(1))+"")&&yt(s,l),g&2&&i!==(i=k[1].t("Youtube")+"")&&yt(a,i)},d(k){k&&m(t),u=!1,c()}}}function Ns(n){var s,r;let t=n[3].length>0||((r=(s=n[0].split(" "))==null?void 0:s.at(0))==null?void 0:r.substring(1).startsWith("http")),e,l=t&&yl(n);return{c(){l&&l.c(),e=At()},l(o){l&&l.l(o),e=At()},m(o,i){l&&l.m(o,i),U(o,e,i)},p(o,[i]){var a,u;i&9&&(t=o[3].length>0||((u=(a=o[0].split(" "))==null?void 0:a.at(0))==null?void 0:u.substring(1).startsWith("http"))),t?l?l.p(o,i):(l=yl(o),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:It,o:It,d(o){o&&m(e),l&&l.d(o)}}}const Os=n=>n.substring(1).startsWith("https://www.youtube.com")||n.substring(1).startsWith("https://youtu.be"),Hs=()=>{};function As(n,t,e){let l,s,r;ft(n,pn,V=>e(13,s=V));const o=de("i18n");ft(n,o,V=>e(1,r=V));let{prompt:i=""}=t;const a=We();let u=0,c=[],d=[],p=[];const k=()=>{e(2,u=Math.max(0,u-1))},g=()=>{e(2,u=Math.min(u+1,c.length-1))},_=async V=>{a("select",V),e(0,i=je(i));const N=document.getElementById("chat-textarea");await kt(),N==null||N.focus(),await kt()},h=async V=>{a("url",V),e(0,i=je(i));const N=document.getElementById("chat-textarea");await kt(),N==null||N.focus(),await kt()},y=async V=>{a("youtube",V),e(0,i=je(i));const N=document.getElementById("chat-textarea");await kt(),N==null||N.focus(),await kt()},v=V=>{console.log(V),_(V)},T=V=>{e(2,u=V)},C=()=>{var N,L;const V=(L=(N=i.split(" "))==null?void 0:N.at(0))==null?void 0:L.substring(1);tl(V)?y(V):ht.error(r.t("Oops! Looks like the URL is invalid. Please double-check and try again."))},P=()=>{var N,L;const V=(L=(N=i.split(" "))==null?void 0:N.at(0))==null?void 0:L.substring(1);tl(V)?h(V):ht.error(r.t("Oops! Looks like the URL is invalid. Please double-check and try again."))};return n.$$set=V=>{"prompt"in V&&e(0,i=V.prompt)},n.$$.update=()=>{n.$$.dirty&8194&&e(11,p=[...s.length>0?[{name:"All Documents",type:"collection",title:r.t("All Documents"),collection_names:s.map(V=>V.collection_name)}]:[],...s.reduce((V,N,L,G)=>{var z;return[...new Set([...V,...(((z=N==null?void 0:N.content)==null?void 0:z.tags)??[]).map(O=>O.name)])]},[]).map(V=>({name:V,type:"collection",collection_names:s.filter(N=>{var L;return(((L=N==null?void 0:N.content)==null?void 0:L.tags)??[]).map(G=>G.name).includes(V)}).map(N=>N.collection_name)}))]),n.$$.dirty&2049&&e(12,l=p.filter(V=>{var N,L;return V.name.includes(((L=(N=i.split(" "))==null?void 0:N.at(0))==null?void 0:L.substring(1))??"")}).sort((V,N)=>V.name.localeCompare(N.name))),n.$$.dirty&8193&&e(10,d=s.filter(V=>{var N,L;return V.name.includes(((L=(N=i.split(" "))==null?void 0:N.at(0))==null?void 0:L.substring(1))??"")}).sort((V,N)=>V.title.localeCompare(N.title))),n.$$.dirty&5120&&e(3,c=[...l,...d]),n.$$.dirty&4097&&i&&(e(2,u=0),console.log(l))},[i,r,u,c,o,_,h,y,k,g,d,p,l,s,v,T,C,P]}class Ls extends Gt{constructor(t){super(),Jt(this,t,As,Ns,Zt,{prompt:0,selectUp:8,selectDown:9})}get selectUp(){return this.$$.ctx[8]}get selectDown(){return this.$$.ctx[9]}}function Sl(n,t,e){const l=n.slice();return l[16]=t[e],l[18]=e,l}function Il(n){let t,e=n[2].length>0&&Ml(n);return{c(){e&&e.c(),t=At()},l(l){e&&e.l(l),t=At()},m(l,s){e&&e.m(l,s),U(l,t,s)},p(l,s){l[2].length>0?e?e.p(l,s):(e=Ml(l),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(l){l&&m(t),e&&e.d(l)}}}function Ml(n){let t,e,l,s='<div class="text-lg font-semibold mt-2">@</div>',r,o,i,a=le(n[2]),u=[];for(let c=0;c<a.length;c+=1)u[c]=Dl(Sl(n,a,c));return{c(){t=S("div"),e=S("div"),l=S("div"),l.innerHTML=s,r=Y(),o=S("div"),i=S("div");for(let c=0;c<u.length;c+=1)u[c].c();this.h()},l(c){t=I(c,"DIV",{class:!0});var d=E(t);e=I(d,"DIV",{class:!0});var p=E(e);l=I(p,"DIV",{class:!0,"data-svelte-h":!0}),Yt(l)!=="svelte-1ourwwn"&&(l.innerHTML=s),r=X(p),o=I(p,"DIV",{class:!0});var k=E(o);i=I(k,"DIV",{class:!0});var g=E(i);for(let _=0;_<u.length;_+=1)u[_].l(g);g.forEach(m),k.forEach(m),p.forEach(m),d.forEach(m),this.h()},h(){f(l,"class","bg-gray-100 dark:bg-gray-700 w-10 rounded-l-xl text-center"),f(i,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5"),f(o,"class","max-h-60 flex flex-col w-full rounded-r-xl bg-white"),f(e,"class","flex w-full px-2"),f(t,"class","md:px-2 mb-3 text-left w-full absolute bottom-0 left-0 right-0")},m(c,d){U(c,t,d),w(t,e),w(e,l),w(e,r),w(e,o),w(o,i);for(let p=0;p<u.length;p+=1)u[p]&&u[p].m(i,null)},p(c,d){if(d&22){a=le(c[2]);let p;for(p=0;p<a.length;p+=1){const k=Sl(c,a,p);u[p]?u[p].p(k,d):(u[p]=Dl(k),u[p].c(),u[p].m(i,null))}for(;p<u.length;p+=1)u[p].d(1);u.length=a.length}},d(c){c&&m(t),ye(u,c)}}}function Dl(n){let t,e,l=n[16].name+"",s,r,o,i,a;function u(){return n[11](n[16])}function c(){return n[12](n[18])}return{c(){t=S("button"),e=S("div"),s=_t(l),r=Y(),this.h()},l(d){t=I(d,"BUTTON",{class:!0,type:!0});var p=E(t);e=I(p,"DIV",{class:!0});var k=E(e);s=pt(k,l),k.forEach(m),r=X(p),p.forEach(m),this.h()},h(){f(e,"class","font-medium text-black line-clamp-1"),f(t,"class",o="px-3 py-1.5 rounded-xl w-full text-left "+(n[18]===n[1]?" bg-gray-100 selected-command-option-button":"")),f(t,"type","button")},m(d,p){U(d,t,p),w(t,e),w(e,s),w(t,r),i||(a=[x(t,"click",u),x(t,"mousemove",c),x(t,"focus",Ps)],i=!0)},p(d,p){n=d,p&4&&l!==(l=n[16].name+"")&&yt(s,l),p&2&&o!==(o="px-3 py-1.5 rounded-xl w-full text-left "+(n[18]===n[1]?" bg-gray-100 selected-command-option-button":""))&&f(t,"class",o)},d(d){d&&m(t),i=!1,ue(a)}}}function Us(n){let t=n[0].charAt(0)==="@",e,l=t&&Il(n);return{c(){l&&l.c(),e=At()},l(s){l&&l.l(s),e=At()},m(s,r){l&&l.m(s,r),U(s,e,r)},p(s,[r]){r&1&&(t=s[0].charAt(0)==="@"),t?l?l.p(s,r):(l=Il(s),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:It,o:It,d(s){s&&m(e),l&&l.d(s)}}}const Ps=()=>{};function Rs(n,t,e){let l;ft(n,Ue,y=>e(10,l=y));const s=de("i18n");ft(n,s,y=>e(13,y));const r=We();let{prompt:o=""}=t,{user:i=null}=t,{chatInputPlaceholder:a=""}=t,{messages:u=[]}=t,c=0,d=[];const p=()=>{e(1,c=Math.max(0,c-1))},k=()=>{e(1,c=Math.min(c+1,d.length-1))},g=async y=>{e(0,o=""),r("select",y)},_=y=>{g(y)},h=y=>{e(1,c=y)};return n.$$set=y=>{"prompt"in y&&e(0,o=y.prompt),"user"in y&&e(5,i=y.user),"chatInputPlaceholder"in y&&e(6,a=y.chatInputPlaceholder),"messages"in y&&e(7,u=y.messages)},n.$$.update=()=>{n.$$.dirty&1025&&e(2,d=l.filter(y=>{var v,T;return y.name.includes(((T=(v=o.split(" "))==null?void 0:v.at(0))==null?void 0:T.substring(1))??"")}).sort((y,v)=>y.name.localeCompare(v.name))),n.$$.dirty&1&&o&&e(1,c=0)},[o,c,d,s,g,i,a,u,p,k,l,_,h]}class js extends Gt{constructor(t){super(),Jt(this,t,Rs,Us,Zt,{prompt:0,user:5,chatInputPlaceholder:6,messages:7,selectUp:8,selectDown:9})}get selectUp(){return this.$$.ctx[8]}get selectDown(){return this.$$.ctx[9]}}function zs(n){let t,e;return{c(){t=dt("svg"),e=dt("path"),this.h()},l(l){t=mt(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=E(t);e=mt(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),E(e).forEach(m),s.forEach(m),this.h()},h(){f(e,"stroke-linecap","round"),f(e,"stroke-linejoin","round"),f(e,"d","M6 18 18 6M6 6l12 12"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"fill","none"),f(t,"viewBox","0 0 24 24"),f(t,"stroke-width",n[1]),f(t,"stroke","currentColor"),f(t,"class",n[0])},m(l,s){U(l,t,s),w(t,e)},p(l,[s]){s&2&&f(t,"stroke-width",l[1]),s&1&&f(t,"class",l[0])},i:It,o:It,d(l){l&&m(t)}}}function Fs(n,t,e){let{className:l="size-3.5"}=t,{strokeWidth:s="2"}=t;return n.$$set=r=>{"className"in r&&e(0,l=r.className),"strokeWidth"in r&&e(1,s=r.strokeWidth)},[l,s]}class Ws extends Gt{constructor(t){super(),Jt(this,t,Fs,zs,Zt,{className:0,strokeWidth:1})}}function qs(n){let t,e,l;return{c(){t=dt("svg"),e=dt("path"),l=dt("path"),this.h()},l(s){t=mt(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var r=E(t);e=mt(r,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),E(e).forEach(m),l=mt(r,"path",{d:!0}),E(l).forEach(m),r.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M5.625 1.5H9a3.75 3.75 0 0 1 3.75 3.75v1.875c0 1.036.84 1.875 1.875 1.875H16.5a3.75 3.75 0 0 1 3.75 3.75v7.875c0 1.035-.84 1.875-1.875 1.875H5.625a1.875 1.875 0 0 1-1.875-1.875V3.375c0-1.036.84-1.875 1.875-1.875Zm6.905 9.97a.75.75 0 0 0-1.06 0l-3 3a.75.75 0 1 0 1.06 1.06l1.72-1.72V18a.75.75 0 0 0 1.5 0v-4.19l1.72 1.72a.75.75 0 1 0 1.06-1.06l-3-3Z"),f(e,"clip-rule","evenodd"),f(l,"d","M14.25 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 16.5 7.5h-1.875a.375.375 0 0 1-.375-.375V5.25Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class",n[0])},m(s,r){U(s,t,r),w(t,e),w(t,l)},p(s,[r]){r&1&&f(t,"class",s[0])},i:It,o:It,d(s){s&&m(t)}}}function Zs(n,t,e){let{className:l="size-4"}=t;return n.$$set=s=>{"className"in s&&e(0,l=s.className)},[l]}class Gs extends Gt{constructor(t){super(),Jt(this,t,Zs,qs,Zt,{className:0})}}function Js(n){let t,e;return{c(){t=dt("svg"),e=dt("path"),this.h()},l(l){t=mt(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var s=E(t);e=mt(s,"path",{d:!0}),E(e).forEach(m),s.forEach(m),this.h()},h(){f(e,"d","M21.721 12.752a9.711 9.711 0 0 0-.945-5.003 12.754 12.754 0 0 1-4.339 2.708 18.991 18.991 0 0 1-.214 4.772 17.165 17.165 0 0 0 5.498-2.477ZM14.634 15.55a17.324 17.324 0 0 0 .332-4.647c-.952.227-1.945.347-2.966.347-1.021 0-2.014-.12-2.966-.347a17.515 17.515 0 0 0 .332 4.647 17.385 17.385 0 0 0 5.268 0ZM9.772 17.119a18.963 18.963 0 0 0 4.456 0A17.182 17.182 0 0 1 12 21.724a17.18 17.18 0 0 1-2.228-4.605ZM7.777 15.23a18.87 18.87 0 0 1-.214-4.774 12.753 12.753 0 0 1-4.34-2.708 9.711 9.711 0 0 0-.944 5.004 17.165 17.165 0 0 0 5.498 2.477ZM21.356 14.752a9.765 9.765 0 0 1-7.478 6.817 18.64 18.64 0 0 0 1.988-4.718 18.627 18.627 0 0 0 5.49-2.098ZM2.644 14.752c1.682.971 3.53 1.688 5.49 2.099a18.64 18.64 0 0 0 1.988 4.718 9.765 9.765 0 0 1-7.478-6.816ZM13.878 2.43a9.755 9.755 0 0 1 6.116 3.986 11.267 11.267 0 0 1-3.746 2.504 18.63 18.63 0 0 0-2.37-6.49ZM12 2.276a17.152 17.152 0 0 1 2.805 7.121c-.897.23-1.837.353-2.805.353-.968 0-1.908-.122-2.805-.353A17.151 17.151 0 0 1 12 2.276ZM10.122 2.43a18.629 18.629 0 0 0-2.37 6.49 11.266 11.266 0 0 1-3.746-2.504 9.754 9.754 0 0 1 6.116-3.985Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class",n[0])},m(l,s){U(l,t,s),w(t,e)},p(l,[s]){s&1&&f(t,"class",l[0])},i:It,o:It,d(l){l&&m(t)}}}function Qs(n,t,e){let{className:l="size-4"}=t;return n.$$set=s=>{"className"in s&&e(0,l=s.className)},[l]}class Ys extends Gt{constructor(t){super(),Jt(this,t,Qs,Js,Zt,{className:0})}}function Xs(n){let t;const e=n[7].default,l=ne(e,n,n[12],null);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,r){l&&l.p&&(!t||r&4096)&&se(l,e,s,s[12],t?re(e,s[12],r,null):oe(s[12]),null)},i(s){t||(A(l,s),t=!0)},o(s){R(l,s),t=!1},d(s){l&&l.d(s)}}}function Ks(n){let t,e;return t=new he({props:{content:n[5].t("More"),$$slots:{default:[Xs]},$$scope:{ctx:n}}}),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,s){const r={};s&32&&(r.content=l[5].t("More")),s&4096&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(A(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function Cl(n){let t,e,l,s,r,o=n[5].t("Web Search")+"",i,a,u,c,d,p,k;l=new Ys({});function g(h){n[8](h)}let _={};return n[0]!==void 0&&(_.state=n[0]),u=new Gn({props:_}),gt.push(()=>Ht(u,"state",g)),{c(){t=S("div"),e=S("div"),rt(l.$$.fragment),s=Y(),r=S("div"),i=_t(o),a=Y(),rt(u.$$.fragment),d=Y(),p=S("hr"),this.h()},l(h){t=I(h,"DIV",{class:!0});var y=E(t);e=I(y,"DIV",{class:!0});var v=E(e);it(l.$$.fragment,v),s=X(v),r=I(v,"DIV",{class:!0});var T=E(r);i=pt(T,o),T.forEach(m),v.forEach(m),a=X(y),it(u.$$.fragment,y),y.forEach(m),d=X(h),p=I(h,"HR",{class:!0}),this.h()},h(){f(r,"class","flex items-center"),f(e,"class","flex-1 flex items-center gap-2"),f(t,"class","flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl"),f(p,"class","border-gray-100 dark:border-gray-800 my-1")},m(h,y){U(h,t,y),w(t,e),at(l,e,null),w(e,s),w(e,r),w(r,i),w(t,a),at(u,t,null),U(h,d,y),U(h,p,y),k=!0},p(h,y){(!k||y&32)&&o!==(o=h[5].t("Web Search")+"")&&yt(i,o);const v={};!c&&y&1&&(c=!0,v.state=h[0],Ot(()=>c=!1)),u.$set(v)},i(h){k||(A(l.$$.fragment,h),A(u.$$.fragment,h),k=!0)},o(h){R(l.$$.fragment,h),R(u.$$.fragment,h),k=!1},d(h){h&&(m(t),m(d),m(p)),ct(l),ct(u)}}}function xs(n){let t,e,l,s=n[5].t("Upload Files")+"",r,o;return t=new Gs({}),{c(){rt(t.$$.fragment),e=Y(),l=S("div"),r=_t(s),this.h()},l(i){it(t.$$.fragment,i),e=X(i),l=I(i,"DIV",{class:!0});var a=E(l);r=pt(a,s),a.forEach(m),this.h()},h(){f(l,"class","flex items-center")},m(i,a){at(t,i,a),U(i,e,a),U(i,l,a),w(l,r),o=!0},p(i,a){(!o||a&32)&&s!==(s=i[5].t("Upload Files")+"")&&yt(r,s)},i(i){o||(A(t.$$.fragment,i),o=!0)},o(i){R(t.$$.fragment,i),o=!1},d(i){i&&(m(e),m(l)),ct(t,i)}}}function $s(n){var r,o;let t,e,l,s=((o=(r=n[4])==null?void 0:r.features)==null?void 0:o.enable_web_search)&&Cl(n);return e=new Ae({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl",$$slots:{default:[xs]},$$scope:{ctx:n}}}),e.$on("click",n[9]),{c(){s&&s.c(),t=Y(),rt(e.$$.fragment)},l(i){s&&s.l(i),t=X(i),it(e.$$.fragment,i)},m(i,a){s&&s.m(i,a),U(i,t,a),at(e,i,a),l=!0},p(i,a){var c,d;(d=(c=i[4])==null?void 0:c.features)!=null&&d.enable_web_search?s?(s.p(i,a),a&16&&A(s,1)):(s=Cl(i),s.c(),A(s,1),s.m(t.parentNode,t)):s&&(Rt(),R(s,1,1,()=>{s=null}),jt());const u={};a&4128&&(u.$$scope={dirty:a,ctx:i}),e.$set(u)},i(i){l||(A(s),A(e.$$.fragment,i),l=!0)},o(i){R(s),R(e.$$.fragment,i),l=!1},d(i){i&&m(t),s&&s.d(i),ct(e,i)}}}function to(n){let t,e,l;return e=new rn({props:{class:"w-full max-w-[190px] rounded-xl px-1 py-1  border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow",sideOffset:15,alignOffset:-8,side:"top",align:"start",transition:Ze,$$slots:{default:[$s]},$$scope:{ctx:n}}}),{c(){t=S("div"),rt(e.$$.fragment),this.h()},l(s){t=I(s,"DIV",{slot:!0});var r=E(t);it(e.$$.fragment,r),r.forEach(m),this.h()},h(){f(t,"slot","content")},m(s,r){U(s,t,r),at(e,t,null),l=!0},p(s,r){const o={};r&4147&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){l||(A(e.$$.fragment,s),l=!0)},o(s){R(e.$$.fragment,s),l=!1},d(s){s&&m(t),ct(e)}}}function eo(n){let t,e,l;function s(o){n[10](o)}let r={$$slots:{content:[to],default:[Ks]},$$scope:{ctx:n}};return n[3]!==void 0&&(r.show=n[3]),t=new cn({props:r}),gt.push(()=>Ht(t,"show",s)),t.$on("change",n[11]),{c(){rt(t.$$.fragment)},l(o){it(t.$$.fragment,o)},m(o,i){at(t,o,i),l=!0},p(o,[i]){const a={};i&4147&&(a.$$scope={dirty:i,ctx:o}),!e&&i&8&&(e=!0,a.show=o[3],Ot(()=>e=!1)),t.$set(a)},i(o){l||(A(t.$$.fragment,o),l=!0)},o(o){R(t.$$.fragment,o),l=!1},d(o){ct(t,o)}}}function lo(n,t,e){let l,s;ft(n,ln,h=>e(4,l=h));let{$$slots:r={},$$scope:o}=t;const i=de("i18n");ft(n,i,h=>e(5,s=h));let{uploadFilesHandler:a}=t,{webSearchEnabled:u}=t,{onClose:c}=t,d=!1;function p(h){u=h,e(0,u)}const k=()=>{a()};function g(h){d=h,e(3,d)}const _=h=>{h.detail===!1&&c()};return n.$$set=h=>{"uploadFilesHandler"in h&&e(1,a=h.uploadFilesHandler),"webSearchEnabled"in h&&e(0,u=h.webSearchEnabled),"onClose"in h&&e(2,c=h.onClose),"$$scope"in h&&e(12,o=h.$$scope)},[u,a,c,d,l,s,i,r,p,k,g,_,o]}class no extends Gt{constructor(t){super(),Jt(this,t,lo,eo,Zt,{uploadFilesHandler:1,webSearchEnabled:0,onClose:2})}}function Tl(n,t,e){const l=n.slice();return l[71]=t[e],l[73]=e,l}function Vl(n){let t,e,l,s,r,o,i;return r=new An({}),{c(){t=S("div"),e=S("div"),l=S("div"),s=S("div"),rt(r.$$.fragment),this.h()},l(a){t=I(a,"DIV",{class:!0,id:!0,role:!0,"aria-label":!0});var u=E(t);e=I(u,"DIV",{class:!0});var c=E(e);l=I(c,"DIV",{class:!0});var d=E(l);s=I(d,"DIV",{class:!0});var p=E(s);it(r.$$.fragment,p),p.forEach(m),d.forEach(m),c.forEach(m),u.forEach(m),this.h()},h(){f(s,"class","max-w-md"),f(l,"class","m-auto pt-64 flex flex-col justify-center"),f(e,"class","absolute w-full h-full backdrop-blur bg-gray-800/40 flex justify-center"),f(t,"class",o="fixed "+(n[24]?"left-0 md:left-[260px] md:w-[calc(100%-260px)]":"left-0")+" w-full h-full flex z-50 touch-none pointer-events-none"),f(t,"id","dropzone"),f(t,"role","region"),f(t,"aria-label","Drag and Drop Container")},m(a,u){U(a,t,u),w(t,e),w(e,l),w(l,s),at(r,s,null),i=!0},p(a,u){(!i||u[0]&16777216&&o!==(o="fixed "+(a[24]?"left-0 md:left-[260px] md:w-[calc(100%-260px)]":"left-0")+" w-full h-full flex z-50 touch-none pointer-events-none"))&&f(t,"class",o)},i(a){i||(A(r.$$.fragment,a),i=!0)},o(a){R(r.$$.fragment,a),i=!1},d(a){a&&m(t),ct(r)}}}function Bl(n){let t,e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z" clip-rule="evenodd"></path></svg>',s,r;return{c(){t=S("div"),e=S("button"),e.innerHTML=l,this.h()},l(o){t=I(o,"DIV",{class:!0});var i=E(t);e=I(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Yt(e)!=="svelte-4loiwr"&&(e.innerHTML=l),i.forEach(m),this.h()},h(){f(e,"class","bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full"),f(t,"class","absolute -top-12 left-0 right-0 flex justify-center z-30")},m(o,i){U(o,t,i),w(t,e),s||(r=x(e,"click",n[32]),s=!0)},p:It,d(o){o&&m(t),s=!1,r()}}}function so(n){let t,e,l;function s(o){n[36](o)}let r={};return n[1]!==void 0&&(r.prompt=n[1]),t=new Ls({props:r}),n[35](t),gt.push(()=>Ht(t,"prompt",s)),t.$on("youtube",n[37]),t.$on("url",n[38]),t.$on("select",n[39]),{c(){rt(t.$$.fragment)},l(o){it(t.$$.fragment,o)},m(o,i){at(t,o,i),l=!0},p(o,i){const a={};!e&&i[0]&2&&(e=!0,a.prompt=o[1],Ot(()=>e=!1)),t.$set(a)},i(o){l||(A(t.$$.fragment,o),l=!0)},o(o){R(t.$$.fragment,o),l=!1},d(o){n[35](null),ct(t,o)}}}function oo(n){let t,e,l;function s(o){n[34](o)}let r={};return n[1]!==void 0&&(r.prompt=n[1]),t=new Ds({props:r}),n[33](t),gt.push(()=>Ht(t,"prompt",s)),{c(){rt(t.$$.fragment)},l(o){it(t.$$.fragment,o)},m(o,i){at(t,o,i),l=!0},p(o,i){const a={};!e&&i[0]&2&&(e=!0,a.prompt=o[1],Ot(()=>e=!1)),t.$set(a)},i(o){l||(A(t.$$.fragment,o),l=!0)},o(o){R(t.$$.fragment,o),l=!1},d(o){n[33](null),ct(t,o)}}}function Nl(n){let t,e,l,s,r,o,i,a,u=n[0].name+"",c,d,p,k,g,_,h,y;return g=new Ws({}),{c(){t=S("div"),e=S("div"),l=S("img"),r=Y(),o=S("div"),i=_t("Talking to "),a=S("span"),c=_t(u),d=Y(),p=S("div"),k=S("button"),rt(g.$$.fragment),this.h()},l(v){t=I(v,"DIV",{class:!0});var T=E(t);e=I(T,"DIV",{class:!0});var C=E(e);l=I(C,"IMG",{crossorigin:!0,alt:!0,class:!0,src:!0}),r=X(C),o=I(C,"DIV",{});var P=E(o);i=pt(P,"Talking to "),a=I(P,"SPAN",{class:!0});var V=E(a);c=pt(V,u),V.forEach(m),P.forEach(m),C.forEach(m),d=X(T),p=I(T,"DIV",{});var N=E(p);k=I(N,"BUTTON",{class:!0});var L=E(k);it(g.$$.fragment,L),L.forEach(m),N.forEach(m),T.forEach(m),this.h()},h(){var v,T,C;f(l,"crossorigin","anonymous"),f(l,"alt","model profile"),f(l,"class","size-5 max-w-[28px] object-cover rounded-full"),we(l.src,s=((C=(T=(v=n[11].find(n[45]))==null?void 0:v.info)==null?void 0:T.meta)==null?void 0:C.profile_image_url)??(n[22].language==="dg-DG"?"/doge.png":`${He}/static/favicon.png`))||f(l,"src",s),f(a,"class","font-medium"),f(e,"class","flex items-center gap-2 text-sm dark:text-gray-500"),f(k,"class","flex items-center"),f(t,"class","px-3 py-2.5 text-left w-full flex justify-between items-center absolute bottom-0 left-0 right-0 bg-gradient-to-t from-50% from-white dark:from-gray-900")},m(v,T){U(v,t,T),w(t,e),w(e,l),w(e,r),w(e,o),w(o,i),w(o,a),w(a,c),w(t,d),w(t,p),w(p,k),at(g,k,null),_=!0,h||(y=x(k,"click",n[46]),h=!0)},p(v,T){var C,P,V;(!_||T[0]&4196353&&!we(l.src,s=((V=(P=(C=v[11].find(v[45]))==null?void 0:C.info)==null?void 0:P.meta)==null?void 0:V.profile_image_url)??(v[22].language==="dg-DG"?"/doge.png":`${He}/static/favicon.png`)))&&f(l,"src",s),(!_||T[0]&1)&&u!==(u=v[0].name+"")&&yt(c,u)},i(v){_||(A(g.$$.fragment,v),_=!0)},o(v){R(g.$$.fragment,v),_=!1},d(v){v&&m(t),ct(g),h=!1,y()}}}function Ol(n){let t,e,l=le(n[3]),s=[];for(let o=0;o<l.length;o+=1)s[o]=Al(Tl(n,l,o));const r=o=>R(s[o],1,1,()=>{s[o]=null});return{c(){t=S("div");for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){t=I(o,"DIV",{class:!0});var i=E(t);for(let a=0;a<s.length;a+=1)s[a].l(i);i.forEach(m),this.h()},h(){f(t,"class","mx-2 mt-2 mb-1 flex flex-wrap gap-2")},m(o,i){U(o,t,i);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(t,null);e=!0},p(o,i){if(i[0]&5243017){l=le(o[3]);let a;for(a=0;a<l.length;a+=1){const u=Tl(o,l,a);s[a]?(s[a].p(u,i),A(s[a],1)):(s[a]=Al(u),s[a].c(),A(s[a],1),s[a].m(t,null))}for(Rt(),a=l.length;a<s.length;a+=1)r(a);jt()}},i(o){if(!e){for(let i=0;i<l.length;i+=1)A(s[i]);e=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)R(s[i]);e=!1},d(o){o&&m(t),ye(s,o)}}}function ro(n){var k;let t,e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6"><path d="M7.5 3.375c0-1.036.84-1.875 1.875-1.875h.375a3.75 3.75 0 0 1 3.75 3.75v1.875C13.5 8.161 14.34 9 15.375 9h1.875A3.75 3.75 0 0 1 21 12.75v3.375C21 17.16 20.16 18 19.125 18h-9.75A1.875 1.875 0 0 1 7.5 16.125V3.375Z"></path><path d="M15 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 17.25 7.5h-1.875A.375.375 0 0 1 15 7.125V5.25ZM4.875 6H6v10.125A3.375 3.375 0 0 0 9.375 19.5H16.5v1.125c0 1.035-.84 1.875-1.875 1.875h-9.75A1.875 1.875 0 0 1 3 20.625V7.875C3 6.839 3.84 6 4.875 6Z"></path></svg>',s,r,o,i=(((k=n[71])==null?void 0:k.title)??`#${n[71].name}`)+"",a,u,c,d=n[22].t("Collection")+"",p;return{c(){t=S("div"),e=S("div"),e.innerHTML=l,s=Y(),r=S("div"),o=S("div"),a=_t(i),u=Y(),c=S("div"),p=_t(d),this.h()},l(g){t=I(g,"DIV",{class:!0});var _=E(t);e=I(_,"DIV",{class:!0,"data-svelte-h":!0}),Yt(e)!=="svelte-2wa7ie"&&(e.innerHTML=l),s=X(_),r=I(_,"DIV",{class:!0});var h=E(r);o=I(h,"DIV",{class:!0});var y=E(o);a=pt(y,i),y.forEach(m),u=X(h),c=I(h,"DIV",{class:!0});var v=E(c);p=pt(v,d),v.forEach(m),h.forEach(m),_.forEach(m),this.h()},h(){f(e,"class","p-2.5 bg-red-400 text-white rounded-lg"),f(o,"class","dark:text-gray-100 text-sm font-medium line-clamp-1"),f(c,"class","text-gray-500 text-sm"),f(r,"class","flex flex-col justify-center -space-y-0.5"),f(t,"class","h-16 w-[15rem] flex items-center space-x-3 px-2.5 dark:bg-gray-600 rounded-xl border border-gray-200 dark:border-none")},m(g,_){U(g,t,_),w(t,e),w(t,s),w(t,r),w(r,o),w(o,a),w(r,u),w(r,c),w(c,p)},p(g,_){var h;_[0]&8&&i!==(i=(((h=g[71])==null?void 0:h.title)??`#${g[71].name}`)+"")&&yt(a,i),_[0]&4194304&&d!==(d=g[22].t("Collection")+"")&&yt(p,d)},i:It,o:It,d(g){g&&m(t)}}}function io(n){let t,e,l,s,r,o=n[71].name+"",i,a,u,c=n[22].t("Document")+"",d;function p(_,h){return _[71].upload_status?uo:co}let k=p(n),g=k(n);return{c(){t=S("div"),e=S("div"),g.c(),l=Y(),s=S("div"),r=S("div"),i=_t(o),a=Y(),u=S("div"),d=_t(c),this.h()},l(_){t=I(_,"DIV",{class:!0});var h=E(t);e=I(h,"DIV",{class:!0});var y=E(e);g.l(y),y.forEach(m),l=X(h),s=I(h,"DIV",{class:!0});var v=E(s);r=I(v,"DIV",{class:!0});var T=E(r);i=pt(T,o),T.forEach(m),a=X(v),u=I(v,"DIV",{class:!0});var C=E(u);d=pt(C,c),C.forEach(m),v.forEach(m),h.forEach(m),this.h()},h(){f(e,"class","p-2.5 bg-red-400 text-white rounded-lg"),f(r,"class","dark:text-gray-100 text-sm font-medium line-clamp-1"),f(u,"class","text-gray-500 text-sm"),f(s,"class","flex flex-col justify-center -space-y-0.5"),f(t,"class","h-16 w-[15rem] flex items-center space-x-3 px-2.5 dark:bg-gray-600 rounded-xl border border-gray-200 dark:border-none")},m(_,h){U(_,t,h),w(t,e),g.m(e,null),w(t,l),w(t,s),w(s,r),w(r,i),w(s,a),w(s,u),w(u,d)},p(_,h){k!==(k=p(_))&&(g.d(1),g=k(_),g&&(g.c(),g.m(e,null))),h[0]&8&&o!==(o=_[71].name+"")&&yt(i,o),h[0]&4194304&&c!==(c=_[22].t("Document")+"")&&yt(d,c)},i:It,o:It,d(_){_&&m(t),g.d()}}}function ao(n){let t,e,l,s,r,o=(n[0]?n[20].length===0:n[7].length!==n[20].length)&&Hl(n);return{c(){t=S("div"),e=S("img"),s=Y(),o&&o.c(),this.h()},l(i){t=I(i,"DIV",{class:!0});var a=E(t);e=I(a,"IMG",{src:!0,alt:!0,class:!0}),s=X(a),o&&o.l(a),a.forEach(m),this.h()},h(){we(e.src,l=n[71].url)||f(e,"src",l),f(e,"alt","input"),f(e,"class","h-16 w-16 rounded-xl object-cover"),f(t,"class","relative")},m(i,a){U(i,t,a),w(t,e),w(t,s),o&&o.m(t,null),r=!0},p(i,a){(!r||a[0]&8&&!we(e.src,l=i[71].url))&&f(e,"src",l),(i[0]?i[20].length===0:i[7].length!==i[20].length)?o?(o.p(i,a),a[0]&1048705&&A(o,1)):(o=Hl(i),o.c(),A(o,1),o.m(t,null)):o&&(Rt(),R(o,1,1,()=>{o=null}),jt())},i(i){r||(A(o),r=!0)},o(i){R(o),r=!1},d(i){i&&m(t),o&&o.d()}}}function co(n){let t,e,l,s,r,o;return{c(){t=dt("svg"),e=dt("style"),l=_t(`.spinner_qM83 {
																	animation: spinner_8HQG 1.05s infinite;
																}
																.spinner_oXPr {
																	animation-delay: 0.1s;
																}
																.spinner_ZTLf {
																	animation-delay: 0.2s;
																}
																@keyframes spinner_8HQG {
																	0%,
																	57.14% {
																		animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																		transform: translate(0);
																	}
																	28.57% {
																		animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																		transform: translateY(-6px);
																	}
																	100% {
																		transform: translate(0);
																	}
																}
															`),s=dt("circle"),r=dt("circle"),o=dt("circle"),this.h()},l(i){t=mt(i,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=E(t);e=mt(a,"style",{});var u=E(e);l=pt(u,`.spinner_qM83 {
																	animation: spinner_8HQG 1.05s infinite;
																}
																.spinner_oXPr {
																	animation-delay: 0.1s;
																}
																.spinner_ZTLf {
																	animation-delay: 0.2s;
																}
																@keyframes spinner_8HQG {
																	0%,
																	57.14% {
																		animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																		transform: translate(0);
																	}
																	28.57% {
																		animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																		transform: translateY(-6px);
																	}
																	100% {
																		transform: translate(0);
																	}
																}
															`),u.forEach(m),s=mt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),E(s).forEach(m),r=mt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),E(r).forEach(m),o=mt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),E(o).forEach(m),a.forEach(m),this.h()},h(){f(s,"class","spinner_qM83"),f(s,"cx","4"),f(s,"cy","12"),f(s,"r","2.5"),f(r,"class","spinner_qM83 spinner_oXPr"),f(r,"cx","12"),f(r,"cy","12"),f(r,"r","2.5"),f(o,"class","spinner_qM83 spinner_ZTLf"),f(o,"cx","20"),f(o,"cy","12"),f(o,"r","2.5"),f(t,"class","w-6 h-6 translate-y-[0.5px]"),f(t,"fill","currentColor"),f(t,"viewBox","0 0 24 24"),f(t,"xmlns","http://www.w3.org/2000/svg")},m(i,a){U(i,t,a),w(t,e),w(e,l),w(t,s),w(t,r),w(t,o)},d(i){i&&m(t)}}}function uo(n){let t,e,l;return{c(){t=dt("svg"),e=dt("path"),l=dt("path"),this.h()},l(s){t=mt(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var r=E(t);e=mt(r,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),E(e).forEach(m),l=mt(r,"path",{d:!0}),E(l).forEach(m),r.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z"),f(e,"clip-rule","evenodd"),f(l,"d","M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class","w-6 h-6")},m(s,r){U(s,t,r),w(t,e),w(t,l)},d(s){s&&m(t)}}}function Hl(n){let t,e;return t=new he({props:{className:" absolute top-1 left-1",content:n[22].t("{{ models }}",{models:[...n[0]?[n[0]]:n[7]].filter(n[50]).join(", ")}),$$slots:{default:[fo]},$$scope:{ctx:n}}}),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,s){const r={};s[0]&5243009&&(r.content=l[22].t("{{ models }}",{models:[...l[0]?[l[0]]:l[7]].filter(l[50]).join(", ")})),s[2]&4096&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(A(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function fo(n){let t,e;return{c(){t=dt("svg"),e=dt("path"),this.h()},l(l){t=mt(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var s=E(t);e=mt(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),E(e).forEach(m),s.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"),f(e,"clip-rule","evenodd"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class","size-4 fill-yellow-300")},m(l,s){U(l,t,s),w(t,e)},p:It,d(l){l&&m(t)}}}function Al(n){let t,e,l,s,r,o,i='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',a,u,c,d;const p=[ao,io,ro],k=[];function g(h,y){return h[71].type==="image"?0:h[71].type==="doc"?1:h[71].type==="collection"?2:-1}~(e=g(n))&&(l=k[e]=p[e](n));function _(){return n[51](n[73])}return{c(){t=S("div"),l&&l.c(),s=Y(),r=S("div"),o=S("button"),o.innerHTML=i,a=Y(),this.h()},l(h){t=I(h,"DIV",{class:!0});var y=E(t);l&&l.l(y),s=X(y),r=I(y,"DIV",{class:!0});var v=E(r);o=I(v,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Yt(o)!=="svelte-1i5njtt"&&(o.innerHTML=i),v.forEach(m),a=X(y),y.forEach(m),this.h()},h(){f(o,"class","bg-gray-400 text-white border border-white rounded-full group-hover:visible invisible transition"),f(o,"type","button"),f(r,"class","absolute -top-1 -right-1"),f(t,"class","relative group")},m(h,y){U(h,t,y),~e&&k[e].m(t,null),w(t,s),w(t,r),w(r,o),w(t,a),u=!0,c||(d=x(o,"click",_),c=!0)},p(h,y){n=h;let v=e;e=g(n),e===v?~e&&k[e].p(n,y):(l&&(Rt(),R(k[v],1,1,()=>{k[v]=null}),jt()),~e?(l=k[e],l?l.p(n,y):(l=k[e]=p[e](n),l.c()),A(l,1),l.m(t,s)):l=null)},i(h){u||(A(l),u=!0)},o(h){R(l),u=!1},d(h){h&&m(t),~e&&k[e].d(),c=!1,d()}}}function mo(n){let t,e='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-5"><path d="M8.75 3.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z"></path></svg>';return{c(){t=S("button"),t.innerHTML=e,this.h()},l(l){t=I(l,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Yt(t)!=="svelte-2y5816"&&(t.innerHTML=e),this.h()},h(){f(t,"class","bg-gray-50 hover:bg-gray-100 text-gray-800 dark:bg-gray-850 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5 outline-none focus:outline-none"),f(t,"type","button")},m(l,s){U(l,t,s)},p:It,d(l){l&&m(t)}}}function ho(n){let t,e='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z" clip-rule="evenodd"></path></svg>',l,s;return{c(){t=S("button"),t.innerHTML=e,this.h()},l(r){t=I(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Yt(t)!=="svelte-1ygp9cw"&&(t.innerHTML=e),this.h()},h(){f(t,"class","bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5")},m(r,o){U(r,t,o),l||(s=x(t,"click",function(){dn(n[6])&&n[6].apply(this,arguments)}),l=!0)},p(r,o){n=r},i:It,o:It,d(r){r&&m(t),l=!1,s()}}}function go(n){let t,e,l,s;return t=new he({props:{content:n[22].t("Record voice"),$$slots:{default:[bo]},$$scope:{ctx:n}}}),l=new he({props:{content:n[22].t("Send message"),$$slots:{default:[vo]},$$scope:{ctx:n}}}),{c(){rt(t.$$.fragment),e=Y(),rt(l.$$.fragment)},l(r){it(t.$$.fragment,r),e=X(r),it(l.$$.fragment,r)},m(r,o){at(t,r,o),U(r,e,o),at(l,r,o),s=!0},p(r,o){const i={};o[0]&4194304&&(i.content=r[22].t("Record voice")),o[0]&2097408|o[2]&4096&&(i.$$scope={dirty:o,ctx:r}),t.$set(i);const a={};o[0]&4194304&&(a.content=r[22].t("Send message")),o[0]&2|o[2]&4096&&(a.$$scope={dirty:o,ctx:r}),l.$set(a)},i(r){s||(A(t.$$.fragment,r),A(l.$$.fragment,r),s=!0)},o(r){R(t.$$.fragment,r),R(l.$$.fragment,r),s=!1},d(r){r&&m(e),ct(t,r),ct(l,r)}}}function Ll(n){let t,e,l;function s(i,a){return i[21]?po:_o}let r=s(n),o=r(n);return{c(){t=S("button"),o.c(),this.h()},l(i){t=I(i,"BUTTON",{id:!0,class:!0,type:!0});var a=E(t);o.l(a),a.forEach(m),this.h()},h(){f(t,"id","voice-input-button"),f(t,"class","text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-850 transition rounded-full p-1.5 mr-0.5 self-center"),f(t,"type","button")},m(i,a){U(i,t,a),o.m(t,null),e||(l=x(t,"click",n[62]),e=!0)},p(i,a){r!==(r=s(i))&&(o.d(1),o=r(i),o&&(o.c(),o.m(t,null)))},d(i){i&&m(t),o.d(),e=!1,l()}}}function _o(n){let t,e,l;return{c(){t=dt("svg"),e=dt("path"),l=dt("path"),this.h()},l(s){t=mt(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var r=E(t);e=mt(r,"path",{d:!0}),E(e).forEach(m),l=mt(r,"path",{d:!0}),E(l).forEach(m),r.forEach(m),this.h()},h(){f(e,"d","M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"),f(l,"d","M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 20 20"),f(t,"fill","currentColor"),f(t,"class","w-5 h-5 translate-y-[0.5px]")},m(s,r){U(s,t,r),w(t,e),w(t,l)},d(s){s&&m(t)}}}function po(n){let t,e,l,s,r,o;return{c(){t=dt("svg"),e=dt("style"),l=_t(`.spinner_qM83 {
																animation: spinner_8HQG 1.05s infinite;
															}
															.spinner_oXPr {
																animation-delay: 0.1s;
															}
															.spinner_ZTLf {
																animation-delay: 0.2s;
															}
															@keyframes spinner_8HQG {
																0%,
																57.14% {
																	animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																	transform: translate(0);
																}
																28.57% {
																	animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																	transform: translateY(-6px);
																}
																100% {
																	transform: translate(0);
																}
															}
														`),s=dt("circle"),r=dt("circle"),o=dt("circle"),this.h()},l(i){t=mt(i,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=E(t);e=mt(a,"style",{});var u=E(e);l=pt(u,`.spinner_qM83 {
																animation: spinner_8HQG 1.05s infinite;
															}
															.spinner_oXPr {
																animation-delay: 0.1s;
															}
															.spinner_ZTLf {
																animation-delay: 0.2s;
															}
															@keyframes spinner_8HQG {
																0%,
																57.14% {
																	animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																	transform: translate(0);
																}
																28.57% {
																	animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																	transform: translateY(-6px);
																}
																100% {
																	transform: translate(0);
																}
															}
														`),u.forEach(m),s=mt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),E(s).forEach(m),r=mt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),E(r).forEach(m),o=mt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),E(o).forEach(m),a.forEach(m),this.h()},h(){f(s,"class","spinner_qM83"),f(s,"cx","4"),f(s,"cy","12"),f(s,"r","2.5"),f(r,"class","spinner_qM83 spinner_oXPr"),f(r,"cx","12"),f(r,"cy","12"),f(r,"r","2.5"),f(o,"class","spinner_qM83 spinner_ZTLf"),f(o,"cx","20"),f(o,"cy","12"),f(o,"r","2.5"),f(t,"class","w-5 h-5 translate-y-[0.5px]"),f(t,"fill","currentColor"),f(t,"viewBox","0 0 24 24"),f(t,"xmlns","http://www.w3.org/2000/svg")},m(i,a){U(i,t,a),w(t,e),w(e,l),w(t,s),w(t,r),w(t,o)},d(i){i&&m(t)}}}function bo(n){let t,e=n[8]&&Ll(n);return{c(){e&&e.c(),t=At()},l(l){e&&e.l(l),t=At()},m(l,s){e&&e.m(l,s),U(l,t,s)},p(l,s){l[8]?e?e.p(l,s):(e=Ll(l),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(l){l&&m(t),e&&e.d(l)}}}function vo(n){let t,e,l,s,r;return{c(){t=S("button"),e=dt("svg"),l=dt("path"),this.h()},l(o){t=I(o,"BUTTON",{id:!0,class:!0,type:!0});var i=E(t);e=mt(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=E(e);l=mt(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),E(l).forEach(m),a.forEach(m),i.forEach(m),this.h()},h(){f(l,"fill-rule","evenodd"),f(l,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),f(l,"clip-rule","evenodd"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"viewBox","0 0 16 16"),f(e,"fill","currentColor"),f(e,"class","w-5 h-5"),f(t,"id","send-message-button"),f(t,"class",s=(n[1]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 self-center"),f(t,"type","submit"),t.disabled=r=n[1]===""},m(o,i){U(o,t,i),w(t,e),w(e,l)},p(o,i){i[0]&2&&s!==(s=(o[1]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 self-center")&&f(t,"class",s),i[0]&2&&r!==(r=o[1]==="")&&(t.disabled=r)},d(o){o&&m(t)}}}function wo(n){let t,e,l,s,r,o,i,a,u,c,d,p,k,g,_,h,y,v,T,C,P,V,N,L,G,z,O,H,nt,tt,Mt,ot,Wt,zt,Et,Xt,Nt,St,Kt,$t,F,W=n[22].t("LLMs can make mistakes. Verify important information.")+"",lt,Ut,Dt,Pt,ge,Ct=n[17]&&Vl(n),Lt=n[2]===!1&&n[9].length>0&&Bl(n);const _e=[oo,so],te=[];function pe(D,B){return B[0]&2&&(u=null),B[0]&2&&(c=null),u==null&&(u=D[1].charAt(0)==="/"),u?0:(c==null&&(c=D[1].charAt(0)==="#"),c?1:-1)}~(d=pe(n,[-1,-1,-1]))&&(p=te[d]=_e[d](n));function Se(D){n[41](D)}function Ie(D){n[42](D)}function Me(D){n[43](D)}let me={messages:n[9]};n[1]!==void 0&&(me.prompt=n[1]),n[18]!==void 0&&(me.user=n[18]),n[19]!==void 0&&(me.chatInputPlaceholder=n[19]),g=new js({props:me}),n[40](g),gt.push(()=>Ht(g,"prompt",Se)),gt.push(()=>Ht(g,"user",Ie)),gt.push(()=>Ht(g,"chatInputPlaceholder",Me)),g.$on("select",n[44]);let Tt=n[0]!==void 0&&Nl(n),Vt=n[3].length>0&&Ol(n);function De(D){n[54](D)}let be={uploadFilesHandler:n[52],onClose:n[53],$$slots:{default:[mo]},$$scope:{ctx:n}};n[4]!==void 0&&(be.webSearchEnabled=n[4]),nt=new no({props:be}),gt.push(()=>Ht(nt,"webSearchEnabled",De));const M=[go,ho],Z=[];function $(D,B){return B[0]&512&&(Xt=null),Xt==null&&(Xt=D[9].length==0||D[9].at(-1).done==!0),Xt?0:1}return Nt=$(n,[-1,-1,-1]),St=Z[Nt]=M[Nt](n),{c(){Ct&&Ct.c(),t=Y(),e=S("div"),l=S("div"),s=S("div"),r=S("div"),o=S("div"),Lt&&Lt.c(),i=Y(),a=S("div"),p&&p.c(),k=Y(),rt(g.$$.fragment),v=Y(),Tt&&Tt.c(),T=Y(),C=S("div"),P=S("div"),V=S("div"),N=S("input"),L=Y(),G=S("form"),Vt&&Vt.c(),z=Y(),O=S("div"),H=S("div"),rt(nt.$$.fragment),Mt=Y(),ot=S("textarea"),zt=Y(),Et=S("div"),St.c(),$t=Y(),F=S("div"),lt=_t(W),this.h()},l(D){Ct&&Ct.l(D),t=X(D),e=I(D,"DIV",{class:!0});var B=E(e);l=I(B,"DIV",{class:!0});var J=E(l);s=I(J,"DIV",{class:!0});var bt=E(s);r=I(bt,"DIV",{class:!0});var vt=E(r);o=I(vt,"DIV",{class:!0});var wt=E(o);Lt&&Lt.l(wt),wt.forEach(m),i=X(vt),a=I(vt,"DIV",{class:!0});var Bt=E(a);p&&p.l(Bt),k=X(Bt),it(g.$$.fragment,Bt),v=X(Bt),Tt&&Tt.l(Bt),Bt.forEach(m),vt.forEach(m),bt.forEach(m),T=X(J),C=I(J,"DIV",{class:!0});var Ft=E(C);P=I(Ft,"DIV",{class:!0});var xt=E(P);V=I(xt,"DIV",{class:!0});var b=E(V);N=I(b,"INPUT",{type:!0}),L=X(b),G=I(b,"FORM",{dir:!0,class:!0});var Q=E(G);Vt&&Vt.l(Q),z=X(Q),O=I(Q,"DIV",{class:!0});var j=E(O);H=I(j,"DIV",{class:!0});var q=E(H);it(nt.$$.fragment,q),q.forEach(m),Mt=X(j),ot=I(j,"TEXTAREA",{id:!0,class:!0,placeholder:!0,rows:!0}),E(ot).forEach(m),zt=X(j),Et=I(j,"DIV",{class:!0});var K=E(Et);St.l(K),K.forEach(m),j.forEach(m),Q.forEach(m),$t=X(b),F=I(b,"DIV",{class:!0});var ut=E(F);lt=pt(ut,W),ut.forEach(m),b.forEach(m),xt.forEach(m),Ft.forEach(m),J.forEach(m),B.forEach(m),this.h()},h(){var D;f(o,"class","relative"),f(a,"class","w-full relative"),f(r,"class","flex flex-col max-w-6xl px-2.5 md:px-6 w-full"),f(s,"class","-mb-0.5 mx-auto inset-x-0 bg-transparent flex justify-center"),f(N,"type","file"),N.hidden=!0,N.multiple=!0,f(H,"class","ml-1 flex items-center"),f(ot,"id","chat-textarea"),f(ot,"class","scrollbar-hidden bg-gray-50 dark:bg-gray-850 dark:text-gray-100 outline-none w-full py-3 px-3 rounded-xl resize-none h-[48px] svelte-141e0sl"),f(ot,"placeholder",Wt=n[19]!==""?n[19]:n[21]?n[22].t("Listening..."):n[22].t("Send a Message")),f(ot,"rows","1"),f(Et,"class","self-end mb-2 flex space-x-1 mr-1"),f(O,"class","flex"),f(G,"dir",Kt=((D=n[23])==null?void 0:D.chatDirection)??"LTR"),f(G,"class","flex flex-col relative w-full rounded-3xl px-1.5 bg-gray-50 dark:bg-gray-850 dark:text-gray-100"),f(F,"class","mt-1.5 text-xs text-gray-500 text-center"),f(V,"class","pb-2"),f(P,"class","max-w-6xl px-2.5 md:px-6 mx-auto inset-x-0"),f(C,"class","bg-white dark:bg-gray-900"),f(l,"class","w-full"),f(e,"class",Ut="fixed bottom-0 "+(n[24]?"left-0 md:left-[260px]":"left-0")+" right-0")},m(D,B){Ct&&Ct.m(D,B),U(D,t,B),U(D,e,B),w(e,l),w(l,s),w(s,r),w(r,o),Lt&&Lt.m(o,null),w(r,i),w(r,a),~d&&te[d].m(a,null),w(a,k),at(g,a,null),w(a,v),Tt&&Tt.m(a,null),w(l,T),w(l,C),w(C,P),w(P,V),w(V,N),n[47](N),w(V,L),w(V,G),Vt&&Vt.m(G,null),w(G,z),w(G,O),w(O,H),at(nt,H,null),w(O,Mt),w(O,ot),n[55](ot),Xe(ot,n[1]),w(O,zt),w(O,Et),Z[Nt].m(Et,null),w(V,$t),w(V,F),w(F,lt),Dt=!0,Pt||(ge=[x(N,"change",n[48]),x(N,"change",n[49]),x(ot,"input",n[56]),x(ot,"keypress",n[57]),x(ot,"keydown",n[58]),x(ot,"input",n[59]),x(ot,"focus",n[60]),x(ot,"paste",n[61]),x(G,"submit",fn(n[63]))],Pt=!0)},p(D,B){var Bt;D[17]?Ct?(Ct.p(D,B),B[0]&131072&&A(Ct,1)):(Ct=Vl(D),Ct.c(),A(Ct,1),Ct.m(t.parentNode,t)):Ct&&(Rt(),R(Ct,1,1,()=>{Ct=null}),jt()),D[2]===!1&&D[9].length>0?Lt?Lt.p(D,B):(Lt=Bl(D),Lt.c(),Lt.m(o,null)):Lt&&(Lt.d(1),Lt=null);let J=d;d=pe(D,B),d===J?~d&&te[d].p(D,B):(p&&(Rt(),R(te[J],1,1,()=>{te[J]=null}),jt()),~d?(p=te[d],p?p.p(D,B):(p=te[d]=_e[d](D),p.c()),A(p,1),p.m(a,k)):p=null);const bt={};B[0]&512&&(bt.messages=D[9]),!_&&B[0]&2&&(_=!0,bt.prompt=D[1],Ot(()=>_=!1)),!h&&B[0]&262144&&(h=!0,bt.user=D[18],Ot(()=>h=!1)),!y&&B[0]&524288&&(y=!0,bt.chatInputPlaceholder=D[19],Ot(()=>y=!1)),g.$set(bt),D[0]!==void 0?Tt?(Tt.p(D,B),B[0]&1&&A(Tt,1)):(Tt=Nl(D),Tt.c(),A(Tt,1),Tt.m(a,null)):Tt&&(Rt(),R(Tt,1,1,()=>{Tt=null}),jt()),D[3].length>0?Vt?(Vt.p(D,B),B[0]&8&&A(Vt,1)):(Vt=Ol(D),Vt.c(),A(Vt,1),Vt.m(G,z)):Vt&&(Rt(),R(Vt,1,1,()=>{Vt=null}),jt());const vt={};B[0]&4096&&(vt.uploadFilesHandler=D[52]),B[0]&1024&&(vt.onClose=D[53]),B[2]&4096&&(vt.$$scope={dirty:B,ctx:D}),!tt&&B[0]&16&&(tt=!0,vt.webSearchEnabled=D[4],Ot(()=>tt=!1)),nt.$set(vt),(!Dt||B[0]&6815744&&Wt!==(Wt=D[19]!==""?D[19]:D[21]?D[22].t("Listening..."):D[22].t("Send a Message")))&&f(ot,"placeholder",Wt),B[0]&2&&Xe(ot,D[1]);let wt=Nt;Nt=$(D,B),Nt===wt?Z[Nt].p(D,B):(Rt(),R(Z[wt],1,1,()=>{Z[wt]=null}),jt(),St=Z[Nt],St?St.p(D,B):(St=Z[Nt]=M[Nt](D),St.c()),A(St,1),St.m(Et,null)),(!Dt||B[0]&8388608&&Kt!==(Kt=((Bt=D[23])==null?void 0:Bt.chatDirection)??"LTR"))&&f(G,"dir",Kt),(!Dt||B[0]&4194304)&&W!==(W=D[22].t("LLMs can make mistakes. Verify important information.")+"")&&yt(lt,W),(!Dt||B[0]&16777216&&Ut!==(Ut="fixed bottom-0 "+(D[24]?"left-0 md:left-[260px]":"left-0")+" right-0"))&&f(e,"class",Ut)},i(D){Dt||(A(Ct),A(p),A(g.$$.fragment,D),A(Tt),A(Vt),A(nt.$$.fragment,D),A(St),Dt=!0)},o(D){R(Ct),R(p),R(g.$$.fragment,D),R(Tt),R(Vt),R(nt.$$.fragment,D),R(St),Dt=!1},d(D){D&&(m(t),m(e)),Ct&&Ct.d(D),Lt&&Lt.d(),~d&&te[d].d(),n[40](null),ct(g),Tt&&Tt.d(),n[47](null),Vt&&Vt.d(),ct(nt),n[55](null),Z[Nt].d(),Pt=!1,ue(ge)}}}function ko(n,t,e){let l,s,r,o,i;ft(n,fe,b=>e(23,s=b)),ft(n,Ue,b=>e(11,r=b)),ft(n,Oe,b=>e(24,o=b)),ft(n,nn,b=>e(25,i=b));const a=de("i18n");ft(n,a,b=>e(22,l=b));let{submitPrompt:u}=t,{stopResponse:c}=t,{autoScroll:d=!0}=t,{atSelectedModel:p}=t,{selectedModels:k}=t,g,_,h,y,v,T,C=!1,P=null,V="",{files:N=[]}=t,{speechRecognitionEnabled:L=!0}=t,{webSearchEnabled:G=!1}=t,{prompt:z=""}=t,{messages:O=[]}=t,H,nt=[],tt,Mt=[],ot=!1;const Wt=-45,zt=()=>{const b=document.getElementById("messages-container");b.scrollTop=b.scrollHeight},Et=async()=>{const b=await navigator.mediaDevices.getUserMedia({audio:!0});tt=new MediaRecorder(b),tt.onstart=()=>{e(21,ot=!0),console.log("Recording started")},tt.ondataavailable=Q=>Mt.push(Q.data),tt.onstop=async()=>{e(21,ot=!1),console.log("Recording stopped");const Q=new Blob(Mt,{type:"audio/wav"}),j=el(Q,"recording.wav"),q=await rl(localStorage.token,j).catch(K=>(ht.error(K),null));q&&(e(1,z=q.text),await kt(),g==null||g.focus(),z!==""&&(s==null?void 0:s.speechAutoSend)===!0&&u(z,P)),Mt=[]},tt.start(),Xt(b)},Xt=b=>{const Q=new AudioContext,j=Q.createMediaStreamSource(b),q=Q.createAnalyser();q.minDecibels=Wt,j.connect(q);const K=q.frequencyBinCount,ut=new Uint8Array(K);let st=Date.now();const et=()=>{if(q.getByteFrequencyData(ut),ut.some(qt=>qt>0)&&(st=Date.now()),ot&&Date.now()-st>3e3){tt.stop(),Q.close();return}window.requestAnimationFrame(et)};window.requestAnimationFrame(et)},Nt=()=>{var b;if(ot)H&&H.stop(),tt&&tt.stop();else if(e(21,ot=!0),((b=s==null?void 0:s.audio)==null?void 0:b.STTEngine)??!1)Et();else if("SpeechRecognition"in window||"webkitSpeechRecognition"in window){H=new(window.SpeechRecognition||window.webkitSpeechRecognition),H.continuous=!0;const Q=3e3;let j;H.start(),H.onresult=async q=>{clearTimeout(j),console.log(q);const K=q.results[Object.keys(q.results).length-1][0].transcript;e(1,z=`${z}${K}`),await kt(),g==null||g.focus(),j=setTimeout(()=>{console.log("Speech recognition turned off due to inactivity."),H.stop()},Q)},H.onend=function(){console.log("recognition ended"),e(21,ot=!1),z!==""&&(s==null?void 0:s.speechAutoSend)===!0&&u(z,P)},H.onerror=function(q){console.log(q),ht.error(l.t("Speech recognition error: {{error}}",{error:q.error})),e(21,ot=!1)}}else ht.error(l.t("SpeechRecognition API is not supported in this browser."))},St=async b=>{console.log(b);const Q={type:"doc",name:b.name,collection_name:"",upload_status:!1,error:""};try{if(e(3,N=[...N,Q]),["audio/mpeg","audio/wav"].includes(b.type)){const q=await rl(localStorage.token,b).catch(K=>(ht.error(K),null));if(q){console.log(q);const K=new Blob([q.text],{type:"text/plain"});b=el(K,`${b.name}.txt`)}}const j=await Ln(localStorage.token,"",b);j&&(Q.upload_status=!0,Q.collection_name=j.collection_name,e(3,N))}catch(j){e(3,N=N.filter(q=>q.name!==b.name)),ht.error(j)}},Kt=async b=>{console.log(b);const Q={type:"doc",name:b,collection_name:"",upload_status:!1,url:b,error:""};try{e(3,N=[...N,Q]);const j=await Un(localStorage.token,"",b);j&&(Q.upload_status=!0,Q.collection_name=j.collection_name,e(3,N))}catch(j){e(3,N=N.filter(q=>q.name!==b)),ht.error(j)}},$t=async b=>{console.log(b);const Q={type:"doc",name:b,collection_name:"",upload_status:!1,url:b,error:""};try{e(3,N=[...N,Q]);const j=await Pn(localStorage.token,b);j&&(Q.upload_status=!0,Q.collection_name=j.collection_name,e(3,N))}catch(j){e(3,N=N.filter(q=>q.name!==b)),ht.error(j)}};qe(()=>{window.setTimeout(()=>g==null?void 0:g.focus(),0);const b=document.querySelector("body"),Q=ut=>{ut.key==="Escape"&&(console.log("Escape"),e(17,C=!1))},j=ut=>{ut.preventDefault(),e(17,C=!0)},q=()=>{e(17,C=!1)},K=async ut=>{var st,et;if(ut.preventDefault(),console.log(ut),(st=ut.dataTransfer)!=null&&st.files){const qt=Array.from((et=ut.dataTransfer)==null?void 0:et.files);qt&&qt.length>0?qt.forEach(Qt=>{if(console.log(Qt,Qt.name.split(".").at(-1)),["image/gif","image/webp","image/jpeg","image/png"].includes(Qt.type)){if(nt.length===0){ht.error(l.t("Selected model(s) do not support image inputs"));return}let ie=new FileReader;ie.onload=Ve=>{e(3,N=[...N,{type:"image",url:`${Ve.target.result}`}])},ie.readAsDataURL(Qt)}else Ke.includes(Qt.type)||xe.includes(Qt.name.split(".").at(-1))||ht.error(l.t("Unknown File Type '{{file_type}}', but accepting and treating as plain text",{file_type:Qt.type})),St(Qt)}):ht.error(l.t("File not found."))}e(17,C=!1)};return window.addEventListener("keydown",Q),b==null||b.addEventListener("dragover",j),b==null||b.addEventListener("drop",K),b==null||b.addEventListener("dragleave",q),()=>{window.removeEventListener("keydown",Q),b==null||b.removeEventListener("dragover",j),b==null||b.removeEventListener("drop",K),b==null||b.removeEventListener("dragleave",q)}});const F=()=>{e(2,d=!0),zt()};function W(b){gt[b?"unshift":"push"](()=>{h=b,e(13,h)})}function lt(b){z=b,e(1,z)}function Ut(b){gt[b?"unshift":"push"](()=>{y=b,e(14,y)})}function Dt(b){z=b,e(1,z)}const Pt=b=>{console.log(b),$t(b.detail)},ge=b=>{console.log(b),Kt(b.detail)},Ct=b=>{var Q;console.log(b),e(3,N=[...N,{type:((Q=b==null?void 0:b.detail)==null?void 0:Q.type)??"doc",...b.detail,upload_status:!0}])};function Lt(b){gt[b?"unshift":"push"](()=>{v=b,e(15,v)})}function _e(b){z=b,e(1,z)}function te(b){P=b,e(18,P)}function pe(b){V=b,e(19,V)}const Se=b=>{e(0,p=b.detail),g==null||g.focus()},Ie=b=>b.id===p.id,Me=()=>{e(0,p=void 0)};function me(b){gt[b?"unshift":"push"](()=>{_=b,e(12,_)})}function Tt(){T=this.files,e(16,T)}const Vt=async()=>{T&&T.length>0?Array.from(T).forEach(Q=>{if(["image/gif","image/webp","image/jpeg","image/png"].includes(Q.type)){if(nt.length===0){ht.error(l.t("Selected model(s) do not support image inputs")),e(16,T=null),e(12,_.value="",_);return}let j=new FileReader;j.onload=q=>{e(3,N=[...N,{type:"image",url:`${q.target.result}`}]),e(16,T=null),e(12,_.value="",_)},j.readAsDataURL(Q)}else Ke.includes(Q.type)||xe.includes(Q.name.split(".").at(-1))?(St(Q),e(12,_.value="",_)):(ht.error(l.t("Unknown File Type '{{file_type}}', but accepting and treating as plain text",{file_type:Q.type})),St(Q),e(12,_.value="",_))}):ht.error(l.t("File not found."))},De=b=>!nt.includes(b),be=b=>{N.splice(b,1),e(3,N)},M=()=>{_.click()},Z=async()=>{await kt(),g==null||g.focus()};function $(b){G=b,e(4,G)}function D(b){gt[b?"unshift":"push"](()=>{g=b,e(10,g),e(1,z)})}function B(){z=this.value,e(1,z)}const J=b=>{(!i||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))&&(b.keyCode==13&&!b.shiftKey&&b.preventDefault(),z!==""&&b.keyCode==13&&!b.shiftKey&&u(z,P))},bt=async b=>{var j;const Q=b.ctrlKey||b.metaKey;if(z===""&&Q&&b.key.toLowerCase()==="r"){b.preventDefault(),console.log("regenerate");const q=[...document.getElementsByClassName("regenerate-response-button")].at(-1);q==null||q.click()}if(z===""&&b.key=="ArrowUp"){b.preventDefault();const q=[...document.getElementsByClassName("user-message")].at(-1),K=[...document.getElementsByClassName("edit-user-message-button")].at(-1);console.log(q),q.scrollIntoView({block:"center"}),K==null||K.click()}if(["/","#","@"].includes(z.charAt(0))&&b.key==="ArrowUp"&&(b.preventDefault(),(h||y||v).selectUp(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),["/","#","@"].includes(z.charAt(0))&&b.key==="ArrowDown"&&(b.preventDefault(),(h||y||v).selectDown(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),["/","#","@"].includes(z.charAt(0))&&b.key==="Enter"){b.preventDefault();const q=[...document.getElementsByClassName("selected-command-option-button")].at(-1);q?q==null||q.click():(j=document.getElementById("send-message-button"))==null||j.click()}if(["/","#","@"].includes(z.charAt(0))&&b.key==="Tab"){b.preventDefault();const q=[...document.getElementsByClassName("selected-command-option-button")].at(-1);q==null||q.click()}else if(b.key==="Tab"){const q=on(z);if(q.length>0){const K=q.at(0),ut=z;e(1,z=z.substring(0,(K==null?void 0:K.endIndex)+1)),await kt(),b.target.scrollTop=b.target.scrollHeight,e(1,z=ut),await kt(),b.preventDefault(),b.target.setSelectionRange(K==null?void 0:K.startIndex,K.endIndex+1)}b.target.style.height="",b.target.style.height=Math.min(b.target.scrollHeight,200)+"px"}b.key==="Escape"&&(console.log("Escape"),e(0,p=void 0))},vt=b=>{b.target.style.height="",b.target.style.height=Math.min(b.target.scrollHeight,200)+"px",e(18,P=null)},wt=b=>{b.target.style.height="",b.target.style.height=Math.min(b.target.scrollHeight,200)+"px"},Bt=b=>{const Q=b.clipboardData||window.clipboardData;if(Q&&Q.items){for(const j of Q.items)if(j.type.indexOf("image")!==-1){const q=j.getAsFile(),K=new FileReader;K.onload=function(ut){e(3,N=[...N,{type:"image",url:`${ut.target.result}`}])},K.readAsDataURL(q)}}},Ft=()=>{Nt()},xt=()=>{u(z,P)};return n.$$set=b=>{"submitPrompt"in b&&e(5,u=b.submitPrompt),"stopResponse"in b&&e(6,c=b.stopResponse),"autoScroll"in b&&e(2,d=b.autoScroll),"atSelectedModel"in b&&e(0,p=b.atSelectedModel),"selectedModels"in b&&e(7,k=b.selectedModels),"files"in b&&e(3,N=b.files),"speechRecognitionEnabled"in b&&e(8,L=b.speechRecognitionEnabled),"webSearchEnabled"in b&&e(4,G=b.webSearchEnabled),"prompt"in b&&e(1,z=b.prompt),"messages"in b&&e(9,O=b.messages)},n.$$.update=()=>{n.$$.dirty[0]&2177&&e(20,nt=[...p?[p]:k].filter(b=>{var Q,j,q,K;return((K=(q=(j=(Q=r.find(ut=>ut.id===b))==null?void 0:Q.info)==null?void 0:j.meta)==null?void 0:q.capabilities)==null?void 0:K.vision)??!0})),n.$$.dirty[0]&1026&&z&&g&&(e(10,g.style.height="",g),e(10,g.style.height=Math.min(g.scrollHeight,200)+"px",g))},[p,z,d,N,G,u,c,k,L,O,g,r,_,h,y,v,T,C,P,V,nt,ot,l,s,o,i,a,zt,Nt,St,Kt,$t,F,W,lt,Ut,Dt,Pt,ge,Ct,Lt,_e,te,pe,Se,Ie,Me,me,Tt,Vt,De,be,M,Z,$,D,B,J,bt,vt,wt,Bt,Ft,xt]}class yo extends Gt{constructor(t){super(),Jt(this,t,ko,wo,Zt,{submitPrompt:5,stopResponse:6,autoScroll:2,atSelectedModel:0,selectedModels:7,files:3,speechRecognitionEnabled:8,webSearchEnabled:4,prompt:1,messages:9},null,[-1,-1,-1])}}function Ul(n,t,e){const l=n.slice();return l[12]=t[e],l[13]=t,l[14]=e,l}function Eo(n){let t,e,l;return e=new he({props:{content:n[4].t("Remove Model"),$$slots:{default:[Io]},$$scope:{ctx:n}}}),{c(){t=S("div"),rt(e.$$.fragment),this.h()},l(s){t=I(s,"DIV",{class:!0});var r=E(t);it(e.$$.fragment,r),r.forEach(m),this.h()},h(){f(t,"class","self-center disabled:text-gray-600 disabled:hover:text-gray-600 mr-2")},m(s,r){U(s,t,r),at(e,t,null),l=!0},p(s,r){const o={};r&16&&(o.content=s[4].t("Remove Model")),r&32771&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){l||(A(e.$$.fragment,s),l=!0)},o(s){R(e.$$.fragment,s),l=!1},d(s){s&&m(t),ct(e)}}}function So(n){let t,e,l;return e=new he({props:{content:n[4].t("Add Model"),$$slots:{default:[Mo]},$$scope:{ctx:n}}}),{c(){t=S("div"),rt(e.$$.fragment),this.h()},l(s){t=I(s,"DIV",{class:!0});var r=E(t);it(e.$$.fragment,r),r.forEach(m),this.h()},h(){f(t,"class","self-center mr-2 disabled:text-gray-600 disabled:hover:text-gray-600")},m(s,r){U(s,t,r),at(e,t,null),l=!0},p(s,r){const o={};r&16&&(o.content=s[4].t("Add Model")),r&32771&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){l||(A(e.$$.fragment,s),l=!0)},o(s){R(e.$$.fragment,s),l=!1},d(s){s&&m(t),ct(e)}}}function Io(n){let t,e,l,s,r;function o(){return n[10](n[14])}return{c(){t=S("button"),e=dt("svg"),l=dt("path"),this.h()},l(i){t=I(i,"BUTTON",{});var a=E(t);e=mt(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=E(e);l=mt(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),E(l).forEach(m),u.forEach(m),a.forEach(m),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"stroke-linejoin","round"),f(l,"d","M19.5 12h-15"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","2"),f(e,"stroke","currentColor"),f(e,"class","size-3.5"),t.disabled=n[1]},m(i,a){U(i,t,a),w(t,e),w(e,l),s||(r=x(t,"click",o),s=!0)},p(i,a){n=i,a&2&&(t.disabled=n[1])},d(i){i&&m(t),s=!1,r()}}}function Mo(n){let t,e,l,s,r;return{c(){t=S("button"),e=dt("svg"),l=dt("path"),this.h()},l(o){t=I(o,"BUTTON",{class:!0});var i=E(t);e=mt(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=E(e);l=mt(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),E(l).forEach(m),a.forEach(m),i.forEach(m),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"stroke-linejoin","round"),f(l,"d","M12 6v12m6-6H6"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","2"),f(e,"stroke","currentColor"),f(e,"class","size-3.5"),f(t,"class",""),t.disabled=n[1]},m(o,i){U(o,t,i),w(t,e),w(e,l),s||(r=x(t,"click",n[9]),s=!0)},p(o,i){i&2&&(t.disabled=o[1])},d(o){o&&m(t),s=!1,r()}}}function Pl(n){let t,e,l,s,r,o,i,a,u,c;function d(h){n[8](h,n[12],n[13],n[14])}let p={placeholder:n[4].t("Select a model"),items:n[3].map(jl)};n[12]!==void 0&&(p.value=n[12]),s=new Qn({props:p}),gt.push(()=>Ht(s,"value",d));const k=[So,Eo],g=[];function _(h,y){return h[14]===0?0:1}return i=_(n),a=g[i]=k[i](n),{c(){t=S("div"),e=S("div"),l=S("div"),rt(s.$$.fragment),o=Y(),a.c(),u=Y(),this.h()},l(h){t=I(h,"DIV",{class:!0});var y=E(t);e=I(y,"DIV",{class:!0});var v=E(e);l=I(v,"DIV",{class:!0});var T=E(l);it(s.$$.fragment,T),T.forEach(m),v.forEach(m),o=X(y),a.l(y),u=X(y),y.forEach(m),this.h()},h(){f(l,"class","mr-1 max-w-full"),f(e,"class","overflow-hidden w-full"),f(t,"class","flex w-full max-w-fit")},m(h,y){U(h,t,y),w(t,e),w(e,l),at(s,l,null),w(t,o),g[i].m(t,null),w(t,u),c=!0},p(h,y){n=h;const v={};y&16&&(v.placeholder=n[4].t("Select a model")),y&8&&(v.items=n[3].map(jl)),!r&&y&1&&(r=!0,v.value=n[12],Ot(()=>r=!1)),s.$set(v),a.p(n,y)},i(h){c||(A(s.$$.fragment,h),A(a),c=!0)},o(h){R(s.$$.fragment,h),R(a),c=!1},d(h){h&&m(t),ct(s),g[i].d()}}}function Rl(n){let t,e,l=n[4].t("Set as default")+"",s,r,o;return{c(){t=S("div"),e=S("button"),s=_t(l),this.h()},l(i){t=I(i,"DIV",{class:!0});var a=E(t);e=I(a,"BUTTON",{});var u=E(e);s=pt(u,l),u.forEach(m),a.forEach(m),this.h()},h(){f(t,"class","text-left mt-0.5 ml-1 text-[0.7rem] text-gray-500")},m(i,a){U(i,t,a),w(t,e),w(e,s),r||(o=x(e,"click",n[7]),r=!0)},p(i,a){a&16&&l!==(l=i[4].t("Set as default")+"")&&yt(s,l)},d(i){i&&m(t),r=!1,o()}}}function Do(n){let t,e,l,s,r=le(n[0]),o=[];for(let u=0;u<r.length;u+=1)o[u]=Pl(Ul(n,r,u));const i=u=>R(o[u],1,1,()=>{o[u]=null});let a=n[2]&&!n[5]&&Rl(n);return{c(){t=S("div");for(let u=0;u<o.length;u+=1)o[u].c();e=Y(),a&&a.c(),l=At(),this.h()},l(u){t=I(u,"DIV",{class:!0});var c=E(t);for(let d=0;d<o.length;d+=1)o[d].l(c);c.forEach(m),e=X(u),a&&a.l(u),l=At(),this.h()},h(){f(t,"class","flex flex-col w-full items-center md:items-start")},m(u,c){U(u,t,c);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(t,null);U(u,e,c),a&&a.m(u,c),U(u,l,c),s=!0},p(u,[c]){if(c&27){r=le(u[0]);let d;for(d=0;d<r.length;d+=1){const p=Ul(u,r,d);o[d]?(o[d].p(p,c),A(o[d],1)):(o[d]=Pl(p),o[d].c(),A(o[d],1),o[d].m(t,null))}for(Rt(),d=r.length;d<o.length;d+=1)i(d);jt()}u[2]&&!u[5]?a?a.p(u,c):(a=Rl(u),a.c(),a.m(l.parentNode,l)):a&&(a.d(1),a=null)},i(u){if(!s){for(let c=0;c<r.length;c+=1)A(o[c]);s=!0}},o(u){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)R(o[c]);s=!1},d(u){u&&(m(t),m(e),m(l)),ye(o,u),a&&a.d(u)}}}const jl=n=>({value:n.id,label:n.name,model:n});function Co(n,t,e){let l,s,r,o;ft(n,Ue,_=>e(3,l=_)),ft(n,fe,_=>e(11,r=_)),ft(n,nn,_=>e(5,o=_));const i=de("i18n");ft(n,i,_=>e(4,s=_));let{selectedModels:a=[""]}=t,{disabled:u=!1}=t,{showSetDefault:c=!0}=t;const d=async()=>{if(a.filter(h=>h==="").length){ht.error(s.t("Choose a model before saving..."));return}fe.set({...r,models:a}),await Bn(localStorage.token,{ui:r}),ht.success(s.t("Default model updated"))};function p(_,h,y,v){y[v]=_,e(0,a),e(3,l)}const k=()=>{e(0,a=[...a,""])},g=_=>{a.splice(_,1),e(0,a),e(3,l)};return n.$$set=_=>{"selectedModels"in _&&e(0,a=_.selectedModels),"disabled"in _&&e(1,u=_.disabled),"showSetDefault"in _&&e(2,c=_.showSetDefault)},n.$$.update=()=>{n.$$.dirty&9&&a.length>0&&l.length>0&&e(0,a=a.map(_=>l.map(h=>h.id).includes(_)?_:""))},[a,u,c,l,s,o,i,d,p,k,g]}class To extends Gt{constructor(t){super(),Jt(this,t,Co,Do,Zt,{selectedModels:0,disabled:1,showSetDefault:2})}}function Vo(n){let t;const e=n[9].default,l=ne(e,n,n[14],null);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,r){l&&l.p&&(!t||r&16384)&&se(l,e,s,s[14],t?re(e,s[14],r,null):oe(s[14]),null)},i(s){t||(A(l,s),t=!0)},o(s){R(l,s),t=!1},d(s){l&&l.d(s)}}}function Bo(n){let t,e,l,s,r=n[3].t("Share")+"",o;return{c(){t=dt("svg"),e=dt("path"),l=Y(),s=S("div"),o=_t(r),this.h()},l(i){t=mt(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=E(t);e=mt(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),E(e).forEach(m),a.forEach(m),l=X(i),s=I(i,"DIV",{class:!0});var u=E(s);o=pt(u,r),u.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M15.75 4.5a3 3 0 1 1 .825 2.066l-8.421 4.679a3.002 3.002 0 0 1 0 1.51l8.421 4.679a3 3 0 1 1-.729 1.31l-8.421-4.678a3 3 0 1 1 0-4.132l8.421-4.679a3 3 0 0 1-.096-.755Z"),f(e,"clip-rule","evenodd"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class","size-4"),f(s,"class","flex items-center")},m(i,a){U(i,t,a),w(t,e),U(i,l,a),U(i,s,a),w(s,o)},p(i,a){a&8&&r!==(r=i[3].t("Share")+"")&&yt(o,r)},d(i){i&&(m(t),m(l),m(s))}}}function No(n){let t,e,l,s,r=n[3].t("Download")+"",o;return{c(){t=dt("svg"),e=dt("path"),l=Y(),s=S("div"),o=_t(r),this.h()},l(i){t=mt(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=E(t);e=mt(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),E(e).forEach(m),a.forEach(m),l=X(i),s=I(i,"DIV",{class:!0});var u=E(s);o=pt(u,r),u.forEach(m),this.h()},h(){f(e,"stroke-linecap","round"),f(e,"stroke-linejoin","round"),f(e,"d","M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"fill","none"),f(t,"viewBox","0 0 24 24"),f(t,"stroke-width","1.5"),f(t,"stroke","currentColor"),f(t,"class","size-4"),f(s,"class","flex items-center")},m(i,a){U(i,t,a),w(t,e),U(i,l,a),U(i,s,a),w(s,o)},p(i,a){a&8&&r!==(r=i[3].t("Download")+"")&&yt(o,r)},d(i){i&&(m(t),m(l),m(s))}}}function Oo(n){let t,e=n[3].t("Plain text (.txt)")+"",l;return{c(){t=S("div"),l=_t(e),this.h()},l(s){t=I(s,"DIV",{class:!0});var r=E(t);l=pt(r,e),r.forEach(m),this.h()},h(){f(t,"class","flex items-center line-clamp-1")},m(s,r){U(s,t,r),w(t,l)},p(s,r){r&8&&e!==(e=s[3].t("Plain text (.txt)")+"")&&yt(l,e)},d(s){s&&m(t)}}}function Ho(n){let t,e=n[3].t("PDF document (.pdf)")+"",l;return{c(){t=S("div"),l=_t(e),this.h()},l(s){t=I(s,"DIV",{class:!0});var r=E(t);l=pt(r,e),r.forEach(m),this.h()},h(){f(t,"class","flex items-center line-clamp-1")},m(s,r){U(s,t,r),w(t,l)},p(s,r){r&8&&e!==(e=s[3].t("PDF document (.pdf)")+"")&&yt(l,e)},d(s){s&&m(t)}}}function Ao(n){let t,e,l,s;return t=new Ae({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Oo]},$$scope:{ctx:n}}}),t.$on("click",n[11]),l=new Ae({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Ho]},$$scope:{ctx:n}}}),l.$on("click",n[12]),{c(){rt(t.$$.fragment),e=Y(),rt(l.$$.fragment)},l(r){it(t.$$.fragment,r),e=X(r),it(l.$$.fragment,r)},m(r,o){at(t,r,o),U(r,e,o),at(l,r,o),s=!0},p(r,o){const i={};o&16392&&(i.$$scope={dirty:o,ctx:r}),t.$set(i);const a={};o&16392&&(a.$$scope={dirty:o,ctx:r}),l.$set(a)},i(r){s||(A(t.$$.fragment,r),A(l.$$.fragment,r),s=!0)},o(r){R(t.$$.fragment,r),R(l.$$.fragment,r),s=!1},d(r){r&&m(e),ct(t,r),ct(l,r)}}}function Lo(n){let t,e,l,s;return t=new Es({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[No]},$$scope:{ctx:n}}}),l=new _s({props:{class:"w-full rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",transition:Ze,sideOffset:8,$$slots:{default:[Ao]},$$scope:{ctx:n}}}),{c(){rt(t.$$.fragment),e=Y(),rt(l.$$.fragment)},l(r){it(t.$$.fragment,r),e=X(r),it(l.$$.fragment,r)},m(r,o){at(t,r,o),U(r,e,o),at(l,r,o),s=!0},p(r,o){const i={};o&16392&&(i.$$scope={dirty:o,ctx:r}),t.$set(i);const a={};o&16392&&(a.$$scope={dirty:o,ctx:r}),l.$set(a)},i(r){s||(A(t.$$.fragment,r),A(l.$$.fragment,r),s=!0)},o(r){R(t.$$.fragment,r),R(l.$$.fragment,r),s=!1},d(r){r&&m(e),ct(t,r),ct(l,r)}}}function Uo(n){let t,e,l,s,r,o,i,a,u;return t=new Ae({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[Bo]},$$scope:{ctx:n}}}),t.$on("click",n[10]),l=new es({props:{$$slots:{default:[Lo]},$$scope:{ctx:n}}}),a=new Fn({props:{chatId:n[1].id}}),{c(){rt(t.$$.fragment),e=Y(),rt(l.$$.fragment),s=Y(),r=S("hr"),o=Y(),i=S("div"),rt(a.$$.fragment),this.h()},l(c){it(t.$$.fragment,c),e=X(c),it(l.$$.fragment,c),s=X(c),r=I(c,"HR",{class:!0}),o=X(c),i=I(c,"DIV",{class:!0});var d=E(i);it(a.$$.fragment,d),d.forEach(m),this.h()},h(){f(r,"class","border-gray-100 dark:border-gray-800 mt-2.5 mb-1.5"),f(i,"class","flex p-1")},m(c,d){at(t,c,d),U(c,e,d),at(l,c,d),U(c,s,d),U(c,r,d),U(c,o,d),U(c,i,d),at(a,i,null),u=!0},p(c,d){const p={};d&16392&&(p.$$scope={dirty:d,ctx:c}),t.$set(p);const k={};d&16392&&(k.$$scope={dirty:d,ctx:c}),l.$set(k);const g={};d&2&&(g.chatId=c[1].id),a.$set(g)},i(c){u||(A(t.$$.fragment,c),A(l.$$.fragment,c),A(a.$$.fragment,c),u=!0)},o(c){R(t.$$.fragment,c),R(l.$$.fragment,c),R(a.$$.fragment,c),u=!1},d(c){c&&(m(e),m(s),m(r),m(o),m(i)),ct(t,c),ct(l,c),ct(a)}}}function Po(n){let t,e,l;return e=new rn({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:8,side:"bottom",align:"end",transition:Ze,$$slots:{default:[Uo]},$$scope:{ctx:n}}}),{c(){t=S("div"),rt(e.$$.fragment),this.h()},l(s){t=I(s,"DIV",{slot:!0});var r=E(t);it(e.$$.fragment,r),r.forEach(m),this.h()},h(){f(t,"slot","content")},m(s,r){U(s,t,r),at(e,t,null),l=!0},p(s,r){const o={};r&16395&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){l||(A(e.$$.fragment,s),l=!0)},o(s){R(e.$$.fragment,s),l=!1},d(s){s&&m(t),ct(e)}}}function Ro(n){let t,e;return t=new cn({props:{$$slots:{content:[Po],default:[Vo]},$$scope:{ctx:n}}}),t.$on("change",n[13]),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,[s]){const r={};s&16395&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(A(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function jo(n,t,e){let l,{$$slots:s={},$$scope:r}=t;const{saveAs:o}=Xn,i=de("i18n");ft(n,i,T=>e(3,l=T));let{shareEnabled:a=!1}=t,{shareHandler:u}=t,{downloadHandler:c}=t,{chat:d}=t,{onClose:p=()=>{}}=t;const k=async()=>{const T=d.chat;console.log("download",d);const C=T.messages.reduce((V,N,L,G)=>`${V}### ${N.role.toUpperCase()}
${N.content}

`,"");let P=new Blob([C],{type:"text/plain"});o(P,`chat-${T.title}.txt`)},g=async()=>{const T=d.chat;console.log("download",d);const C=await Jn(T),P=window.URL.createObjectURL(C),V=document.createElement("a");V.href=P,V.download=`chat-${T.title}.pdf`,document.body.appendChild(V),V.click(),document.body.removeChild(V),window.URL.revokeObjectURL(P)},_=()=>{u()},h=()=>{k()},y=()=>{g()},v=T=>{T.detail===!1&&p()};return n.$$set=T=>{"shareEnabled"in T&&e(7,a=T.shareEnabled),"shareHandler"in T&&e(0,u=T.shareHandler),"downloadHandler"in T&&e(8,c=T.downloadHandler),"chat"in T&&e(1,d=T.chat),"onClose"in T&&e(2,p=T.onClose),"$$scope"in T&&e(14,r=T.$$scope)},[u,d,p,l,i,k,g,a,c,s,_,h,y,v,r]}class zo extends Gt{constructor(t){super(),Jt(this,t,jo,Ro,Zt,{shareEnabled:7,shareHandler:0,downloadHandler:8,chat:1,onClose:2})}}function zl(n){let t,e,l;function s(o){n[15](o)}let r={showSetDefault:!n[2]};return n[0]!==void 0&&(r.selectedModels=n[0]),t=new To({props:r}),gt.push(()=>Ht(t,"selectedModels",s)),{c(){rt(t.$$.fragment)},l(o){it(t.$$.fragment,o)},m(o,i){at(t,o,i),l=!0},p(o,i){const a={};i&4&&(a.showSetDefault=!o[2]),!e&&i&1&&(e=!0,a.selectedModels=o[0],Ot(()=>e=!1)),t.$set(a)},i(o){l||(A(t.$$.fragment,o),l=!0)},o(o){R(t.$$.fragment,o),l=!1},d(o){ct(t,o)}}}function Fl(n){let t,e;return t=new zo({props:{chat:n[3],shareEnabled:n[2],shareHandler:n[16],downloadHandler:n[17],$$slots:{default:[Fo]},$$scope:{ctx:n}}}),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,s){const r={};s&8&&(r.chat=l[3]),s&4&&(r.shareEnabled=l[2]),s&32&&(r.shareHandler=l[16]),s&64&&(r.downloadHandler=l[17]),s&2097152&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(A(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function Fo(n){let t,e='<div class="m-auto self-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"></path></svg></div>';return{c(){t=S("button"),t.innerHTML=e,this.h()},l(l){t=I(l,"BUTTON",{class:!0,id:!0,"data-svelte-h":!0}),Yt(t)!=="svelte-9m6068"&&(t.innerHTML=e),this.h()},h(){f(t,"class","hidden md:flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition"),f(t,"id","chat-context-menu-button")},m(l,s){U(l,t,s)},p:It,d(l){l&&m(t)}}}function Wo(n){let t,e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"></path><path d="M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"></path></svg>',s,r,o;return{c(){t=S("button"),e=S("div"),e.innerHTML=l,this.h()},l(i){t=I(i,"BUTTON",{id:!0,class:!0});var a=E(t);e=I(a,"DIV",{class:!0,"data-svelte-h":!0}),Yt(e)!=="svelte-1fcii9y"&&(e.innerHTML=l),a.forEach(m),this.h()},h(){f(e,"class","m-auto self-center"),f(t,"id","new-chat-button"),f(t,"class",s="flex "+(n[8]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition")},m(i,a){U(i,t,a),w(t,e),r||(o=x(t,"click",n[18]),r=!0)},p(i,a){a&256&&s!==(s="flex "+(i[8]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition")&&f(t,"class",s)},d(i){i&&m(t),r=!1,o()}}}function Wl(n){let t,e;return t=new qn({props:{className:"max-w-[200px]",role:n[10].role,$$slots:{default:[qo]},$$scope:{ctx:n}}}),t.$on("show",n[19]),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,s){const r={};s&1024&&(r.role=l[10].role),s&2098176&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(A(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function qo(n){let t,e,l,s;return{c(){t=S("button"),e=S("div"),l=S("img"),this.h()},l(r){t=I(r,"BUTTON",{class:!0,"aria-label":!0});var o=E(t);e=I(o,"DIV",{class:!0});var i=E(e);l=I(i,"IMG",{src:!0,class:!0,alt:!0,draggable:!0}),i.forEach(m),o.forEach(m),this.h()},h(){we(l.src,s=n[10].profile_image_url)||f(l,"src",s),f(l,"class","size-6 object-cover rounded-full"),f(l,"alt","User profile"),f(l,"draggable","false"),f(e,"class","self-center"),f(t,"class","select-none flex rounded-xl p-1.5 w-full hover:bg-gray-100 dark:hover:bg-gray-850 transition"),f(t,"aria-label","User Menu")},m(r,o){U(r,t,o),w(t,e),w(e,l)},p(r,o){o&1024&&!we(l.src,s=r[10].profile_image_url)&&f(l,"src",s)},d(r){r&&m(t)}}}function Zo(n){let t,e,l,s,r,o,i,a,u,c,d,p,k,g,_,h,y,v,T,C,P;function V(O){n[13](O)}let N={chatId:n[7]};n[5]!==void 0&&(N.show=n[5]),t=new Wn({props:N}),gt.push(()=>Ht(t,"show",V)),c=new Kn({});let L=n[4]&&zl(n),G=n[2]&&Fl(n);y=new he({props:{content:n[9].t("New Chat"),$$slots:{default:[Wo]},$$scope:{ctx:n}}});let z=n[10]!==void 0&&Wl(n);return{c(){rt(t.$$.fragment),l=Y(),s=S("nav"),r=S("div"),o=S("div"),i=S("div"),a=S("button"),u=S("div"),rt(c.$$.fragment),p=Y(),k=S("div"),L&&L.c(),g=Y(),_=S("div"),G&&G.c(),h=Y(),rt(y.$$.fragment),v=Y(),z&&z.c(),this.h()},l(O){it(t.$$.fragment,O),l=X(O),s=I(O,"NAV",{id:!0,class:!0});var H=E(s);r=I(H,"DIV",{class:!0});var nt=E(r);o=I(nt,"DIV",{class:!0});var tt=E(o);i=I(tt,"DIV",{class:!0});var Mt=E(i);a=I(Mt,"BUTTON",{id:!0,class:!0});var ot=E(a);u=I(ot,"DIV",{class:!0});var Wt=E(u);it(c.$$.fragment,Wt),Wt.forEach(m),ot.forEach(m),Mt.forEach(m),p=X(tt),k=I(tt,"DIV",{class:!0});var zt=E(k);L&&L.l(zt),zt.forEach(m),g=X(tt),_=I(tt,"DIV",{class:!0});var Et=E(_);G&&G.l(Et),h=X(Et),it(y.$$.fragment,Et),v=X(Et),z&&z.l(Et),Et.forEach(m),tt.forEach(m),nt.forEach(m),H.forEach(m),this.h()},h(){f(u,"class","m-auto self-center"),f(a,"id","sidebar-toggle-button"),f(a,"class","cursor-pointer px-2 py-2 flex rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition"),f(i,"class",d=(n[8]?"md:hidden":"")+" mr-3 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),f(k,"class","flex-1 overflow-hidden max-w-full"),f(_,"class","self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),f(o,"class","flex items-center w-full max-w-full"),f(r,"class","flex max-w-full w-full mx-auto px-5 pt-0.5 md:px-[1rem]"),f(s,"id","nav"),f(s,"class","sticky py-2.5 top-0 flex flex-row justify-center z-30")},m(O,H){at(t,O,H),U(O,l,H),U(O,s,H),w(s,r),w(r,o),w(o,i),w(i,a),w(a,u),at(c,u,null),w(o,p),w(o,k),L&&L.m(k,null),w(o,g),w(o,_),G&&G.m(_,null),w(_,h),at(y,_,null),w(_,v),z&&z.m(_,null),T=!0,C||(P=x(a,"click",n[14]),C=!0)},p(O,[H]){const nt={};H&128&&(nt.chatId=O[7]),!e&&H&32&&(e=!0,nt.show=O[5],Ot(()=>e=!1)),t.$set(nt),(!T||H&256&&d!==(d=(O[8]?"md:hidden":"")+" mr-3 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"))&&f(i,"class",d),O[4]?L?(L.p(O,H),H&16&&A(L,1)):(L=zl(O),L.c(),A(L,1),L.m(k,null)):L&&(Rt(),R(L,1,1,()=>{L=null}),jt()),O[2]?G?(G.p(O,H),H&4&&A(G,1)):(G=Fl(O),G.c(),A(G,1),G.m(_,h)):G&&(Rt(),R(G,1,1,()=>{G=null}),jt());const tt={};H&512&&(tt.content=O[9].t("New Chat")),H&2097410&&(tt.$$scope={dirty:H,ctx:O}),y.$set(tt),O[10]!==void 0?z?(z.p(O,H),H&1024&&A(z,1)):(z=Wl(O),z.c(),A(z,1),z.m(_,null)):z&&(Rt(),R(z,1,1,()=>{z=null}),jt())},i(O){T||(A(t.$$.fragment,O),A(c.$$.fragment,O),A(L),A(G),A(y.$$.fragment,O),A(z),T=!0)},o(O){R(t.$$.fragment,O),R(c.$$.fragment,O),R(L),R(G),R(y.$$.fragment,O),R(z),T=!1},d(O){O&&(m(l),m(s)),ct(t,O),ct(c),L&&L.d(),G&&G.d(),ct(y),z&&z.d(),C=!1,P()}}}function Go(n,t,e){let l,s,r,o,i;ft(n,sn,L=>e(20,l=L)),ft(n,ve,L=>e(7,s=L)),ft(n,Oe,L=>e(8,r=L)),ft(n,bn,L=>e(10,i=L));const a=de("i18n");ft(n,a,L=>e(9,o=L));let{initNewChat:u}=t,{title:c=l}=t,{shareEnabled:d=!1}=t,{chat:p}=t,{selectedModels:k}=t,{showModelSelector:g=!0}=t,_=!1,h=!1;function y(L){_=L,e(5,_)}const v=()=>{Oe.set(!r)};function T(L){k=L,e(0,k)}const C=()=>{e(5,_=!_)},P=()=>{e(6,h=!h)},V=()=>{u()},N=L=>{L.detail==="archived-chat"&&vn.set(!0)};return n.$$set=L=>{"initNewChat"in L&&e(1,u=L.initNewChat),"title"in L&&e(12,c=L.title),"shareEnabled"in L&&e(2,d=L.shareEnabled),"chat"in L&&e(3,p=L.chat),"selectedModels"in L&&e(0,k=L.selectedModels),"showModelSelector"in L&&e(4,g=L.showModelSelector)},[k,u,d,p,g,_,h,s,r,o,i,a,c,y,v,T,C,P,V,N]}class Jo extends Gt{constructor(t){super(),Jt(this,t,Go,Zo,Zt,{initNewChat:1,title:12,shareEnabled:2,chat:3,selectedModels:0,showModelSelector:4})}}function Qo(n){let t,e,l,s,r,o,i;return a(),{feed:u,reset:a};function a(){t=!0,e="",l=0,s=-1,r=void 0,o=void 0,i=""}function u(d){e=e?e+d:d,t&&Yo(e)&&(e=e.slice(un.length)),t=!1;const p=e.length;let k=0,g=!1;for(;k<p;){g&&(e[k]===`
`&&++k,g=!1);let _=-1,h=s,y;for(let v=l;_<0&&v<p;++v)y=e[v],y===":"&&h<0?h=v-k:y==="\r"?(g=!0,_=v-k):y===`
`&&(_=v-k);if(_<0){l=p-k,s=h;break}else l=0,s=-1;c(e,k,h,_),k+=_+1}k===p?e="":k>0&&(e=e.slice(k))}function c(d,p,k,g){if(g===0){i.length>0&&(n({type:"event",id:r,event:o||void 0,data:i.slice(0,-1)}),i="",r=void 0),o=void 0;return}const _=k<0,h=d.slice(p,p+(_?g:k));let y=0;_?y=g:d[p+k+1]===" "?y=k+2:y=k+1;const v=p+y,T=g-y,C=d.slice(v,v+T).toString();if(h==="data")i+=C?"".concat(C,`
`):`
`;else if(h==="event")o=C;else if(h==="id"&&!C.includes("\0"))r=C;else if(h==="retry"){const P=parseInt(C,10);Number.isNaN(P)||n({type:"reconnect-interval",value:P})}}}const un=[239,187,191];function Yo(n){return un.every((t,e)=>n.charCodeAt(e)===t)}class Xo extends TransformStream{constructor(){let t;super({start(e){t=Qo(l=>{l.type==="event"&&e.enqueue(l)})},transform(e){t.feed(e)}})}}async function Ko(n,t){const e=n.pipeThrough(new TextDecoderStream).pipeThrough(new Xo).getReader();let l=xo(e);return t&&(l=$o(l)),l}async function*xo(n){var t,e,l;for(;;){const{value:s,done:r}=await n.read();if(r){yield{done:!0,value:""};break}if(!s)continue;const o=s.data;if(o.startsWith("[DONE]")){yield{done:!0,value:""};break}try{const i=JSON.parse(o);if(console.log(i),i.error){yield{done:!0,value:"",error:i.error};break}if(i.citations){yield{done:!1,value:"",citations:i.citations};continue}yield{done:!1,value:((l=(e=(t=i.choices)==null?void 0:t[0])==null?void 0:e.delta)==null?void 0:l.content)??"",usage:i.usage}}catch(i){console.error("Error extracting delta from SSE event:",i)}}}async function*$o(n){for await(const t of n){if(t.done){yield t;return}if(t.citations){yield t;continue}let e=t.value;if(e.length<5){yield{done:!1,value:e};continue}for(;e!="";){const l=Math.min(Math.floor(Math.random()*3)+1,e.length);yield{done:!1,value:e.slice(0,l)},(document==null?void 0:document.visibilityState)!=="hidden"&&await tr(5),e=e.slice(l)}}}const tr=n=>new Promise(t=>setTimeout(t,n));function ql(n){let t,e=n[2]&&Zl(n);return{c(){e&&e.c(),t=At()},l(l){e&&e.l(l),t=At()},m(l,s){e&&e.m(l,s),U(l,t,s)},p(l,s){l[2]?e?(e.p(l,s),s&4&&A(e,1)):(e=Zl(l),e.c(),A(e,1),e.m(t.parentNode,t)):e&&(Rt(),R(e,1,1,()=>{e=null}),jt())},d(l){l&&m(t),e&&e.d(l)}}}function Zl(n){let t,e,l,s,r=n[1].type+"",o,i,a,u,c,d=n[1].content+"",p,k,g,_,h,y,v=n[1].url&&Gl(),T=n[1].url&&Jl(),C=n[1].dismissible&&Ql(n);return{c(){t=S("div"),e=S("div"),l=S("div"),s=S("div"),o=_t(r),a=Y(),v&&v.c(),u=Y(),c=S("div"),p=_t(d),k=Y(),T&&T.c(),g=Y(),_=S("div"),C&&C.c(),this.h()},l(P){t=I(P,"DIV",{class:!0});var V=E(t);e=I(V,"DIV",{class:!0});var N=E(e);l=I(N,"DIV",{class:!0});var L=E(l);s=I(L,"DIV",{class:!0});var G=E(s);o=pt(G,r),G.forEach(m),a=X(L),v&&v.l(L),L.forEach(m),u=X(N),c=I(N,"DIV",{class:!0});var z=E(c);p=pt(z,d),z.forEach(m),N.forEach(m),k=X(V),T&&T.l(V),g=X(V),_=I(V,"DIV",{class:!0});var O=E(_);C&&C.l(O),O.forEach(m),V.forEach(m),this.h()},h(){f(s,"class",i="text-xs font-black "+(n[3][n[1].type]??n[3].info)+" w-fit px-2 rounded uppercase line-clamp-1 mr-0.5"),f(l,"class","flex justify-between self-start"),f(c,"class","flex-1 text-xs text-gray-700 dark:text-white"),f(e,"class","flex flex-col md:flex-row md:items-center flex-1 text-sm w-fit gap-1.5"),f(_,"class","flex self-start"),f(t,"class","top-0 left-0 right-0 p-2 mx-4 px-3 flex justify-center items-center relative rounded-xl border border-gray-100 dark:border-gray-850 text-gray-800 dark:text-gary-100 bg-white dark:bg-gray-900 backdrop-blur-xl z-40")},m(P,V){U(P,t,V),w(t,e),w(e,l),w(l,s),w(s,o),w(l,a),v&&v.m(l,null),w(e,u),w(e,c),w(c,p),w(t,k),T&&T.m(t,null),w(t,g),w(t,_),C&&C.m(_,null),y=!0},p(P,V){(!y||V&2)&&r!==(r=P[1].type+"")&&yt(o,r),(!y||V&2&&i!==(i="text-xs font-black "+(P[3][P[1].type]??P[3].info)+" w-fit px-2 rounded uppercase line-clamp-1 mr-0.5"))&&f(s,"class",i),P[1].url?v||(v=Gl(),v.c(),v.m(l,null)):v&&(v.d(1),v=null),(!y||V&2)&&d!==(d=P[1].content+"")&&yt(p,d),P[1].url?T||(T=Jl(),T.c(),T.m(t,g)):T&&(T.d(1),T=null),P[1].dismissible?C?C.p(P,V):(C=Ql(P),C.c(),C.m(_,null)):C&&(C.d(1),C=null)},i(P){y||(P&&Le(()=>{y&&(h||(h=Ne(t,il,{delay:100,duration:300},!0)),h.run(1))}),y=!0)},o(P){P&&(h||(h=Ne(t,il,{delay:100,duration:300},!1)),h.run(0)),y=!1},d(P){P&&m(t),v&&v.d(),T&&T.d(),C&&C.d(),P&&h&&h.end()}}}function Gl(n){let t,e='<a class="text-gray-700 dark:text-white text-xs font-bold underline" href="/assets/files/whitepaper.pdf" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-4 h-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){t=S("div"),t.innerHTML=e,this.h()},l(l){t=I(l,"DIV",{class:!0,"data-svelte-h":!0}),Yt(t)!=="svelte-1ofrdjc"&&(t.innerHTML=e),this.h()},h(){f(t,"class","flex md:hidden group w-fit md:items-center")},m(l,s){U(l,t,s)},d(l){l&&m(t)}}}function Jl(n){let t,e='<a class="text-gray-700 dark:text-white text-xs font-bold underline" href="/" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){t=S("div"),t.innerHTML=e,this.h()},l(l){t=I(l,"DIV",{class:!0,"data-svelte-h":!0}),Yt(t)!=="svelte-15ujvd1"&&(t.innerHTML=e),this.h()},h(){f(t,"class","hidden md:flex group w-fit md:items-center")},m(l,s){U(l,t,s)},d(l){l&&m(t)}}}function Ql(n){let t,e="",l,s;return{c(){t=S("button"),t.textContent=e,this.h()},l(r){t=I(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Yt(t)!=="svelte-17pf3tf"&&(t.textContent=e),this.h()},h(){f(t,"class","-mt-[3px] ml-1.5 mr-1 text-gray-400 dark:hover:text-white h-1")},m(r,o){U(r,t,o),l||(s=x(t,"click",n[5]),l=!0)},p:It,d(r){r&&m(t),l=!1,s()}}}function er(n){let t,e=!n[0]&&ql(n);return{c(){e&&e.c(),t=At()},l(l){e&&e.l(l),t=At()},m(l,s){e&&e.m(l,s),U(l,t,s)},p(l,[s]){l[0]?e&&(e.d(1),e=null):e?e.p(l,s):(e=ql(l),e.c(),e.m(t.parentNode,t))},i:It,o:It,d(l){l&&m(t),e&&e.d(l)}}}function lr(n,t,e){const l=We();let{banner:s={id:"",type:"info",title:"",content:"",url:"",dismissable:!0,timestamp:Math.floor(Date.now()/1e3)}}=t,{dismissed:r=!1}=t,o=!1;const i={info:"bg-blue-500/20 text-blue-700 dark:text-blue-200 ",success:"bg-green-500/20 text-green-700 dark:text-green-200",warning:"bg-yellow-500/20 text-yellow-700 dark:text-yellow-200",error:"bg-red-500/20 text-red-700 dark:text-red-200"},a=c=>{e(0,r=!0),l("dismiss",c)};qe(()=>{e(2,o=!0)});const u=()=>{a(s.id)};return n.$$set=c=>{"banner"in c&&e(1,s=c.banner),"dismissed"in c&&e(0,r=c.dismissed)},[r,s,o,i,a,u]}class nr extends Gt{constructor(t){super(),Jt(this,t,lr,er,Zt,{banner:1,dismissed:0})}}const{document:Fe}=hn;function Yl(n,t,e){const l=n.slice();return l[61]=t[e],l}function Xl(n){let t,e,l,s,r,o,i,a,u,c,d,p,k,g,_,h,y,v,T,C,P,V,N,L,G,z;function O(W){n[25](W)}function H(W){n[26](W)}let nt={title:n[10],shareEnabled:n[13].length>0,chat:n[9],initNewChat:n[19]};n[6]!==void 0&&(nt.selectedModels=n[6]),n[5]!==void 0&&(nt.showModelSelector=n[5]),e=new Jo({props:nt}),gt.push(()=>Ht(e,"selectedModels",O)),gt.push(()=>Ht(e,"showModelSelector",H));let tt=n[17].length>0&&!n[14]&&n[6].length<=1&&Kl(n);function Mt(W){n[29](W)}function ot(W){n[30](W)}function Wt(W){n[31](W)}function zt(W){n[32](W)}let Et={chatId:n[14],selectedModels:n[6],processing:or,bottomPadding:n[12].length>0,sendPrompt:n[21],continueGeneration:n[24],regenerateResponse:n[23]};n[1]!==void 0&&(Et.history=n[1]),n[13]!==void 0&&(Et.messages=n[13]),n[3]!==void 0&&(Et.autoScroll=n[3]),n[11]!==void 0&&(Et.prompt=n[11]),c=new jn({props:Et}),gt.push(()=>Ht(c,"history",Mt)),gt.push(()=>Ht(c,"messages",ot)),gt.push(()=>Ht(c,"autoScroll",Wt)),gt.push(()=>Ht(c,"prompt",zt));function Xt(W){n[35](W)}function Nt(W){n[36](W)}function St(W){n[37](W)}function Kt(W){n[38](W)}function $t(W){n[39](W)}let F={selectedModels:n[6],messages:n[13],submitPrompt:n[20],stopResponse:n[22]};return n[12]!==void 0&&(F.files=n[12]),n[11]!==void 0&&(F.prompt=n[11]),n[3]!==void 0&&(F.autoScroll=n[3]),n[8]!==void 0&&(F.webSearchEnabled=n[8]),n[7]!==void 0&&(F.atSelectedModel=n[7]),v=new yo({props:F}),gt.push(()=>Ht(v,"files",Xt)),gt.push(()=>Ht(v,"prompt",Nt)),gt.push(()=>Ht(v,"autoScroll",St)),gt.push(()=>Ht(v,"webSearchEnabled",Kt)),gt.push(()=>Ht(v,"atSelectedModel",$t)),{c(){t=S("div"),rt(e.$$.fragment),r=Y(),tt&&tt.c(),o=Y(),i=S("div"),a=S("div"),u=S("div"),rt(c.$$.fragment),y=Y(),rt(v.$$.fragment),this.h()},l(W){t=I(W,"DIV",{class:!0});var lt=E(t);it(e.$$.fragment,lt),r=X(lt),tt&&tt.l(lt),o=X(lt),i=I(lt,"DIV",{class:!0});var Ut=E(i);a=I(Ut,"DIV",{class:!0,id:!0});var Dt=E(a);u=I(Dt,"DIV",{class:!0});var Pt=E(u);it(c.$$.fragment,Pt),Pt.forEach(m),Dt.forEach(m),Ut.forEach(m),lt.forEach(m),y=X(W),it(v.$$.fragment,W),this.h()},h(){f(u,"class",_="h-full w-full flex flex-col "+(n[0]?"py-4":"pt-2 pb-4")),f(a,"class","pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0 max-w-full"),f(a,"id","messages-container"),f(i,"class","flex flex-col flex-auto"),f(t,"class",h="min-h-screen max-h-screen "+(n[16]?"md:max-w-[calc(100%-260px)]":"")+" w-full max-w-full flex flex-col")},m(W,lt){U(W,t,lt),at(e,t,null),w(t,r),tt&&tt.m(t,null),w(t,o),w(t,i),w(i,a),w(a,u),at(c,u,null),n[33](a),U(W,y,lt),at(v,W,lt),L=!0,G||(z=x(a,"scroll",n[34]),G=!0)},p(W,lt){const Ut={};lt[0]&1024&&(Ut.title=W[10]),lt[0]&8192&&(Ut.shareEnabled=W[13].length>0),lt[0]&512&&(Ut.chat=W[9]),!l&&lt[0]&64&&(l=!0,Ut.selectedModels=W[6],Ot(()=>l=!1)),!s&&lt[0]&32&&(s=!0,Ut.showModelSelector=W[5],Ot(()=>s=!1)),e.$set(Ut),W[17].length>0&&!W[14]&&W[6].length<=1?tt?(tt.p(W,lt),lt[0]&147520&&A(tt,1)):(tt=Kl(W),tt.c(),A(tt,1),tt.m(t,o)):tt&&(Rt(),R(tt,1,1,()=>{tt=null}),jt());const Dt={};lt[0]&16384&&(Dt.chatId=W[14]),lt[0]&64&&(Dt.selectedModels=W[6]),lt[0]&4096&&(Dt.bottomPadding=W[12].length>0),!d&&lt[0]&2&&(d=!0,Dt.history=W[1],Ot(()=>d=!1)),!p&&lt[0]&8192&&(p=!0,Dt.messages=W[13],Ot(()=>p=!1)),!k&&lt[0]&8&&(k=!0,Dt.autoScroll=W[3],Ot(()=>k=!1)),!g&&lt[0]&2048&&(g=!0,Dt.prompt=W[11],Ot(()=>g=!1)),c.$set(Dt),(!L||lt[0]&1&&_!==(_="h-full w-full flex flex-col "+(W[0]?"py-4":"pt-2 pb-4")))&&f(u,"class",_),(!L||lt[0]&65536&&h!==(h="min-h-screen max-h-screen "+(W[16]?"md:max-w-[calc(100%-260px)]":"")+" w-full max-w-full flex flex-col"))&&f(t,"class",h);const Pt={};lt[0]&64&&(Pt.selectedModels=W[6]),lt[0]&8192&&(Pt.messages=W[13]),!T&&lt[0]&4096&&(T=!0,Pt.files=W[12],Ot(()=>T=!1)),!C&&lt[0]&2048&&(C=!0,Pt.prompt=W[11],Ot(()=>C=!1)),!P&&lt[0]&8&&(P=!0,Pt.autoScroll=W[3],Ot(()=>P=!1)),!V&&lt[0]&256&&(V=!0,Pt.webSearchEnabled=W[8],Ot(()=>V=!1)),!N&&lt[0]&128&&(N=!0,Pt.atSelectedModel=W[7],Ot(()=>N=!1)),v.$set(Pt)},i(W){L||(A(e.$$.fragment,W),A(tt),A(c.$$.fragment,W),A(v.$$.fragment,W),L=!0)},o(W){R(e.$$.fragment,W),R(tt),R(c.$$.fragment,W),R(v.$$.fragment,W),L=!1},d(W){W&&(m(t),m(y)),ct(e),tt&&tt.d(),ct(c),n[33](null),ct(v,W),G=!1,z()}}}function Kl(n){let t,e,l,s,r=le(n[17].filter(n[27])),o=[];for(let a=0;a<r.length;a+=1)o[a]=xl(Yl(n,r,a));const i=a=>R(o[a],1,1,()=>{o[a]=null});return{c(){t=S("div"),e=S("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){t=I(a,"DIV",{class:!0});var u=E(t);e=I(u,"DIV",{class:!0});var c=E(e);for(let d=0;d<o.length;d+=1)o[d].l(c);c.forEach(m),u.forEach(m),this.h()},h(){f(e,"class","flex flex-col gap-1 w-full"),f(t,"class",l="absolute top-[4.25rem] w-full "+(n[16]?"md:max-w-[calc(100%-260px)]":""))},m(a,u){U(a,t,u),w(t,e);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(e,null);s=!0},p(a,u){if(u[0]&131072){r=le(a[17].filter(a[27]));let c;for(c=0;c<r.length;c+=1){const d=Yl(a,r,c);o[c]?(o[c].p(d,u),A(o[c],1)):(o[c]=xl(d),o[c].c(),A(o[c],1),o[c].m(e,null))}for(Rt(),c=r.length;c<o.length;c+=1)i(c);jt()}(!s||u[0]&65536&&l!==(l="absolute top-[4.25rem] w-full "+(a[16]?"md:max-w-[calc(100%-260px)]":"")))&&f(t,"class",l)},i(a){if(!s){for(let u=0;u<r.length;u+=1)A(o[u]);s=!0}},o(a){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)R(o[u]);s=!1},d(a){a&&m(t),ye(o,a)}}}function xl(n){let t,e;return t=new nr({props:{banner:n[61]}}),t.$on("dismiss",n[28]),{c(){rt(t.$$.fragment)},l(l){it(t.$$.fragment,l)},m(l,s){at(t,l,s),e=!0},p(l,s){const r={};s[0]&131072&&(r.banner=l[61]),t.$set(r)},i(l){e||(A(t.$$.fragment,l),e=!0)},o(l){R(t.$$.fragment,l),e=!1},d(l){ct(t,l)}}}function sr(n){let t,e,l,s;Fe.title=t=`
		`+(n[10]?`${n[10].length>30?`${n[10].slice(0,30)}...`:n[10]} | ${n[15]}`:`${n[15]}`)+`
	`;let r=(!n[0]||n[2]&&n[0])&&Xl(n);return{c(){e=Y(),r&&r.c(),l=At()},l(o){mn("svelte-1123lr8",Fe.head).forEach(m),e=X(o),r&&r.l(o),l=At()},m(o,i){U(o,e,i),r&&r.m(o,i),U(o,l,i),s=!0},p(o,i){(!s||i[0]&33792)&&t!==(t=`
		`+(o[10]?`${o[10].length>30?`${o[10].slice(0,30)}...`:o[10]} | ${o[15]}`:`${o[15]}`)+`
	`)&&(Fe.title=t),!o[0]||o[2]&&o[0]?r?(r.p(o,i),i[0]&5&&A(r,1)):(r=Xl(o),r.c(),A(r,1),r.m(l.parentNode,l)):r&&(Rt(),R(r,1,1,()=>{r=null}),jt())},i(o){s||(A(r),s=!0)},o(o){R(r),s=!1},d(o){o&&(m(e),m(l)),r&&r.d(o)}}}let or="";function rr(n,t,e){let l,s,r,o,i,a,u,c,d;ft(n,ve,M=>e(14,l=M)),ft(n,fe,M=>e(43,s=M)),ft(n,Ue,M=>e(44,r=M)),ft(n,gn,M=>e(46,i=M)),ft(n,ln,M=>e(47,a=M)),ft(n,sn,M=>e(15,u=M)),ft(n,Oe,M=>e(16,c=M)),ft(n,wn,M=>e(17,d=M));const p=de("i18n");ft(n,p,M=>e(45,o=M));let{chatIdProp:k=""}=t,g=!1,_=!1,h=!0,y,v=null,T=!0,C=[""],P,V=!1,N=null,L="",G="",z=[],O=[],H={messages:{},currentId:null};qe(async()=>{l?(s.saveChatHistory??!0)||await Pe("/"):await nt()});const nt=async()=>{var $;v!==null&&(await sl(localStorage.token,v),v=null),window.history.replaceState(H.state,"","/"),await ve.set(""),e(3,h=!0),e(10,L=""),e(13,O=[]),e(1,H={messages:{},currentId:null}),i.url.searchParams.get("models")?e(6,C=($=i.url.searchParams.get("models"))==null?void 0:$.split(",")):s!=null&&s.models?e(6,C=s==null?void 0:s.models):a!=null&&a.default_models?(console.log((a==null?void 0:a.default_models.split(","))??""),e(6,C=a==null?void 0:a.default_models.split(","))):e(6,C=[""]),i.url.searchParams.get("q")&&(e(11,G=i.url.searchParams.get("q")??""),G&&(await kt(),Wt(G))),e(6,C=C.map(D=>r.map(B=>B.id).includes(D)?D:""));const M=await ol(localStorage.token);M?fe.set(M.ui):fe.set(JSON.parse(localStorage.getItem("settings")??"{}"));const Z=document.getElementById("chat-textarea");setTimeout(()=>Z==null?void 0:Z.focus(),0)},tt=async()=>{if(ve.set(k),e(9,N=await On(localStorage.token,l).catch(async M=>(await Pe("/"),null))),N){await Dt();const M=N.chat;if(M){console.log(M),e(6,C=((M==null?void 0:M.models)??void 0)!==void 0?M.models:[M.models??""]),e(1,H=((M==null?void 0:M.history)??void 0)!==void 0?M.history:yn(M.messages)),e(10,L=M.title);const Z=await ol(localStorage.token);return Z?await fe.set(Z.ui):await fe.set(JSON.parse(localStorage.getItem("settings")??"{}")),await fe.set({...s,system:M.system??s.system,params:M.options??s.params}),e(3,h=!0),await kt(),O.length>0&&e(1,H.messages[O.at(-1).id].done=!0,H),await kt(),!0}else return null}},Mt=async()=>{await kt(),y&&e(4,y.scrollTop=y.scrollHeight,y)},ot=M=>{const Z=H.messages[M];return Z.parentId?[...ot(Z.parentId),Z]:[Z]},Wt=async(M,Z=null)=>{if(console.log("submitPrompt",l),e(6,C=C.map($=>r.map(D=>D.id).includes($)?$:"")),C.includes(""))ht.error(o.t("Model not selected"));else if(O.length!=0&&O.at(-1).done!=!0)console.log("wait");else if(z.length>0&&z.filter($=>$.upload_status===!1).length>0)ht.error(o.t("Oops! Hold tight! Your files are still in the processing oven. We're cooking them up to perfection. Please be patient and we'll let you know once they're ready."));else{document.getElementById("chat-textarea").style.height="";let $=ll(),D={id:$,parentId:O.length!==0?O.at(-1).id:null,childrenIds:[],role:"user",user:Z??void 0,content:M,files:z.length>0?z:void 0,timestamp:Math.floor(Date.now()/1e3),models:C.filter((B,J)=>C.indexOf(B)===J)};e(1,H.messages[$]=D,H),e(1,H.currentId=$,H),O.length!==0&&H.messages[O.at(-1).id].childrenIds.push($),await kt(),O.length==1&&(s.saveChatHistory??!0?(e(9,N=await Nn(localStorage.token,{id:l,title:o.t("New Chat"),models:C,system:s.system??void 0,options:{...s.params??{}},messages:O,history:H,tags:[],timestamp:Date.now()})),await Ce.set(await Te(localStorage.token)),await ve.set(N.id)):await ve.set("local"),await kt()),e(11,G=""),document.getElementById("chat-textarea").style.height="",e(12,z=[]),await zt(M,$)}},zt=async(M,Z,$=null)=>{const D=JSON.parse(JSON.stringify(l));await Promise.all(($?[$]:P!==void 0?[P.id]:C).map(async B=>{var bt,vt,wt;console.log("modelId",B);const J=r.filter(Bt=>Bt.id===B).at(0);if(J){O.some(Q=>{var j;return(j=Q.files)==null?void 0:j.some(q=>q.type==="image")})&&!(((wt=(vt=(bt=J.info)==null?void 0:bt.meta)==null?void 0:vt.capabilities)==null?void 0:wt.vision)??!0)&&ht.error(o.t("Model {{modelName}} is not vision capable",{modelName:J.name??J.id}));let Ft=ll(),xt={parentId:Z,id:Ft,childrenIds:[],role:"assistant",content:"",model:J.id,modelName:J.name??J.id,userContext:null,timestamp:Math.floor(Date.now()/1e3)};e(1,H.messages[Ft]=xt,H),e(1,H.currentId=Ft,H),Z!==null&&e(1,H.messages[Z].childrenIds=[...H.messages[Z].childrenIds,Ft],H),await kt();let b=null;if(((s==null?void 0:s.memory)??!1)&&b===null){const Q=await Zn(localStorage.token,M).catch(j=>(ht.error(j),null));Q&&(Q.documents[0].length>0&&(b=Q.documents.reduce((j,q,K)=>{const ut=Q.metadatas[K][0].created_at,st=new Date(ut*1e3).toISOString().split("T")[0];return j.push(`${K+1}. [${st}]. ${q[0]}`),j},[])),console.log(b))}xt.userContext=b,V&&await Et(J.id,Z,Ft),(J==null?void 0:J.owned_by)==="openai"?await Nt(J,M,Ft,D):J&&await Xt(J,M,Ft,D)}else ht.error(o.t("Model {{modelId}} not found",{modelId:B}))})),await Ce.set(await Te(localStorage.token))},Et=async(M,Z,$)=>{const D=H.messages[$];D.status={done:!1,action:"web_search",description:o.t("Generating search query")},e(13,O),e(1,H);const B=H.messages[Z].content;let J=B;if(B.length>100&&(J=await lt(M,B),!J)){ht.warning(o.t("No search query generated")),D.status={...D.status,done:!0,error:!0,description:"No search query generated"},e(13,O),e(1,H);return}D.status={...D.status,description:o.t("Searching the web for '{{searchQuery}}'",{searchQuery:J})},e(13,O),e(1,H);const bt=await Rn(localStorage.token,J);if(bt===void 0){ht.warning(o.t("No search results found")),D.status={...D.status,done:!0,error:!0,description:"No search results found"},e(13,O),e(1,H);return}D.status={...D.status,done:!0,description:o.t("Searched {{count}} sites",{count:bt.filenames.length}),urls:bt.filenames},((D==null?void 0:D.files)??!0)&&(D.files=[]),D.files.push({collection_name:bt.collection_name,name:J,type:"web_search_results",urls:bt.filenames}),e(13,O),e(1,H)},Xt=async(M,Z,$,D)=>{var Ft,xt,b,Q;M=M.id;const B=H.messages[$];await kt(),Mt();const J=[s.system||((B==null?void 0:B.userContext)??null)?{role:"system",content:`${(s==null?void 0:s.system)??""}${(B==null?void 0:B.userContext)??null?`

User Context:
${((B==null?void 0:B.userContext)??[]).join(`
`)}`:""}`}:void 0,...O].filter(j=>{var q;return(q=j==null?void 0:j.content)==null?void 0:q.trim()}).map((j,q,K)=>{var et;const ut={role:j.role,content:j.content},st=(et=j.files)==null?void 0:et.filter(qt=>qt.type==="image").map(qt=>qt.url.slice(qt.url.indexOf(",")+1));return st&&st.length>0&&j.role==="user"&&(ut.images=st),ut});let bt=-1;J.forEach((j,q)=>{j.images&&(bt=q)}),J.forEach((j,q)=>{q!==bt&&delete j.images});const vt=O.filter(j=>(j==null?void 0:j.files)??null).map(j=>j.files.filter(q=>["doc","collection","web_search_results"].includes(q.type))).flat(1),[wt,Bt]=await Dn(localStorage.token,{model:M,messages:J,options:{...s.params??{},stop:((Ft=s==null?void 0:s.params)==null?void 0:Ft.stop)??void 0?s.params.stop.map(j=>decodeURIComponent(JSON.parse('"'+j.replace(/\"/g,'\\"')+'"'))):void 0,num_predict:((xt=s==null?void 0:s.params)==null?void 0:xt.max_tokens)??void 0,repeat_penalty:((b=s==null?void 0:s.params)==null?void 0:b.frequency_penalty)??void 0},format:s.requestFormat??void 0,keep_alive:s.keepAlive??void 0,docs:vt.length>0?vt:void 0,citations:vt.length>0,chat_id:l});if(wt&&wt.ok){console.log("controller",Bt);const j=wt.body.pipeThrough(new TextDecoderStream).pipeThrough(kn(`
`)).getReader();for(;;){const{value:q,done:K}=await j.read();if(K||_||D!==l){if(B.done=!0,e(13,O),e(1,H),_)Bt.abort("User: Stop Response"),await sl(localStorage.token,v);else{const ut=ot($),st=await al(localStorage.token,{model:M,messages:ut.map(et=>({id:et.id,role:et.role,content:et.content,timestamp:et.timestamp})),chat_id:l}).catch(et=>(console.error(et),null));if(st!==null)for(const et of st.messages)e(1,H.messages[et.id]={...H.messages[et.id],...et},H)}v=null;break}try{let ut=q.split(`
`);for(const st of ut)if(st!==""){console.log(st);let et=JSON.parse(st);if("citations"in et){B.citations=et.citations;continue}if("detail"in et)throw et;if("id"in et)console.log(et),v=et.id;else if(et.done==!1){if(B.content==""&&et.message.content==`
`)continue;B.content+=et.message.content,e(13,O),e(1,H)}else{if(B.done=!0,B.content==""&&(B.error=!0,B.content="Oops! No text generated from Ollama, Please try again."),B.context=et.context??null,B.info={total_duration:et.total_duration,load_duration:et.load_duration,sample_count:et.sample_count,sample_duration:et.sample_duration,prompt_eval_count:et.prompt_eval_count,prompt_eval_duration:et.prompt_eval_duration,eval_count:et.eval_count,eval_duration:et.eval_duration},e(13,O),e(1,H),s.notificationEnabled&&!document.hasFocus()){const qt=new Notification(selectedModelfile?`${selectedModelfile.title.charAt(0).toUpperCase()+selectedModelfile.title.slice(1)}`:`${M}`,{body:B.content,icon:(selectedModelfile==null?void 0:selectedModelfile.imageUrl)??`${He}/static/favicon.png`})}s.responseAutoCopy&&nl(B.content),s.responseAutoPlayback&&(await kt(),(Q=document.getElementById(`speak-button-${B.id}`))==null||Q.click())}}}catch(ut){console.log(ut),"detail"in ut&&ht.error(ut.detail);break}h&&Mt()}l==D&&(s.saveChatHistory??!0)&&(e(9,N=await ze(localStorage.token,D,{messages:O,history:H,models:C})),await Ce.set(await Te(localStorage.token)))}else{if(wt!==null){const j=await wt.json();console.log(j),"detail"in j?(ht.error(j.detail),B.content=j.detail):(ht.error(j.error),B.content=j.error)}else ht.error(o.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:"Ollama"})),B.content=o.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:"Ollama"});B.error=!0,B.content=o.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:"Ollama"}),B.done=!0,e(13,O),e(1,H)}if(_=!1,await kt(),h&&Mt(),O.length==2&&O.at(1).content!==""){window.history.replaceState(H.state,"",`/c/${D}`);const j=await W(Z);await Ut(D,j)}},Nt=async(M,Z,$,D)=>{var bt,vt,wt,Bt,Ft,xt,b,Q,j,q;const B=H.messages[$],J=O.filter(K=>(K==null?void 0:K.files)??null).map(K=>K.files.filter(ut=>["doc","collection","web_search_results"].includes(ut.type))).flat(1);console.log(J),Mt();try{const[K,ut]=await Cn(localStorage.token,{model:M.id,stream:!0,stream_options:((wt=(vt=(bt=M.info)==null?void 0:bt.meta)==null?void 0:vt.capabilities)==null?void 0:wt.usage)??!1?{include_usage:!0}:void 0,messages:[s.system||((B==null?void 0:B.userContext)??null)?{role:"system",content:`${(s==null?void 0:s.system)??""}${(B==null?void 0:B.userContext)??null?`

User Context:
${((B==null?void 0:B.userContext)??[]).join(`
`)}`:""}`}:void 0,...O].filter(st=>{var et;return(et=st==null?void 0:st.content)==null?void 0:et.trim()}).map((st,et,qt)=>{var Qt;return{role:st.role,...((Qt=st.files)==null?void 0:Qt.filter(ie=>ie.type==="image").length)>0&&st.role==="user"?{content:[{type:"text",text:qt.length-1!==et?st.content:(st==null?void 0:st.raContent)??st.content},...st.files.filter(ie=>ie.type==="image").map(ie=>({type:"image_url",image_url:{url:ie.url}}))]}:{content:qt.length-1!==et?st.content:(st==null?void 0:st.raContent)??st.content}}}),seed:((Bt=s==null?void 0:s.params)==null?void 0:Bt.seed)??void 0,stop:((Ft=s==null?void 0:s.params)==null?void 0:Ft.stop)??void 0?s.params.stop.map(st=>decodeURIComponent(JSON.parse('"'+st.replace(/\"/g,'\\"')+'"'))):void 0,temperature:((xt=s==null?void 0:s.params)==null?void 0:xt.temperature)??void 0,top_p:((b=s==null?void 0:s.params)==null?void 0:b.top_p)??void 0,frequency_penalty:((Q=s==null?void 0:s.params)==null?void 0:Q.frequency_penalty)??void 0,max_tokens:((j=s==null?void 0:s.params)==null?void 0:j.max_tokens)??void 0,docs:J.length>0?J:void 0,citations:J.length>0,chat_id:l},`${Re}`);if(await kt(),Mt(),K&&K.ok&&K.body){const st=await Ko(K.body,s.splitLargeChunks);let et=null;for await(const qt of st){const{value:Qt,done:ie,citations:Ve,error:Ge,usage:Je}=qt;if(Ge){await St(Ge,null,M,B);break}if(ie||_||D!==l){if(B.done=!0,e(13,O),e(1,H),_)ut.abort("User: Stop Response");else{const Qe=ot($),Ye=await al(localStorage.token,{model:M,messages:Qe.map(ae=>({id:ae.id,role:ae.role,content:ae.content,timestamp:ae.timestamp})),chat_id:l}).catch(ae=>(console.error(ae),null));if(Ye!==null)for(const ae of Ye.messages)e(1,H.messages[ae.id]={...H.messages[ae.id],...ae},H)}break}if(Je&&(et=Je),Ve){B.citations=Ve;continue}if(!(B.content==""&&Qt==`
`)){if(B.content+=Qt,e(13,O),e(1,H),s.notificationEnabled&&!document.hasFocus()){const Qe=new Notification(`OpenAI ${M}`,{body:B.content,icon:`${He}/static/favicon.png`})}s.responseAutoCopy&&nl(B.content),s.responseAutoPlayback&&(await kt(),(q=document.getElementById(`speak-button-${B.id}`))==null||q.click()),h&&Mt()}}et&&(B.info={...et,openai:!0}),l==D&&(s.saveChatHistory??!0)&&(e(9,N=await ze(localStorage.token,D,{models:C,messages:O,history:H})),await Ce.set(await Te(localStorage.token)))}else await St(null,K,M,B)}catch(K){await St(K,null,M,B)}if(e(13,O),e(1,H),_=!1,await kt(),h&&Mt(),O.length==2){window.history.replaceState(H.state,"",`/c/${D}`);const K=await W(Z);await Ut(D,K)}},St=async(M,Z,$,D)=>{let B="",J;M?J=M:Z!==null&&(J=await Z.json()),console.error(J),"detail"in J?(ht.error(J.detail),B=J.detail):"error"in J?"message"in J.error?(ht.error(J.error.message),B=J.error.message):(ht.error(J.error),B=J.error):"message"in J&&(ht.error(J.message),B=J.message),D.error=!0,D.content=o.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:$.name??$.id})+`
`+B,D.done=!0,e(13,O),e(1,H)},Kt=()=>{_=!0,console.log("stopResponse")},$t=async M=>{if(console.log("regenerateResponse"),O.length!=0){let Z=H.messages[M.parentId],$=Z.content;((Z==null?void 0:Z.models)??[...C]).length==1?await zt($,Z.id):await zt($,Z.id,M.model)}},F=async()=>{console.log("continueGeneration");const M=JSON.parse(JSON.stringify(l));if(O.length!=0&&O.at(-1).done==!0){const Z=H.messages[H.currentId];Z.done=!1,await kt();const $=r.filter(D=>D.id===Z.model).at(0);$&&(($==null?void 0:$.owned_by)==="openai"?await Nt($,H.messages[Z.parentId].content,Z.id,M):await Xt($,H.messages[Z.parentId].content,Z.id,M))}else ht.error(o.t("Model {{modelId}} not found",{modelId}))},W=async M=>{var Z,$,D,B;if(((Z=s==null?void 0:s.title)==null?void 0:Z.auto)??!0){const J=r.find(Bt=>Bt.id===C[0]),bt=(J==null?void 0:J.owned_by)==="openai"?(($=s==null?void 0:s.title)==null?void 0:$.modelExternal)??C[0]:((D=s==null?void 0:s.title)==null?void 0:D.model)??C[0],vt=r.find(Bt=>Bt.id===bt);return console.log(vt),await Tn(localStorage.token,((B=s==null?void 0:s.title)==null?void 0:B.prompt)??o.t("Create a concise, 3-5 word phrase as a header for the following query, strictly adhering to the 3-5 word limit and avoiding the use of the word 'title':")+" {{prompt}}",bt,M,(vt==null?void 0:vt.owned_by)==="openai"?`${Re}`:`${$e}/v1`)}else return`${M}`},lt=async(M,Z)=>{var bt,vt;const $=r.find(wt=>wt.id===M),D=($==null?void 0:$.owned_by)==="openai"?((bt=s==null?void 0:s.title)==null?void 0:bt.modelExternal)??M:((vt=s==null?void 0:s.title)==null?void 0:vt.model)??M,B=r.find(wt=>wt.id===D),J=O.filter(wt=>wt.role==="user").map(wt=>wt.content);return await Vn(localStorage.token,D,J,Z,(B==null?void 0:B.owned_by)==="openai"?`${Re}`:`${$e}/v1`)},Ut=async(M,Z)=>{M===l&&e(10,L=Z),(s.saveChatHistory??!0)&&(e(9,N=await ze(localStorage.token,M,{title:Z})),await Ce.set(await Te(localStorage.token)))},Dt=async()=>await Hn(localStorage.token,l).catch(async M=>[]);function Pt(M){C=M,e(6,C)}function ge(M){T=M,e(5,T)}const Ct=M=>M.dismissible?!JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]").includes(M.id):!0,Lt=M=>{const Z=M.detail;localStorage.setItem("dismissedBannerIds",JSON.stringify([Z,...JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]")].filter($=>d.find(D=>D.id===$))))};function _e(M){H=M,e(1,H)}function te(M){O=M,e(13,O),e(1,H)}function pe(M){h=M,e(3,h)}function Se(M){G=M,e(11,G)}function Ie(M){gt[M?"unshift":"push"](()=>{y=M,e(4,y)})}const Me=M=>{e(3,h=y.scrollHeight-y.scrollTop<=y.clientHeight+5)};function me(M){z=M,e(12,z)}function Tt(M){G=M,e(11,G)}function Vt(M){h=M,e(3,h)}function De(M){V=M,e(8,V)}function be(M){P=M,e(7,P)}return n.$$set=M=>{"chatIdProp"in M&&e(0,k=M.chatIdProp)},n.$$.update=()=>{if(n.$$.dirty[0]&2)if(H.currentId!==null){let M=[],Z=H.messages[H.currentId];for(;Z!==null;)M.unshift({...Z}),Z=Z.parentId!==null?H.messages[Z.parentId]:null;e(13,O=M)}else e(13,O=[]);n.$$.dirty[0]&1&&k&&(async()=>{if(await tt()){await kt(),e(2,g=!0),window.setTimeout(()=>Mt(),0);const M=document.getElementById("chat-textarea");M==null||M.focus()}else await Pe("/")})()},[k,H,g,h,y,T,C,P,V,N,L,G,z,O,l,u,c,d,p,nt,Wt,zt,Kt,$t,F,Pt,ge,Ct,Lt,_e,te,pe,Se,Ie,Me,me,Tt,Vt,De,be]}class Ar extends Gt{constructor(t){super(),Jt(this,t,rr,sr,Zt,{chatIdProp:0},null,[-1,-1,-1])}}export{Ar as C};
//# sourceMappingURL=Chat.0020c829.js.map
