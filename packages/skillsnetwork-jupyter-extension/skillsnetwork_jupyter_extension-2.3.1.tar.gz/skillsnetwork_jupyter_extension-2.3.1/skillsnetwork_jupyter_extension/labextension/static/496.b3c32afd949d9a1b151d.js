"use strict";(self.webpackChunkskillsnetwork_jupyter_extension=self.webpackChunkskillsnetwork_jupyter_extension||[]).push([[496],{904:(e,t,o)=>{o.a(e,(async(e,n)=>{try{o.d(t,{AP:()=>m,CS:()=>g,CY:()=>u,Gq:()=>k,Mh:()=>s,Ut:()=>l,a:()=>i,aQ:()=>y,mW:()=>a,o7:()=>p,qK:()=>b,sd:()=>v,wr:()=>f,xy:()=>h});var a,i,r=o(956);!function(e){e.JUPYTERLAB="jupyterlab",e.JUPYTERLITE="jupyterlite",e.LOCAL="local"}(a||(a={})),function(e){e.LEARN="learn",e.AUTHOR="author"}(i||(i={}));const e=e=>{let t=e.baseUrl;return t.endsWith("/")||(t+="/"),t},l=function(){const e=window.location.href,t=new URL(e);let o=t.searchParams.get("env_type");return o!==a.JUPYTERLAB&&o!==a.JUPYTERLITE&&o!==a.LOCAL?(console.log("Valid env_type not found in URL parameters"),t.pathname.includes(a.JUPYTERLITE)?(console.log("Guessed env_type from URL pathname"),o=a.JUPYTERLITE):t.host.includes(a.JUPYTERLAB)?(console.log("Guessed env_type from URL hostname"),o=a.JUPYTERLAB):(console.log("Using default env_type"),o=a.LOCAL)):console.log("env_type found in URL parameters"),console.log("Environment Type (env_type):",o),o}(),s=function(){const e=window.location.href;let t=new URL(e).searchParams.get("mode");return t!==i.AUTHOR&&t!==i.LEARN&&(console.log("Valid mode not found in URL parameters"),l===a.LOCAL?(console.log("Using author mode for local environment"),t=i.AUTHOR):(console.log("Using default mode"),t=i.LEARN)),console.log("Mode:",t),t}(),c=async()=>{const t=r.ServerConnection.makeSettings(),o=e(t)+"skillsnetwork_jupyter_extension/config",n=await r.ServerConnection.makeRequest(o,{method:"GET"},t);return await n.json()},d=async(e,t)=>{const o=window.location.href,n=new URL(o).searchParams.get(e);if(console.log(`${t} from current url: ${n}`),null===n){if(l===a.JUPYTERLITE)return console.log(`${e} not found in URL parameters, leaving empty due to env_type...`),"";if(s===i.LEARN)return console.log(`${e} not found in URL parameters, leaving empty due to mode...`),"";console.log(`${e} not found in URL parameters, making server request...`);const o=await c();return console.log(`${t} from server: ${o[t]}`),o[t]}return decodeURIComponent(n)},u=await d("atlas_base_url","ATLAS_BASE_URL"),h=await d("awb_base_url","AWB_BASE_URL"),g=await d("sn_file_library_url","SN_V2_FILE_LIBRARY_URL"),p=await d("sn_file_library_url","SN_FILE_LIBRARY_URL"),w=(e,t,o)=>{const n=window.location.href,a=new URL(n).searchParams.get(e);return null!==a?t?decodeURIComponent(a):a:o},b=w("atlas_token",!1,"NO_TOKEN"),m=w("awb_token",!1,"NO_TOKEN"),f=w("notebook_url",!0,null),y=w("file_path",!0,null),v=async()=>{const e=l;return e===a.JUPYTERLAB||e===a.LOCAL?(k.PY_KERNEL_NAME=await _(),k.DEFAULT_LAB_NAME="lab.ipynb"):e===a.JUPYTERLITE&&(k.PY_KERNEL_NAME="python",k.DEFAULT_LAB_NAME="lab.jupyterlite.ipynb"),e},_=async()=>{const e=await(await r.KernelSpecAPI.getSpecs()).kernelspecs,t=Object.keys(e).filter((function(e){return e.includes("python")})).sort();return t[t.length-1]};class k{}k.TOKENS=new Map,k.SHOW_PUBLISH_BUTTON_FOR=void 0,k.PREV_PUB_HASH="prev_pub_hash",k.BACKUP_EXT=".backup",n()}catch(e){n(e)}}),1)},780:(e,t,o)=>{o.d(t,{E3:()=>r,KQ:()=>d,Sc:()=>l,WA:()=>s,Zm:()=>u,g3:()=>c});var n=o(760),a=o(580);class i extends n.Widget{constructor(){const e=document.createElement("div"),t=new a.Spinner;e.appendChild(t.node),e.style.padding="15px",super({node:e})}}const r=e=>{const t=new i;(0,a.showDialog)({title:e,body:t,buttons:[a.Dialog.cancelButton()]}).then((e=>{"Cancel"===e.button.label&&console.log("Spinner dialog cancelled by user")}))},l=e=>{const t=new i;return(0,a.showDialog)({title:e,body:t,buttons:[]}).then((e=>e))},s=e=>(0,a.showDialog)({title:e,body:"Are you sure you want to publish? This action is not reversible",buttons:[a.Dialog.okButton(),a.Dialog.cancelButton()]}).then((e=>{if(!e.button.accept)throw new Error("Operation cancelled by the user.")})),c=()=>{(0,a.showDialog)({title:"Success!",body:"This lab has been successfully published!",buttons:[a.Dialog.okButton()]}).catch((e=>{console.error("Error closing success dialog:",e)}))},d=()=>{(0,a.showDialog)({title:"Failed to Publish",body:"This lab failed to publish.",buttons:[a.Dialog.okButton()]}).catch((e=>{console.log("Error closing failure dialog:",e)}))},u=()=>{(0,a.showDialog)({title:"Failed to Load Lab",body:"This lab failed to load.",buttons:[a.Dialog.okButton()]}).catch((e=>{console.log("Error closing failure to load lab dialog:",e)}))}},480:(e,t,o)=>{o.a(e,(async(e,n)=>{try{o.d(t,{CU:()=>b,GK:()=>w,Oc:()=>_,So:()=>y,iU:()=>v,k5:()=>k,uU:()=>f});var a=o(637),i=o.n(a),r=o(780),l=o(580),s=o(904),c=o(96),d=o(500),u=o.n(d),h=o(416),g=o.n(h),p=e([s,c]);[s,c]=p.then?(await p)():p;const w=e=>m(e,s.CY),b=e=>m(e,s.xy),m=(e,t)=>u().create({baseURL:t,headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json","Access-Control-Allow-Origin":"*",Accept:"application/json"}}),f=async(e,t)=>{try{const o=g()(t),n=o.version_id,a=o.lab_id;console.log(`Fetching lab model for lab_id: ${a}, version_id: ${n}`);const i=`${o.lab_name}.ipynb`,r=await e.get(`api/v1/labs/${a}/lab_versions/${n}/download?timestamp=${(new Date).getTime()}`).then((e=>(console.log("Lab model fetched successfully"),e.data)));return l.Dialog.flush(),{labFilename:i,body:r}}catch(e){throw"Failed to fetch notebook"}},y=async(e,t,o,n)=>{if(!await(0,r.WA)("Publishing your lab onto Skills Network...").then((e=>!0)).catch((e=>!1)))return;(0,r.Sc)("Publishing your changes...");const a=g()(n),s=a.version_id,d=a.lab_id;await(0,c.ol)(t,o);const u=await(0,c.gv)(t,o),h=new(i());return h.append("publish","true"),h.append("draft[changelog]","updated notebook"),h.append("file",u),console.log(`Posting lab model to AWB for lab_id: ${d}, version_id: ${s}`),new Promise((async(t,o)=>{await e.post(`api/v1/labs/${d}/lab_versions/${s}/drafts`,h).then((e=>{console.log(`Successfully Pushed Lab Version for lab id: ${d}, ver: ${s}`,e),l.Dialog.flush(),(0,r.g3)(),t()})).catch((e=>{l.Dialog.flush(),(0,r.KQ)(),o(new Error("Failed to post lab model"))}))}))},v=e=>e.get(`v1/labs?timestamp=${(new Date).getTime()}`).then((e=>(l.Dialog.flush(),e.data))).catch((e=>{throw"Failed to fetch notebook"})),_=e=>{const t=new URL(e);return 0===t.searchParams.size&&t.searchParams.append("timestamp",(new Date).getTime().toString()),u().get(t.toString(),{headers:{"Cache-Control":"no-cache",Expires:"0","Access-Control-Allow-Origin":"*",Accept:"application/json"}}).then((e=>(l.Dialog.flush(),e))).catch((e=>{throw"Failed to fetch notebook"}))},k=async(e,t,o)=>{if(!await(0,r.WA)("Publishing your lab onto Skills Network...").then((e=>!0)).catch((e=>!1)))return;(0,r.Sc)("Publishing your changes..."),console.log("Updating lab commit ID"),await(0,c.ol)(t,o);const n=await(0,c.gv)(t,o);return console.log("Posting lab model to ATLAS"),new Promise((async(t,o)=>{await e.post("v1/labs",{body:n}).then((e=>{l.Dialog.flush(),(0,r.g3)(),t()})).catch((e=>{l.Dialog.flush(),(0,r.KQ)(),o(new Error("Failed to post lab model to ATLAS"))}))}))};n()}catch(e){n(e)}}))},496:(e,t,o)=>{o.a(e,(async(e,n)=>{try{o.r(t),o.d(t,{default:()=>c});var a=o(964),i=o(808),r=o(168),l=e([a,i]);[a,i]=l.then?(await l)():l,console.log("Initializing JupyterFrontEnd plugins for skillsnetwork_jupyter_extension.");const s=[a.c,i.c,r.c];console.log("JupyterFrontEnd plugins defined:",s.map((e=>e.id)));const c=s;n()}catch(e){n(e)}}))},964:(e,t,o)=>{o.a(e,(async(e,n)=>{try{o.d(t,{c:()=>b});var a=o(556),i=o(760),r=o(580),l=o(40),s=o(652),c=o(432),d=o(780),u=o(904),h=o(96),g=o(416),p=o.n(g),w=e([u,h]);[u,h]=w.then?(await w)():w;const b={id:"skillsnetwork_jupyter_extension:menu",autoStart:!0,requires:[a.IMainMenu,r.ICommandPalette,l.INotebookTracker,s.IDocumentManager,c.IDefaultFileBrowser],activate:async(e,t,o,n,a,r)=>{if(console.log("skillsnetwork_jupyter_extension:menu extension activated"),u.Mh===u.a.LEARN)return;const{commands:l}=e,s="mainMenu:editLabFromToken";l.addCommand(s,{label:"Edit a Lab",execute:t=>{m(0,a,e.serviceManager.contents,r)}}),o.addItem({command:s,category:"skillsNetwork",args:{origin:"from the palette"}});const c=new i.Menu({commands:l});c.title.label="Skills Network",t.addMenu(c,!0,{rank:80}),c.addItem({command:s,args:{}})}};function m(e,t,o,n){const a=document.createElement("div"),l=document.createElement("label");l.textContent="Enter your authorization token";const s=document.createElement("input");s.className="jp-mod-styled",a.appendChild(l),a.appendChild(s),(0,r.showDialog)({title:"Edit a Lab",body:new i.Widget({node:a}),buttons:[r.Dialog.cancelButton(),r.Dialog.okButton()]}).then((async e=>{if(e.button.accept){console.log("Token dialog accepted, loading lab..."),(0,d.E3)("Loading up your lab...");const e=s.value;let a="NO_TOKEN",i="NO_TOKEN";"version_id"in p()(e)?(console.log("Token contains version_id, opening AWB lab..."),i=e):(console.log("Token does not contain version_id, opening Atlas lab..."),a=e),await(0,h.UJ)(a,i,"Token Launch",t,o,n)}})).catch((e=>{r.Dialog.flush(),(0,d.Zm)(),console.error("Error occurred while importing lab:",e)}))}n()}catch(f){n(f)}}))},864:(e,t,o)=>{o.a(e,(async(e,n)=>{try{o.d(t,{q:()=>c});var a=o(904),i=o(416),r=o.n(i),l=e([a]);a=(l.then?(await l)():l)[0];var s;class c{constructor(e){s.set(this,void 0),function(e,t,o,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===n?a.call(e,o):a?a.value=o:t.set(e,o)}(this,s,e,"f")}launch(){const e=a.Gq.TOKENS.get(function(e,t,o,n){if("a"===o&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===o?n:"a"===o?n.call(e):n?n.value:t.get(e)}(this,s,"f")||""),t=e?r()(e):{},o=document.createElement("a");o.href="project_id"in t?`${a.o7}?atlas_token=${e}`:`${a.CS}?lab_version_id=${t.version_id}`,o.target="_blank",document.body.appendChild(o),o.click(),document.body.removeChild(o)}}s=new WeakMap,n()}catch(e){n(e)}}))},168:(e,t,o)=>{o.d(t,{c:()=>n});const n={id:"skillsnetwork_jupyter_extension:theme",description:"Theme toggle plugin for Skills Network Authoring Extension",autoStart:!0,requires:[o(580).IThemeManager],activate:(e,t)=>{console.log("Activating skillsnetwork_jupyter_extension theme toggle plugin!"),window.addEventListener("message",(e=>{"update_theme"===e.data.type&&(console.log("Message received in the iframe:",e.data),"light"===e.data.color?t.setTheme("JupyterLab Light"):t.setTheme("JupyterLab Dark"))})),function(){try{return window.self!==window.top}catch(e){return!0}}()&&(console.log("Sending message to parent frame that the iframe has loaded!"),window.parent.postMessage({type:"frame_loaded"},"*"))}}},808:(e,t,o)=>{o.a(e,(async(e,n)=>{try{o.d(t,{c:()=>k});var a=o(652),i=o(432),r=o(580),l=o(96),s=o(508),c=o(480),d=o(780),u=o(904),h=o(416),g=o.n(h),p=o(40),w=o(864),b=o(544),m=e([u,c,l,w]);[u,c,l,w]=m.then?(await m)():m;const f={id:"skillsnetwork_jupyter_extension:toolbar",description:"Toolbar plugin for Skills Network Authoring Extension",autoStart:!0,requires:[p.INotebookTracker,a.IDocumentManager,i.IDefaultFileBrowser],activate:_};async function y(e){e.forEach((e=>{e.dispose()}))}class v{createNew(e,t){if(u.Gq.SHOW_PUBLISH_BUTTON_FOR!==t.path)return new s.DisposableDelegate((()=>{}));{const o=async()=>{const o=t.path,n=u.Gq.TOKENS.get(o);if(void 0===n)return console.log(`[ButtonExtension] No token found for filename: ${o}`),void await(0,r.showDialog)({title:"Publishing Restricted",body:`Only the lab '${u.Gq.TOKENS.keys().next().value}' can be published during this editing session.`,buttons:[r.Dialog.okButton({label:"Dismiss"})]});"version_id"in g()(n)?await(0,c.So)((0,c.CU)(n),e,t,n):await(0,c.k5)((0,c.GK)(n),e,t)},n=async()=>{const o=await(0,l.gv)(e,t),n=new Blob([o],{type:"application/x-ipynb+json"}),a=URL.createObjectURL(n),i=document.createElement("a");i.setAttribute("download",b.PathExt.basename(t.path)),i.setAttribute("href",a),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a)},a=new r.ToolbarButton({className:"download-lab-button",label:"Download Notebook",onClick:n,tooltip:"Download the current notebook ipynb file to your local system"}),i=new r.ToolbarButton({className:"publish-lab-button",label:"Save & Publish",onClick:o,tooltip:"Save & publish the lab to Skills Network"}),d=new r.ToolbarButton({className:"sn-file-library-button",label:"SN File Library",onClick:()=>new w.q(t.path).launch(),tooltip:"Skills Network File Library"});return e.toolbar.insertItem(8,"download",a),e.toolbar.insertItem(9,"sn-file-library",d),e.toolbar.insertItem(10,"publish",i),new s.DisposableDelegate((()=>{a.dispose(),i.dispose(),d.dispose()}))}}}async function _(e,t,o,n){console.log("Activating skillsnetwork_jupyter_extension button plugin!");const a=await(0,u.sd)();if(console.log("Using default kernel:",u.Gq.PY_KERNEL_NAME),u.Mh===u.a.LEARN){if(u.Ut!==u.mW.JUPYTERLITE)return;return console.log("skillsnetwork_jupyter_extension:toolbar extension activated"),void(u.wr?(await e.serviceManager.ready,e.restored.then((async()=>{await y(t);try{await(0,l.wO)(u.wr,u.aQ,o,e.serviceManager.contents,n)}catch(e){console.error("Error opening lab:",e),r.Dialog.flush(),(0,d.Zm)()}}))):console.log("No valid notebook URL found..."))}const i=u.qK,s=u.AP;console.log("skillsnetwork_jupyter_extension:toolbar extension activated"),e.docRegistry.addWidgetExtension("Notebook",new v),await e.serviceManager.ready,e.restored.then((async()=>{if(await y(t),a!==u.mW.LOCAL&&("NO_TOKEN"!==i||"NO_TOKEN"!==s))try{await(0,l.UJ)(i,s,u.aQ,o,e.serviceManager.contents,n)}catch(e){console.error("Error opening lab with Atlas/AWB token:",e),r.Dialog.flush(),(0,d.Zm)()}}))}const k=f;n()}catch(E){n(E)}}))},96:(e,t,o)=>{o.a(e,(async(e,n)=>{try{o.d(t,{UJ:()=>m,gv:()=>u,ol:()=>g,wO:()=>f});var a=o(580),i=o(944),r=o(904),l=o(480),s=e([r,l]);[r,l]=s.then?(await s)():s;const c=e=>{const t=e.model.toJSON().source,o="string"==typeof t?[t]:t;return{cell_type:e.model.type,id:e.model.id,metadata:{},outputs:[],source:o}},d=e=>{const t=e.model.toJSON().source,o="string"==typeof t?[t]:t;return{cell_type:e.model.type,id:"",metadata:{},outputs:[],source:o}},u=(e,t)=>{const o=[];e.content.widgets.forEach((e=>{const t=c(e);o.push(t)}));const n={kernelspec:t.model.getMetadata("kernelspec"),language_info:t.model.getMetadata("language_info"),orig_nbformat:t.model.getMetadata("orig_nbformat"),[r.Gq.PREV_PUB_HASH]:t.model.getMetadata(r.Gq.PREV_PUB_HASH)},a=t.model.nbformat,i=t.model.nbformatMinor,l={cells:o,metadata:n,nbformat:a,nbformat_minor:i};return JSON.stringify(l,null,2)},h=async(e,t)=>{t=i.C.removeSlash(t);const o=i.C.dirname(t),n=[];o.split("/").reduce(((e,t)=>{const o=i.C.removeSlash(e+"/"+t);return n.push(o),o}),""),console.log(n);for(const t of n)try{await e.services.contents.get(t,{content:!1})}catch(o){console.log("Creating",t);const n=await e.newUntitled({path:"",type:"directory"});await e.rename(n.path,t)}};async function g(e,t){const o=await b(e,t),n=await N(o);await t.ready,t.model.setMetadata(r.Gq.PREV_PUB_HASH,n),t.save().then((()=>{console.log("Notebook saved with updated commit ID.")})).catch((e=>{console.error("Failed to save notebook with updated commit ID:",e)}))}function p(e){var t,o,n,a,i,l,s;return"string"==typeof e&&(e=JSON.parse(e)),"object"!=typeof e||null===e||!("metadata"in e)&&!("content"in e)?(console.error("Lab content is of unknown type: ",typeof e,"\n Value: \n",e),""):null!==(s=null!==(n=null===(o=null===(t=e.metadata)||void 0===t?void 0:t[r.Gq.PREV_PUB_HASH])||void 0===o?void 0:o.toString())&&void 0!==n?n:null===(l=null===(i=null===(a=e.content)||void 0===a?void 0:a.metadata)||void 0===i?void 0:i[r.Gq.PREV_PUB_HASH])||void 0===l?void 0:l.toString())&&void 0!==s?s:""}function w(e){var t;if("string"==typeof e)try{e=JSON.parse(e)}catch(e){return console.error("Error parsing lab content string:",e),!1}if("object"!=typeof e||null===e||!("cells"in e)&&(!e.content||!("cells"in e.content)))return console.error("Lab content is of unknown type or missing 'cells': ",typeof e,"\n Value: \n",e),!1;const o=e.cells||(null===(t=e.content)||void 0===t?void 0:t.cells);return 0===o.length||1===o.length&&0===o[0].source.length}const b=(e,t)=>{const o=[];return e.content.widgets.forEach((e=>{const t=d(e);o.push(t)})),JSON.stringify(o,null,2)},m=async(e,t,o,n,a,s)=>{let c,d,u,g;if("NO_TOKEN"!==e)({instructions_file_path:c,body:d}=await(0,l.iU)((0,l.GK)(e))),u=c,g=e;else{if("NO_TOKEN"===t)throw Error("No valid token found.");({labFilename:u,body:d}=await(0,l.uU)((0,l.CU)(t),t)),g=t}let p=`${u}`;if(null!==o&&(p=E(o,u)),console.log("Opening lab:",p),p.includes("/")){await h(n,p);const e=i.C.dirname(p);s.model.path!==e&&(console.log(`Opening /${e} in the file browser`),await s.model.cd(`/${e}`))}else await s.model.cd("/");let w,b=p;return r.Ut!==r.mW.JUPYTERLITE?(b=`./${p}`,await _(p,a,n),await v(b,d,a,n)):await n.deleteFile(b),r.Gq.SHOW_PUBLISH_BUTTON_FOR=p,r.Gq.TOKENS.set(p,g),w=await L(b,a)?n.openOrReveal(p):await y(n,p,"NO_TOKEN"!==e?JSON.parse(d):d),w},f=async(e,t,o,n,i)=>{const r=await(0,l.Oc)(e),s=r.data;if(!S(s))throw Error(`content of ${e} is not a valid JSON! Please let the author know about this issue!`);const c=Date.parse(r.headers["last-modified"]||"");if(console.log(`last-modified date of ${e} extracted from headers:`,c),!(t&&t.endsWith(".ipynb")||(console.log(`filePath from query (which is ${t}) is either missing or doesn't end with .ipynb. Trying to use the pathname from ${e} as filePath...`),(t=decodeURI(new URL(e).pathname)).endsWith(".ipynb"))))throw Error(`pathname of ${e} (which is ${t}) doesn't end with .ipynb. A notebook can't be created.`);console.log("filePath:",t),await h(o,t),console.log(`Opening ${t} in filebrowser`),await i.model.cd(t.substring(0,t.lastIndexOf("/")));const d=await L(t,n);let u;return d?(console.log("last-modified date of",t,"extracted from notebook:",Date.parse(d.last_modified)),(!c||c>Date.parse(d.last_modified))&&(await(0,a.showDialog)({title:"Newer version of notebook available",body:`A newer version of the lab is available. Would you like to load the latest version? The current state of the notebook ${t} will be saved with a .backup.ipynb extension.`,buttons:[a.Dialog.cancelButton(),a.Dialog.okButton({label:"Use the newer version"})]})).button.accept?(console.log("Opening newer version of notebook"),await o.overwrite(t,t.slice(0,t.lastIndexOf(".ipynb"))+".backup.ipynb"),u=await y(o,t,s)):(console.log("Opening existing notebook"),u=o.openOrReveal(t)),u):(console.log("Creating a new notebook"),u=await y(o,t,s),u)},y=async(e,t,o)=>{const n=e.createNew(t,"notebook",{name:r.Gq.PY_KERNEL_NAME});if(void 0===n)throw Error("Error loading lab");return n.hide(),await k(n,o),n.close(),e.openOrReveal(t,"notebook")};async function v(e,t,o,n){const i=await L(e,o);if(i&&p(t)!==p(i))try{await A(i,o,n),await(0,a.showDialog)({title:"Your Lab was Updated",body:`The newest published version of "${e}" is loaded. Your previous version has been backed up under "${e}${r.Gq.BACKUP_EXT}.ipynb"`,buttons:[a.Dialog.okButton({label:"Dismiss"})]})}catch(t){console.error("[checkAndBackupSaveFile] Error during file backup",t),await(0,a.showDialog)({title:"Error with Previous File",body:`While trying to load your lab: "${e}", we found that you have another file named "${e}" that already exists in this folder, please delete it or rename it so we can load your published version"`,buttons:[a.Dialog.okButton({label:"Dismiss"})]})}}async function _(e,t,o){const n=await L(e,t);n&&(await U(e,o),w(n)&&await t.delete(e))}const k=async(e,t,o)=>{if(await e.context.ready,o!==r.mW.LOCAL){e.context.model.fromJSON(t);try{await e.context.save()}catch(e){console.error("[loadLabContents] Error saving notebook:",e)}}else console.error("[loadLabContents] Notebook model is not initialized or environment is local.")},E=(e,t)=>{let o=e;return e.includes(t)||(e.includes(i.C.dirname(t))&&(t=i.C.basename(t)),""!==i.C.extname(e)&&(o=i.C.dirname(e)),o=i.C.join(o,t)),i.C.removeSlash(o)};async function L(e,t){try{return await t.get(e)}catch(e){if(e instanceof Error){const t=e;if(t.response&&404!==t.response.status)throw console.error("Error checking for existent backup file: ",e),e;return null}throw console.error("[getFile] Unexpected error type:",e),e}}async function T(e,t){const o=t.findWidget(e);if(o)try{o.context.model.dirty&&await o.context.save(),o.close()}catch(e){console.error("[saveAndCloseOpenFiles] Error saving or closing widget:",e)}}async function U(e,t){const o=t.findWidget(e);if(o)try{const e=t.contextForWidget(o);e&&e.model&&(e.model.dirty=!1),o.close()}catch(e){console.error("[closeWithoutSaving] Error closing widget:",e)}}async function A(e,t,o){const n=e.path,a=n.split(".").pop(),i=`${n.replace(/\.[^/.]+$/,"")}${r.Gq.BACKUP_EXT}.${a}`;if(await L(i,t))try{await t.delete(i)}catch(e){console.error("[convertFileToBackup] Error deleting existing backup file:",e)}try{await T(n,o),await t.rename(n,i)}catch(e){console.error("[convertFileToBackup] Error renaming file to backup:",e)}}async function N(e){const t=(new TextEncoder).encode(e),o=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(o)).map((e=>e.toString(16).padStart(2,"0"))).join("")}function S(e){e="string"!=typeof e?JSON.stringify(e):e;try{e=JSON.parse(e)}catch(e){return!1}return"object"==typeof e&&null!==e}n()}catch(O){n(O)}}))}}]);