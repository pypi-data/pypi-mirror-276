"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2114],{26954:function(e,t,n){n.d(t,{$:function(){return A}});var r=n(52322),s=n(3842),i=n(14934),a=n(16629),l=n(1747),o=n(79106),d=n(37504),c=n(35292),u=n(39013),h=n(2784),p=n(93812),m=n(76575),x=n(28363),g=n(4733),f=n(16336),j=n(88257),v=n(4378),y=n(15332);let k=e=>{var t,n;let{setSelectedTick:s,setTableView:i,setTimerange:a,setParentStatuses:l}=e,[o,d]=(0,v.q)({queryKey:"statuses",decode:(0,h.useCallback)(e=>{let{statuses:t}=e;return new Set(t?JSON.parse(t):[j.izS.STARTED,j.izS.SUCCESS,j.izS.FAILURE,j.izS.SKIPPED])},[]),encode:(0,h.useCallback)(e=>({statuses:JSON.stringify(Array.from(e))}),[])}),{queryResult:c,paginationProps:u}=(0,y.l)({query:p.X,variables:{statuses:(0,h.useMemo)(()=>Array.from(o),[o])},nextCursorForResult:e=>{var t;let n=e.autoMaterializeTicks;if(n.length)return null===(t=n[14])||void 0===t?void 0:t.id},getResultArray:e=>(null==e?void 0:e.autoMaterializeTicks)?e.autoMaterializeTicks:[],pageSize:15});return(0,f.C4)(c,1e4,!u.hasPrevCursor),(0,h.useEffect)(()=>{if(u.hasPrevCursor){var e,t,n;let r=null===(e=c.data)||void 0===e?void 0:e.autoMaterializeTicks;if(r&&r.length){let e=null===(t=r[r.length-1])||void 0===t?void 0:t.timestamp,s=null===(n=r[0])||void 0===n?void 0:n.endTimestamp;e&&s&&a([e,s])}}else a(void 0)},[u.hasPrevCursor,null===(t=c.data)||void 0===t?void 0:t.autoMaterializeTicks,a]),(0,h.useEffect)(()=>{u.hasPrevCursor?l(Array.from(o)):l(void 0)},[u.hasPrevCursor,l,o]),(0,r.jsx)(g.V,{loading:c.loading,ticks:(null===(n=c.data)||void 0===n?void 0:n.autoMaterializeTicks)||[],paginationProps:u,setSelectedTick:s,setStatuses:d,setTableView:i,statuses:o})};var S=n(56130),E=n(36803),w=n(59502),C=n(57758),b=n(34219),T=n(71348);let A=()=>{var e;let t=(0,T.dx)(),n=(0,S.p)(),{permissions:{canToggleAutoMaterialize:g}={}}=(0,E.WB)(),[y,A]=(0,h.useState)(!1),[P,z]=(0,h.useState)(void 0),[O,B]=(0,h.useState)(void 0),F=(0,h.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return O||P?{afterTimestamp:null==O?void 0:O[0],beforeTimestamp:null==O?void 0:O[1],statuses:P}:{afterTimestamp:(e-12e5)/1e3}},[P,O]),[I,N]=(0,s.t)(p.X),_=(0,h.useCallback)(async()=>await I({variables:F()}),[I,F]);(0,b.Hu)(N,"AssetDaemonTicksQuery"),(0,f.bT)({refresh:_,enabled:!y&&!O&&!P,intervalMs:2e3,leading:!0});let[L,M]=(0,h.useState)(null),[R,U]=(0,v.q)((0,h.useMemo)(()=>({queryKey:"view",decode:e=>{let{view:t}=e;return"runs"===t?"runs":"evaluations"},encode:e=>({view:e,cursor:void 0,statuses:void 0})}),[])),$=null!==(e=N.data)&&void 0!==e?e:N.previousData,D=(0,h.useMemo)(()=>(null==$?void 0:$.autoMaterializeTicks)||[],[$]),K=(0,h.useMemo)(()=>{var e;return null!==(e=null==D?void 0:D.map((e,t)=>{let n=D[t-1];if(n&&(0,C.g6)(e,t)){let t={...e};return t.endTimestamp=n.timestamp,t.status=j.izS.FAILURE,t}return e}))&&void 0!==e?e:[]},[JSON.stringify(D.map(e=>"".concat(e.id,":").concat(e.status)))]),V=(0,h.useCallback)(e=>{A(!!e)},[A]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.x,{padding:{vertical:12,horizontal:24},flex:{direction:"column",gap:12},children:(0,r.jsx)(a.b,{intent:"info",title:"[Experimental] Dagster can automatically materialize assets when criteria are met.",description:(0,r.jsxs)(r.Fragment,{children:["Auto-materialization enables a declarative approach to asset scheduling – instead of defining imperative workflows to materialize your assets, you just describe the conditions under which they should be materialized."," ",(0,r.jsx)("a",{href:"https://docs.dagster.io/concepts/assets/asset-auto-execution",target:"_blank",rel:"noreferrer",children:"Learn more about auto-materialization here"}),"."]})})}),(0,r.jsx)(l.i,{children:(0,r.jsxs)("tbody",{children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:"Running"}),(0,r.jsx)("td",{children:t.loading?(0,r.jsx)(o.$,{purpose:"body-text"}):(0,r.jsx)(d.X,{format:"switch",checked:!t.paused,disabled:!g,onChange:async e=>{let r=e.target.checked;r||await n({title:"Pause Auto-materializing?",description:"Pausing Auto-materializing will prevent new materializations triggered by an Auto-materializing policy."}),t.setPaused(!r)}})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:"Evaluation frequency"}),(0,r.jsx)("td",{children:"~30s"})]})]})}),(0,r.jsx)(i.x,{padding:{vertical:12,horizontal:24},border:"bottom",children:(0,r.jsx)(c.Tj,{children:"Evaluation timeline"})}),$?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.p,{ticks:K,onHoverTick:V,onSelectTick:M,exactRange:O,timeRange:12e5,tickGrid:3e5,timeAfter:18e4}),(0,r.jsx)(m.d,{tick:L,isOpen:!!L,close:()=>{M(null)}}),"evaluations"===R?(0,r.jsx)(k,{setSelectedTick:M,setTableView:U,setParentStatuses:z,setTimerange:B}):(0,r.jsx)(x.o,{setTableView:U})]}):(0,r.jsxs)(i.x,{padding:{vertical:48},flex:{direction:"row",justifyContent:"center",gap:12,alignItems:"center"},children:[(0,r.jsx)(o.$,{purpose:"body-text"}),(0,r.jsx)("div",{style:{color:u.$()},children:"Loading evaluations…"})]})]})}},7870:function(e,t,n){n.d(t,{A:function(){return z}});var r=n(73235),s=n(52322),i=n(40794),a=n(89130),l=n(14934),o=n(79106),d=n(39013),c=n(37483),u=n(80122),h=n(40782),p=n(90731),m=n(78491),x=n(23399),g=n(16336),f=n(69737),j=n(88257),v=n(20171),y=n(4378),k=n(54048),S=n(34219),E=n(15332),w=n(10481),C=n(83586);function b(){let e=(0,r._)(["\n  query InstanceHealthForBackfillsQuery {\n    instance {\n      id\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n"]);return b=function(){return e},e}function T(){let e=(0,r._)(["\n  query InstanceBackfillsQuery($status: BulkActionStatus, $cursor: String, $limit: Int) {\n    partitionBackfillsOrError(status: $status, cursor: $cursor, limit: $limit) {\n      ... on PartitionBackfills {\n        results {\n          id\n          status\n          isValidSerialization\n          numPartitions\n          timestamp\n          partitionSetName\n          partitionSet {\n            id\n            name\n            mode\n            pipelineName\n            repositoryOrigin {\n              id\n              repositoryName\n              repositoryLocationName\n            }\n          }\n          error {\n            ...PythonErrorFragment\n          }\n\n          ...BackfillTableFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return T=function(){return e},e}let A=e=>{switch(e){case j.Jv3.CANCELED:return"Canceled";case j.Jv3.CANCELING:return"Canceling";case j.Jv3.COMPLETED:return"Completed";case j.Jv3.FAILED:return"Failed";case j.Jv3.REQUESTED:return"In progress"}},P=Object.keys(j.Jv3).map(e=>{let t=A(e);return{label:t,value:e,match:[e,t]}}),z=()=>{(0,f.Px)(),(0,v.j)("Overview | Backfills");let e=(0,i.a)(O);(0,S.Hu)(e,"InstanceHealthForBackfillsQuery");let[t,n]=(0,y.q)({encode:e=>({status:e.size?Array.from(e).join(","):void 0}),decode:e=>{var t;return new Set((null===(t=e.status)||void 0===t?void 0:t.split(","))||[])}}),r=(0,C.im)({name:"Status",icon:"status",allValues:P,allowMultipleSelections:!1,closeOnSelect:!0,renderLabel:e=>{let{value:t}=e;return(0,s.jsx)("div",{children:A(t)})},getStringValue:e=>A(e),state:t,onStateChanged:n}),{button:a,activeFiltersJsx:h}=(0,w.m)({filters:[r]}),{queryResult:m,paginationProps:j}=(0,E.l)({query:B,variables:{status:t.size>0?Array.from(t)[0]:void 0},pageSize:10,nextCursorForResult:e=>{var t;return"PartitionBackfills"===e.partitionBackfillsOrError.__typename?null===(t=e.partitionBackfillsOrError.results[9])||void 0===t?void 0:t.id:void 0},getResultArray:e=>(null==e?void 0:e.partitionBackfillsOrError.__typename)==="PartitionBackfills"?e.partitionBackfillsOrError.results:[]}),b=(0,g.C4)(m,g.dT),{loading:T,data:z}=m;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.x,{padding:{vertical:12,horizontal:20},flex:{direction:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,s.jsxs)(l.x,{flex:{direction:"column",gap:8},children:[(0,s.jsx)("div",{children:a}),h]}),(0,s.jsx)(g.xi,{refreshState:b})]}),(()=>{var n;if(T&&!z)return(0,s.jsx)(l.x,{padding:{vertical:64},flex:{direction:"column",alignItems:"center"},children:(0,s.jsxs)(l.x,{flex:{direction:"row",alignItems:"center",gap:8},children:[(0,s.jsx)(o.$,{purpose:"body-text"}),(0,s.jsx)("div",{style:{color:d.$()},children:"Loading backfills…"})]})});let r=null==z?void 0:z.partitionBackfillsOrError;if((null==r?void 0:r.__typename)==="PythonError")return(0,s.jsx)(x.T9,{error:r});if(!r||!(null==r?void 0:r.results.length))return t.size>0?(0,s.jsx)(l.x,{padding:{vertical:64},children:(0,s.jsx)(c.t,{icon:"no-results",title:"No matching backfills",description:"No backfills were found for this filter."})}):(0,s.jsx)(l.x,{padding:{vertical:64},children:(0,s.jsx)(c.t,{icon:"no-results",title:"No backfills found",description:"This instance does not have any backfill jobs."})});let i=((null===(n=e.data)||void 0===n?void 0:n.instance.daemonHealth.allDaemonStatuses)||[]).filter(e=>"BACKFILL"===e.daemonType).map(e=>e.required&&e.healthy),a=i.length&&i.every(e=>e);return(0,s.jsxs)("div",{children:[a?null:(0,s.jsx)(l.x,{padding:{horizontal:24,vertical:16},children:(0,s.jsx)(k.B1,{})}),(0,s.jsx)(p.G,{backfills:r.results.slice(0,10),refetch:m.refetch}),r.results.length>0?(0,s.jsx)(l.x,{margin:{top:16},children:(0,s.jsx)(u.b$,{...j})}):null]})})()]})},O=(0,a.Ps)(b(),h.O),B=(0,a.Ps)(T(),m.B,p.b)},62512:function(e,t,n){n.d(t,{t4:function(){return H}});var r=n(73235),s=n(52322),i=n(56675),a=n(40794),l=n(89130),o=n(14934),d=n(79106),c=n(37483),u=n(1747),h=n(89891),p=n(43212),m=n(49308),x=n(74580),g=n(35292),f=n(39013),j=n(28879),v=n.n(j),y=n(64989),k=n.n(y),S=n(77491),E=n.n(S),w=n(2784),C=n(7267),b=n(47933),T=n(35505),A=n(84927),P=n(32959),z=n(34667),O=n(78491),B=n(23399),F=n(16336),I=n(69737),N=n(22791),_=n(44900),L=n(31259),M=n(75442),R=n(88257),U=n(20171),$=n(34219),D=n(18856),K=n(77851);function V(){let e=(0,r._)(["\n  query BackfillStatusesByAsset($backfillId: String!) {\n    partitionBackfillOrError(backfillId: $backfillId) {\n      ...PartitionBackfillFragment\n      ...PythonErrorFragment\n      ... on BackfillNotFoundError {\n        message\n      }\n    }\n  }\n\n  fragment PartitionBackfillFragment on PartitionBackfill {\n    id\n    status\n    timestamp\n    endTimestamp\n    numPartitions\n    ...BackfillActionsBackfillFragment\n\n    error {\n      ...PythonErrorFragment\n    }\n    assetBackfillData {\n      rootTargetedPartitions {\n        partitionKeys\n        ranges {\n          start\n          end\n        }\n      }\n      assetBackfillStatuses {\n        ... on AssetPartitionsStatusCounts {\n          assetKey {\n            path\n          }\n          numPartitionsTargeted\n          numPartitionsInProgress\n          numPartitionsMaterialized\n          numPartitionsFailed\n        }\n        ... on UnpartitionedAssetStatus {\n          assetKey {\n            path\n          }\n          inProgress\n          materialized\n          failed\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return V=function(){return e},e}function q(){let e=(0,r._)(["\n  query BackfillPartitionsForAssetKey($backfillId: String!, $assetKey: AssetKeyInput!) {\n    partitionBackfillOrError(backfillId: $backfillId) {\n      ... on PartitionBackfill {\n        id\n        partitionsTargetedForAssetKey(assetKey: $assetKey) {\n          partitionKeys\n          ranges {\n            start\n            end\n          }\n        }\n      }\n    }\n  }\n"]);return q=function(){return e},e}v().extend(k()),v().extend(E());let H=()=>{let e=(0,i.x)(),t=(0,C.k6)(),{backfillId:n}=(0,C.UO)();(0,I.Px)(),(0,U.j)("Backfill | ".concat(n));let r=(0,a.a)(G,{variables:{backfillId:n}});(0,$.Hu)(r,"BackfillStatusesByAssetQuery");let{data:l}=r,j=(null==l?void 0:l.partitionBackfillOrError.__typename)==="PartitionBackfill"?l.partitionBackfillOrError:null,v=!j||[R.Jv3.REQUESTED,R.Jv3.CANCELING].includes(j.status),y=(0,F.C4)(r,1e4,v);return(0,s.jsxs)(m.T,{children:[(0,s.jsx)(x.m,{title:(0,s.jsxs)(g.X6,{children:[(0,s.jsx)(b.rU,{to:"/overview/backfills",style:{color:f.$()},children:"Backfills"})," / ",n]}),right:(0,s.jsxs)(o.x,{flex:{gap:12,alignItems:"center"},children:[v?(0,s.jsx)(F.xi,{refreshState:y}):null,j?(0,s.jsx)(A.WH,{backfill:j,refetch:r.refetch,canCancelRuns:j.status===R.Jv3.REQUESTED}):null]})}),function(){var r,i;if(!l||!l.partitionBackfillOrError)return(0,s.jsx)(o.x,{padding:64,"data-testid":(0,K.N)("page-loading-indicator"),children:(0,s.jsx)(d.$,{purpose:"page"})});if("PythonError"===l.partitionBackfillOrError.__typename)return(0,s.jsx)(B.T9,{error:l.partitionBackfillOrError});if("BackfillNotFoundError"===l.partitionBackfillOrError.__typename)return(0,s.jsx)(c.t,{icon:"no-results",title:l.partitionBackfillOrError.message});let a=l.partitionBackfillOrError;function m(e){let t=[{token:"tag",value:"dagster/backfill=".concat(n)}];switch(e){case"inProgress":t.push({token:"status",value:R.VOA.STARTED},{token:"status",value:R.VOA.QUEUED},{token:"status",value:R.VOA.STARTING},{token:"status",value:R.VOA.CANCELING},{token:"status",value:R.VOA.NOT_STARTED});break;case"complete":t.push({token:"status",value:R.VOA.SUCCESS});break;case"failed":t.push({token:"status",value:R.VOA.FAILURE}),t.push({token:"status",value:R.VOA.CANCELED})}return(0,D.it)(t)}let x=async(r,s)=>{let i={};if(s){var a;let t=await e.query({query:X,variables:{backfillId:n,assetKey:(0,L.W1)(r)}}),s="PartitionBackfill"===t.data.partitionBackfillOrError.__typename?t.data.partitionBackfillOrError.partitionsTargetedForAssetKey:null;s&&(null===(a=s.ranges)||void 0===a?void 0:a.length)&&(i={default_range:s.ranges.map(e=>"[".concat(e.start,"...").concat(e.end,"]")).join(",")})}return t.push((0,M.p)(r,i))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(o.x,{padding:24,flex:{direction:"row",justifyContent:"space-between",wrap:"nowrap",alignItems:"center"},"data-testid":(0,K.N)("backfill-page-details"),children:[(0,s.jsx)(W,{label:"Created",detail:(0,s.jsx)(N.E,{timestamp:{ms:Number(1e3*a.timestamp)},timeFormat:{showSeconds:!0,showTimezone:!1}})}),(0,s.jsx)(W,{label:"Duration",detail:(0,s.jsx)(J,{start:1e3*a.timestamp,end:a.endTimestamp?1e3*a.endTimestamp:null})}),(0,s.jsx)(W,{label:"Partition selection",detail:(0,s.jsx)(z.b,{targetPartitionCount:a.numPartitions||0,targetPartitions:null===(r=a.assetBackfillData)||void 0===r?void 0:r.rootTargetedPartitions})}),(0,s.jsx)(W,{label:"Status",detail:(0,s.jsx)(P.w,{backfill:a})})]}),(0,s.jsxs)(u.i,{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{style:{width:"50%"},children:"Asset name"}),(0,s.jsx)("th",{children:(0,s.jsx)(b.rU,{to:m("targeted"),children:"Partitions targeted"})}),(0,s.jsx)("th",{children:(0,s.jsx)(b.rU,{to:m("inProgress"),children:"In progress"})}),(0,s.jsx)("th",{children:(0,s.jsx)(b.rU,{to:m("complete"),children:"Completed"})}),(0,s.jsx)("th",{children:(0,s.jsx)(b.rU,{to:m("failed"),children:"Failed"})})]})}),(0,s.jsx)("tbody",{children:null===(i=a.assetBackfillData)||void 0===i?void 0:i.assetBackfillStatuses.map(e=>{let t,n,r,i;return"AssetPartitionsStatusCounts"===e.__typename?(t=e.numPartitionsTargeted,n=e.numPartitionsInProgress,r=e.numPartitionsMaterialized,i=e.numPartitionsFailed):(t=1,i=e.failed?1:0,n=e.inProgress?1:0,r=e.materialized?1:0),(0,s.jsxs)("tr",{"data-testid":(0,K.N)("backfill-asset-row-".concat((0,_.Je)(e.assetKey))),children:[(0,s.jsx)("td",{children:(0,s.jsxs)(o.x,{flex:{direction:"row",justifyContent:"space-between"},children:[(0,s.jsx)("div",{children:(0,s.jsx)(h.Z,{onClick:()=>x(e.assetKey,"AssetPartitionsStatusCounts"===e.__typename),children:e.assetKey.path.join("/")})}),(0,s.jsx)("div",{children:(0,s.jsx)(Y,{targeted:t,inProgress:n,completed:r,failed:i})})]})}),"AssetPartitionsStatusCounts"===e.__typename?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("td",{children:t}),(0,s.jsx)("td",{children:n}),(0,s.jsx)("td",{children:r}),(0,s.jsx)("td",{children:i})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("td",{children:"-"}),(0,s.jsx)("td",{children:n?(0,s.jsx)(p.V,{icon:"spinner",intent:"primary",children:"In progress"}):"-"}),(0,s.jsx)("td",{children:r?(0,s.jsx)(p.V,{intent:"success",children:"Completed"}):"-"}),(0,s.jsx)("td",{children:i?(0,s.jsx)(p.V,{intent:"danger",children:"Failed"}):"-"})]})]},(0,_.Je)(e.assetKey))})})]})]})}()]})},W=e=>{let{label:t,detail:n}=e;return(0,s.jsxs)(o.x,{flex:{direction:"column",gap:4},style:{minWidth:"280px"},children:[(0,s.jsx)(Q,{children:t}),(0,s.jsx)("div",{children:n})]})};function Y(e){let{targeted:t,inProgress:n,completed:r,failed:i}=e;return(0,s.jsxs)("div",{style:{borderRadius:"8px",backgroundColor:f.gJ(),display:"grid",gridTemplateColumns:"".concat(100*r/t,"% ").concat(100*i/t,"% ").concat(100*n/t,"%"),gridTemplateRows:"100%",height:"12px",width:"200px",overflow:"hidden"},children:[(0,s.jsx)("div",{style:{background:f.fA()}}),(0,s.jsx)("div",{style:{background:f.FY()}}),(0,s.jsx)("div",{style:{background:f.L$()}})]})}let Q=T.ZP.div.withConfig({componentId:"sc-7fa88740-0"})(["color:",";font-size:12px;line-height:16px;"],f.$()),J=e=>{let{start:t,end:n}=e,[r,i]=(0,w.useReducer)((e,t)=>e+1,0);(0,w.useEffect)(()=>{if(n)return;let e=setInterval(i,6e4);return()=>clearInterval(e)},[t,n]);let a=n?n-t:Date.now()-t;return(0,s.jsx)("span",{children:Z(a)})},G=(0,l.Ps)(V(),O.B,A.V2),X=(0,l.Ps)(q()),Z=e=>{let t=Math.floor(e/6e4%60),n=Math.floor(e/36e5%24),r=Math.floor(e/864e5),s="";return r>0?s+="".concat(r,"d ")+"".concat(n,"h"):n>0?s+="".concat(n,"h ")+"".concat(t,"m"):t>0&&(s+="".concat(t,"m ")+"".concat(Math.floor(e/1e3%60),"s")),s.trim()}},6685:function(e,t,n){n.d(t,{z:function(){return q}});var r=n(73235),s=n(52322),i=n(40794),a=n(89130),l=n(14934),o=n(79106),d=n(39013),c=n(37483),u=n(74159),h=n(35002),p=n(2784),m=n(17702),x=n(43212),g=n(88510),f=n(22921),j=n(87209),v=n(17008),y=n(98956),k=n(50646),S=n(6624),E=n(83738),w=n(22563);let C=e=>{let{repos:t,headerCheckbox:n,checkedKeys:r,onToggleCheckFactory:i}=e,a=p.useRef(null),l=p.useMemo(()=>t.map(e=>{let{repoAddress:t}=e;return(0,w.Uz)(t)}),[t]),{expandedKeys:o,onToggle:d,onToggleAll:c}=(0,k.N)(f.y,l),u=p.useMemo(()=>{let e=[];return t.forEach(t=>{let{repoAddress:n,schedules:r}=t;e.push({type:"header",repoAddress:n,scheduleCount:r.length});let s=(0,w.Uz)(n);o.includes(s)&&r.forEach(t=>{e.push({type:"schedule",repoAddress:n,schedule:t})})}),e},[t,o]),m=(0,y.w)(t.map(e=>{let{repoAddress:t}=e;return t.name})),C=(0,g.MG)({count:u.length,getScrollElement:()=>a.current,estimateSize:e=>{let t=u[e];return(null==t?void 0:t.type)==="header"?32:64},overscan:10}),b=C.getTotalSize(),T=C.getVirtualItems();return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{style:{overflow:"hidden"},children:(0,s.jsxs)(v.W2,{ref:a,children:[(0,s.jsx)(S.o,{checkbox:n}),(0,s.jsx)(v.Nh,{$totalHeight:b,children:T.map(e=>{let{index:t,key:a,size:l,start:p}=e,g=u[t];if("header"===g.type)return(0,s.jsx)(E.vG,{repoAddress:g.repoAddress,height:l,start:p,onToggle:d,onToggleAll:c,expanded:o.includes((0,w.Uz)(g.repoAddress)),showLocation:m.has(g.repoAddress.name),rightElement:(0,s.jsx)(h.u,{content:1===g.scheduleCount?"1 schedule":"".concat(g.scheduleCount," schedules"),placement:"top",children:(0,s.jsx)(x.V,{children:g.scheduleCount})})},a);let f=(0,j.g)(g.repoAddress,g.schedule.name);return(0,s.jsx)(S.i,{name:g.schedule.name,scheduleState:g.schedule.scheduleState,showCheckboxColumn:!!n,checked:r.has(f),onToggleChecked:i(f),repoAddress:g.repoAddress,height:l,start:p},a)})})]})})})};var b=n(907),T=n(49455),A=n(78491),P=n(16336),z=n(4378),O=n(52154),B=n(40782),F=n(77044),I=n(34219),N=n(70468),_=n(74050),L=n(2389),M=n(10481),R=n(50027),U=n(2949),$=n(73658),D=n(46146),K=n(65822);function V(){let e=(0,r._)(["\n  query OverviewSchedulesQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                schedules {\n                  id\n                  name\n                  description\n                  scheduleState {\n                    id\n                    ...BasicInstigationStateFragment\n                  }\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n    instance {\n      id\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n  ","\n  ","\n"]);return V=function(){return e},e}let q=()=>{let{allRepos:e,visibleRepos:t,loading:n}=(0,p.useContext)(D.C5),r=e.length,[a,m]=(0,z.q)({queryKey:"search",defaults:{search:""}}),x=(0,R.A)(),g=(0,U.g)(),f=(0,p.useMemo)(()=>[x,g],[x,g]),{button:v,activeFiltersJsx:y}=(0,M.m)({filters:f}),k=(0,i.a)(W,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),{data:S,loading:E}=k;(0,I.Hu)(k,"OverviewSchedulesQuery");let b=(0,P.C4)(k,P.dT),A=(0,p.useMemo)(()=>{let e=(0,T.S)(t);return H(S).filter(t=>{let{repoAddress:n}=t;return e.has((0,w.Uz)(n))})},[S,t]),{state:B}=g,K=(0,p.useMemo)(()=>A.map(e=>{let{schedules:t,...n}=e;return{...n,schedules:B.size?t.filter(e=>{let{scheduleState:t}=e;return B.has(t.status)}):t}}),[A,B]),V=a.trim().toLocaleLowerCase(),q=V.length>0,Y=(0,p.useMemo)(()=>{let e=V.toLocaleLowerCase();return K.map(t=>{let{repoAddress:n,schedules:r}=t;return{repoAddress:n,schedules:r.filter(t=>{let{name:n}=t;return n.toLocaleLowerCase().includes(e)})}}).filter(e=>{let{schedules:t}=e;return t.length>0})},[K,V]),Q=(0,p.useMemo)(()=>Y.some(e=>{let{schedules:t}=e;return t.length>0}),[Y]),J=(0,p.useMemo)(()=>A.map(e=>{let{repoAddress:t,schedules:n}=e;return n.filter(e=>{let{scheduleState:t}=e;return(0,F.i)(t)}).map(e=>{let{name:n,scheduleState:r}=e;return{repoAddress:t,scheduleName:n,scheduleState:r}})}).flat(),[A]),G=(0,p.useMemo)(()=>J.map(e=>{let{repoAddress:t,scheduleName:n}=e;return(0,j.g)(t,n)}),[J]),[{checkedIds:X},{onToggleFactory:Z,onToggleAll:ee}]=(0,O.a)(G),et=(0,p.useMemo)(()=>{let e=new Set(Y.map(e=>{let{repoAddress:t,schedules:n}=e;return n.map(e=>{let{name:n}=e;return(0,j.g)(t,n)})}).flat());return G.filter(t=>e.has(t))},[G,Y]),en=(0,p.useMemo)(()=>{let e=new Set(et.filter(e=>X.has(e)));return J.filter(t=>{let{repoAddress:n,scheduleName:r}=t;return e.has((0,j.g)(n,r))})},[et,J,X]),er=G.length>0,es=en.length,ei=n&&!r||E&&!S;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,s.jsxs)(l.x,{flex:{direction:"row",gap:12},children:[v,(0,s.jsx)(u.oi,{icon:"search",value:a,rightElement:ei?(0,s.jsx)($.W,{tooltipContent:"Loading schedules…"}):void 0,onChange:e=>{m(e.target.value),ee(!1)},placeholder:"Filter by schedule name…",style:{width:"340px"}})]}),(0,s.jsx)(h.u,{content:"You do not have permission to start or stop these schedules",canShow:Q&&!er,placement:"top-end",useDisabledButtonTooltipFix:!0,children:(0,s.jsx)(N._,{schedules:en,onDone:()=>b.refetch()})})]}),y.length?(0,s.jsx)(l.x,{padding:{vertical:8,horizontal:24},border:"top-and-bottom",flex:{direction:"row",gap:8},children:y}):null,E&&!r?(0,s.jsx)(l.x,{padding:64,children:(0,s.jsx)(o.$,{purpose:"page"})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.K,{daemonHealth:null==S?void 0:S.instance.daemonHealth,padding:{vertical:16,horizontal:24},border:"top"}),(()=>{if(E&&!S)return(0,s.jsx)(l.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,s.jsxs)(l.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,s.jsx)(o.$,{purpose:"body-text"}),(0,s.jsx)("div",{style:{color:d.$()},children:"Loading schedules…"})]})});let n=e.length>t.length;return Y.length?(0,s.jsx)(C,{headerCheckbox:er?(0,s.jsx)(L.W,{checkedCount:es,totalCount:et.length,onToggleAll:ee}):void 0,repos:Y,checkedKeys:X,onToggleCheckFactory:Z}):q?(0,s.jsx)(l.x,{padding:{top:20},children:(0,s.jsx)(c.t,{icon:"search",title:"No matching schedules",description:n?(0,s.jsxs)("div",{children:["No schedules matching ",(0,s.jsx)("strong",{children:a})," were found in the selected code locations"]}):(0,s.jsxs)("div",{children:["No schedules matching ",(0,s.jsx)("strong",{children:a})," were found in your definitions"]})})}):(0,s.jsx)(l.x,{padding:{top:20},children:(0,s.jsx)(c.t,{icon:"search",title:"No schedules",description:n?"No matching schedules were found in the selected code locations":"No matching schedules were found in your definitions"})})})()]})]})},H=e=>{if((null==e?void 0:e.workspaceOrError.__typename)!=="Workspace")return[];let t=e.workspaceOrError.locationEntries.map(e=>e.locationOrLoadError),n=[];for(let e of t)if((null==e?void 0:e.__typename)==="RepositoryLocation")for(let t of e.repositories){let{name:r,schedules:s}=t,i=(0,K.kQ)(r,e.name),a=s.map(e=>{let{name:t,scheduleState:n}=e;return{name:t,scheduleState:n}});a.length>0&&n.push({repoAddress:i,schedules:a})}return(0,b.S)(n)},W=(0,a.Ps)(V(),m.i,A.B,B.O)},80089:function(e,t,n){n.d(t,{n:function(){return J}});var r=n(73235),s=n(52322),i=n(40794),a=n(89130),l=n(14934),o=n(79106),d=n(39013),c=n(37483),u=n(74159),h=n(35002),p=n(2784),m=n(17702),x=n(43212),g=n(88510),f=n(22921),j=n(40389),v=n(17008),y=n(98956),k=n(50646),S=n(53029),E=n(83738),w=n(22563);let C=e=>{let{repos:t,headerCheckbox:n,checkedKeys:r,onToggleCheckFactory:i}=e,a=p.useRef(null),l=p.useMemo(()=>t.map(e=>{let{repoAddress:t}=e;return(0,w.Uz)(t)}),[t]),{expandedKeys:o,onToggle:d,onToggleAll:c}=(0,k.N)(f.y,l),u=p.useMemo(()=>{let e=[];return t.forEach(t=>{let{repoAddress:n,sensors:r}=t;e.push({type:"header",repoAddress:n,sensorCount:r.length});let s=(0,w.Uz)(n);o.includes(s)&&r.forEach(t=>{e.push({type:"sensor",repoAddress:n,sensor:t})})}),e},[t,o]),m=(0,y.w)(t.map(e=>{let{repoAddress:t}=e;return t.name})),C=(0,g.MG)({count:u.length,getScrollElement:()=>a.current,estimateSize:e=>{let t=u[e];return(null==t?void 0:t.type)==="header"?32:64},overscan:10}),b=C.getTotalSize(),T=C.getVirtualItems();return(0,s.jsx)("div",{style:{overflow:"hidden"},children:(0,s.jsxs)(v.W2,{ref:a,children:[(0,s.jsx)(S.KF,{checkbox:n}),(0,s.jsx)(v.Nh,{$totalHeight:b,children:T.map(e=>{let{index:t,key:a,size:l,start:p}=e,g=u[t];if("header"===g.type)return(0,s.jsx)(E.vG,{repoAddress:g.repoAddress,height:l,start:p,onToggle:d,onToggleAll:c,expanded:o.includes((0,w.Uz)(g.repoAddress)),showLocation:m.has(g.repoAddress.name),rightElement:(0,s.jsx)(h.u,{content:1===g.sensorCount?"1 sensor":"".concat(g.sensorCount," sensors"),placement:"top",children:(0,s.jsx)(x.V,{children:g.sensorCount})})},a);let f=(0,j.x)(g.repoAddress,g.sensor.name);return(0,s.jsx)(S.Rx,{name:g.sensor.name,sensorState:g.sensor.sensorState,showCheckboxColumn:!!n,checked:r.has(f),onToggleChecked:i(f),repoAddress:g.repoAddress,height:l,start:p},a)})})]})})};var b=n(907),T=n(49455),A=n(78491),P=n(16336),z=n(88257),O=n(4378),B=n(52154),F=n(40782),I=n(77044),N=n(34219),_=n(64265),L=n(5409),M=n(2389),R=n(10481),U=n(50027),$=n(2949),D=n(83586),K=n(73658),V=n(46146),q=n(65822);function H(){let e=(0,r._)(["\n  query OverviewSensorsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                sensors {\n                  id\n                  name\n                  description\n                  sensorType\n                  sensorState {\n                    id\n                    ...BasicInstigationStateFragment\n                  }\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n    instance {\n      id\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n  ","\n  ","\n"]);return H=function(){return e},e}function W(e){let t=S.W_[e].name;return{label:t,value:{type:e,label:t},match:[t]}}let Y={[z.dEY.ASSET]:W(z.dEY.ASSET),[z.dEY.AUTO_MATERIALIZE]:W(z.dEY.AUTO_MATERIALIZE),[z.dEY.FRESHNESS_POLICY]:W(z.dEY.FRESHNESS_POLICY),[z.dEY.MULTI_ASSET]:W(z.dEY.MULTI_ASSET),[z.dEY.RUN_STATUS]:W(z.dEY.RUN_STATUS),[z.dEY.STANDARD]:W(z.dEY.STANDARD)},Q=Object.values(Y),J=()=>{let{allRepos:e,visibleRepos:t,loading:n,data:r}=(0,p.useContext)(V.C5),a=e.length,[m,x]=(0,O.q)({queryKey:"search",defaults:{search:""}}),[g,f]=(0,O.q)({encode:e=>({sensorType:e.size?Array.from(e).join(","):void 0}),decode:e=>{var t;return new Set((null===(t=e.sensorType)||void 0===t?void 0:t.split(","))||[])}}),v=(0,U.A)(),y=(0,$.g)(),k=(0,D.im)({name:"Sensor type",allValues:Q,icon:"sensors",getStringValue:e=>e.label,state:(0,p.useMemo)(()=>new Set(Array.from(g).map(e=>Y[e].value)),[g]),renderLabel:e=>{let{value:t}=e;return(0,s.jsx)("span",{children:t.label})},onStateChanged:e=>{f(new Set(Array.from(e).map(e=>e.type)))}}),S=(0,p.useMemo)(()=>[v,y,k],[v,y,k]),{button:E,activeFiltersJsx:b}=(0,R.m)({filters:S}),A=(0,i.a)(X,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),{data:z,loading:F}=A,q=null!=z?z:(null==r?void 0:r.workspaceOrError.__typename)==="Workspace"?r:null;(0,N.Hu)(A,"OverviewSensorsQuery");let H=(0,P.C4)(A,P.dT),W=(0,p.useMemo)(()=>{let e=(0,T.S)(t);return G(q).filter(t=>{let{repoAddress:n}=t;return e.has((0,w.Uz)(n))})},[q,t]),{state:J}=y,Z=(0,p.useMemo)(()=>W.map(e=>{let{sensors:t,...n}=e;return{...n,sensors:t.filter(e=>{let{sensorState:t,sensorType:n}=e;return(!J.size||!!J.has(t.status))&&(!g.size||!!g.has(n))})}}),[W,J,g]),ee=m.trim().toLocaleLowerCase(),et=ee.length>0,en=(0,p.useMemo)(()=>{let e=ee.toLocaleLowerCase();return Z.map(t=>{let{repoAddress:n,sensors:r}=t;return{repoAddress:n,sensors:r.filter(t=>{let{name:n}=t;return n.toLocaleLowerCase().includes(e)})}}).filter(e=>{let{sensors:t}=e;return t.length>0})},[Z,ee]),er=(0,p.useMemo)(()=>en.some(e=>{let{sensors:t}=e;return t.length>0}),[en]),es=(0,p.useMemo)(()=>W.map(e=>{let{repoAddress:t,sensors:n}=e;return n.filter(e=>{let{sensorState:t}=e;return(0,I.i)(t)}).map(e=>{let{name:n,sensorState:r}=e;return{repoAddress:t,sensorName:n,sensorState:r}})}).flat(),[W]),ei=(0,p.useMemo)(()=>es.map(e=>{let{repoAddress:t,sensorName:n}=e;return(0,j.x)(t,n)}),[es]),[{checkedIds:ea},{onToggleFactory:el,onToggleAll:eo}]=(0,B.a)(ei),ed=(0,p.useMemo)(()=>{let e=new Set(en.map(e=>{let{repoAddress:t,sensors:n}=e;return n.map(e=>{let{name:n}=e;return(0,j.x)(t,n)})}).flat());return ei.filter(t=>e.has(t))},[ei,en]),ec=(0,p.useMemo)(()=>{let e=new Set(ed.filter(e=>ea.has(e)));return es.filter(t=>{let{repoAddress:n,sensorName:r}=t;return e.has((0,j.x)(n,r))})},[ed,es,ea]),eu=ei.length>0,eh=ec.length,ep=n&&!a||F&&!q;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",justifyContent:"space-between",gap:12,grow:0},children:[(0,s.jsxs)(l.x,{flex:{direction:"row",gap:12},children:[E,(0,s.jsx)(u.oi,{icon:"search",value:m,rightElement:ep?(0,s.jsx)(K.W,{tooltipContent:"Loading sensors…"}):void 0,onChange:e=>x(e.target.value),placeholder:"Filter by sensor name…",style:{width:"340px"}})]}),(0,s.jsxs)(l.x,{flex:{direction:"row",gap:12,alignItems:"center"},children:[(0,s.jsx)(P.xi,{refreshState:H}),(0,s.jsx)(h.u,{content:"You do not have permission to start or stop these schedules",canShow:er&&!eu,placement:"top-end",useDisabledButtonTooltipFix:!0,children:(0,s.jsx)(_.b,{sensors:ec,onDone:()=>H.refetch()})})]})]}),b.length?(0,s.jsx)(l.x,{padding:{vertical:8,horizontal:24},border:"top-and-bottom",flex:{direction:"row",gap:8},children:b}):null,F&&!a?(0,s.jsx)(l.x,{padding:64,children:(0,s.jsx)(o.$,{purpose:"page"})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(L.F,{daemonHealth:null==z?void 0:z.instance.daemonHealth,padding:{vertical:16,horizontal:24},border:"top"}),(()=>{if(F&&!q)return(0,s.jsx)(l.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,s.jsxs)(l.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,s.jsx)(o.$,{purpose:"body-text"}),(0,s.jsx)("div",{style:{color:d.$()},children:"Loading sensors…"})]})});let n=e.length>t.length;return en.length?(0,s.jsx)(C,{headerCheckbox:eu?(0,s.jsx)(M.W,{checkedCount:eh,totalCount:ed.length,onToggleAll:eo}):void 0,repos:en,checkedKeys:ea,onToggleCheckFactory:el}):et?(0,s.jsx)(l.x,{padding:{top:20},children:(0,s.jsx)(c.t,{icon:"search",title:"No matching sensors",description:n?(0,s.jsxs)("div",{children:["No sensors matching ",(0,s.jsx)("strong",{children:m})," were found in the selected code locations"]}):(0,s.jsxs)("div",{children:["No sensors matching ",(0,s.jsx)("strong",{children:m})," were found in your definitions"]})})}):(0,s.jsx)(l.x,{padding:{top:20},children:(0,s.jsx)(c.t,{icon:"search",title:"No sensors",description:n?"No sensors were found in the selected code locations":"No sensors were found in your definitions"})})})()]})]})},G=e=>{if((null==e?void 0:e.workspaceOrError.__typename)!=="Workspace")return[];let t=e.workspaceOrError.locationEntries.map(e=>e.locationOrLoadError),n=[];for(let e of t)if((null==e?void 0:e.__typename)==="RepositoryLocation")for(let t of e.repositories){let{name:r,sensors:s}=t,i=(0,q.kQ)(r,e.name);s.length>0&&n.push({repoAddress:i,sensors:s})}return(0,b.S)(n)},X=(0,a.Ps)(H(),m.i,A.B,F.O)},907:function(e,t,n){n.d(t,{S:function(){return s}});var r=n(22563);let s=e=>[...e].sort((e,t)=>{let n=(0,r.Uz)(e.repoAddress),s=(0,r.Uz)(t.repoAddress);return n.localeCompare(s)})},49455:function(e,t,n){n.d(t,{S:function(){return i}});var r=n(65822),s=n(22563);let i=e=>new Set(e.map(e=>(0,s.Uz)((0,r.kQ)(e.repository.name,e.repositoryLocation.name))))},73658:function(e,t,n){n.d(t,{W:function(){return d}});var r=n(52322),s=n(2784);let i=e=>{let[t,n]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let t=setTimeout(()=>n(!0),e);return()=>clearTimeout(t)},[e]),t};var a=n(14934),l=n(35002),o=n(79106);let d=e=>{let{tooltipContent:t}=e;return i(2e3)?(0,r.jsx)(a.x,{margin:{top:1},children:(0,r.jsx)(l.u,{placement:"top",canShow:!!t,content:t||"",children:(0,r.jsx)(o.$,{purpose:"body-text"})})}):null}}}]);
//# sourceMappingURL=2114.dd0cd741f0fa111b.js.map