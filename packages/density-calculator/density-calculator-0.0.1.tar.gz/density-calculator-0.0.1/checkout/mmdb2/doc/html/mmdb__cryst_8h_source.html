<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>MMDB Coordinate Library: src/mmdb_cryst.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.2 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>src/mmdb_cryst.h</h1>  </div>
</div>
<div class="contents">
<a href="mmdb__cryst_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//  $Id: mmdb_cryst.h $</span>
<a name="l00002"></a>00002 <span class="comment">//  =================================================================</span>
<a name="l00003"></a>00003 <span class="comment">//</span>
<a name="l00004"></a>00004 <span class="comment">//   CCP4 Coordinate Library: support of coordinate-related</span>
<a name="l00005"></a>00005 <span class="comment">//   functionality in protein crystallography applications.</span>
<a name="l00006"></a>00006 <span class="comment">//</span>
<a name="l00007"></a>00007 <span class="comment">//   Copyright (C) Eugene Krissinel 2000-2013.</span>
<a name="l00008"></a>00008 <span class="comment">//</span>
<a name="l00009"></a>00009 <span class="comment">//    This library is free software: you can redistribute it and/or</span>
<a name="l00010"></a>00010 <span class="comment">//    modify it under the terms of the GNU Lesser General Public</span>
<a name="l00011"></a>00011 <span class="comment">//    License version 3, modified in accordance with the provisions</span>
<a name="l00012"></a>00012 <span class="comment">//    of the license to address the requirements of UK law.</span>
<a name="l00013"></a>00013 <span class="comment">//</span>
<a name="l00014"></a>00014 <span class="comment">//    You should have received a copy of the modified GNU Lesser</span>
<a name="l00015"></a>00015 <span class="comment">//    General Public License along with this library. If not, copies</span>
<a name="l00016"></a>00016 <span class="comment">//    may be downloaded from http://www.ccp4.ac.uk/ccp4license.php</span>
<a name="l00017"></a>00017 <span class="comment">//</span>
<a name="l00018"></a>00018 <span class="comment">//    This program is distributed in the hope that it will be useful,</span>
<a name="l00019"></a>00019 <span class="comment">//    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00020"></a>00020 <span class="comment">//    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00021"></a>00021 <span class="comment">//    GNU Lesser General Public License for more details.</span>
<a name="l00022"></a>00022 <span class="comment">//</span>
<a name="l00023"></a>00023 <span class="comment">//  =================================================================</span>
<a name="l00024"></a>00024 <span class="comment">//</span>
<a name="l00025"></a>00025 <span class="comment">//    12.09.13   &lt;--  Date of Last Modification.</span>
<a name="l00026"></a>00026 <span class="comment">//                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<a name="l00027"></a>00027 <span class="comment">//  -----------------------------------------------------------------</span>
<a name="l00028"></a>00028 <span class="comment">//</span>
<a name="l00029"></a>00029 <span class="comment">//  **** Module  :  MMDB_Cryst &lt;interface&gt;</span>
<a name="l00030"></a>00030 <span class="comment">//       ~~~~~~~~~</span>
<a name="l00031"></a>00031 <span class="comment">//  **** Project :  MacroMolecular Data Base (MMDB)</span>
<a name="l00032"></a>00032 <span class="comment">//       ~~~~~~~~~</span>
<a name="l00033"></a>00033 <span class="comment">//  **** Classes :  mmdb::CrystContainer ( container for cryst. data )</span>
<a name="l00034"></a>00034 <span class="comment">//       ~~~~~~~~~  mmdb::NCSMatrix  ( non-cryst. symm. matrix class )</span>
<a name="l00035"></a>00035 <span class="comment">//                  mmdb::TVect      ( translation vector class      )</span>
<a name="l00036"></a>00036 <span class="comment">//                  mmdb::Cryst      ( MMDB cryst. section class     )</span>
<a name="l00037"></a>00037 <span class="comment">//</span>
<a name="l00038"></a>00038 <span class="comment">//  (C) E. Krissinel 2000-2013</span>
<a name="l00039"></a>00039 <span class="comment">//</span>
<a name="l00040"></a>00040 <span class="comment">//  =================================================================</span>
<a name="l00041"></a>00041 <span class="comment">//</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="preprocessor">#ifndef __MMDB_Cryst__</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span><span class="preprocessor">#define __MMDB_Cryst__</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="mmdb__io__stream_8h.html">mmdb_io_stream.h</a>&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="mmdb__symop_8h.html">mmdb_symop.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="mmdb__defs_8h.html">mmdb_defs.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="mmdb__utils_8h.html">mmdb_utils.h</a>&quot;</span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="keyword">namespace </span>mmdb  {
<a name="l00052"></a>00052 
<a name="l00053"></a>00053   <span class="comment">//  ====================  CrystContainer  ======================</span>
<a name="l00054"></a>00054 
<a name="l00055"></a>00055   <a class="code" href="namespacemmdb.html#af13b87ae247872885518c1b35a556192">DefineClass</a>(CrystContainer);
<a name="l00056"></a>00056   <a class="code" href="namespacemmdb.html#abce7198f36642de82ab4d5c4da968c4f">DefineStreamFunctions</a>(CrystContainer);
<a name="l00057"></a>00057 
<a name="l00058"></a><a class="code" href="classmmdb_1_1_cryst_container.html">00058</a>   <span class="keyword">class </span><a class="code" href="classmmdb_1_1_cryst_container.html">CrystContainer</a> : <span class="keyword">public</span> <a class="code" href="classmmdb_1_1_class_container.html">ClassContainer</a>  {
<a name="l00059"></a>00059 
<a name="l00060"></a>00060     <span class="keyword">public</span> :
<a name="l00061"></a>00061 
<a name="l00062"></a><a class="code" href="classmmdb_1_1_cryst_container.html#ae11cafbba958a2b197fefbe8ed383e9f">00062</a>       <a class="code" href="classmmdb_1_1_cryst_container.html#ae11cafbba958a2b197fefbe8ed383e9f">CrystContainer</a> () : <a class="code" href="classmmdb_1_1_class_container.html">ClassContainer</a>() {}
<a name="l00063"></a><a class="code" href="classmmdb_1_1_cryst_container.html#ab9720228bb6f70990e56dee982ca5048">00063</a>       <a class="code" href="classmmdb_1_1_cryst_container.html#ae11cafbba958a2b197fefbe8ed383e9f">CrystContainer</a> ( io::RPStream Object )
<a name="l00064"></a>00064                         : <a class="code" href="classmmdb_1_1_class_container.html">ClassContainer</a> ( Object ) {}
<a name="l00065"></a><a class="code" href="classmmdb_1_1_cryst_container.html#ad1896dda9447bc189bc9fb22564e0b83">00065</a>       <a class="code" href="classmmdb_1_1_cryst_container.html#ad1896dda9447bc189bc9fb22564e0b83">~CrystContainer</a>() {}
<a name="l00066"></a>00066 
<a name="l00067"></a>00067       PContainerClass <a class="code" href="classmmdb_1_1_cryst_container.html#a15f9559058650767cfd17f67c854f784">MakeContainerClass</a> ( <span class="keywordtype">int</span> ClassID );
<a name="l00068"></a>00068 
<a name="l00069"></a>00069       <a class="code" href="namespacemmdb.html#af715440dd114899315845ae6bba285c9">ERROR_CODE</a> <a class="code" href="classmmdb_1_1_cryst_container.html#aa641d47f9a779eb9f7072696921384bd">AddMTRIXLine</a> ( <a class="code" href="namespacemmdb.html#a0432213352c8a90e8555c15636c6351e">cpstr</a> S );
<a name="l00070"></a>00070 
<a name="l00071"></a>00071   };
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 
<a name="l00074"></a>00074   <span class="comment">//  ==================  NCSMatrix  ========================</span>
<a name="l00075"></a>00075 
<a name="l00076"></a><a class="code" href="namespacemmdb.html#ac27ecd8f2f0d92827d64fc9e2befe1ab">00076</a>   <span class="keyword">enum</span> <a class="code" href="namespacemmdb.html#ac27ecd8f2f0d92827d64fc9e2befe1ab">NCSM_SET</a>  {
<a name="l00077"></a><a class="code" href="namespacemmdb.html#ac27ecd8f2f0d92827d64fc9e2befe1abab5b5a8fdb95ae5abfc0700d59d877e09">00077</a>     <a class="code" href="namespacemmdb.html#ac27ecd8f2f0d92827d64fc9e2befe1abab5b5a8fdb95ae5abfc0700d59d877e09">NCSMSET_Matrix1</a> = 0x00000001,
<a name="l00078"></a><a class="code" href="namespacemmdb.html#ac27ecd8f2f0d92827d64fc9e2befe1abae1a20696c31a4650f8d5e73ec44a1396">00078</a>     <a class="code" href="namespacemmdb.html#ac27ecd8f2f0d92827d64fc9e2befe1abae1a20696c31a4650f8d5e73ec44a1396">NCSMSET_Matrix2</a> = 0x00000002,
<a name="l00079"></a><a class="code" href="namespacemmdb.html#ac27ecd8f2f0d92827d64fc9e2befe1aba9ecffd19aef665d77dba7f6457e6ba94">00079</a>     <a class="code" href="namespacemmdb.html#ac27ecd8f2f0d92827d64fc9e2befe1aba9ecffd19aef665d77dba7f6457e6ba94">NCSMSET_Matrix3</a> = 0x00000004,
<a name="l00080"></a><a class="code" href="namespacemmdb.html#ac27ecd8f2f0d92827d64fc9e2befe1abaad74903a1066850840c0591ff7d39364">00080</a>     <a class="code" href="namespacemmdb.html#ac27ecd8f2f0d92827d64fc9e2befe1abaad74903a1066850840c0591ff7d39364">NCSMSET_All</a>     = 0x00000007
<a name="l00081"></a>00081   };
<a name="l00082"></a>00082 
<a name="l00083"></a>00083   <a class="code" href="namespacemmdb.html#af13b87ae247872885518c1b35a556192">DefineClass</a>(NCSMatrix);
<a name="l00084"></a>00084   <a class="code" href="namespacemmdb.html#abce7198f36642de82ab4d5c4da968c4f">DefineStreamFunctions</a>(NCSMatrix);
<a name="l00085"></a>00085 
<a name="l00086"></a><a class="code" href="classmmdb_1_1_n_c_s_matrix.html">00086</a>   <span class="keyword">class </span><a class="code" href="classmmdb_1_1_n_c_s_matrix.html">NCSMatrix</a> : <span class="keyword">public</span> <a class="code" href="classmmdb_1_1_container_class.html">ContainerClass</a>  {
<a name="l00087"></a>00087 
<a name="l00088"></a><a class="code" href="classmmdb_1_1_n_c_s_matrix.html#a23468af8f932ddfc9a1cae87275d34ec">00088</a>     <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classmmdb_1_1_cryst.html">Cryst</a>;
<a name="l00089"></a>00089 
<a name="l00090"></a>00090     <span class="keyword">public</span> :
<a name="l00091"></a>00091 
<a name="l00092"></a><a class="code" href="classmmdb_1_1_n_c_s_matrix.html#a69dfab595db00c10627544e5a2c533fa">00092</a>       <span class="keywordtype">int</span>   <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#a69dfab595db00c10627544e5a2c533fa">serNum</a>;   <span class="comment">// serial number</span>
<a name="l00093"></a><a class="code" href="classmmdb_1_1_n_c_s_matrix.html#a6971d9b89e86c544fca6139d004eed3e">00093</a>       <a class="code" href="namespacemmdb.html#a820931a0033798fadcf181ae179e6a2f" title="matrix 3x3 of real numbers">mat33</a> <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#a6971d9b89e86c544fca6139d004eed3e">m</a>;        <span class="comment">// non-crystallographic symmetry matrix</span>
<a name="l00094"></a><a class="code" href="classmmdb_1_1_n_c_s_matrix.html#acf393f51a89555b581613b24a00352a9">00094</a>       <a class="code" href="namespacemmdb.html#aa764d2cc94c71cc7c2969a905af43d3c" title="vector of 3 real numbers">vect3</a> <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#acf393f51a89555b581613b24a00352a9">v</a>;        <span class="comment">// translational part of ncs matrix</span>
<a name="l00095"></a><a class="code" href="classmmdb_1_1_n_c_s_matrix.html#ae279c7ca149b319029c1c9821ed4bfe9">00095</a>       <span class="keywordtype">int</span>   <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#ae279c7ca149b319029c1c9821ed4bfe9">iGiven</a>;   <span class="comment">// iGiven flag (see PDB format)</span>
<a name="l00096"></a>00096 
<a name="l00097"></a>00097       <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#a642696683cfd9ecf3e82b2b1800682c6">NCSMatrix</a> ();
<a name="l00098"></a>00098       <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#a642696683cfd9ecf3e82b2b1800682c6">NCSMatrix</a> ( <a class="code" href="namespacemmdb.html#a0432213352c8a90e8555c15636c6351e">cpstr</a> S );
<a name="l00099"></a>00099       <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#a642696683cfd9ecf3e82b2b1800682c6">NCSMatrix</a> ( io::RPStream Object );
<a name="l00100"></a>00100       <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#a2d374994ef74bc9e2de2c04fffc4b537">~NCSMatrix</a>();
<a name="l00101"></a>00101 
<a name="l00102"></a>00102       <span class="keywordtype">bool</span>       <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#aa81d3116005b3128981061e827f244b9">PDBASCIIDump1</a>   ( io::RFile <a class="code" href="namespacemmdb_1_1mmcif.html#a2fd02f46175faf5e2161124aa83df1b5">f</a> );
<a name="l00103"></a>00103       <a class="code" href="namespacemmdb.html#af715440dd114899315845ae6bba285c9">ERROR_CODE</a> <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#af4ac17127738733a18e94729b173339f">ConvertPDBASCII</a> ( <a class="code" href="namespacemmdb.html#a0432213352c8a90e8555c15636c6351e">cpstr</a> S );
<a name="l00104"></a>00104       <span class="keywordtype">void</span>       <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#aacb494669999cc207e0ff71a3fab2e1c">MakeCIF</a>         ( mmcif::PData CIF, <span class="keywordtype">int</span> N );
<a name="l00105"></a>00105       <a class="code" href="namespacemmdb.html#af715440dd114899315845ae6bba285c9">ERROR_CODE</a> <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#a1a0373b73c011815ebf93f56cb876f92">GetCIF</a>          ( mmcif::PData CIF, <span class="keywordtype">int</span> &amp; n );
<a name="l00106"></a><a class="code" href="classmmdb_1_1_n_c_s_matrix.html#ace613c584e1fce7df342ffea2e251dfa">00106</a>       <a class="code" href="namespacemmdb.html#a3302d17d0c45b9fbfd6240cfdb00400b">CLASS_ID</a>   <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#ace613c584e1fce7df342ffea2e251dfa">GetClassID</a>      () { <span class="keywordflow">return</span> <a class="code" href="namespacemmdb.html#a3302d17d0c45b9fbfd6240cfdb00400baea10d888a8f615da8acc8d9e24552abe">ClassID_NCSMatrix</a>; }
<a name="l00107"></a>00107 
<a name="l00108"></a>00108       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#acc701365878dd15a3fa9638d4192ded9">SetNCSMatrix</a>    ( <span class="keywordtype">int</span> serialNum,
<a name="l00109"></a>00109                               <a class="code" href="namespacemmdb.html#a820931a0033798fadcf181ae179e6a2f" title="matrix 3x3 of real numbers">mat33</a> &amp; ncs_m, <a class="code" href="namespacemmdb.html#aa764d2cc94c71cc7c2969a905af43d3c" title="vector of 3 real numbers">vect3</a> &amp; ncs_v,
<a name="l00110"></a>00110                               <span class="keywordtype">int</span> i_Given );
<a name="l00111"></a>00111 
<a name="l00112"></a>00112       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#a2bb4a0567887f06d447f88b5cc601160">Copy</a>  ( PContainerClass <a class="code" href="classmmdb_1_1_n_c_s_matrix.html">NCSMatrix</a> );
<a name="l00113"></a>00113 
<a name="l00114"></a>00114       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#a628194262b054572754d5050527313f4">write</a> ( io::RFile <a class="code" href="namespacemmdb_1_1mmcif.html#a2fd02f46175faf5e2161124aa83df1b5">f</a> );
<a name="l00115"></a>00115       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#a17c917bc1a6576030d7a6e17b1c16825">read</a>  ( io::RFile <a class="code" href="namespacemmdb_1_1mmcif.html#a2fd02f46175faf5e2161124aa83df1b5">f</a> );
<a name="l00116"></a>00116 
<a name="l00117"></a>00117     <span class="keyword">protected</span> :
<a name="l00118"></a><a class="code" href="classmmdb_1_1_n_c_s_matrix.html#ae90cb7dfd2d5b2d86c7213ac3ef4d710">00118</a>       <a class="code" href="namespacemmdb.html#a269bc849ac0e1e4f1dcdc26170ce09a1">word</a>  <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#ae90cb7dfd2d5b2d86c7213ac3ef4d710">WhatIsSet</a>;  <span class="comment">//    mask       field</span>
<a name="l00119"></a>00119                         <span class="comment">//   0x0001    MTRIX1 was converted</span>
<a name="l00120"></a>00120                         <span class="comment">//   0x0002    MTRIX2 was converted</span>
<a name="l00121"></a>00121                         <span class="comment">//   0x0004    MTRIX3 was converted</span>
<a name="l00122"></a>00122 
<a name="l00123"></a>00123       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_n_c_s_matrix.html#a8cd2e13470343baf8fe17df79779cc80">Init</a>();
<a name="l00124"></a>00124 
<a name="l00125"></a>00125   };
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 
<a name="l00128"></a>00128   <span class="comment">//  ==================  TVect  ========================</span>
<a name="l00129"></a>00129 
<a name="l00130"></a>00130   <a class="code" href="namespacemmdb.html#af13b87ae247872885518c1b35a556192">DefineClass</a>(<a class="code" href="classmmdb_1_1_t_vect.html">TVect</a>);
<a name="l00131"></a>00131   <a class="code" href="namespacemmdb.html#abce7198f36642de82ab4d5c4da968c4f">DefineStreamFunctions</a>(<a class="code" href="classmmdb_1_1_t_vect.html">TVect</a>);
<a name="l00132"></a>00132 
<a name="l00133"></a><a class="code" href="classmmdb_1_1_t_vect.html">00133</a>   <span class="keyword">class </span><a class="code" href="classmmdb_1_1_t_vect.html">TVect</a> : <span class="keyword">public</span> <a class="code" href="classmmdb_1_1_container_class.html">ContainerClass</a>  {
<a name="l00134"></a>00134 
<a name="l00135"></a>00135     <span class="keyword">public</span> :
<a name="l00136"></a>00136 
<a name="l00137"></a><a class="code" href="classmmdb_1_1_t_vect.html#a03a541be10e5e0f350db7b2ab9694ec4">00137</a>       <span class="keywordtype">int</span>   <a class="code" href="classmmdb_1_1_t_vect.html#a03a541be10e5e0f350db7b2ab9694ec4">serNum</a>;   <span class="comment">// serial number</span>
<a name="l00138"></a><a class="code" href="classmmdb_1_1_t_vect.html#a0499a43b0d694a0974a803275520158a">00138</a>       <a class="code" href="namespacemmdb.html#aa764d2cc94c71cc7c2969a905af43d3c" title="vector of 3 real numbers">vect3</a> <a class="code" href="classmmdb_1_1_t_vect.html#a0499a43b0d694a0974a803275520158a">t</a>;        <span class="comment">// translation vector</span>
<a name="l00139"></a><a class="code" href="classmmdb_1_1_t_vect.html#a8e4a9fe37d337176ad003ae6d1ca09c4">00139</a>       <a class="code" href="namespacemmdb.html#ae4679f2216e36062ed20ef4774c3cfef">pstr</a>  <a class="code" href="classmmdb_1_1_t_vect.html#a8e4a9fe37d337176ad003ae6d1ca09c4">comment</a>;  <span class="comment">// comment</span>
<a name="l00140"></a>00140 
<a name="l00141"></a>00141       <a class="code" href="classmmdb_1_1_t_vect.html#a3069fa40ce456bfd14380d63ce010687">TVect</a> ();
<a name="l00142"></a>00142       <a class="code" href="classmmdb_1_1_t_vect.html#a3069fa40ce456bfd14380d63ce010687">TVect</a> ( <a class="code" href="namespacemmdb.html#a0432213352c8a90e8555c15636c6351e">cpstr</a> S );
<a name="l00143"></a>00143       <a class="code" href="classmmdb_1_1_t_vect.html#a3069fa40ce456bfd14380d63ce010687">TVect</a> ( io::RPStream Object );
<a name="l00144"></a>00144       <a class="code" href="classmmdb_1_1_t_vect.html#a1a7ac9aa328ef3d933b79cd18029078b">~TVect</a>();
<a name="l00145"></a>00145 
<a name="l00146"></a>00146       <span class="keywordtype">void</span>       <a class="code" href="classmmdb_1_1_t_vect.html#a6192fc9a4c7e2f2426b7bf059d0b976f">PDBASCIIDump</a>    ( <a class="code" href="namespacemmdb.html#ae4679f2216e36062ed20ef4774c3cfef">pstr</a> S, <span class="keywordtype">int</span> N );
<a name="l00147"></a>00147       <a class="code" href="namespacemmdb.html#af715440dd114899315845ae6bba285c9">ERROR_CODE</a> <a class="code" href="classmmdb_1_1_t_vect.html#a9e94c5b2e71947277e302c37f1b12884">ConvertPDBASCII</a> ( <a class="code" href="namespacemmdb.html#a0432213352c8a90e8555c15636c6351e">cpstr</a> S );
<a name="l00148"></a>00148       <span class="keywordtype">void</span>       <a class="code" href="classmmdb_1_1_t_vect.html#a5a2207b9e4aa2b53891f20d2b23d5aa2">MakeCIF</a>         ( mmcif::PData CIF, <span class="keywordtype">int</span> N );
<a name="l00149"></a>00149       <a class="code" href="namespacemmdb.html#af715440dd114899315845ae6bba285c9">ERROR_CODE</a> <a class="code" href="classmmdb_1_1_t_vect.html#a25157ad33603bffd7b181fd1b28dde27">GetCIF</a>          ( mmcif::PData CIF, <span class="keywordtype">int</span> &amp; n );
<a name="l00150"></a><a class="code" href="classmmdb_1_1_t_vect.html#a509787ce35d5688f979d8fbf8951946b">00150</a>       <a class="code" href="namespacemmdb.html#a3302d17d0c45b9fbfd6240cfdb00400b">CLASS_ID</a>   <a class="code" href="classmmdb_1_1_t_vect.html#a509787ce35d5688f979d8fbf8951946b">GetClassID</a>      () { <span class="keywordflow">return</span> <a class="code" href="namespacemmdb.html#a3302d17d0c45b9fbfd6240cfdb00400ba9c7a8cf3bfca105a1345070efb15b27c">ClassID_TVect</a>; }
<a name="l00151"></a>00151 
<a name="l00152"></a>00152       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_t_vect.html#a04e8fb9f5d1b95b485ef00cc7f3e4e00">Copy</a>  ( PContainerClass <a class="code" href="classmmdb_1_1_t_vect.html">TVect</a> );
<a name="l00153"></a>00153 
<a name="l00154"></a>00154       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_t_vect.html#a94598b35819c3a669b8c93aeabdff9f6">write</a> ( io::RFile <a class="code" href="namespacemmdb_1_1mmcif.html#a2fd02f46175faf5e2161124aa83df1b5">f</a> );
<a name="l00155"></a>00155       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_t_vect.html#abdb2e258e88ba8dea23e5122d6a97bb6">read</a>  ( io::RFile <a class="code" href="namespacemmdb_1_1mmcif.html#a2fd02f46175faf5e2161124aa83df1b5">f</a> );
<a name="l00156"></a>00156 
<a name="l00157"></a>00157     <span class="keyword">protected</span> :
<a name="l00158"></a>00158 
<a name="l00159"></a>00159       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_t_vect.html#ad0c2db1751feeb6dfd4b9c8242b23a65">Init</a>();
<a name="l00160"></a>00160 
<a name="l00161"></a>00161   };
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 
<a name="l00164"></a>00164   <span class="comment">//  =================  Cryst  =======================</span>
<a name="l00165"></a>00165 
<a name="l00166"></a>00166   <a class="code" href="namespacemmdb.html#af13b87ae247872885518c1b35a556192">DefineClass</a>(Cryst);
<a name="l00167"></a>00167   <a class="code" href="namespacemmdb.html#abce7198f36642de82ab4d5c4da968c4f">DefineStreamFunctions</a>(Cryst);
<a name="l00168"></a>00168 
<a name="l00169"></a>00169   <span class="comment">// constants for the CellCheck field</span>
<a name="l00170"></a><a class="code" href="namespacemmdb.html#a76e72f8100ec1378cac9c18245bc97a3">00170</a>   <span class="keyword">enum</span> <a class="code" href="namespacemmdb.html#a76e72f8100ec1378cac9c18245bc97a3">CELL_CHECK</a>  {
<a name="l00171"></a><a class="code" href="namespacemmdb.html#a76e72f8100ec1378cac9c18245bc97a3a8bf7cb472328f3a9171e2b4bd2783703">00171</a>     <a class="code" href="namespacemmdb.html#a76e72f8100ec1378cac9c18245bc97a3a8bf7cb472328f3a9171e2b4bd2783703">CCHK_Ok</a>           = 0x00000000,
<a name="l00172"></a><a class="code" href="namespacemmdb.html#a76e72f8100ec1378cac9c18245bc97a3a5bb026e98c5c54e5bad0847b4e998171">00172</a>     <a class="code" href="namespacemmdb.html#a76e72f8100ec1378cac9c18245bc97a3a5bb026e98c5c54e5bad0847b4e998171">CCHK_NoCell</a>       = 0x00000001,
<a name="l00173"></a><a class="code" href="namespacemmdb.html#a76e72f8100ec1378cac9c18245bc97a3a5af0718d4c49dba7aafe78557117651e">00173</a>     <a class="code" href="namespacemmdb.html#a76e72f8100ec1378cac9c18245bc97a3a5af0718d4c49dba7aafe78557117651e">CCHK_Error</a>        = 0x00000002,
<a name="l00174"></a><a class="code" href="namespacemmdb.html#a76e72f8100ec1378cac9c18245bc97a3adcc3a9af1696decc16b9298e92876ace">00174</a>     <a class="code" href="namespacemmdb.html#a76e72f8100ec1378cac9c18245bc97a3adcc3a9af1696decc16b9298e92876ace">CCHK_Disagreement</a> = 0x00000004,
<a name="l00175"></a><a class="code" href="namespacemmdb.html#a76e72f8100ec1378cac9c18245bc97a3ab84dfbe27cccf90e8dbecb48c7872cdc">00175</a>     <a class="code" href="namespacemmdb.html#a76e72f8100ec1378cac9c18245bc97a3ab84dfbe27cccf90e8dbecb48c7872cdc">CCHK_NoOrthCode</a>   = 0x00000008,
<a name="l00176"></a><a class="code" href="namespacemmdb.html#a76e72f8100ec1378cac9c18245bc97a3a8317d63cac66c99f661acabfa90765c0">00176</a>     <a class="code" href="namespacemmdb.html#a76e72f8100ec1378cac9c18245bc97a3a8317d63cac66c99f661acabfa90765c0">CCHK_Translations</a> = 0x00000010,
<a name="l00177"></a><a class="code" href="namespacemmdb.html#a76e72f8100ec1378cac9c18245bc97a3aa5b70b5b6c4482a6ec743b7c1dc69055">00177</a>     <a class="code" href="namespacemmdb.html#a76e72f8100ec1378cac9c18245bc97a3aa5b70b5b6c4482a6ec743b7c1dc69055">CCHK_Unchecked</a>    = 0x00001000
<a name="l00178"></a>00178   };
<a name="l00179"></a>00179 
<a name="l00180"></a>00180   <span class="comment">// constants for the WhatIsSet field</span>
<a name="l00181"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402">00181</a>   <span class="keyword">enum</span> <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402">CELL_SET</a>  {
<a name="l00182"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a7f216bcf2b8d2e64fa723039a247b54d">00182</a>     <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a7f216bcf2b8d2e64fa723039a247b54d">CSET_CellParams1</a>  = 0x00000001,
<a name="l00183"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a4913a3e9c964ffb474957ddbf33e4cd3">00183</a>     <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a4913a3e9c964ffb474957ddbf33e4cd3">CSET_CellParams2</a>  = 0x00000002,
<a name="l00184"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a1ddb547ea7df7ac4c030552b9d394f04">00184</a>     <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a1ddb547ea7df7ac4c030552b9d394f04">CSET_CellParams</a>   = 0x00000003,
<a name="l00185"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a93692a67453834750f4fc8b7187956a7">00185</a>     <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a93692a67453834750f4fc8b7187956a7">CSET_SpaceGroup</a>   = 0x00000004,
<a name="l00186"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402afa418ec96a53b03e145dda26e9de8b6b">00186</a>     <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402afa418ec96a53b03e145dda26e9de8b6b">CSET_ZValue</a>       = 0x00000008,
<a name="l00187"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a6591899bd08aa5c817184489e1c8a5fc">00187</a>     <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a6591899bd08aa5c817184489e1c8a5fc">CSET_CrystCard</a>    = 0x0000000F,
<a name="l00188"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a5e277361022f3474529193fd05227cb9">00188</a>     <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a5e277361022f3474529193fd05227cb9">CSET_OrigMatrix1</a>  = 0x00000010,
<a name="l00189"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402aba8b9ec5276c8e8a2c7900b1e64b8067">00189</a>     <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402aba8b9ec5276c8e8a2c7900b1e64b8067">CSET_OrigMatrix2</a>  = 0x00000020,
<a name="l00190"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a0e5b345574c210f4664dc47d70ba6ea9">00190</a>     <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a0e5b345574c210f4664dc47d70ba6ea9">CSET_OrigMatrix3</a>  = 0x00000040,
<a name="l00191"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402af2db71a510d79379ae0752a7b73eaaac">00191</a>     <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402af2db71a510d79379ae0752a7b73eaaac">CSET_OrigMatrix</a>   = 0x00000070,
<a name="l00192"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a202968a8c1d86360c7d137999716b5c8">00192</a>     <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a202968a8c1d86360c7d137999716b5c8">CSET_ScaleMatrix1</a> = 0x00000080,
<a name="l00193"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a4c9c4e615597688f6b3834fa43bc4d8b">00193</a>     <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a4c9c4e615597688f6b3834fa43bc4d8b">CSET_ScaleMatrix2</a> = 0x00000100,
<a name="l00194"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402ae5ddc0305fd7e3f4dbd0dcd5d72ec257">00194</a>     <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402ae5ddc0305fd7e3f4dbd0dcd5d72ec257">CSET_ScaleMatrix3</a> = 0x00000200,
<a name="l00195"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402aaa1209261c8d2179f1b713bec83d743a">00195</a>     <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402aaa1209261c8d2179f1b713bec83d743a">CSET_ScaleMatrix</a>  = 0x00000380,
<a name="l00196"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a4a797912d8be2d93b446cf965c3c6e16">00196</a>     <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a4a797912d8be2d93b446cf965c3c6e16">CSET_Transforms</a>   = 0x00000400,
<a name="l00197"></a><a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a23cf16f9bbed600efddfc526febeba79">00197</a>     <a class="code" href="namespacemmdb.html#af2e730df60134092151ec59fb1473402a23cf16f9bbed600efddfc526febeba79">CSET_DummyCell</a>    = 0x00001000
<a name="l00198"></a>00198   };
<a name="l00199"></a>00199 
<a name="l00200"></a>00200   <span class="keyword">extern</span> <a class="code" href="namespacemmdb.html#a0432213352c8a90e8555c15636c6351e">cpstr</a> <a class="code" href="namespacemmdb.html#a9b220bfb9e714d109e2f68b58d39a9f8">OrthCode</a>[6];
<a name="l00201"></a>00201 
<a name="l00202"></a><a class="code" href="classmmdb_1_1_cryst.html">00202</a>   <span class="keyword">class </span><a class="code" href="classmmdb_1_1_cryst.html">Cryst</a> : <span class="keyword">public</span> io::Stream  {
<a name="l00203"></a>00203 
<a name="l00204"></a><a class="code" href="classmmdb_1_1_cryst.html#ac47342240f21ce36f47485e4ab41a10d">00204</a>     <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classmmdb_1_1_cryst.html#ac47342240f21ce36f47485e4ab41a10d">Channel</a>;
<a name="l00205"></a>00205 
<a name="l00206"></a>00206     <span class="keyword">public</span> :
<a name="l00207"></a><a class="code" href="classmmdb_1_1_cryst.html#a645b266ea0559708ae7c826d7794a811">00207</a>       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a>  <a class="code" href="classmmdb_1_1_cryst.html#ae081c5c9c0cd5d71aacc8e500c05663e">a</a>,<a class="code" href="classmmdb_1_1_cryst.html#aa7fbfe3cfe836b552eacb6b909a5e375">b</a>,<a class="code" href="classmmdb_1_1_cryst.html#a645b266ea0559708ae7c826d7794a811">c</a>;            <span class="comment">// cell parameters</span>
<a name="l00208"></a><a class="code" href="classmmdb_1_1_cryst.html#afdefed41181afbcf2b4b54bcd58aaadf">00208</a>       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a>  <a class="code" href="classmmdb_1_1_cryst.html#a35cac3b66a4f1d997cfc9a68d3a55792">alpha</a>,<a class="code" href="classmmdb_1_1_cryst.html#afee57eb9a2668e54714df04a708d4b47">beta</a>,<a class="code" href="classmmdb_1_1_cryst.html#afdefed41181afbcf2b4b54bcd58aaadf">gamma</a>; <span class="comment">// cell parameters</span>
<a name="l00209"></a><a class="code" href="classmmdb_1_1_cryst.html#af5c330ee0516bf39d650df59dc6c07aa">00209</a>       <a class="code" href="namespacemmdb.html#af201af7b5a3f8048870cc0dc176e8cf7" title="matrix 4x4 of real numbers">mat44</a>     <a class="code" href="classmmdb_1_1_cryst.html#af5c330ee0516bf39d650df59dc6c07aa">RO</a>,<a class="code" href="classmmdb_1_1_cryst.html#a702acc0e3f2deae87231dccc05ea5ec6">RF</a>;            <span class="comment">// orthogonal-fractional recalculation</span>
<a name="l00210"></a>00210                                   <span class="comment">//   matrices</span>
<a name="l00211"></a><a class="code" href="classmmdb_1_1_cryst.html#abef415997b086565600c79d07853c0f5">00211</a>       <a class="code" href="namespacemmdb.html#af201af7b5a3f8048870cc0dc176e8cf7" title="matrix 4x4 of real numbers">mat44</a>     <a class="code" href="classmmdb_1_1_cryst.html#abef415997b086565600c79d07853c0f5">ROU</a>,<a class="code" href="classmmdb_1_1_cryst.html#a127990573f485e0d35fb02f69b55ed80">RFU</a>;          <span class="comment">// ort-frac recalc matrices for</span>
<a name="l00212"></a>00212                                   <span class="comment">//   anisotr. t-fac</span>
<a name="l00213"></a><a class="code" href="classmmdb_1_1_cryst.html#a9a46f7c41ab6c329b97b4c36b206318a">00213</a>       <a class="code" href="namespacemmdb.html#ab6c830fdd676f6f02403df3f64f3da77" title="matrix 6x3x3 of real numbers">mat633</a>    <a class="code" href="classmmdb_1_1_cryst.html#a9a46f7c41ab6c329b97b4c36b206318a">RR</a>;               <span class="comment">// standard orthogonalizations</span>
<a name="l00214"></a><a class="code" href="classmmdb_1_1_cryst.html#afdfb4506fdf9c2ac6f5411bf12ef5941">00214</a>       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a>  <a class="code" href="classmmdb_1_1_cryst.html#afdfb4506fdf9c2ac6f5411bf12ef5941">Vol</a>;              <span class="comment">// cell volume</span>
<a name="l00215"></a><a class="code" href="classmmdb_1_1_cryst.html#adea147a81198e654976e9bcb4896a424">00215</a>       <span class="keywordtype">int</span>       <a class="code" href="classmmdb_1_1_cryst.html#adea147a81198e654976e9bcb4896a424">NCode</a>;            <span class="comment">// code of orthogonalization matrix</span>
<a name="l00216"></a><a class="code" href="classmmdb_1_1_cryst.html#a9c8292e1a096122974da983bdc26c349">00216</a>       <a class="code" href="namespacemmdb.html#ac39ab6b80cd38302cd70d41cfa3d9089" title="group of space symmetry">SymGroup</a>  <a class="code" href="classmmdb_1_1_cryst.html#a9c8292e1a096122974da983bdc26c349">spaceGroup</a>;       <span class="comment">// group of space symmetry as read</span>
<a name="l00217"></a>00217                                   <span class="comment">//    from file</span>
<a name="l00218"></a><a class="code" href="classmmdb_1_1_cryst.html#af5c8af2a53818bc5e5cd078ccbcd75f8">00218</a>       <a class="code" href="namespacemmdb.html#ac39ab6b80cd38302cd70d41cfa3d9089" title="group of space symmetry">SymGroup</a>  <a class="code" href="classmmdb_1_1_cryst.html#af5c8af2a53818bc5e5cd078ccbcd75f8">spaceGroupFix</a>;    <span class="comment">// actually used space group</span>
<a name="l00219"></a><a class="code" href="classmmdb_1_1_cryst.html#af7abd472c1e17e1ebdd31877fbfc48e4">00219</a>       <span class="keywordtype">int</span>       <a class="code" href="classmmdb_1_1_cryst.html#af7abd472c1e17e1ebdd31877fbfc48e4">Z</a>;                <span class="comment">// Z-value</span>
<a name="l00220"></a>00220 
<a name="l00221"></a><a class="code" href="classmmdb_1_1_cryst.html#a55fa1265fa2091fd9eb3af4ed44ef437">00221</a>       <a class="code" href="namespacemmdb.html#a820931a0033798fadcf181ae179e6a2f" title="matrix 3x3 of real numbers">mat33</a>     <a class="code" href="classmmdb_1_1_cryst.html#a55fa1265fa2091fd9eb3af4ed44ef437">o</a>;                <span class="comment">// orthogonal transformation matrix</span>
<a name="l00222"></a><a class="code" href="classmmdb_1_1_cryst.html#a3b04abf3a78abe7500f498fd59391c55">00222</a>       <a class="code" href="namespacemmdb.html#aa764d2cc94c71cc7c2969a905af43d3c" title="vector of 3 real numbers">vect3</a>     <a class="code" href="classmmdb_1_1_cryst.html#a3b04abf3a78abe7500f498fd59391c55">t</a>;                <span class="comment">// translation orthogonal vector</span>
<a name="l00223"></a><a class="code" href="classmmdb_1_1_cryst.html#a1a008ab7b4bd333cd9a80cbe7fee8a1f">00223</a>       <a class="code" href="namespacemmdb.html#a820931a0033798fadcf181ae179e6a2f" title="matrix 3x3 of real numbers">mat33</a>     <a class="code" href="classmmdb_1_1_cryst.html#a1a008ab7b4bd333cd9a80cbe7fee8a1f">s</a>;                <span class="comment">// scale matrix</span>
<a name="l00224"></a><a class="code" href="classmmdb_1_1_cryst.html#a1a2f27105bd8a6076129dbafe22a107d">00224</a>       <a class="code" href="namespacemmdb.html#aa764d2cc94c71cc7c2969a905af43d3c" title="vector of 3 real numbers">vect3</a>     <a class="code" href="classmmdb_1_1_cryst.html#a1a2f27105bd8a6076129dbafe22a107d">u</a>;                <span class="comment">// translation part of the scale matrix</span>
<a name="l00225"></a>00225 
<a name="l00226"></a><a class="code" href="classmmdb_1_1_cryst.html#a7f08bafb0bde20385e547fdab2761f49">00226</a>       <a class="code" href="namespacemmdb.html#a269bc849ac0e1e4f1dcdc26170ce09a1">word</a>      <a class="code" href="classmmdb_1_1_cryst.html#a7f08bafb0bde20385e547fdab2761f49">CellCheck</a>;        <span class="comment">// 0x0000 - Ok</span>
<a name="l00227"></a>00227                                   <span class="comment">// 0x0001 - no cell stored</span>
<a name="l00228"></a>00228                                   <span class="comment">// 0x0002 - some error in cell volume</span>
<a name="l00229"></a>00229                                   <span class="comment">// 0x0004 - disagreement between</span>
<a name="l00230"></a>00230                                   <span class="comment">//           cell and PDB</span>
<a name="l00231"></a>00231                                   <span class="comment">// 0x0008 - no orth code derived</span>
<a name="l00232"></a>00232                                   <span class="comment">// 0x0010 - translations also specified</span>
<a name="l00233"></a>00233                                   <span class="comment">// 0x1000 - the check was not done</span>
<a name="l00234"></a><a class="code" href="classmmdb_1_1_cryst.html#ac20de178f3a61e9956c75daa5d0c84fa">00234</a>       <a class="code" href="namespacemmdb.html#a269bc849ac0e1e4f1dcdc26170ce09a1">word</a>   <a class="code" href="classmmdb_1_1_cryst.html#ac20de178f3a61e9956c75daa5d0c84fa">WhatIsSet</a>;           <span class="comment">// indicator of the fields set</span>
<a name="l00235"></a><a class="code" href="classmmdb_1_1_cryst.html#a13e0f7bacd2cf8f7bfbee2a7837619e7">00235</a>       <span class="keywordtype">bool</span>   <a class="code" href="classmmdb_1_1_cryst.html#a13e0f7bacd2cf8f7bfbee2a7837619e7">ignoreScalei</a>;        <span class="comment">// flag to ignore SCALEi cards</span>
<a name="l00236"></a><a class="code" href="classmmdb_1_1_cryst.html#a658a0a63d38fd66fb5c57e2ef49ea2f3">00236</a>       <span class="keywordtype">bool</span>   <a class="code" href="classmmdb_1_1_cryst.html#a658a0a63d38fd66fb5c57e2ef49ea2f3">processSG</a>;           <span class="comment">// flag to process space group at file</span>
<a name="l00237"></a>00237                                   <span class="comment">// read</span>
<a name="l00238"></a><a class="code" href="classmmdb_1_1_cryst.html#ae55aa39e1fa8efd21f686c77f67cabac">00238</a>       <span class="keywordtype">bool</span>   <a class="code" href="classmmdb_1_1_cryst.html#ae55aa39e1fa8efd21f686c77f67cabac">fixSpaceGroup</a>;       <span class="comment">// flag to fix space group at file read</span>
<a name="l00239"></a>00239 
<a name="l00240"></a>00240       <a class="code" href="classmmdb_1_1_cryst.html#a61f1a06f37c0022d6d60e7a133b59fda">Cryst</a> ();
<a name="l00241"></a>00241       <a class="code" href="classmmdb_1_1_cryst.html#a61f1a06f37c0022d6d60e7a133b59fda">Cryst</a> ( io::RPStream Object );
<a name="l00242"></a>00242       <a class="code" href="classmmdb_1_1_cryst.html#aaa8300f228a7bde13e91c5e334900ed0">~Cryst</a>();
<a name="l00243"></a>00243 
<a name="l00244"></a>00244       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_cryst.html#a1822d1cbcc82bf304d1d6d9c4d6bfd8e">FreeMemory</a>();
<a name="l00245"></a>00245       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_cryst.html#a2fdd0a2cf054044bd4fa5dd86fcb8964">Reset</a>     ();
<a name="l00246"></a>00246 
<a name="l00247"></a>00247       <span class="comment">//   ConvertPDBString(..) interprets an ASCII PDB line and fills</span>
<a name="l00248"></a>00248       <span class="comment">// the corresponding data fields. It returns zero if the line was</span>
<a name="l00249"></a>00249       <span class="comment">// successfully converted, otherwise returns a non-negative value</span>
<a name="l00250"></a>00250       <span class="comment">// of Error_XXXX.</span>
<a name="l00251"></a>00251       <span class="comment">//   PDBString must be not shorter than 81 characters.</span>
<a name="l00252"></a>00252       <a class="code" href="namespacemmdb.html#af715440dd114899315845ae6bba285c9">ERROR_CODE</a> <a class="code" href="classmmdb_1_1_cryst.html#a25a7f434df871436e347ac1ff8cf59a5">ConvertPDBString</a> ( <a class="code" href="namespacemmdb.html#ae4679f2216e36062ed20ef4774c3cfef">pstr</a> PDBString );
<a name="l00253"></a>00253 
<a name="l00254"></a>00254       <span class="comment">//   RWBROOKReadPrintout() may be invoked after reading PDB file</span>
<a name="l00255"></a>00255       <span class="comment">// for simulating the old RWBROOK messages and warnings</span>
<a name="l00256"></a>00256       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_cryst.html#acb4794818fa0c3ae63050889c45f6a32">RWBROOKReadPrintout</a>();
<a name="l00257"></a>00257 
<a name="l00258"></a>00258       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_cryst.html#aaf6f4b6b1484f79b8bbf115ff9b32c4b">SetCell</a> ( <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> cell_a,
<a name="l00259"></a>00259                       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> cell_b,
<a name="l00260"></a>00260                       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> cell_c,
<a name="l00261"></a>00261                       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> cell_alpha,
<a name="l00262"></a>00262                       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> cell_beta,
<a name="l00263"></a>00263                       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> cell_gamma,
<a name="l00264"></a>00264                       <span class="keywordtype">int</span>      <a class="code" href="namespacemmdb.html#a9b220bfb9e714d109e2f68b58d39a9f8">OrthCode</a> );
<a name="l00265"></a>00265       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_cryst.html#a15e49ada5d5ac230dd9131353795bb19">PutCell</a> ( <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> cell_a,
<a name="l00266"></a>00266                       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> cell_b,
<a name="l00267"></a>00267                       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> cell_c,
<a name="l00268"></a>00268                       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> cell_alpha,
<a name="l00269"></a>00269                       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> cell_beta,
<a name="l00270"></a>00270                       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> cell_gamma,
<a name="l00271"></a>00271                       <span class="keywordtype">int</span>      <a class="code" href="namespacemmdb.html#a9b220bfb9e714d109e2f68b58d39a9f8">OrthCode</a> );
<a name="l00272"></a>00272 
<a name="l00273"></a>00273       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_cryst.html#af0947b3191c050e7831c5ecaa2055888">GetCell</a> ( <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; cell_a,
<a name="l00274"></a>00274                       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; cell_b,
<a name="l00275"></a>00275                       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; cell_c,
<a name="l00276"></a>00276                       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; cell_alpha,
<a name="l00277"></a>00277                       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; cell_beta,
<a name="l00278"></a>00278                       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; cell_gamma,
<a name="l00279"></a>00279                       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; vol );
<a name="l00280"></a>00280 
<a name="l00281"></a>00281       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_cryst.html#a561cf7d314c342705fcb484d75a39633">GetRCell</a> ( <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; cell_as,
<a name="l00282"></a>00282                        <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; cell_bs,
<a name="l00283"></a>00283                        <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; cell_cs,
<a name="l00284"></a>00284                        <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; cell_alphas,
<a name="l00285"></a>00285                        <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; cell_betas,
<a name="l00286"></a>00286                        <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; cell_gammas,
<a name="l00287"></a>00287                        <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; vols );
<a name="l00288"></a>00288 
<a name="l00289"></a>00289       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_cryst.html#a3a1e89267d5241b9075ebe4d4184f800">SetSyminfoLib</a> ( <a class="code" href="namespacemmdb.html#a0432213352c8a90e8555c15636c6351e">cpstr</a> syminfoLib );
<a name="l00290"></a>00290       <a class="code" href="namespacemmdb.html#ae4679f2216e36062ed20ef4774c3cfef">pstr</a>  <a class="code" href="classmmdb_1_1_cryst.html#ad304dc22bfc6f1ba09e5f54596f31bfb">GetSyminfoLib</a> ();
<a name="l00291"></a>00291 
<a name="l00292"></a>00292       <span class="keywordtype">int</span>   <a class="code" href="classmmdb_1_1_cryst.html#a7bd3ea169f77f1020757e5088aa9b6ea">SetSpaceGroup</a> ( <a class="code" href="namespacemmdb.html#a0432213352c8a90e8555c15636c6351e">cpstr</a> spGroup );
<a name="l00293"></a>00293       <a class="code" href="namespacemmdb.html#ae4679f2216e36062ed20ef4774c3cfef">pstr</a>  <a class="code" href="classmmdb_1_1_cryst.html#aac6f95382d5a125646b33059c8c61765">GetSpaceGroup</a> ();
<a name="l00294"></a>00294       <a class="code" href="namespacemmdb.html#ae4679f2216e36062ed20ef4774c3cfef">pstr</a>  <a class="code" href="classmmdb_1_1_cryst.html#a861fb6fe5a1365454e33c1c161560f58">GetSpaceGroupFix</a>();
<a name="l00295"></a>00295 
<a name="l00296"></a>00296       <span class="comment">//   CalcCoordTransforms() should be called once after all data</span>
<a name="l00297"></a>00297       <span class="comment">// relevant to the crystallographic information, are read and</span>
<a name="l00298"></a>00298       <span class="comment">// converted. Field CellCheck will then have bits set if there</span>
<a name="l00299"></a>00299       <span class="comment">// are errors, e.g. bit CCHK_NoCell means that the coordinate</span>
<a name="l00300"></a>00300       <span class="comment">// transformations cannot be performed.</span>
<a name="l00301"></a>00301       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_cryst.html#ac630d6cd7171b48b1af99df75e697fc0">CalcCoordTransforms</a>();
<a name="l00302"></a>00302 
<a name="l00303"></a>00303       <span class="comment">// A PDB ASCII dump</span>
<a name="l00304"></a>00304       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_cryst.html#a6471eb7e66d9b167c8a4a7785feea61c">PDBASCIIDump</a> ( io::RFile <a class="code" href="namespacemmdb_1_1mmcif.html#a2fd02f46175faf5e2161124aa83df1b5">f</a> );
<a name="l00305"></a>00305 
<a name="l00306"></a>00306       <a class="code" href="namespacemmdb.html#af715440dd114899315845ae6bba285c9">ERROR_CODE</a> <a class="code" href="classmmdb_1_1_cryst.html#adcf80e5fe25e400e02724d38ebcae1a4">GetCIF</a>  ( mmcif::PData CIF );
<a name="l00307"></a>00307       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_cryst.html#aea52b3d7aa9fec7355c8aeb7d3b12725">MakeCIF</a> ( mmcif::PData CIF );
<a name="l00308"></a>00308 
<a name="l00309"></a>00309       <span class="keywordtype">bool</span> <a class="code" href="classmmdb_1_1_cryst.html#a38f84b96cfe2c52a4c72e694d6796b05">areMatrices</a>();  <span class="comment">// returns True if the orthogonal-to-</span>
<a name="l00310"></a>00310                               <span class="comment">// fractional and fractional-to-orthogonal</span>
<a name="l00311"></a>00311                               <span class="comment">// matrices are defined</span>
<a name="l00312"></a>00312 
<a name="l00313"></a>00313       <span class="comment">//   Frac2Orth(..) and Orth2Frac(..) transform between fractional</span>
<a name="l00314"></a>00314       <span class="comment">// and orthogonal coordinates, if areMatrices() returns True.</span>
<a name="l00315"></a>00315       <span class="comment">// If the transformation matrices were not set, the functions just</span>
<a name="l00316"></a>00316       <span class="comment">// copy the coordinates.  Returns True if the transformation was</span>
<a name="l00317"></a>00317       <span class="comment">// done; False return means that transformation matrices were not</span>
<a name="l00318"></a>00318       <span class="comment">// calculated</span>
<a name="l00319"></a>00319       <span class="keywordtype">bool</span> <a class="code" href="classmmdb_1_1_cryst.html#a956748d3e61875dc163e73e3a19df646">Frac2Orth</a> (
<a name="l00320"></a>00320                 <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> x,    <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> y,    <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> z,
<a name="l00321"></a>00321                 <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; xx, <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; yy, <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; zz );
<a name="l00322"></a>00322       <span class="keywordtype">bool</span> <a class="code" href="classmmdb_1_1_cryst.html#aa6de274fdd88eba5023a8eac4c2e897a">Orth2Frac</a> (
<a name="l00323"></a>00323                 <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> x,    <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> y,    <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> z,
<a name="l00324"></a>00324                 <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; xx, <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; yy, <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> &amp; zz );
<a name="l00325"></a>00325 
<a name="l00326"></a>00326       <span class="comment">//   Below, F and T are transformation matrices in fractional and</span>
<a name="l00327"></a>00327       <span class="comment">// orthogonal coordinates, respectively.</span>
<a name="l00328"></a>00328       <span class="keywordtype">bool</span> <a class="code" href="classmmdb_1_1_cryst.html#a956748d3e61875dc163e73e3a19df646">Frac2Orth</a> ( <a class="code" href="namespacemmdb.html#af201af7b5a3f8048870cc0dc176e8cf7" title="matrix 4x4 of real numbers">mat44</a> &amp; F, <a class="code" href="namespacemmdb.html#af201af7b5a3f8048870cc0dc176e8cf7" title="matrix 4x4 of real numbers">mat44</a> &amp; T );
<a name="l00329"></a>00329       <span class="keywordtype">bool</span> <a class="code" href="classmmdb_1_1_cryst.html#aa6de274fdd88eba5023a8eac4c2e897a">Orth2Frac</a> ( <a class="code" href="namespacemmdb.html#af201af7b5a3f8048870cc0dc176e8cf7" title="matrix 4x4 of real numbers">mat44</a> &amp; T, <a class="code" href="namespacemmdb.html#af201af7b5a3f8048870cc0dc176e8cf7" title="matrix 4x4 of real numbers">mat44</a> &amp; F );
<a name="l00330"></a>00330 
<a name="l00331"></a>00331 
<a name="l00332"></a>00332       <span class="comment">//   Cryst2Orth(..) and Orth2Cryst(..) transform between fractional</span>
<a name="l00333"></a>00333       <span class="comment">// and orthogonal anisotropic temperature factors, if areMatrices()</span>
<a name="l00334"></a>00334       <span class="comment">// returns True. If the transformation matrices were not set, the</span>
<a name="l00335"></a>00335       <span class="comment">// functions leave the factors unchanged.</span>
<a name="l00336"></a>00336       <span class="comment">//   Vector U is composed as follows:</span>
<a name="l00337"></a>00337       <span class="comment">//      U[0]=u11   U[1]=u22   U[2]=u33</span>
<a name="l00338"></a>00338       <span class="comment">//      U[3]=u12   U[4]=u13   U[5]=u23</span>
<a name="l00339"></a>00339       <span class="comment">// Returns True if the transformation was done; False retuen</span>
<a name="l00340"></a>00340       <span class="comment">// means that transformation matrices were not calculated</span>
<a name="l00341"></a>00341       <span class="keywordtype">bool</span>  <a class="code" href="classmmdb_1_1_cryst.html#a34d471cdd8616001e09f2f3eb75539fd">Cryst2Orth</a> ( <a class="code" href="namespacemmdb.html#abe4abc147eb794001aecc6a4ab85addb">rvector</a> U );
<a name="l00342"></a>00342       <span class="keywordtype">bool</span>  <a class="code" href="classmmdb_1_1_cryst.html#a12e7ceb4dc248a5ac481b7afbffcfe2e">Orth2Cryst</a> ( <a class="code" href="namespacemmdb.html#abe4abc147eb794001aecc6a4ab85addb">rvector</a> U );
<a name="l00343"></a>00343 
<a name="l00344"></a>00344       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_cryst.html#a4ac75c61544b5bda4811375f96b17335">CalcOrthMatrices</a>();  <span class="comment">// calculates RR, AC, cella&#39;s and Vol</span>
<a name="l00345"></a>00345 
<a name="l00346"></a>00346       <span class="keywordtype">bool</span>  <a class="code" href="classmmdb_1_1_cryst.html#a9b989552fbc0b5838e2cf25b4c462251">isNCSMatrix</a>     ();
<a name="l00347"></a>00347       <span class="keywordtype">bool</span>  <a class="code" href="classmmdb_1_1_cryst.html#a9a07604196392fb793b2f7721f177837">isScaleMatrix</a>   ();
<a name="l00348"></a>00348       <span class="keywordtype">bool</span>  <a class="code" href="classmmdb_1_1_cryst.html#a274036d158e1036f7dd9a6ad8b9664c3">isCellParameters</a>();
<a name="l00349"></a>00349 
<a name="l00350"></a>00350       <span class="keywordtype">int</span>   <a class="code" href="classmmdb_1_1_cryst.html#a7680ed38f2f5203f11088411cc8aee06">GetNumberOfSymOps</a>();
<a name="l00351"></a>00351       <a class="code" href="namespacemmdb.html#ae4679f2216e36062ed20ef4774c3cfef">pstr</a>  <a class="code" href="classmmdb_1_1_cryst.html#a888196eca86d841b22569c73d59d864e">GetSymOp</a> ( <span class="keywordtype">int</span> Nop );
<a name="l00352"></a>00352 
<a name="l00353"></a>00353       <span class="keywordtype">int</span>   <a class="code" href="classmmdb_1_1_cryst.html#ab2e7a277e84da9327ae6046890651d93">GetNumberOfNCSMatrices</a>();
<a name="l00354"></a>00354       <span class="keywordtype">int</span>   <a class="code" href="classmmdb_1_1_cryst.html#aa9682267b018d4e845441b3f7200a34a">GetNumberOfNCSMates</a>   ();  <span class="comment">// Returns the number of</span>
<a name="l00355"></a>00355                                        <span class="comment">// NCS mates not given in</span>
<a name="l00356"></a>00356                                        <span class="comment">// the file (iGiven==0)</span>
<a name="l00357"></a>00357 
<a name="l00358"></a>00358       <span class="keywordtype">bool</span>  <a class="code" href="classmmdb_1_1_cryst.html#ae9b77e399835a46944104c9549e81a28">GetNCSMatrix</a> ( <span class="keywordtype">int</span> NCSMatrixNo, <a class="code" href="namespacemmdb.html#a820931a0033798fadcf181ae179e6a2f" title="matrix 3x3 of real numbers">mat33</a> &amp; ncs_m,
<a name="l00359"></a>00359                            <a class="code" href="namespacemmdb.html#aa764d2cc94c71cc7c2969a905af43d3c" title="vector of 3 real numbers">vect3</a> &amp; ncs_v );
<a name="l00360"></a>00360       <span class="keywordtype">bool</span>  <a class="code" href="classmmdb_1_1_cryst.html#ae9b77e399835a46944104c9549e81a28">GetNCSMatrix</a> ( <span class="keywordtype">int</span> NCSMatrixNo, <a class="code" href="namespacemmdb.html#af201af7b5a3f8048870cc0dc176e8cf7" title="matrix 4x4 of real numbers">mat44</a> &amp; ncs_m,
<a name="l00361"></a>00361                            <span class="keywordtype">int</span> &amp; iGiven ); <span class="comment">// no=0..N-1</span>
<a name="l00362"></a>00362       <span class="keywordtype">int</span>   <a class="code" href="classmmdb_1_1_cryst.html#ae7f169e5727686fe8d88cc6cc251ded6">AddNCSMatrix</a> ( <a class="code" href="namespacemmdb.html#a820931a0033798fadcf181ae179e6a2f" title="matrix 3x3 of real numbers">mat33</a> &amp; ncs_m, <a class="code" href="namespacemmdb.html#aa764d2cc94c71cc7c2969a905af43d3c" title="vector of 3 real numbers">vect3</a> &amp; ncs_v, <span class="keywordtype">int</span> iGiven );
<a name="l00363"></a>00363 
<a name="l00364"></a>00364       <span class="comment">//  GetTMatrix(..) calculates and returns the coordinate</span>
<a name="l00365"></a>00365       <span class="comment">//  transformation matrix, which converts orthogonal coordinates</span>
<a name="l00366"></a>00366       <span class="comment">//  according to the symmetry operation number Nop and places</span>
<a name="l00367"></a>00367       <span class="comment">//  them into unit cell shifted by cellshift_a a&#39;s, cellshift_b</span>
<a name="l00368"></a>00368       <span class="comment">//  b&#39;s and cellshift_c c&#39;s.</span>
<a name="l00369"></a>00369       <span class="comment">//</span>
<a name="l00370"></a>00370       <span class="comment">//  Return 0 means everything&#39;s fine,</span>
<a name="l00371"></a>00371       <span class="comment">//         1 there&#39;s no symmetry operation Nop defined</span>
<a name="l00372"></a>00372       <span class="comment">//         2 fractionalizing/orthogonalizing matrices were not</span>
<a name="l00373"></a>00373       <span class="comment">//           calculated</span>
<a name="l00374"></a>00374       <span class="comment">//         3 cell parameters were not set up.</span>
<a name="l00375"></a>00375       <span class="keywordtype">int</span>   <a class="code" href="classmmdb_1_1_cryst.html#a97b34d295fd447a9378bc7d050277bbc">GetTMatrix</a> ( <a class="code" href="namespacemmdb.html#af201af7b5a3f8048870cc0dc176e8cf7" title="matrix 4x4 of real numbers">mat44</a> &amp; TMatrix, <span class="keywordtype">int</span> Nop,
<a name="l00376"></a>00376                          <span class="keywordtype">int</span> cellshift_a, <span class="keywordtype">int</span> cellshift_b,
<a name="l00377"></a>00377                          <span class="keywordtype">int</span> cellshift_c, PSymOps symOpers=NULL );
<a name="l00378"></a>00378 
<a name="l00379"></a>00379       <span class="comment">//  GetUCTMatrix(..) calculates and returns the coordinate</span>
<a name="l00380"></a>00380       <span class="comment">//  transformation matrix, which converts orthogonal coordinates</span>
<a name="l00381"></a>00381       <span class="comment">//  according to the symmetry operation Nop. Translation part</span>
<a name="l00382"></a>00382       <span class="comment">//  of the matrix is  being chosen such that point (x,y,z) has</span>
<a name="l00383"></a>00383       <span class="comment">//  least distance to the center of primary (333) unit cell,</span>
<a name="l00384"></a>00384       <span class="comment">//  and then it is shifted by cellshift_a a&#39;s, cellshift_b b&#39;s</span>
<a name="l00385"></a>00385       <span class="comment">//  and cellshift_c c&#39;s.</span>
<a name="l00386"></a>00386       <span class="comment">//</span>
<a name="l00387"></a>00387       <span class="comment">//  Return 0 means everything&#39;s fine,</span>
<a name="l00388"></a>00388       <span class="comment">//         1 there&#39;s no symmetry operation Nop defined</span>
<a name="l00389"></a>00389       <span class="comment">//         2 fractionalizing/orthogonalizing matrices were not</span>
<a name="l00390"></a>00390       <span class="comment">//           calculated</span>
<a name="l00391"></a>00391       <span class="comment">//         3 cell parameters were not set up.</span>
<a name="l00392"></a>00392       <span class="comment">//</span>
<a name="l00393"></a>00393       <span class="keywordtype">int</span>   <a class="code" href="classmmdb_1_1_cryst.html#aac0ca0acd3a3120dadaa1be985184ab7">GetUCTMatrix</a> ( <a class="code" href="namespacemmdb.html#af201af7b5a3f8048870cc0dc176e8cf7" title="matrix 4x4 of real numbers">mat44</a> &amp; TMatrix, <span class="keywordtype">int</span> Nop,
<a name="l00394"></a>00394                            <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> x, <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> y, <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a> z,
<a name="l00395"></a>00395                            <span class="keywordtype">int</span> cellshift_a, <span class="keywordtype">int</span> cellshift_b,
<a name="l00396"></a>00396                            <span class="keywordtype">int</span> cellshift_c, PSymOps symOpers=NULL );
<a name="l00397"></a>00397 
<a name="l00398"></a>00398       <span class="comment">//  GetFractMatrix(..) calculates and returns the coordinate</span>
<a name="l00399"></a>00399       <span class="comment">//  transformation matrix, which converts fractional coordinates</span>
<a name="l00400"></a>00400       <span class="comment">//  according to the symmetry operation number Nop and places them</span>
<a name="l00401"></a>00401       <span class="comment">//  into unit cell shifted by cellshift_a a&#39;s, cellshift_b b&#39;s and</span>
<a name="l00402"></a>00402       <span class="comment">//  cellshift_c c&#39;s.</span>
<a name="l00403"></a>00403       <span class="comment">//</span>
<a name="l00404"></a>00404       <span class="comment">//  Return 0 means everything&#39;s fine,</span>
<a name="l00405"></a>00405       <span class="comment">//         1 there&#39;s no symmetry operation Nop defined</span>
<a name="l00406"></a>00406       <span class="comment">//         2 fractionalizing/orthogonalizing matrices were not</span>
<a name="l00407"></a>00407       <span class="comment">//           calculated</span>
<a name="l00408"></a>00408       <span class="comment">//         3 cell parameters were not set up.</span>
<a name="l00409"></a>00409       <span class="keywordtype">int</span>   <a class="code" href="classmmdb_1_1_cryst.html#a3e249720a233dbb6aa81b934b36cb19a">GetFractMatrix</a> ( <a class="code" href="namespacemmdb.html#af201af7b5a3f8048870cc0dc176e8cf7" title="matrix 4x4 of real numbers">mat44</a> &amp; TMatrix, <span class="keywordtype">int</span> Nop,
<a name="l00410"></a>00410                              <span class="keywordtype">int</span> cellshift_a, <span class="keywordtype">int</span> cellshift_b,
<a name="l00411"></a>00411                              <span class="keywordtype">int</span> cellshift_c, PSymOps symOpers=NULL );
<a name="l00412"></a>00412 
<a name="l00413"></a>00413       <span class="comment">//  GetSymOpMatrix(..) returns the transformation matrix for</span>
<a name="l00414"></a>00414       <span class="comment">//  Nop-th symmetry operator in the space group</span>
<a name="l00415"></a>00415       <span class="comment">//</span>
<a name="l00416"></a>00416       <span class="comment">//  Return 0 means everything&#39;s fine,</span>
<a name="l00417"></a>00417       <span class="comment">//         1 there&#39;s no symmetry operation Nop defined</span>
<a name="l00418"></a>00418       <span class="comment">//         2 fractionalizing/orthogonalizing matrices were not</span>
<a name="l00419"></a>00419       <span class="comment">//           calculated</span>
<a name="l00420"></a>00420       <span class="comment">//         3 cell parameters were not set up.</span>
<a name="l00421"></a>00421       <span class="comment">//</span>
<a name="l00422"></a>00422       <span class="keywordtype">int</span>   <a class="code" href="classmmdb_1_1_cryst.html#a2385953e8a7a9d2ac26e777e7f633a9d">GetSymOpMatrix</a> ( <a class="code" href="namespacemmdb.html#af201af7b5a3f8048870cc0dc176e8cf7" title="matrix 4x4 of real numbers">mat44</a> &amp; TMatrix, <span class="keywordtype">int</span> Nop );
<a name="l00423"></a>00423 
<a name="l00424"></a>00424       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_cryst.html#a36c3ac9cdfb3ef8e0d537e6dc1fa8688">Copy</a>  ( PCryst <a class="code" href="classmmdb_1_1_cryst.html">Cryst</a> );
<a name="l00425"></a>00425 
<a name="l00426"></a>00426       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_cryst.html#a6c31924228b61ed5d4a15395aa227b60">write</a> ( io::RFile <a class="code" href="namespacemmdb_1_1mmcif.html#a2fd02f46175faf5e2161124aa83df1b5">f</a> );    <span class="comment">// writes header to PDB binary file</span>
<a name="l00427"></a>00427       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_cryst.html#a129cde701002e6572b0af7b464ed5cca">read</a>  ( io::RFile <a class="code" href="namespacemmdb_1_1mmcif.html#a2fd02f46175faf5e2161124aa83df1b5">f</a> );    <span class="comment">// reads header from PDB binary file</span>
<a name="l00428"></a>00428 
<a name="l00429"></a>00429     <span class="keyword">protected</span> :
<a name="l00430"></a>00430 
<a name="l00431"></a><a class="code" href="classmmdb_1_1_cryst.html#acebdff8be2fa6b478bd4ab721100ede1">00431</a>       <a class="code" href="classmmdb_1_1_cryst_container.html">CrystContainer</a> <a class="code" href="classmmdb_1_1_cryst.html#acebdff8be2fa6b478bd4ab721100ede1">ncsMatrix</a>;      <span class="comment">// non-cryst. symm. matrices</span>
<a name="l00432"></a><a class="code" href="classmmdb_1_1_cryst.html#a00929861dfb017641b43a136c653ac1c">00432</a>       <a class="code" href="classmmdb_1_1_cryst_container.html">CrystContainer</a> <a class="code" href="classmmdb_1_1_cryst.html#a00929861dfb017641b43a136c653ac1c">tVect</a>;          <span class="comment">// translation vectors</span>
<a name="l00433"></a>00433 
<a name="l00434"></a><a class="code" href="classmmdb_1_1_cryst.html#a56d48495794d09cd6a305c09f9f93a4d">00434</a>       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a>  <a class="code" href="classmmdb_1_1_cryst.html#aa94aff20191433f95072ae865cf74421">as</a>,<a class="code" href="classmmdb_1_1_cryst.html#a6f2d4888c6bf560cd41cfa4da195713b">bs</a>,<a class="code" href="classmmdb_1_1_cryst.html#a56d48495794d09cd6a305c09f9f93a4d">cs</a>;             <span class="comment">// calculated &#39;cell parameters&#39;</span>
<a name="l00435"></a><a class="code" href="classmmdb_1_1_cryst.html#ad0265a30480e437eea39d3e40b5aee59">00435</a>       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a>  <a class="code" href="classmmdb_1_1_cryst.html#af1a4ca5d5dbd5d11df0af102b6ecf8b7">alphas</a>,<a class="code" href="classmmdb_1_1_cryst.html#ae28fa8189169ab145d28bdd61452d080">betas</a>,<a class="code" href="classmmdb_1_1_cryst.html#ad0265a30480e437eea39d3e40b5aee59">gammas</a>;  <span class="comment">// calculated &#39;cell parameters&#39;</span>
<a name="l00436"></a><a class="code" href="classmmdb_1_1_cryst.html#afcaba85e4a3b930cd0ce937104486554">00436</a>       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a>  <a class="code" href="classmmdb_1_1_cryst.html#afcaba85e4a3b930cd0ce937104486554">AC</a>[6];
<a name="l00437"></a><a class="code" href="classmmdb_1_1_cryst.html#a7b2158e378a717c00558a1ab9ecc41a6">00437</a>       <a class="code" href="namespacemmdb.html#aedf45172577d6e2171ecfe7fb8f672fd">realtype</a>  <a class="code" href="classmmdb_1_1_cryst.html#a611726f497352b798c1b06831ef833ea">VolChk</a>,<a class="code" href="classmmdb_1_1_cryst.html#a7b2158e378a717c00558a1ab9ecc41a6">VolErr</a>;
<a name="l00438"></a>00438 
<a name="l00439"></a><a class="code" href="classmmdb_1_1_cryst.html#a921b4868a093290ff12de7ee04ac0654">00439</a>       <a class="code" href="namespacemmdb.html#ae4679f2216e36062ed20ef4774c3cfef">pstr</a>      <a class="code" href="classmmdb_1_1_cryst.html#a921b4868a093290ff12de7ee04ac0654">syminfo_lib</a>;          <span class="comment">// path to syminfo.lib</span>
<a name="l00440"></a><a class="code" href="classmmdb_1_1_cryst.html#a43901ccc548d98c8a40d868e76cb6b58">00440</a>       <a class="code" href="classmmdb_1_1_sym_ops.html">SymOps</a>    <a class="code" href="classmmdb_1_1_cryst.html#a43901ccc548d98c8a40d868e76cb6b58">symOps</a>;               <span class="comment">// symmetry operations</span>
<a name="l00441"></a>00441 
<a name="l00442"></a>00442       <span class="keywordtype">void</span>  <a class="code" href="classmmdb_1_1_cryst.html#a4ba96fc10ddd9bc86e823938c1200b83">Init</a> ( <span class="keywordtype">bool</span> fullInit );
<a name="l00443"></a>00443       <span class="keywordtype">int</span>   <a class="code" href="classmmdb_1_1_cryst.html#a4c6593c36d36cf2f233533f5d9c55ede">FixSpaceGroup</a>();
<a name="l00444"></a>00444 
<a name="l00445"></a>00445   };
<a name="l00446"></a>00446 
<a name="l00447"></a>00447   <span class="keyword">extern</span> <a class="code" href="namespacemmdb.html#a0432213352c8a90e8555c15636c6351e">cpstr</a> <a class="code" href="namespacemmdb.html#ac84aba8e588c24adf88cd2e41591fb59">getOrthCodeName</a> ( <span class="keywordtype">int</span> NCode );
<a name="l00448"></a>00448 
<a name="l00449"></a>00449 }  <span class="comment">// namespace mmdb</span>
<a name="l00450"></a>00450 
<a name="l00451"></a>00451 <span class="comment">/*</span>
<a name="l00452"></a>00452 <span class="comment">extern void  TestCryst();  //  reads from &#39;in.cryst&#39;, writes into</span>
<a name="l00453"></a>00453 <span class="comment">                           //  &#39;out.cryst&#39; and &#39;abin.cryst&#39;</span>
<a name="l00454"></a>00454 <span class="comment">*/</span>
<a name="l00455"></a>00455 
<a name="l00456"></a>00456 
<a name="l00457"></a>00457 <span class="preprocessor">#endif</span>
<a name="l00458"></a>00458 <span class="preprocessor"></span>
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Tue Nov 19 2013 12:37:24 for MMDB Coordinate Library by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
